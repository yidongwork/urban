/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n","esri/layers/FeatureEditResult":function(){define("esri/layers/FeatureEditResult",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_1,_2,_3,_4){var _5=_1(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(_6){if(_6&&_2.isObject(_6)){this.objectId=_6.objectId;this.success=_6.success;if(!_6.success){var _7=_6.error;this.error=new Error();this.error.code=_7.code;this.error.message=_7.description;}}}});if(_3("extend-esri")){_2.setObject("layers.FeatureEditResult",_5,_4);}return _5;});},"esri/dijit/editing/tools/ToolBase":function(){define("esri/dijit/editing/tools/ToolBase",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","dojo/i18n!esri/nls/jsapi"],function(_8,_9,_a,_b,_c){var _d=_8(null,{declaredClass:"esri.dijit.editing.tools.ToolBase",_enabled:true,showLabel:false,constructor:function(_e,_f){_e=_e||{};_9.mixin(this,_e);this.label=this._label?_c.widgets.editor.tools[this._label]:"";this._settings=_e.settings;this._toolbar=_e.settings.drawToolbar;this._editToolbar=_e.settings.editToolbar;this._initializeTool();},onFinished:function(){},onDrawEnd:function(){},onApplyEdits:function(){},postCreate:function(){this.deactivate();this.inherited(arguments);},destroy:function(){},activate:function(_10){if(this._toolbar){this._toolbar.deactivate();}if(this._editToolbar){this._editToolbar.deactivate();}if(!this._enabled){return;}this._checked=true;this._layer=_10;if(this._toolbar&&this._drawType){this._toolbar.activate(this._drawType);}},deactivate:function(){if(this._toolbar){this._toolbar.deactivate();}if(this._editToolbar){this._editToolbar.deactivate();}this.setChecked(false);this._updateUI();},setEnabled:function(_11){this._enabled=_11;this._updateUI();},setChecked:function(_12){this._checked=_12;},enable:function(_13){this._updateUI();},isEnabled:function(){return this._enabled;},getToolName:function(){return this._toolName;},_initializeTool:function(){},_updateUI:function(){this.disabled=!this._enabled;this.attr("iconClass",this._enabled?this._enabledIcon:this._disabledIcon);}});if(_a("extend-esri")){_9.setObject("dijit.editing.tools.ToolBase",_d,_b);}return _d;});},"esri/dijit/editing/SelectionHelper":function(){define("esri/dijit/editing/SelectionHelper",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dojo/DeferredList","esri/geometry/Extent","esri/geometry/Point","esri/geometry/ScreenPoint","esri/layers/FeatureLayer","esri/tasks/query","esri/kernel"],function(_14,_15,_16,_17,has,_18,_19,_1a,_1b,_1c,_1d,_1e){var SH=_14(null,{declaredClass:"esri.dijit.editing.SelectionHelper",constructor:function(_1f){this._settings=_1f||{};this._sConnects=[];this._mapServiceCount=0;this._map=this._settings.map;this._tolerance=this._settings.singleSelectionTolerance;this._initMapServiceInfos(this._settings.layers);},destroy:function(){var _20;for(_20 in this._sConnects){if(this._sConnects.hasOwnProperty(_20)){_20.disconnect(this._sConnects[_20]);}}},selectFeatures:function(_21,_22,_23,_24){if(_23===_1c.SELECTION_NEW){this._resetMapServiceInfos();this.getSelection(_21);}var _25=[];_17.forEach(_21,function(_26){if(_26.visible===true&&_26._isMapAtVisibleScale()===true){var _27=_23;if(_26._isSelOnly&&_27===_1c.SELECTION_NEW){_27=_1c.SELECTION_ADD;}_25.push(_26.selectFeatures(_22,_27));}});var _28=new _18(_25);_28.addCallback(_15.hitch(this,function(_29){var _2a=[];_17.forEach(_29,function(set,idx){_17.forEach(set[1],function(_2b){var _2c=_2b.attributes[_21[idx].objectIdField];_2b=_21[idx]._mode._getFeature(_2c)||null;if(_2b){_2a.push(_2b);}},this);},this);if(!this._mapServiceCount){_24(_2a);return;}var _2d=_23===_1c.SELECTION_SUBTRACT;if(_2d){this._resetMapServiceInfos();this._createLayerDefs(this._getLayerInfosFromSelection(_21));}else{this._createLayerDefs(this._getLayerInfosFromFeatures(_2a));}this._updateLayerDefs(this._mapServiceInfos,false,!((_2a&&_2a.length)||_2d),_15.hitch(this,_24,_2a));}));},selectFeaturesByGeometry:function(_2e,_2f,_30,_31){var _32=_2f;if(_2f.declaredClass.indexOf("Extent")!==-1){if(_2f.xmax===_2f.xmin&&_2f.ymax===_2f.ymin){_32=new _1a(_2f.xmax,_2f.ymax,_2f.spatialReference);}}_32=(_32.declaredClass.indexOf("Point")!==-1)?this._extentFromPoint(_32):_32;var _33=new _1d();_33.geometry=_32;this.selectFeatures(_2e,_33,_30,_31);},clearSelection:function(_34){var _35=this._nonSelOnlyLayers;_17.forEach(_35,function(_36){if(_36.clearSelection){_36.clearSelection();}});if(!this._mapServiceCount){return;}this._resetMapServiceInfos();var _37=this._getLayerInfosFromSelection(this._settings.layers);var _38=_17.some(_37,function(_39){return _39.oids&&_39.oids.length;});if(_38){this._createLayerDefs(_37);this._updateLayerDefs(this._mapServiceInfos,true,_34||false);}},findMapService:function(_3a){var map=this._map,_3b=map.layerIds,_3c=(_3a&&_3a._url)?_3a._url.path.toLowerCase():"",_3d,_3e,_3f;for(_3e in _3b){if(_3b.hasOwnProperty(_3e)){_3d=map.getLayer(_3b[_3e]);_3f=_3d._url?_3d._url.path.toLowerCase().replace("mapserver","featureserver"):"";if(_3c.substr(0,_3f.length)===_3f&&_3d.declaredClass==="esri.layers.ArcGISDynamicMapServiceLayer"){return _3d;}}}},getSelection:function(_40){var _41=[];_17.forEach(_40,function(_42){if(_42._isSelOnly){_41.push(this._createLayerInfo(_42));}},this);_17.forEach(_41,function(_43){var _44=this._createMapServiceInfo(this.findMapService(_43.layer));if(_44){_44.layerInfos[_43.layer.layerId]=_43;}},this);},_initMapServiceInfos:function(_45){this._nonSelOnlyLayers=[];this._mapServiceInfos=[];_17.forEach(_45,function(_46){var _47=this.findMapService(_46);if(_47){this._mapServiceCount++;this._createMapServiceInfo(_47);if(_47){_47.setDisableClientCaching(true);}}else{this._nonSelOnlyLayers.push(_46);}},this);},_createMapServiceInfo:function(_48){if(!_48){return null;}var _49=this._mapServiceInfos;var _4a=_49[_48.id];if(!_4a){_4a=_49[_48.id]={mapService:_48,layerInfos:[],layerDefs:_15.mixin([],_48.layerDefinitions||[]),origLayerDefs:_15.mixin([],_48.layerDefinitions||[])};}return _4a;},_resetMapServiceInfo:function(_4b){_17.forEach(_4b.layerInfos,this._resetLayerInfo);_4b.layerDefs=_15.mixin([],_4b.origLayerDefs||[]);},_resetMapServiceInfos:function(){var _4c=this._mapServiceInfos,_4d;for(_4d in _4c){if(_4c.hasOwnProperty(_4d)){this._resetMapServiceInfo(_4c[_4d]);}}},_createLayerInfo:function(_4e,_4f){var _50=_4e.objectIdField;var _51=_4f?[]:_4e.getSelectedFeatures();return {layer:_4e,selectedFeatures:_51||[],oids:_17.map(_51,function(_52){return _52.attributes[_50];})};},_resetLayerInfo:function(_53){if(!_53){return;}_53.selectedFeatures=[];_53.oids=[];},_updateLayerDefs:function(_54,_55,_56,_57){var _58;for(_58 in _54){if(_54.hasOwnProperty(_58)){var _59=_54[_58];var _5a=_59.mapService;var _5b=_59.layerDefs=(_55?_15.mixin([],_59.origLayerDefs||[]):_59.layerDefs);if(_5b){if(!_56){this._sConnects[_5a.id]=(_16.connect(_5a,"onUpdateEnd",_15.hitch(this,"_onMapServiceUpdate",_59,_55,_57)));}else{if(_57){_57();}}_5a.setLayerDefinitions(_5b,_56||false);}else{if(_57){_57();}}}}},_onMapServiceUpdate:function(_5c,_5d,_5e){_16.disconnect(this._sConnects[_5c.mapService.id]);_17.forEach(_5c.layerInfos,function(_5f){if(_5d){if(_5f){_5f.layer.clearSelection();}}else{var _60=new _1d();_60.objectIds=_5f?_5f.oids:[];if(_60.objectIds.length){_5f.layer.selectFeatures(_60,_1c.SELECTION_SUBTRACT);}}},this);if(_5d){this._resetMapServiceInfo(_5c);}if(_5e){_5e();}},_createLayerDefs:function(_61){_17.forEach(_61,function(_62){var _63=_62.layer;var _64=this._createMapServiceInfo(this.findMapService(_62.layer));if(!_64){return;}var _65=_64.mapService;var _66=_64.layerDefs;var _67=_63.objectIdField;var _68=_63.layerId;var _69="(\""+_67+"\" NOT IN (";var _6a=_62.oids;if(_6a&&_6a.length){_17.forEach(_62.oids,function(oid,idx){_6a=true;if(idx){_69+=",";}_69+="'"+oid+"'";});_69+="))";if(_66.length&&(_66[_68]&&_66[_68].length)){_66[_68]+=" AND"+_69;}else{_66[_68]=_69;}}},this);},_getLayerInfosFromFeatures:function(_6b){var _6c=[];_17.forEach(_6b,function(_6d){var _6e=_6d.getLayer();if(_6e&&_6e._isSelOnly){if(!_6c[_6e.id]){_6c[_6e.id]=this._createLayerInfo(_6e,true);}_6c[_6e.id].selectedFeatures.push(_6d);_6c[_6e.id].oids.push(_6d.attributes[_6e.objectIdField]);}},this);var _6f=[],_70;for(_70 in _6c){if(_6c.hasOwnProperty(_70)){_6f.push(_6c[_70]);}}return _6f;},_getLayerInfosFromSelection:function(_71){var _72=[];_17.forEach(_71,function(_73){if(_73._isSelOnly){_72.push(this._createLayerInfo(_73,false));}},this);return _72;},_extentFromPoint:function(_74){var _75=this._tolerance;var map=this._map;var _76=map.toScreen(_74);var _77=new _1b(_76.x-_75,_76.y+_75);var _78=new _1b(_76.x+_75,_76.y-_75);var _79=map.toMap(_77);var _7a=map.toMap(_78);return new _19(_79.x,_79.y,_7a.x,_7a.y,map.spatialReference);}});if(has("extend-esri")){_15.setObject("dijit.editing.SelectionHelper",SH,_1e);}return SH;});},"dojox/grid/DataGrid":function(){define("dojox/grid/DataGrid",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/sniff","dojo/_base/declare","./_Grid","./DataSelection","dojo/_base/html"],function(_7b,_7c,_7d,_7e,has,_7f,_80,_81,_82){var _83=_7f("dojox.grid.DataGrid",_80,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:false,_isLoading:false,keepSelection:false,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments);},destroy:function(){this.selection.destroy();this.inherited(arguments);},createSelection:function(){this.selection=new _81(this);},get:function(_84,_85){if(_85&&this.field=="_item"&&!this.fields){return _85;}else{if(_85&&this.fields){var ret=[];var s=this.grid.store;_7c.forEach(this.fields,function(f){ret=ret.concat(s.getValues(_85,f));});return ret;}else{if(!_85&&typeof _84==="string"){return this.inherited(arguments);}}}return (!_85?this.defaultValue:(!this.field?this.value:(this.field=="_item"?_85:this.grid.store.getValue(_85,this.field))));},_checkUpdateStatus:function(){if(this.updateDelay>0){var _86=false;if(this._endUpdateDelay){clearTimeout(this._endUpdateDelay);delete this._endUpdateDelay;_86=true;}if(!this.updating){this.beginUpdate();_86=true;}if(_86){var _87=this;this._endUpdateDelay=setTimeout(function(){delete _87._endUpdateDelay;_87.endUpdate();},this.updateDelay);}}},_onSet:function(_88,_89,_8a,_8b){this._checkUpdateStatus();var idx=this.getItemIndex(_88);if(idx>-1){this.updateRow(idx);}},_createItem:function(_8c,_8d){var _8e=this._hasIdentity?this.store.getIdentity(_8c):_7e.toJson(this.query)+":idx:"+_8d+":sort:"+_7e.toJson(this.getSortProps());var o=this._by_idty[_8e]={idty:_8e,item:_8c};return o;},_addItem:function(_8f,_90,_91){this._by_idx[_90]=this._createItem(_8f,_90);if(!_91){this.updateRow(_90);}},_onNew:function(_92,_93){this._checkUpdateStatus();var _94=this.get("rowCount");this._addingItem=true;this.updateRowCount(_94+1);this._addingItem=false;this._addItem(_92,_94);this.showMessage();},_onDelete:function(_95){this._checkUpdateStatus();var idx=this._getItemIndex(_95,true);if(idx>=0){this._pages=[];this._bop=-1;this._eop=-1;var o=this._by_idx[idx];this._by_idx.splice(idx,1);delete this._by_idty[o.idty];this.updateRowCount(this.get("rowCount")-1);if(this.get("rowCount")===0){this.showMessage(this.noDataMessage);}}if(this.selection.isSelected(idx)){this.selection.deselect(idx);this.selection.selected.splice(idx,1);}},_onRevert:function(){this._refresh();},setStore:function(_96,_97,_98){if(this._requestsPending(0)){return;}this._setQuery(_97,_98);this._setStore(_96);this._refresh(true);},setQuery:function(_99,_9a){if(this._requestsPending(0)){return;}this._setQuery(_99,_9a);this._refresh(true);},setItems:function(_9b){this.items=_9b;this._setStore(this.store);this._refresh(true);},_setQuery:function(_9c,_9d){this.query=_9c;this.queryOptions=_9d||this.queryOptions;},_setStore:function(_9e){if(this.store&&this._store_connects){_7c.forEach(this._store_connects,this.disconnect,this);}this.store=_9e;if(this.store){var f=this.store.getFeatures();var h=[];this._canEdit=!!f["dojo.data.api.Write"]&&!!f["dojo.data.api.Identity"];this._hasIdentity=!!f["dojo.data.api.Identity"];if(!!f["dojo.data.api.Notification"]&&!this.items){h.push(this.connect(this.store,"onSet","_onSet"));h.push(this.connect(this.store,"onNew","_onNew"));h.push(this.connect(this.store,"onDelete","_onDelete"));}if(this._canEdit){h.push(this.connect(this.store,"revert","_onRevert"));}this._store_connects=h;}},_onFetchBegin:function(_9f,req){if(!this.scroller){return;}if(this.rowCount!=_9f){if(req.isRender){this.scroller.init(_9f,this.keepRows,this.rowsPerPage);this.rowCount=_9f;this._setAutoHeightAttr(this.autoHeight,true);this._skipRowRenormalize=true;this.prerender();this._skipRowRenormalize=false;}else{this.updateRowCount(_9f);}}if(!_9f){this.views.render();this._resize();this.showMessage(this.noDataMessage);this.focus.initFocusView();}else{this.showMessage();}},_onFetchComplete:function(_a0,req){if(!this.scroller){return;}if(_a0&&_a0.length>0){_7c.forEach(_a0,function(_a1,idx){this._addItem(_a1,req.start+idx,true);},this);this.updateRows(req.start,_a0.length);if(req.isRender){this.setScrollTop(0);this.postrender();}else{if(this._lastScrollTop){this.setScrollTop(this._lastScrollTop);}}if(has("ie")){_82.setSelectable(this.domNode,this.selectable);}}delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;}this._pending_requests[req.start]=false;},_onFetchError:function(err,req){console.log(err);delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;this.showMessage(this.errorMessage);}this._pending_requests[req.start]=false;this.onFetchError(err,req);},onFetchError:function(err,req){},_fetch:function(_a2,_a3){_a2=_a2||0;if(this.store&&!this._pending_requests[_a2]){if(!this._isLoaded&&!this._isLoading){this._isLoading=true;this.showMessage(this.loadingMessage);}this._pending_requests[_a2]=true;try{if(this.items){var _a4=this.items;var _a5=this.store;this.rowsPerPage=_a4.length;var req={start:_a2,count:this.rowsPerPage,isRender:_a3};this._onFetchBegin(_a4.length,req);var _a6=0;_7c.forEach(_a4,function(i){if(!_a5.isItemLoaded(i)){_a6++;}});if(_a6===0){this._onFetchComplete(_a4,req);}else{var _a7=function(_a8){_a6--;if(_a6===0){this._onFetchComplete(_a4,req);}};_7c.forEach(_a4,function(i){if(!_a5.isItemLoaded(i)){_a5.loadItem({item:i,onItem:_a7,scope:this});}},this);}}else{this.store.fetch({start:_a2,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:_a3,onBegin:_7d.hitch(this,"_onFetchBegin"),onComplete:_7d.hitch(this,"_onFetchComplete"),onError:_7d.hitch(this,"_onFetchError")});}}catch(e){this._onFetchError(e,{start:_a2,count:this.rowsPerPage});}}},_clearData:function(){this.updateRowCount(0);this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoaded=false;this._isLoading=false;},getItem:function(idx){var _a9=this._by_idx[idx];if(!_a9||(_a9&&!_a9.item)){this._preparePage(idx);return null;}return _a9.item;},getItemIndex:function(_aa){return this._getItemIndex(_aa,false);},_getItemIndex:function(_ab,_ac){if(!_ac&&!this.store.isItem(_ab)){return -1;}var _ad=this._hasIdentity?this.store.getIdentity(_ab):null;for(var i=0,l=this._by_idx.length;i<l;i++){var d=this._by_idx[i];if(d&&((_ad&&d.idty==_ad)||(d.item===_ab))){return i;}}return -1;},filter:function(_ae,_af){this.query=_ae;if(_af){this._clearData();}this._fetch();},_getItemAttr:function(idx,_b0){var _b1=this.getItem(idx);return (!_b1?this.fetchText:this.store.getValue(_b1,_b0));},_render:function(){if(this.domNode.parentNode){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this._fetch(0,true);}},_requestsPending:function(_b2){return this._pending_requests[_b2];},_rowToPage:function(_b3){return (this.rowsPerPage?Math.floor(_b3/this.rowsPerPage):_b3);},_pageToRow:function(_b4){return (this.rowsPerPage?this.rowsPerPage*_b4:_b4);},_preparePage:function(_b5){if((_b5<this._bop||_b5>=this._eop)&&!this._addingItem){var _b6=this._rowToPage(_b5);this._needPage(_b6);this._bop=_b6*this.rowsPerPage;this._eop=this._bop+(this.rowsPerPage||this.get("rowCount"));}},_needPage:function(_b7){if(!this._pages[_b7]){this._pages[_b7]=true;this._requestPage(_b7);}},_requestPage:function(_b8){var row=this._pageToRow(_b8);var _b9=Math.min(this.rowsPerPage,this.get("rowCount")-row);if(_b9>0){this._requests++;if(!this._requestsPending(row)){setTimeout(_7d.hitch(this,"_fetch",row,false),1);}}},getCellName:function(_ba){return _ba.field;},_refresh:function(_bb){this._clearData();this._fetch(0,_bb);},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh();},canSort:function(){return (!this._isLoading);},getSortProps:function(){var c=this.getCell(this.getSortIndex());if(!c){if(this.sortFields){return this.sortFields;}return null;}else{var _bc=c["sortDesc"];var si=!(this.sortInfo>0);if(typeof _bc=="undefined"){_bc=si;}else{_bc=si?!_bc:_bc;}return [{attribute:c.field,descending:_bc}];}},styleRowState:function(_bd){if(this.store&&this.store.getState){var _be=this.store.getState(_bd.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_be[s]){c=" dojoxGridRow-"+s;break;}}_bd.customClasses+=c;}},onStyleRow:function(_bf){this.styleRowState(_bf);this.inherited(arguments);},canEdit:function(_c0,_c1){return this._canEdit;},_copyAttr:function(idx,_c2){var row={};var _c3={};var src=this.getItem(idx);return this.store.getValue(src,_c2);},doStartEdit:function(_c4,_c5){if(!this._cache[_c5]){this._cache[_c5]=this._copyAttr(_c5,_c4.field);}this.onStartEdit(_c4,_c5);},doApplyCellEdit:function(_c6,_c7,_c8){this.store.fetchItemByIdentity({identity:this._by_idx[_c7].idty,onItem:_7d.hitch(this,function(_c9){var _ca=this.store.getValue(_c9,_c8);if(typeof _ca=="number"){_c6=isNaN(_c6)?_c6:parseFloat(_c6);}else{if(typeof _ca=="boolean"){_c6=_c6=="true"?true:_c6=="false"?false:_c6;}else{if(_ca instanceof Date){var _cb=new Date(_c6);_c6=isNaN(_cb.getTime())?_c6:_cb;}}}this.store.setValue(_c9,_c8,_c6);this.onApplyCellEdit(_c6,_c7,_c8);})});},doCancelEdit:function(_cc){var _cd=this._cache[_cc];if(_cd){this.updateRow(_cc);delete this._cache[_cc];}this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_ce,_cf){var _d0=this._cache[_ce];this.onApplyEdit(_ce);},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();var fx=_7d.hitch(this,function(_d1){if(_d1.length){_7c.forEach(_d1,this.store.deleteItem,this.store);this.selection.clear();}});if(this.allItemsSelected){this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:fx});}else{fx(this.selection.getSelected());}}}});_83.cell_markupFactory=function(_d2,_d3,_d4){var _d5=_7d.trim(_82.attr(_d3,"field")||"");if(_d5){_d4.field=_d5;}_d4.field=_d4.field||_d4.name;var _d6=_7d.trim(_82.attr(_d3,"fields")||"");if(_d6){_d4.fields=_d6.split(",");}if(_d2){_d2(_d3,_d4);}};_83.markupFactory=function(_d7,_d8,_d9,_da){return _80.markupFactory(_d7,_d8,_d9,_7d.partial(_83.cell_markupFactory,_da));};return _83;});},"dojox/grid/_FocusManager":function(){define("dojox/grid/_FocusManager",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/event","dojo/_base/sniff","dojo/query","./util","dojo/_base/html"],function(_db,_dc,_dd,_de,_df,has,_e0,_e1,_e2){return _dd("dojox.grid._FocusManager",null,{constructor:function(_e3){this.grid=_e3;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(_de.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(_de.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(_de.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(_de.connect(this.grid.domNode,"mouseup",this,"_mouseUp"));this._connects.push(_de.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(_de.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(_de.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(_de.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(_de.connect(this.grid,"postrender",this,"_delayedHeaderFocus"));},destroy:function(){_db.forEach(this._connects,_de.disconnect);_db.forEach(this._headerConnects,_de.disconnect);delete this.grid;delete this.cell;},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:false,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders();},isFocusCell:function(_e4,_e5){return (this.cell==_e4)&&(this.rowIndex==_e5);},isLastFocusCell:function(){if(this.cell){return (this.rowIndex==this.grid.rowCount-1)&&(this.cell.index==this.grid.layout.cellCount-1);}return false;},isFirstFocusCell:function(){if(this.cell){return (this.rowIndex===0)&&(this.cell.index===0);}return false;},isNoFocusCell:function(){return (this.rowIndex<0)||!this.cell;},isNavHeader:function(){return (!!this._colHeadNode);},getHeaderIndex:function(){if(this._colHeadNode){return _db.indexOf(this._findHeaderCells(),this._colHeadNode);}else{return -1;}},_focusifyCellNode:function(_e6){var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){_e2.toggleClass(n,this.focusClass,_e6);if(_e6){var sl=this.scrollIntoView();try{if(has("webkit")||!this.grid.edit.isEditing()){_e1.fire(n,"focus");if(sl){this.cell.view.scrollboxNode.scrollLeft=sl;}}}catch(e){}}}},_delayedCellFocus:function(){if(this.isNavHeader()||!this.grid.focused){return;}var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){try{if(!this.grid.edit.isEditing()){_e2.toggleClass(n,this.focusClass,true);if(this._colHeadNode){this.blurHeader();}_e1.fire(n,"focus");}}catch(e){}}},_delayedHeaderFocus:function(){if(this.isNavHeader()){this.focusHeader();}},_initColumnHeaders:function(){_db.forEach(this._headerConnects,_de.disconnect);this._headerConnects=[];var _e7=this._findHeaderCells();for(var i=0;i<_e7.length;i++){this._headerConnects.push(_de.connect(_e7[i],"onfocus",this,"doColHeaderFocus"));this._headerConnects.push(_de.connect(_e7[i],"onblur",this,"doColHeaderBlur"));}},_findHeaderCells:function(){var _e8=_e0("th",this.grid.viewsHeaderNode);var _e9=[];for(var i=0;i<_e8.length;i++){var _ea=_e8[i];var _eb=_e2.hasAttr(_ea,"tabIndex");var _ec=_e2.attr(_ea,"tabIndex");if(_eb&&_ec<0){_e9.push(_ea);}}return _e9;},_setActiveColHeader:function(_ed,_ee,_ef){this.grid.domNode.setAttribute("aria-activedescendant",_ed.id);if(_ef!=null&&_ef>=0&&_ef!=_ee){_e2.toggleClass(this._findHeaderCells()[_ef],this.focusClass,false);}_e2.toggleClass(_ed,this.focusClass,true);this._colHeadNode=_ed;this._colHeadFocusIdx=_ee;this._scrollHeader(this._colHeadFocusIdx);},scrollIntoView:function(){var _f0=(this.cell?this._scrollInfo(this.cell):null);if(!_f0||!_f0.s){return null;}var rt=this.grid.scroller.findScrollTop(this.rowIndex);if(_f0.n&&_f0.sr){if(_f0.n.offsetLeft+_f0.n.offsetWidth>_f0.sr.l+_f0.sr.w){_f0.s.scrollLeft=_f0.n.offsetLeft+_f0.n.offsetWidth-_f0.sr.w;}else{if(_f0.n.offsetLeft<_f0.sr.l){_f0.s.scrollLeft=_f0.n.offsetLeft;}}}if(_f0.r&&_f0.sr){if(rt+_f0.r.offsetHeight>_f0.sr.t+_f0.sr.h){this.grid.setScrollTop(rt+_f0.r.offsetHeight-_f0.sr.h);}else{if(rt<_f0.sr.t){this.grid.setScrollTop(rt);}}}return _f0.s.scrollLeft;},_scrollInfo:function(_f1,_f2){if(_f1){var cl=_f1,sbn=cl.view.scrollboxNode,_f3={w:sbn.clientWidth,l:sbn.scrollLeft,t:sbn.scrollTop,h:sbn.clientHeight},rn=cl.view.getRowNode(this.rowIndex);return {c:cl,s:sbn,sr:_f3,n:(_f2?_f2:_f1.getNode(this.rowIndex)),r:rn};}return null;},_scrollHeader:function(_f4){var _f5=null;if(this._colHeadNode){var _f6=this.grid.getCell(_f4);if(!_f6){return;}_f5=this._scrollInfo(_f6,_f6.getNode(0));}if(_f5&&_f5.s&&_f5.sr&&_f5.n){var _f7=_f5.sr.l+_f5.sr.w;if(_f5.n.offsetLeft+_f5.n.offsetWidth>_f7){_f5.s.scrollLeft=_f5.n.offsetLeft+_f5.n.offsetWidth-_f5.sr.w;}else{if(_f5.n.offsetLeft<_f5.sr.l){_f5.s.scrollLeft=_f5.n.offsetLeft;}else{if(has("ie")<=7&&_f6&&_f6.view.headerNode){_f6.view.headerNode.scrollLeft=_f5.s.scrollLeft;}}}}},_isHeaderHidden:function(){var _f8=this.focusView;if(!_f8){for(var i=0,_f9;(_f9=this.grid.views.views[i]);i++){if(_f9.headerNode){_f8=_f9;break;}}}return (_f8&&_e2.getComputedStyle(_f8.headerNode).display=="none");},colSizeAdjust:function(e,_fa,_fb){var _fc=this._findHeaderCells();var _fd=this.focusView;if(!_fd||!_fd.header.tableMap.map){for(var i=0,_fe;(_fe=this.grid.views.views[i]);i++){if(_fe.header.tableMap.map){_fd=_fe;break;}}}var _ff=_fc[_fa];if(!_fd||(_fa==_fc.length-1&&_fa===0)){return;}_fd.content.baseDecorateEvent(e);e.cellNode=_ff;e.cellIndex=_fd.content.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);if(_fd.header.canResize(e)){var _100={l:_fb};var drag=_fd.header.colResizeSetup(e,false);_fd.header.doResizeColumn(drag,null,_100);_fd.update();}},styleRow:function(_101){return;},setFocusIndex:function(_102,_103){this.setFocusCell(this.grid.getCell(_103),_102);},setFocusCell:function(_104,_105){if(_104&&!this.isFocusCell(_104,_105)){this.tabbingOut=false;if(this._colHeadNode){this.blurHeader();}this._colHeadNode=this._colHeadFocusIdx=null;this.focusGridView();this._focusifyCellNode(false);this.cell=_104;this.rowIndex=_105;this._focusifyCellNode(true);}if(has("opera")){setTimeout(_dc.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);}else{this.grid.onCellFocus(this.cell,this.rowIndex);}},next:function(){if(this.cell){var row=this.rowIndex,col=this.cell.index+1,cc=this.grid.layout.cellCount-1,rc=this.grid.rowCount-1;if(col>cc){col=0;row++;}if(row>rc){col=cc;row=rc;}if(this.grid.edit.isEditing()){var _106=this.grid.getCell(col);if(!this.isLastFocusCell()&&(!_106.editable||this.grid.canEdit&&!this.grid.canEdit(_106,row))){this.cell=_106;this.rowIndex=row;this.next();return;}}this.setFocusIndex(row,col);}},previous:function(){if(this.cell){var row=(this.rowIndex||0),col=(this.cell.index||0)-1;if(col<0){col=this.grid.layout.cellCount-1;row--;}if(row<0){row=0;col=0;}if(this.grid.edit.isEditing()){var _107=this.grid.getCell(col);if(!this.isFirstFocusCell()&&!_107.editable){this.cell=_107;this.rowIndex=row;this.previous();return;}}this.setFocusIndex(row,col);}},move:function(_108,_109){var _10a=_109<0?-1:1;if(this.isNavHeader()){var _10b=this._findHeaderCells();var _10c=currentIdx=_db.indexOf(_10b,this._colHeadNode);currentIdx+=_109;while(currentIdx>=0&&currentIdx<_10b.length&&_10b[currentIdx].style.display=="none"){currentIdx+=_10a;}if((currentIdx>=0)&&(currentIdx<_10b.length)){this._setActiveColHeader(_10b[currentIdx],currentIdx,_10c);}}else{if(this.cell){var sc=this.grid.scroller,r=this.rowIndex,rc=this.grid.rowCount-1,row=Math.min(rc,Math.max(0,r+_108));if(_108){if(_108>0){if(row>sc.getLastPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop+sc.findScrollTop(row)-sc.findScrollTop(r));}}else{if(_108<0){if(row<=sc.getPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop-sc.findScrollTop(r)-sc.findScrollTop(row));}}}}var cc=this.grid.layout.cellCount-1,i=this.cell.index,col=Math.min(cc,Math.max(0,i+_109));var cell=this.grid.getCell(col);while(col>=0&&col<cc&&cell&&cell.hidden===true){col+=_10a;cell=this.grid.getCell(col);}if(!cell||cell.hidden===true){col=i;}var n=cell.getNode(row);if(!n&&_108){if((row+_108)>=0&&(row+_108)<=rc){this.move(_108>0?++_108:--_108,_109);}return;}else{if((!n||_e2.style(n,"display")==="none")&&_109){if((col+_109)>=0&&(col+_109)<=cc){this.move(_108,_109>0?++_109:--_109);}return;}}this.setFocusIndex(row,col);if(_108){this.grid.updateRow(r);}}}},previousKey:function(e){if(this.grid.edit.isEditing()){_df.stop(e);this.previous();}else{if(!this.isNavHeader()&&!this._isHeaderHidden()){this.grid.domNode.focus();_df.stop(e);}else{this.tabOut(this.grid.domNode);if(this._colHeadFocusIdx!=null){_e2.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,false);this._colHeadFocusIdx=null;}this._focusifyCellNode(false);}}},nextKey:function(e){var _10d=(this.grid.rowCount===0);if(e.target===this.grid.domNode&&this._colHeadFocusIdx==null){this.focusHeader();_df.stop(e);}else{if(this.isNavHeader()){this.blurHeader();if(!this.findAndFocusGridCell()){this.tabOut(this.grid.lastFocusNode);}this._colHeadNode=this._colHeadFocusIdx=null;}else{if(this.grid.edit.isEditing()){_df.stop(e);this.next();}else{this.tabOut(this.grid.lastFocusNode);}}}},tabOut:function(_10e){this.tabbingOut=true;_10e.focus();},focusGridView:function(){_e1.fire(this.focusView,"focus");},focusGrid:function(_10f){this.focusGridView();this._focusifyCellNode(true);},findAndFocusGridCell:function(){var _110=true;var _111=(this.grid.rowCount===0);if(this.isNoFocusCell()&&!_111){var _112=0;var cell=this.grid.getCell(_112);if(cell.hidden){_112=this.isNavHeader()?this._colHeadFocusIdx:0;}this.setFocusIndex(0,_112);}else{if(this.cell&&!_111){if(this.focusView&&!this.focusView.rowNodes[this.rowIndex]){this.grid.scrollToRow(this.rowIndex);}this.focusGrid();}else{_110=false;}}this._colHeadNode=this._colHeadFocusIdx=null;return _110;},focusHeader:function(){var _113=this._findHeaderCells();var _114=this._colHeadFocusIdx;if(this._isHeaderHidden()){this.findAndFocusGridCell();}else{if(!this._colHeadFocusIdx){if(this.isNoFocusCell()){this._colHeadFocusIdx=0;}else{this._colHeadFocusIdx=this.cell.index;}}}this._colHeadNode=_113[this._colHeadFocusIdx];while(this._colHeadNode&&this._colHeadFocusIdx>=0&&this._colHeadFocusIdx<_113.length&&this._colHeadNode.style.display=="none"){this._colHeadFocusIdx++;this._colHeadNode=_113[this._colHeadFocusIdx];}if(this._colHeadNode&&this._colHeadNode.style.display!="none"){if(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode){this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode);this.headerMenu.bindDomNode(this.grid.domNode);this._contextMenuBindNode=this.grid.domNode;}this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,_114);this._scrollHeader(this._colHeadFocusIdx);this._focusifyCellNode(false);}else{this.findAndFocusGridCell();}},blurHeader:function(){_e2.removeClass(this._colHeadNode,this.focusClass);_e2.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var _115=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(_115);this._contextMenuBindNode=_115;}},doFocus:function(e){if(e&&e.target!=e.currentTarget){_df.stop(e);return;}if(this._clickFocus){return;}if(!this.tabbingOut){this.focusHeader();}this.tabbingOut=false;_df.stop(e);},doBlur:function(e){_df.stop(e);},doContextMenu:function(e){if(!this.headerMenu){_df.stop(e);}},doLastNodeFocus:function(e){if(this.tabbingOut){this._focusifyCellNode(false);}else{if(this.grid.rowCount>0){if(this.isNoFocusCell()){this.setFocusIndex(0,0);}this._focusifyCellNode(true);}else{this.focusHeader();}}this.tabbingOut=false;_df.stop(e);},doLastNodeBlur:function(e){_df.stop(e);},doColHeaderFocus:function(e){this._setActiveColHeader(e.target,_e2.attr(e.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());_df.stop(e);},doColHeaderBlur:function(e){_e2.toggleClass(e.target,this.focusClass,false);},_mouseDown:function(e){this._clickFocus=dojo.some(this.grid.views.views,function(v){return v.scrollboxNode===e.target;});},_mouseUp:function(e){this._clickFocus=false;}});});},"esri/toolbars/_VertexEditor":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dijit/Menu","dijit/MenuItem","esri/kernel","esri/toolbars/_VertexMover","esri/geometry/Point","esri/geometry/jsonUtils","dojo/i18n!esri/nls/jsapi"],function(_116,lang,_117,_118,has,Menu,_119,_11a,_11b,_11c,_11d,_11e){var GVE=_116(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(_11f,map,_120){this.graphic=_11f;this.map=map;this.toolbar=_120;var _121=_120._options;this._symbol1=_121.vertexSymbol;this._symbol2=_121.ghostVertexSymbol;var _122=_121.ghostLineSymbol;this._lineStroke={style:_122.style,width:_122.width,color:_122.color};this._canDel=_121.allowDeleteVertices;this._canAdd=_121.allowAddVertices;this._addControllers();},destroy:function(){this._removeControllers();},refresh:function(_123){if(_123){this._removeControllers();this._addControllers();}else{this._refresh(this._vertexMovers);this._refresh(this._mpVertexMovers);}},suspend:function(){if(!this._suspended){this._removeControllers();}this._suspended=true;},resume:function(){if(this._suspended){this._addControllers();}this._suspended=false;},_addControllers:function(){this._firstMoveHandle=_117.connect(_11b,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=_117.connect(_11b,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);if(this._canAdd){this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,true);}var _124=this._getGraphicsLayer();this._mouseOverHandle=_117.connect(_124,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=_117.connect(_124,"onMouseOut",this,this._mouseOutHandler);if(this._canDel){this._ctxMenu=new Menu({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"});var _125=(this._ctxDelete=new _119({label:_11e.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}));this._deleteHandle=_117.connect(_125,"onClick",this,this._deleteHandler);this._ctxMenu.addChild(_125);this._ctxMenu.startup();}},_removeControllers:function(){_117.disconnect(this._firstMoveHandle);_117.disconnect(this._moveStopHandle);_117.disconnect(this._mouseOverHandle);_117.disconnect(this._mouseOutHandle);_117.disconnect(this._deleteHandle);if(this._ctxMenu){this._ctxDelete=null;this._unbindCtxNode();this._ctxMenu.destroyRecursive();}this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=null;},_add:function(_126,_127,_128){var i,j,_129=this.graphic,_12a=[];for(i=0;i<_126.length;i++){var _12b=_126[i],_12c=[];for(j=0;j<_12b.length;j++){_12c.push(new _11b(_12b[j],_127,_129,i,j,_12b.length,this,_128));}_12a.push(_12c);}return _12a;},_remove:function(_12d){if(_12d){_118.forEach(_12d,function(_12e){_118.forEach(_12e,function(_12f){_12f.destroy();});});}},_refresh:function(_130){if(_130){_118.forEach(_130,function(_131){_118.forEach(_131,function(_132){_132.refresh();});});}},_isNew:function(_133){return (_118.indexOf(this._vertexMovers[_133.segIndex],_133)===-1)?true:false;},_getGraphicsLayer:function(){return this.toolbar._scratchGL;},_deleteHandler:function(evt){var _134=this._selectedMover,_135=_134.ptIndex;this._updateRelatedGraphic(_134,_134.relatedGraphic,_134.graphic.geometry,_134.segIndex,_134.ptIndex,_134.segLength,false,true);if(this._canAdd){this._deleteMidpoints(_134);}this._deleteVertex(_134);this.toolbar._endOperation("VERTICES");},_mouseOverHandler:function(evt){var _136=evt.graphic,_137=this._findMover(_136);if(_137){this.toolbar.onVertexMouseOver(this.graphic,_137._getInfo());if(!_137._placeholder){this._selectedMover=_137;if(this._canDel){this._bindCtxNode(_136.getDojoShape().getNode());}}}},_mouseOutHandler:function(evt){var _138=evt.graphic,_139=this._findMover(_138);if(_139){this.toolbar.onVertexMouseOut(this.graphic,_139._getInfo());}},_bindCtxNode:function(node){this._unbindCtxNode();this._ctxDelete.set("disabled",(this._selectedMover.segLength<=this.minLength)?true:false);this._ctxMenu.bindDomNode(node);this._bindNode=node;},_unbindCtxNode:function(){var node=this._bindNode;if(node){this._ctxMenu.unBindDomNode(node);}},_findMover:function(_13a){var i,_13b=[],_13c=this._mpVertexMovers;_118.forEach(this._vertexMovers,function(_13d){_13b=_13b.concat(_13d);});if(_13c){_118.forEach(_13c,function(_13e){_13b=_13b.concat(_13e);});}for(i=0;i<_13b.length;i++){var _13f=_13b[i];if(_13f.graphic===_13a){return _13f;}}},_firstMoveHandler:function(_140){if(!this._isNew(_140)&&this._canAdd){this._hideRelatedMidpoints(_140);}this.toolbar._beginOperation("VERTICES");},_moveStopHandler:function(_141,tx){var add=this._isNew(_141);if(!tx||!tx.dx&&!tx.dy){if(!add&&this._canAdd){this._showRelatedMidpoints(_141);}return;}this._updateRelatedGraphic(_141,_141.relatedGraphic,_141.graphic.geometry,_141.segIndex,_141.ptIndex,_141.segLength,add);if(this._canAdd){if(add){this._addMidpoints(_141);}else{this._repositionRelatedMidpoints(_141);this._showRelatedMidpoints(_141);}}this.toolbar._endOperation("VERTICES");},_showRelatedMidpoints:function(_142){var i,_143=this._getAdjacentMidpoints(_142.ptIndex,_142.segLength),_144=this._mpVertexMovers[_142.segIndex];for(i=0;i<_143.length;i++){var mvr=_144[_143[i]];mvr.graphic.show();mvr.refresh();}},_hideRelatedMidpoints:function(_145){var i,_146=this._getAdjacentMidpoints(_145.ptIndex,_145.segLength),_147=this._mpVertexMovers[_145.segIndex];for(i=0;i<_146.length;i++){_147[_146[i]].graphic.hide();}},_repositionRelatedMidpoints:function(_148){var i,_149=this._getAdjacentMidpoints(_148.ptIndex,_148.segLength),_14a=this._mpVertexMovers[_148.segIndex];for(i=0;i<_149.length;i++){var _14b=this._getAdjacentVertices(_149[i],_148.segLength);var _14c=_148.relatedGraphic.geometry.getPoint(_148.segIndex,_14b[0]),_14d=_148.relatedGraphic.geometry.getPoint(_148.segIndex,_14b[1]);var _14e=new _11c({x:(_14c.x+_14d.x)/2,y:(_14c.y+_14d.y)/2,spatialReference:_14c.spatialReference.toJson()});_14a[_149[i]].graphic.setGeometry(_14e);}},_addMidpoints:function(_14f){var _150=_14f.segIndex,_151=_14f.ptIndex,_152=_14f.segLength;var _153=_151+1;var i,_154=_152+1;this._mpVertexMovers[_150].splice(_151,1);var _155=this._vertexMovers[_150];for(i=0;i<_153;i++){_155[i].segLength+=1;}for(i=_153;i<_155.length;i++){_155[i].ptIndex+=1;_155[i].segLength+=1;}_14f.ptIndex=_153;_14f.segLength=_155.length+1;_155.splice(_153,0,_14f);_14f.graphic.setSymbol(this._symbol1);_155=this._mpVertexMovers[_150];for(i=0;i<_151;i++){_155[i].segLength+=1;}for(i=_151;i<_152-1;i++){_155[i].ptIndex+=1;_155[i].segLength+=1;}var _156=this._getAdjacentVertices(_151,_154);var _157=this._getAdjacentVertices(_151+1,_154);var _158,_159;_158=_14f.relatedGraphic.geometry.getPoint(_14f.segIndex,_156[0]);_159=_14f.relatedGraphic.geometry.getPoint(_14f.segIndex,_156[1]);var _15a=new _11c({x:(_158.x+_159.x)/2,y:(_158.y+_159.y)/2,spatialReference:_158.spatialReference.toJson()});_158=_14f.relatedGraphic.geometry.getPoint(_14f.segIndex,_157[0]);_159=_14f.relatedGraphic.geometry.getPoint(_14f.segIndex,_157[1]);var _15b=new _11c({x:(_158.x+_159.x)/2,y:(_158.y+_159.y)/2,spatialReference:_158.spatialReference.toJson()});var mvr1=new _11b(_15a,this._symbol2,this.graphic,_14f.segIndex,_151,_154,this,true);var mvr2=new _11b(_15b,this._symbol2,this.graphic,_14f.segIndex,_151+1,_154,this,true);_155.splice(_151,0,mvr1,mvr2);},_deleteVertex:function(_15c){var i,_15d=_15c.segIndex,_15e=_15c.ptIndex;var _15f=this._vertexMovers[_15d];for(i=0;i<_15e;i++){_15f[i].segLength-=1;}for(i=_15e+1;i<_15f.length;i++){var mvr=_15f[i];mvr.ptIndex-=1;mvr.segLength-=1;}_15f.splice(_15e,1);var info=_15c._getInfo();_15c.destroy();this.toolbar.onVertexDelete(this.graphic,info);}});lang.mixin(GVE,{create:function(_160,map,_161){var type=_160.geometry.type;switch(type){case "multipoint":return new GVE.MultipointVertexEditor(_160,map,_161);break;case "polyline":return new GVE.PolylineVertexEditor(_160,map,_161);break;case "polygon":return new GVE.PolygonVertexEditor(_160,map,_161);break;}}});GVE.MultipointVertexEditor=_116(GVE,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=_117.connect(_11b,"onMoveStart",this,this._moveStartHandler);_117.disconnect(this._firstMoveHandle);},destroy:function(){this.inherited(arguments);_117.disconnect(this._moveStartHandle);},_getSegments:function(_162){var i,_163=_162.points,_164=[],sr=_162.spatialReference;for(i=0;i<_163.length;i++){var _165=_163[i];_164.push(new _11c({x:_165[0],y:_165[1],spatialReference:sr.toJson()}));}return [_164];},_getMidpointSegments:function(_166){return [];},_getControlPoints:function(_167,_168,_169,_16a,_16b){return [];},_getGraphicsLayer:function(){return this.graphic._graphicsLayer;},_mouseOverHandler:function(evt){var _16c=evt.graphic,_16d=this._findMover(evt);if(_16d){this.toolbar.onVertexMouseOver(_16c,_16d._getInfo());this._selectedMover=_16d;if(this._canDel){this._bindCtxNode(_16d.graphic.getDojoShape().getNode());}}},_mouseOutHandler:function(evt){var _16e=evt.graphic,_16f=this._findMover(evt);if(_16f){this.toolbar.onVertexMouseOut(_16e,_16f._getInfo());}},_findMover:function(evt){var i,_170=[].concat(this._vertexMovers[0]),_171=evt.target;for(i=0;i<_170.length;i++){var _172=_170[i];if(_172.graphic.getDojoShape().getNode()===_171){return _172;}}},_moveStartHandler:function(_173){var geom=_173.relatedGraphic.geometry,_174=_173.ptIndex;var _175=_173.segLength-1;var _176=geom.points;var _177=_176.splice(_174,1);_176.push(_177[0]);var j,_178=this._vertexMovers[0];for(j=_175;j>_174;j--){_178[j].ptIndex-=1;}_177=_178.splice(_174,1);_178.push(_177[0]);_177[0].ptIndex=_175;},_moveStopHandler:function(_179){this._updateRelatedGraphic(_179,_179.relatedGraphic,_179.graphic.geometry,_179.segIndex,_179.ptIndex,_179.segLength);this.toolbar._endOperation("VERTICES");},_updateRelatedGraphic:function(_17a,_17b,_17c,_17d,_17e,_17f,add,del){var geom=_17b.geometry;if(del){geom.removePoint(_17e);}else{geom.setPoint(_17e,_17c);}_17b.setGeometry(geom);},_deleteMidpoints:function(_180){}});GVE.PolylineVertexEditor=_116(GVE,{declaredClass:"esri.toolbars._PolylineVertexEditor",minLength:2,_getSegments:function(_181){var i,j,_182=_181.paths,_183=[];for(i=0;i<_182.length;i++){var path=_182[i],_184=[];for(j=0;j<path.length;j++){_184.push(_181.getPoint(i,j));}_183.push(_184);}return _183;},_getMidpointSegments:function(_185){var i,j,_186=_185.paths,_187=[],sr=_185.spatialReference;for(i=0;i<_186.length;i++){var path=_186[i],_188=[];for(j=0;j<path.length-1;j++){var _189=_185.getPoint(i,j),_18a=_185.getPoint(i,j+1);var midX=(_189.x+_18a.x)/2,midY=(_189.y+_18a.y)/2;var _18b=new _11c({x:midX,y:midY,spatialReference:sr.toJson()});_188.push(_18b);}_187.push(_188);}return _187;},_getControlPoints:function(_18c,_18d,_18e,_18f,_190){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_18c)){idx1=_18f;idx2=_18f+1;if(idx1>=0){pt1=map.toScreen(_18d.getPoint(_18e,idx1));}if(idx2<=_190){pt2=map.toScreen(_18d.getPoint(_18e,idx2));}}else{idx1=_18f-1;idx2=_18f+1;if(idx1>=0){pt1=map.toScreen(_18d.getPoint(_18e,idx1));}if(idx2<_190){pt2=map.toScreen(_18d.getPoint(_18e,idx2));}}return [pt1,pt2];},_getAdjacentMidpoints:function(_191,_192){var _193=[];var idx1=_191-1;if(idx1>=0){_193.push(idx1);}var idx2=_191;if(idx2<_192-1){_193.push(idx2);}return _193;},_getAdjacentVertices:function(_194,_195){return [_194,_194+1];},_deleteMidpoints:function(_196){var _197=_196.segIndex,_198=_196.ptIndex,_199=_196.segLength;var _19a=this._mpVertexMovers[_197],_19b=_19a.length-1;var _19c=this._getAdjacentMidpoints(_198,_199).sort();var i,min=_19c[0];for(i=0;i<min;i++){_19a[i].segLength-=1;}for(i=min+1;i<_19a.length;i++){var mvr=_19a[i];mvr.ptIndex-=1;mvr.segLength-=1;}if(_19c.length===1){_19a.splice(min,1)[0].destroy();}else{var _19d=this._getAdjacentVertices(min,_19b);var _19e=_196.relatedGraphic.geometry.getPoint(_196.segIndex,_19d[0]);var _19f=_196.relatedGraphic.geometry.getPoint(_196.segIndex,_19d[1]);var _1a0=new _11c({x:(_19e.x+_19f.x)/2,y:(_19e.y+_19f.y)/2,spatialReference:_19e.spatialReference.toJson()});var mvr1=new _11b(_1a0,this._symbol2,this.graphic,_196.segIndex,min,_19b,this,true);var _1a1=_19a.splice(min,_19c.length,mvr1);for(i=0;i<_1a1.length;i++){_1a1[i].destroy();}}},_updateRelatedGraphic:function(_1a2,_1a3,_1a4,_1a5,_1a6,_1a7,add,del){var geom=_1a3.geometry;if(add){geom.insertPoint(_1a5,_1a6+1,_11d.fromJson(_1a4.toJson()));}else{if(del){geom.removePoint(_1a5,_1a6);}else{geom.setPoint(_1a5,_1a6,_11d.fromJson(_1a4.toJson()));}}_1a3.setGeometry(geom);}});GVE.PolygonVertexEditor=_116(GVE,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(_1a8){var i,j,_1a9=_1a8.rings,_1aa=[];for(i=0;i<_1a9.length;i++){var ring=_1a9[i],_1ab=[];for(j=0;j<ring.length-1;j++){_1ab.push(_1a8.getPoint(i,j));}_1aa.push(_1ab);}return _1aa;},_getMidpointSegments:function(_1ac){var i,j,_1ad=_1ac.rings,_1ae=[],sr=_1ac.spatialReference;for(i=0;i<_1ad.length;i++){var ring=_1ad[i],_1af=[];for(j=0;j<ring.length-1;j++){var _1b0=_1ac.getPoint(i,j),_1b1=_1ac.getPoint(i,j+1);var midX=(_1b0.x+_1b1.x)/2,midY=(_1b0.y+_1b1.y)/2;var _1b2=new _11c({x:midX,y:midY,spatialReference:sr.toJson()});_1af.push(_1b2);}_1ae.push(_1af);}return _1ae;},_getControlPoints:function(_1b3,_1b4,_1b5,_1b6,_1b7){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_1b3)){idx1=_1b6;idx2=(_1b6+1)%_1b7;}else{idx1=_1b6-1;idx1=idx1<0?(_1b7+idx1)%_1b7:idx1;idx2=(_1b6+1)%_1b7;}pt1=map.toScreen(_1b4.getPoint(_1b5,idx1));pt2=map.toScreen(_1b4.getPoint(_1b5,idx2));return [pt1,pt2];},_getAdjacentMidpoints:function(_1b8,_1b9){var idx1=_1b8-1;idx1=idx1<0?(_1b9+idx1)%_1b9:idx1;var idx2=_1b8;return [idx1,idx2];},_getAdjacentVertices:function(_1ba,_1bb){return [_1ba,(_1ba+1)%_1bb];},_deleteMidpoints:function(_1bc){var _1bd=_1bc.segIndex,_1be=_1bc.ptIndex,_1bf=_1bc.segLength;var _1c0=this._mpVertexMovers[_1bd],_1c1=_1c0.length-1,_1c2=this._getAdjacentMidpoints(_1be,_1bf).sort(),_1c3,_1c4,_1c5,_1c6,i,mvr1,mvr,min=_1c2[0],max=_1c2[_1c2.length-1];if(_1be===0){_1c3=this._getAdjacentVertices(_1c1-1,_1c1);_1c4=_1bc.relatedGraphic.geometry.getPoint(_1bc.segIndex,_1c3[0]);_1c5=_1bc.relatedGraphic.geometry.getPoint(_1bc.segIndex,_1c3[1]);_1c6=new _11c({x:(_1c4.x+_1c5.x)/2,y:(_1c4.y+_1c5.y)/2,spatialReference:_1c4.spatialReference.toJson()});mvr1=new _11b(_1c6,this._symbol2,this.graphic,_1bc.segIndex,_1c1-1,_1c1,this,true);_1c0.splice(max,1,mvr1)[0].destroy();_1c0.splice(min,1)[0].destroy();for(i=0;i<_1c0.length-1;i++){mvr=_1c0[i];mvr.ptIndex-=1;mvr.segLength-=1;}}else{_1c3=this._getAdjacentVertices(min,_1c1);_1c4=_1bc.relatedGraphic.geometry.getPoint(_1bc.segIndex,_1c3[0]);_1c5=_1bc.relatedGraphic.geometry.getPoint(_1bc.segIndex,_1c3[1]);_1c6=new _11c({x:(_1c4.x+_1c5.x)/2,y:(_1c4.y+_1c5.y)/2,spatialReference:_1c4.spatialReference.toJson()});mvr1=new _11b(_1c6,this._symbol2,this.graphic,_1bc.segIndex,min,_1c1,this,true);var _1c7=_1c0.splice(min,_1c2.length,mvr1);for(i=0;i<_1c7.length;i++){_1c7[i].destroy();}for(i=0;i<min;i++){_1c0[i].segLength-=1;}for(i=min+1;i<_1c0.length;i++){mvr=_1c0[i];mvr.ptIndex-=1;mvr.segLength-=1;}}},_updateRelatedGraphic:function(_1c8,_1c9,_1ca,_1cb,_1cc,_1cd,add,del){var geom=_1c9.geometry;if(add){geom.insertPoint(_1cb,_1cc+1,_11d.fromJson(_1ca.toJson()));}else{if(del){geom.removePoint(_1cb,_1cc);if(_1cc===0){geom.setPoint(_1cb,_1cd-1,_11d.fromJson(geom.getPoint(_1cb,0).toJson()));}}else{geom.setPoint(_1cb,_1cc,_11d.fromJson(_1ca.toJson()));if(_1cc===0){geom.setPoint(_1cb,_1cd,_11d.fromJson(_1ca.toJson()));}}}_1c9.setGeometry(geom);}});if(has("extend-esri")){lang.setObject("toolbars._GraphicVertexEditor",GVE,_11a);lang.setObject("toolbars._MultipointVertexEditor",GVE.MultipointVertexEditor,_11a);lang.setObject("toolbars._PolylineVertexEditor",GVE.PolylineVertexEditor,_11a);lang.setObject("toolbars._PolygonVertexEditor",GVE.PolygonVertexEditor,_11a);}return GVE;});},"dijit/_editor/html":function(){define("dijit/_editor/html",["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(_1ce,lang,has){var _1cf={};lang.setObject("dijit._editor.html",_1cf);var _1d0=_1cf.escapeXml=function(str,_1d1){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_1d1){str=str.replace(/'/gm,"&#39;");}return str;};_1cf.getNodeHtml=function(node){var _1d2=[];_1cf.getNodeHtmlHelper(node,_1d2);return _1d2.join("");};_1cf.getNodeHtmlHelper=function(node,_1d3){switch(node.nodeType){case 1:var _1d4=node.nodeName.toLowerCase();if(!_1d4||_1d4.charAt(0)=="/"){return "";}_1d3.push("<",_1d4);var _1d5=[],_1d6={};var attr;if(has("dom-attributes-explicit")||has("dom-attributes-specified-flag")){var i=0;while((attr=node.attributes[i++])){var n=attr.name;if(n.substr(0,3)!=="_dj"&&(!has("dom-attributes-specified-flag")||attr.specified)&&!(n in _1d6)){var v=attr.value;if(n=="src"||n=="href"){if(node.getAttribute("_djrealurl")){v=node.getAttribute("_djrealurl");}}if(has("ie")===8&&n==="style"){v=v.replace("HEIGHT:","height:").replace("WIDTH:","width:");}_1d5.push([n,v]);_1d6[n]=v;}}}else{var _1d7=/^input$|^img$/i.test(node.nodeName)?node:node.cloneNode(false);var s=_1d7.outerHTML;var _1d8=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;var _1d9=s.match(_1d8);s=s.substr(0,s.indexOf(">"));_1ce.forEach(_1d9,function(attr){if(attr){var idx=attr.indexOf("=");if(idx>0){var key=attr.substring(0,idx);if(key.substr(0,3)!="_dj"){if(key=="src"||key=="href"){if(node.getAttribute("_djrealurl")){_1d5.push([key,node.getAttribute("_djrealurl")]);return;}}var val,_1da;switch(key){case "style":val=node.style.cssText.toLowerCase();break;case "class":val=node.className;break;case "width":if(_1d4==="img"){_1da=/width=(\S+)/i.exec(s);if(_1da){val=_1da[1];}break;}case "height":if(_1d4==="img"){_1da=/height=(\S+)/i.exec(s);if(_1da){val=_1da[1];}break;}default:val=node.getAttribute(key);}if(val!=null){_1d5.push([key,val.toString()]);}}}}},this);}_1d5.sort(function(a,b){return a[0]<b[0]?-1:(a[0]==b[0]?0:1);});var j=0;while((attr=_1d5[j++])){_1d3.push(" ",attr[0],"=\"",(typeof attr[1]==="string"?_1d0(attr[1],true):attr[1]),"\"");}switch(_1d4){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":_1d3.push(" />");break;case "script":_1d3.push(">",node.innerHTML,"</",_1d4,">");break;default:_1d3.push(">");if(node.hasChildNodes()){_1cf.getChildrenHtmlHelper(node,_1d3);}_1d3.push("</",_1d4,">");}break;case 4:case 3:_1d3.push(_1d0(node.nodeValue,true));break;case 8:_1d3.push("<!--",_1d0(node.nodeValue,true),"-->");break;default:_1d3.push("<!-- Element not recognized - Type: ",node.nodeType," Name: ",node.nodeName,"-->");}};_1cf.getChildrenHtml=function(node){var _1db=[];_1cf.getChildrenHtmlHelper(node,_1db);return _1db.join("");};_1cf.getChildrenHtmlHelper=function(dom,_1dc){if(!dom){return;}var _1dd=dom["childNodes"]||dom;var _1de=!has("ie")||_1dd!==dom;var node,i=0;while((node=_1dd[i++])){if(!_1de||node.parentNode==dom){_1cf.getNodeHtmlHelper(node,_1dc);}}};return _1cf;});},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dijit/_editor/plugins/EnterKeyHandling",["dojo/_base/declare","dojo/dom-construct","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/_base/window","dojo/window","../_Plugin","../RichText","../range","../../_base/focus"],function(_1df,_1e0,_1e1,keys,lang,has,win,_1e2,_1e3,_1e4,_1e5,_1e6){return _1df("dijit._editor.plugins.EnterKeyHandling",_1e3,{blockNodeForEnter:"BR",constructor:function(args){if(args){if("blockNodeForEnter" in args){args.blockNodeForEnter=args.blockNodeForEnter.toUpperCase();}lang.mixin(this,args);}},setEditor:function(_1e7){if(this.editor===_1e7){return;}this.editor=_1e7;if(this.blockNodeForEnter=="BR"){this.editor.customUndo=true;_1e7.onLoadDeferred.then(lang.hitch(this,function(d){this.connect(_1e7.document,"onkeypress",function(e){if(e.charOrCode==keys.ENTER){var ne=lang.mixin({},e);ne.shiftKey=true;if(!this.handleEnterKey(ne)){_1e1.stop(e);}}});if(has("ie")>=9){this.connect(_1e7.document,"onpaste",function(e){setTimeout(dojo.hitch(this,function(){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();r.move("character",1);r.select();}),0);});}return d;}));}else{if(this.blockNodeForEnter){var h=lang.hitch(this,this.handleEnterKey);_1e7.addKeyHandler(13,0,0,h);_1e7.addKeyHandler(13,0,1,h);this.connect(this.editor,"onKeyPressed","onKeyPressed");}}},onKeyPressed:function(){if(this._checkListLater){if(win.withGlobal(this.editor.window,"isCollapsed",_1e6)){var _1e8=this.editor._sCall("getAncestorElement",["LI"]);if(!_1e8){_1e4.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);var _1e9=this.editor._sCall("getAncestorElement",[this.blockNodeForEnter]);if(_1e9){_1e9.innerHTML=this.bogusHtmlContent;if(has("ie")<=9){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();}}else{console.error("onKeyPressed: Cannot find the new block node");}}else{if(has("mozilla")){if(_1e8.parentNode.parentNode.nodeName=="LI"){_1e8=_1e8.parentNode.parentNode;}}var fc=_1e8.firstChild;if(fc&&fc.nodeType==1&&(fc.nodeName=="UL"||fc.nodeName=="OL")){_1e8.insertBefore(fc.ownerDocument.createTextNode(""),fc);var _1ea=_1e5.create(this.editor.window);_1ea.setStart(_1e8.firstChild,0);var _1eb=_1e5.getSelection(this.editor.window,true);_1eb.removeAllRanges();_1eb.addRange(_1ea);}}}this._checkListLater=false;}if(this._pressedEnterInBlock){if(this._pressedEnterInBlock.previousSibling){this.removeTrailingBr(this._pressedEnterInBlock.previousSibling);}delete this._pressedEnterInBlock;}},bogusHtmlContent:"&#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(e){var _1ec,_1ed,_1ee,_1ef,_1f0,_1f1,doc=this.editor.document,br,rs,txt;if(e.shiftKey){var _1f2=this.editor._sCall("getParentElement",[]);var _1f3=_1e5.getAncestor(_1f2,this.blockNodes);if(_1f3){if(_1f3.tagName=="LI"){return true;}_1ec=_1e5.getSelection(this.editor.window);_1ed=_1ec.getRangeAt(0);if(!_1ed.collapsed){_1ed.deleteContents();_1ec=_1e5.getSelection(this.editor.window);_1ed=_1ec.getRangeAt(0);}if(_1e5.atBeginningOfContainer(_1f3,_1ed.startContainer,_1ed.startOffset)){br=doc.createElement("br");_1ee=_1e5.create(this.editor.window);_1f3.insertBefore(br,_1f3.firstChild);_1ee.setStartAfter(br);_1ec.removeAllRanges();_1ec.addRange(_1ee);}else{if(_1e5.atEndOfContainer(_1f3,_1ed.startContainer,_1ed.startOffset)){_1ee=_1e5.create(this.editor.window);br=doc.createElement("br");_1f3.appendChild(br);_1f3.appendChild(doc.createTextNode(""));_1ee.setStart(_1f3.lastChild,0);_1ec.removeAllRanges();_1ec.addRange(_1ee);}else{rs=_1ed.startContainer;if(rs&&rs.nodeType==3){txt=rs.nodeValue;_1ef=doc.createTextNode(txt.substring(0,_1ed.startOffset));_1f0=doc.createTextNode(txt.substring(_1ed.startOffset));_1f1=doc.createElement("br");if(_1f0.nodeValue==""&&has("webkit")){_1f0=doc.createTextNode("");}_1e0.place(_1ef,rs,"after");_1e0.place(_1f1,_1ef,"after");_1e0.place(_1f0,_1f1,"after");_1e0.destroy(rs);_1ee=_1e5.create(this.editor.window);_1ee.setStart(_1f0,0);_1ec.removeAllRanges();_1ec.addRange(_1ee);return false;}return true;}}}else{_1ec=_1e5.getSelection(this.editor.window);if(_1ec.rangeCount){_1ed=_1ec.getRangeAt(0);if(_1ed&&_1ed.startContainer){if(!_1ed.collapsed){_1ed.deleteContents();_1ec=_1e5.getSelection(this.editor.window);_1ed=_1ec.getRangeAt(0);}rs=_1ed.startContainer;if(rs&&rs.nodeType==3){var _1f4=false;var _1f5=_1ed.startOffset;if(rs.length<_1f5){ret=this._adjustNodeAndOffset(rs,_1f5);rs=ret.node;_1f5=ret.offset;}txt=rs.nodeValue;_1ef=doc.createTextNode(txt.substring(0,_1f5));_1f0=doc.createTextNode(txt.substring(_1f5));_1f1=doc.createElement("br");if(!_1f0.length){_1f0=doc.createTextNode("");_1f4=true;}if(_1ef.length){_1e0.place(_1ef,rs,"after");}else{_1ef=rs;}_1e0.place(_1f1,_1ef,"after");_1e0.place(_1f0,_1f1,"after");_1e0.destroy(rs);_1ee=_1e5.create(this.editor.window);_1ee.setStart(_1f0,0);_1ee.setEnd(_1f0,_1f0.length);_1ec.removeAllRanges();_1ec.addRange(_1ee);if(_1f4&&!has("webkit")){this.editor._sCall("remove",[]);}else{this.editor._sCall("collapse",[true]);}}else{var _1f6;if(_1ed.startOffset>=0){_1f6=rs.childNodes[_1ed.startOffset];}var _1f1=doc.createElement("br");var _1f0=doc.createTextNode("");if(!_1f6){rs.appendChild(_1f1);rs.appendChild(_1f0);}else{_1e0.place(_1f1,_1f6,"before");_1e0.place(_1f0,_1f1,"after");}_1ee=_1e5.create(this.editor.window);_1ee.setStart(_1f0,0);_1ee.setEnd(_1f0,_1f0.length);_1ec.removeAllRanges();_1ec.addRange(_1ee);this.editor._sCall("collapse",[true]);}}}else{_1e4.prototype.execCommand.call(this.editor,"inserthtml","<br>");}}return false;}var _1f7=true;_1ec=_1e5.getSelection(this.editor.window);_1ed=_1ec.getRangeAt(0);if(!_1ed.collapsed){_1ed.deleteContents();_1ec=_1e5.getSelection(this.editor.window);_1ed=_1ec.getRangeAt(0);}var _1f8=_1e5.getBlockAncestor(_1ed.endContainer,null,this.editor.editNode);var _1f9=_1f8.blockNode;if((this._checkListLater=(_1f9&&(_1f9.nodeName=="LI"||_1f9.parentNode.nodeName=="LI")))){if(has("mozilla")){this._pressedEnterInBlock=_1f9;}if(/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(_1f9.innerHTML)){_1f9.innerHTML="";if(has("webkit")){_1ee=_1e5.create(this.editor.window);_1ee.setStart(_1f9,0);_1ec.removeAllRanges();_1ec.addRange(_1ee);}this._checkListLater=false;}return true;}if(!_1f8.blockNode||_1f8.blockNode===this.editor.editNode){try{_1e4.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);}catch(e2){}_1f8={blockNode:this.editor._sCall("getAncestorElement",[this.blockNodeForEnter]),blockContainer:this.editor.editNode};if(_1f8.blockNode){if(_1f8.blockNode!=this.editor.editNode&&(!(_1f8.blockNode.textContent||_1f8.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)){this.removeTrailingBr(_1f8.blockNode);return false;}}else{_1f8.blockNode=this.editor.editNode;}_1ec=_1e5.getSelection(this.editor.window);_1ed=_1ec.getRangeAt(0);}var _1fa=doc.createElement(this.blockNodeForEnter);_1fa.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(_1f8.blockNode);var _1fb=_1ed.endOffset;var node=_1ed.endContainer;if(node.length<_1fb){var ret=this._adjustNodeAndOffset(node,_1fb);node=ret.node;_1fb=ret.offset;}if(_1e5.atEndOfContainer(_1f8.blockNode,node,_1fb)){if(_1f8.blockNode===_1f8.blockContainer){_1f8.blockNode.appendChild(_1fa);}else{_1e0.place(_1fa,_1f8.blockNode,"after");}_1f7=false;_1ee=_1e5.create(this.editor.window);_1ee.setStart(_1fa,0);_1ec.removeAllRanges();_1ec.addRange(_1ee);if(this.editor.height){_1e2.scrollIntoView(_1fa);}}else{if(_1e5.atBeginningOfContainer(_1f8.blockNode,_1ed.startContainer,_1ed.startOffset)){_1e0.place(_1fa,_1f8.blockNode,_1f8.blockNode===_1f8.blockContainer?"first":"before");if(_1fa.nextSibling&&this.editor.height){_1ee=_1e5.create(this.editor.window);_1ee.setStart(_1fa.nextSibling,0);_1ec.removeAllRanges();_1ec.addRange(_1ee);_1e2.scrollIntoView(_1fa.nextSibling);}_1f7=false;}else{if(_1f8.blockNode===_1f8.blockContainer){_1f8.blockNode.appendChild(_1fa);}else{_1e0.place(_1fa,_1f8.blockNode,"after");}_1f7=false;if(_1f8.blockNode.style){if(_1fa.style){if(_1f8.blockNode.style.cssText){_1fa.style.cssText=_1f8.blockNode.style.cssText;}}}rs=_1ed.startContainer;var _1fc;if(rs&&rs.nodeType==3){var _1fd,_1fe;_1fb=_1ed.endOffset;if(rs.length<_1fb){ret=this._adjustNodeAndOffset(rs,_1fb);rs=ret.node;_1fb=ret.offset;}txt=rs.nodeValue;_1ef=doc.createTextNode(txt.substring(0,_1fb));_1f0=doc.createTextNode(txt.substring(_1fb,txt.length));_1e0.place(_1ef,rs,"before");_1e0.place(_1f0,rs,"after");_1e0.destroy(rs);var _1ff=_1ef.parentNode;while(_1ff!==_1f8.blockNode){var tg=_1ff.tagName;var _200=doc.createElement(tg);if(_1ff.style){if(_200.style){if(_1ff.style.cssText){_200.style.cssText=_1ff.style.cssText;}}}if(_1ff.tagName==="FONT"){if(_1ff.color){_200.color=_1ff.color;}if(_1ff.face){_200.face=_1ff.face;}if(_1ff.size){_200.size=_1ff.size;}}_1fd=_1f0;while(_1fd){_1fe=_1fd.nextSibling;_200.appendChild(_1fd);_1fd=_1fe;}_1e0.place(_200,_1ff,"after");_1ef=_1ff;_1f0=_200;_1ff=_1ff.parentNode;}_1fd=_1f0;if(_1fd.nodeType==1||(_1fd.nodeType==3&&_1fd.nodeValue)){_1fa.innerHTML="";}_1fc=_1fd;while(_1fd){_1fe=_1fd.nextSibling;_1fa.appendChild(_1fd);_1fd=_1fe;}}_1ee=_1e5.create(this.editor.window);var _201;var _202=_1fc;if(this.blockNodeForEnter!=="BR"){while(_202){_201=_202;_1fe=_202.firstChild;_202=_1fe;}if(_201&&_201.parentNode){_1fa=_201.parentNode;_1ee.setStart(_1fa,0);_1ec.removeAllRanges();_1ec.addRange(_1ee);if(this.editor.height){_1e2.scrollIntoView(_1fa);}if(has("mozilla")){this._pressedEnterInBlock=_1f8.blockNode;}}else{_1f7=true;}}else{_1ee.setStart(_1fa,0);_1ec.removeAllRanges();_1ec.addRange(_1ee);if(this.editor.height){_1e2.scrollIntoView(_1fa);}if(has("mozilla")){this._pressedEnterInBlock=_1f8.blockNode;}}}}return _1f7;},_adjustNodeAndOffset:function(node,_203){while(node.length<_203&&node.nextSibling&&node.nextSibling.nodeType==3){_203=_203-node.length;node=node.nextSibling;}return {"node":node,"offset":_203};},removeTrailingBr:function(_204){var para=/P|DIV|LI/i.test(_204.tagName)?_204:this.editor._sCall("getParentOfType",[_204,["P","DIV","LI"]]);if(!para){return;}if(para.lastChild){if((para.childNodes.length>1&&para.lastChild.nodeType==3&&/^[\s\xAD]*$/.test(para.lastChild.nodeValue))||para.lastChild.tagName=="BR"){_1e0.destroy(para.lastChild);}}if(!para.childNodes.length){para.innerHTML=this.bogusHtmlContent;}}});});},"esri/dijit/NavigationBar":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/kernel","dojo/has","dojo/query","dojo/dom","dojo/dom-class","dojo/dom-construct","esri/dijit/_TouchBase","esri/kernel"],function(_205,lang,_206,_207,_208,has,_209,dom,_20a,_20b,_20c,_20d){var NB=_205(null,{declaredClass:"esri.dijit.NavigationBar",_items:[],constructor:function(_20e,_20f){var i;this.container=dom.byId(_20f);this._touchBase=_20c(this.container,null);this._slideDiv=_20b.create("div",{},this.container,"first");this.events=[_206.connect(this._touchBase,"onclick",this,this._onClickHandler)];this._items=_20e.items;_20a.add(this.container,"esriMobileNavigationBar");var _210=_20b.create("div",{},this._slideDiv);for(i=0;i<this._items.length;i++){var node,div;switch(this._items[i].type){case "img":div=_20b.create("div",{"class":"esriMobileNavigationItem"},_210);node=_20b.create("img",{src:this._items[i].src.toString(),style:{width:"100%",height:"100%"}},div);break;case "span":div=_20b.create("div",{"class":"esriMobileNavigationItem"},_210);node=_20b.create("span",{innerHTML:this._items[i].text},div);break;case "div":div=_20b.create("div",{"class":"esriMobileNavigationInfoPanel"},_210);node=_20b.create("div",{innerHTML:this._items[i].text},div);break;}_20a.add(div,this._items[i].position);if(this._items[i].className){_20a.add(node,this._items[i].className);}node._index=i;node._item=this._items[i];this._items[i]._node=node;}},startup:function(){this.onCreate(this._items);},destroy:function(){_207.forEach(this.events,_206.disconnect);this._touchBase=null;_208.query("img",this.container).forEach(function(node){node._index=null;node._item=null;_20b.destroy(node);node=null;});this._items=null;_20b.destroy(this._slideDiv);_20b.destroy(this.container);this.container=this._slideDiv=null;},getItems:function(){return this._items;},select:function(item){this._markSelected(item._node,item);},onSelect:function(item){},onUnSelect:function(item){},onCreate:function(_211){},_onClickHandler:function(e){if(e.target.tagName.toLowerCase()==="img"){var img=e.target;var _212=img._index;var item=img._item;_208.query("img",this.container).forEach(function(node){if(node!==img&&node._item.toggleGroup===item.toggleGroup){this._markUnSelected(node,node._item);}},this);this._toggleNode(img,item);}},_toggleNode:function(_213,item){if(item.toggleState==="ON"){item.toggleState="OFF";if(item.src){_213.src=item.src.toString();}this.onUnSelect(item);}else{item.toggleState="ON";if(item.srcAlt){_213.src=item.srcAlt;}this.onSelect(item);}},_markSelected:function(_214,item){item.toggleState="ON";if(item.srcAlt){_214.src=item.srcAlt;}this.onSelect(item);},_markUnSelected:function(_215,item){if(item.toggleState==="ON"){item.toggleState="OFF";if(item.src){_215.src=item.src.toString();}this.onUnSelect(item);}}});if(has("extend-esri")){lang.setObject("dijit.NavigationBar",NB,_20d);}return NB;});},"dojo/dnd/Selector":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../dom","../dom-construct","../mouse","../_base/NodeList","../on","../touch","./common","./Container"],function(_216,_217,_218,_219,lang,dom,_21a,_21b,_21c,on,_21d,dnd,_21e){var _21f=_217("dojo.dnd.Selector",_21e,{constructor:function(node,_220){if(!_220){_220={};}this.singular=_220.singular;this.autoSync=_220.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(on(this.node,_21d.press,lang.hitch(this,"onMouseDown")),on(this.node,_21d.release,lang.hitch(this,"onMouseUp")));},singular:false,getSelectedNodes:function(){var t=new _21c();var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dom.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dom.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dom.byId(i);this.delItem(i);_21a.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||_219.global;var s=this.selection,e=dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){_21f.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}_216.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_221,data,_222,_223){var _224=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_224.call(this,item,hint);if(_221){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};_21f.superclass.insertNodes.call(this,data,_222,_223);this._normalizedCreator=_224;return this;},destroy:function(){_21f.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(_21b.isLeft(e)){_218.stop(e);}return;}if(!this.singular&&e.shiftKey){if(!dnd.getCopyKeyState(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0,node;for(;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dnd.getCopyKeyState(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dnd.getCopyKeyState(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}_218.stop(e);},onMouseUp:function(){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=on(this.node,_21d.move,lang.hitch(this,"onMouseMove"));},onOutEvent:function(){if(this.onmousemoveEvent){this.onmousemoveEvent.remove();delete this.onmousemoveEvent;}},_removeSelection:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dom.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return _21f;});},"esri/layers/OnDemandMode":function(){define("esri/layers/OnDemandMode",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/geometry/Point","esri/tasks/query","esri/layers/RenderMode","esri/layers/GridLayout"],function(_225,_226,lang,_227,has,_228,_229,_22a,_22b,_22c){var _22d=_225([_22b],{declaredClass:"esri.layers._OnDemandMode",constructor:function(_22e){this.featureLayer=_22e;this._featureMap={};this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},initialize:function(map){this.inherited(arguments);var _22f=this.featureLayer,_230=_22f._srInfo;this._gridLayer=new _22c(new _229(_230?_230.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_22f._tileWidth,height:_22f._tileHeight},{width:map.width,height:map.height},_230);this._cellMap={};this._gridLayer.setResolution(map.extent);},startup:function(){this._ioQueue=[];if(!this.featureLayer.suspended){this._zoomHandler();this._enableConnectors();}},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}else{console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id = "+this.featureLayer.id+", Layer URL = "+this.featureLayer.url);}}},destroy:function(){this._disableConnectors();this.inherited(arguments);},drawFeature:function(_231){var _232=this._gridLayer,geom=_231.geometry,_233=[];if(!geom){return;}_233=_232.getCellsInExtent((geom.type==="point")?{xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}:geom.getExtent(),false).cells;var _234=this._cellMap,i,cell,oid=_231.attributes[this.featureLayer.objectIdField],_235,row,col;for(i=0;i<_233.length;i++){cell=_233[i];_235=cell.latticeID;row=cell.row;col=cell.col;if(_235){cell=(_234[_235]=(_234[_235]||cell));}else{_234[row]=_234[row]||{};cell=(_234[row][col]=(_234[row][col]||cell));}cell.features=cell.features||[];cell.features.push(_231);this._addFeatureIIf(oid,_231);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_enableConnectors:function(){var map=this.map;this._zoomConnect=_226.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=_226.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=_226.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){_226.disconnect(this._zoomConnect);_226.disconnect(this._panConnect);_226.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _236=this.featureLayer,map=this.map;if(_236.suspended){return;}_236._fireUpdateStart();this._clearIIf();var _237=_236._trackManager;if(_237){_237.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_238,cell){var id="_"+_238.name+_238.layerId+_238._ulid+"_"+cell.resolution+"_"+(cell.latticeID||(cell.row+"_"+cell.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_239){this._exceeds=false;var _23a=this.featureLayer,map=this.map,_23b=_239||map.extent,_23c=this._gridLayer.getCellsInExtent(_23b,_23a.latticeTiling),_23d=_23c.cells;if(!_23a.isEditable()){var _23e=this._cellMap;_23d=_227.filter(_23d,function(cell){if(cell.lattice){if(_23e[cell.latticeID]){return false;}}else{if(_23e[cell.row]&&_23e[cell.row][cell.col]){return false;}}return true;});}var _23f=_23a.getOutFields(),_240=_23a.getDefinitionExpression(),time=_23a._getOffsettedTE(_23a._mapTimeExtent),_241=_23a._usePatch,_242=this._ioQueue,i,self=this,func=this._drawFeatures,cell,_243,_244;this._pending=this._pending||0;for(i=0;i<_23d.length;i++){cell=_23d[i];_243=new _22a();_243.geometry=cell.extent||cell.lattice;_243.outFields=_23f;_243.where=_240;if(_23a.latticeTiling&&cell.extent){_243.spatialRelationship=_22a.SPATIAL_REL_CONTAINS;}_243.returnGeometry=true;_243.timeExtent=time;_243.maxAllowableOffset=_23a._maxOffset;if(_23a._ts){_243._ts=(new Date()).getTime();}_244=null;if(_241){_244=this._getRequestId(_23a,cell);if(this._isPending(_244)){continue;}}this._pending++;_242.push(_23a._task.execute(_243,function(){var _245=cell;return function(_246){func.apply(self,[_246,_245]);};}.call(this),this._queryErrorHandler,_244));}this._removeOldCells(_23b);this._endCheck();},_drawFeatures:function(_247,cell){this._exceeds=this._exceeds||_247.exceededTransferLimit;this._finalizeIO();var _248=this.featureLayer,map=this.map,_249=map.extent,_24a=cell.extent,row=cell.row,col=cell.col,_24b=_248.objectIdField,_24c=_247.features,_24d=this._gridLayer,_24e=this._cellMap,i,len,_24f=cell.latticeID,_250=_24f?_24e[_24f]:(_24e[row]&&_24e[row][col]);if((cell.resolution!=_24d._resolution)||(_24f?(_24f!==_24d.getLatticeID(_249)):(!_24d.intersects(_24a,_249)))){if(_250){this._removeCell(row,col,_24f);}}else{if(_250){this._updateCell(_250,_24c);}else{cell.features=_24c;if(_24f){_24e[_24f]=cell;}else{_24e[row]=_24e[row]||{};_24e[row][col]=cell;}len=_24c.length;for(i=0;i<len;i++){var _251=_24c[i];var oid=_251.attributes[_24b];this._addFeatureIIf(oid,_251);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_252){if(this._pending===0){this._processIOQueue();var _253=this.featureLayer,_254=_253._trackManager;if(_254){_254.clearTracks();_254.addFeatures(_253.graphics);if(_253._ager){_227.forEach(_253.graphics,function(_255){if(_255._shape){_253._repaint(_255);}});}_254.moveLatestToFront();_254.drawTracks();}this.featureLayer._fireUpdateEnd(_252&&new Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_253.onQueryLimitExceeded();}}},_processIOQueue:function(_256){this._ioQueue=_227.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_256){_227.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_257){var _258=this._cellMap,_259=this._gridLayer,_25a,_25b;for(_25a in _258){if(_258[_25a]){var row=_258[_25a],_25c=row.latticeID,_25d=0,_25e=0;if(_25c){_25d++;if(_25c!==_259.getLatticeID(_257)){this._removeCell(null,null,_25c);_25e++;}}else{for(_25b in row){if(row[_25b]){_25d++;var _25f=row[_25b].extent;if(!_259.intersects(_25f,_257)){this._removeCell(_25a,_25b);_25e++;}}}}if(_25e===_25d){delete _258[_25a];}}}},_updateCell:function(cell,_260){var _261=this.featureLayer,_262=_261.objectIdField,_263=_261._selectedFeatures,i,len=_260.length;cell.features=cell.features||[];for(i=0;i<len;i++){var _264=_260[i];var oid=_264.attributes[_262];var _265=this._addFeatureIIf(oid,_264);if(_265===_264){this._incRefCount(oid);cell.features.push(_265);}else{if(!(oid in _263)){_265.setGeometry(_264.geometry);_265.setAttributes(_264.attributes);}}}},_removeCell:function(row,col,_266){var _267=this._cellMap,_268=this.featureLayer,_269=_268.objectIdField;var cell=_266?_267[_266]:(_267[row]&&_267[row][col]);if(cell){if(_266){delete _267[_266];}else{delete _267[row][col];}var _26a=cell.features,i;for(i=0;i<_26a.length;i++){var _26b=_26a[i];var oid=_26b.attributes[_269];this._decRefCount(oid);if(oid in _268._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});if(has("extend-esri")){lang.setObject("layers._OnDemandMode",_22d,_228);}return _22d;});},"dijit/_MenuBase":function(){define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./popup","./registry","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_26c,_26d,dom,_26e,_26f,lang,_270,on,_271,_272,pm,_273,_274,_275,_276){return _26d("dijit._MenuBase",[_274,_276,_275],{parentMenu:null,popupDelay:500,autoFocus:false,childSelector:function(node){var _277=_273.byNode(node);return node.parentNode==this.containerNode&&_277&&_277.focus;},postCreate:function(){var self=this,_278=typeof this.childSelector=="string"?this.childSelector:lang.hitch(this,"childSelector");this.own(on(this.containerNode,on.selector(_278,_270.enter),function(){self.onItemHover(_273.byNode(this));}),on(this.containerNode,on.selector(_278,_270.leave),function(){self.onItemUnhover(_273.byNode(this));}),on(this.containerNode,on.selector(_278,_272),function(evt){self.onItemClick(_273.byNode(this),evt);evt.stopPropagation();evt.preventDefault();}));this.inherited(arguments);},onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.onItemClick(this.focusedChild,evt);}else{var _279=this._getTopMenu();if(_279&&_279._isMenuBar){_279.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _27a=this.currentPopup.parentMenu;if(_27a.focusedChild){_27a.focusedChild._setSelected(false);}_27a.focusedChild=this.currentPopup.from_item;_27a.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=this.defer("_openPopup",this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;item._set("hovering",true);},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _27b=item.popup;if(_27b){this._stopPendingCloseTimer(_27b);_27b._pendingClose_timer=this.defer(function(){_27b._pendingClose_timer=null;if(_27b.parentMenu){_27b.parentMenu.currentPopup=null;}pm.close(_27b);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}item._set("hovering",false);},_stopPopupTimer:function(){if(this.hover_timer){this.hover_timer=this.hover_timer.remove();}},_stopPendingCloseTimer:function(_27c){if(_27c._pendingClose_timer){_27c._pendingClose_timer=_27c._pendingClose_timer.remove();}},_stopFocusTimer:function(){if(this._focus_timer){this._focus_timer=this._focus_timer.remove();}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup(evt.type=="keypress");}else{this.onExecute();item._onClick?item._onClick(evt):item.onClick(evt);}},_openPopup:function(_27d){this._stopPopupTimer();var _27e=this.focusedChild;if(!_27e){return;}var _27f=_27e.popup;if(!_27f.isShowingNow){if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_27f.parentMenu=this;_27f.from_item=_27e;var self=this;pm.open({parent:this,popup:_27f,around:_27e.domNode,orient:this._orient||["after","before"],onCancel:function(){self.focusChild(_27e);self._cleanUp();_27e._setSelected(true);self.focusedChild=_27e;},onExecute:lang.hitch(this,"_cleanUp")});this.currentPopup=_27f;_27f.connect(_27f.domNode,"onmouseenter",lang.hitch(self,"_onPopupHover"));}if(_27d&&_27f.focus){_27f._focus_timer=this.defer(lang.hitch(_27f,function(){this._focus_timer=null;this.focus();}));}},_markActive:function(){this.isActive=true;_26f.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_26f.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_26c.indexOf(this._focusManager.activeStack,this.id)>=0){_26e.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.onItemUnhover(this.focusedChild);this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this.onItemUnhover(this._hoveredChild);}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});},"esri/dijit/_TouchBase":function(){define("esri/dijit/_TouchBase",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/dom","dojo/has","esri/kernel"],function(_280,lang,_281,dom,has,_282){var TB=_280(null,{declaredClass:"esri.dijit._TouchBase",_preventDefault:true,_swipeThreshold:20,constructor:function(node,_283){this.domNode=dom.byId(node);this.events=[_281.connect(this.domNode,"touchstart",this,this._touchStartHandler),_281.connect(this.domNode,"touchmove",this,this._touchMoveHandler),_281.connect(this.domNode,"touchend",this,this._touchEndHandler),_281.connect(this.domNode,"onclick",this,this._clickHandler)];},setPreventDefault:function(args){this._preventDefault=args;},disableOnClick:function(){_281.disconnect(this.events.pop());},_clickHandler:function(e){if(!this._moved){this.onclick(e);}else{e.preventDefault();}},_touchStartHandler:function(e){this._moved=false;this.client_x=e.targetTouches[0].clientX;this.client_y=e.targetTouches[0].clientY;this.down_x=e.targetTouches[0].pageX;this.down_y=e.targetTouches[0].pageY;e.downX=this.down_x;e.downY=this.down_y;this.onTouchStart(e);},_touchMoveHandler:function(e){if(this._preventDefault){e.preventDefault();}this._moved=true;this.up_x=e.targetTouches[0].pageX;this.cur_x=e.targetTouches[0].pageX-this.down_x;this.cur_y=e.targetTouches[0].pageY-this.down_y;e.curX=this.cur_x;e.curY=this.cur_y;this.onTouchMove(e);},_touchEndHandler:function(e){if(!this._moved){e.clientX=this.client_x;e.clientY=this.client_y;}else{e.curX=this.cur_x;e.curY=this.cur_y;if(this.down_x-this.up_x>this._swipeThreshold){e.swipeDirection="left";}else{if(this.up_x-this.down_x>this._swipeThreshold){e.swipeDirection="right";}}}this.onTouchEnd(e);},onTouchStart:function(evt){},onTouchMove:function(evt){},onTouchEnd:function(evt){},onclick:function(evt){}});if(has("extend-esri")){lang.setObject("dijit._TouchBase",TB,_282);}return TB;});},"esri/layers/SelectionMode":function(){define("esri/layers/SelectionMode",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/layers/RenderMode"],function(_284,lang,has,_285,_286){var _287=_284([_286],{declaredClass:"esri.layers._SelectionMode",constructor:function(_288){this.featureLayer=_288;this._featureMap={};},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},resume:function(){this.propertyChangeHandler(0);}});if(has("extend-esri")){lang.setObject("layers._SelectionMode",_287,_285);}return _287;});},"dojox/widget/gauge/_Gauge":function(){define("dojox/widget/gauge/_Gauge",["dijit","dojo","dojox","dojo/require!dojox/gauges/_Gauge"],function(_289,dojo,_28a){dojo.provide("dojox.widget.gauge._Gauge");dojo.require("dojox.gauges._Gauge");_28a.widget.gauge._Gauge=_28a.gauges._Gauge;_28a.widget.gauge.Range=_28a.gauges.Range;_28a.widget.gauge._indicator=_28a.gauges._indicator;});},"dojox/html/metrics":function(){define("dojox/html/metrics",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/ready","dojo/_base/unload","dojo/_base/window","dojo/dom-geometry"],function(_28b,lang,has,_28c,_28d,_28e,_28f){var dhm=lang.getObject("dojox.html.metrics",true);var _290=lang.getObject("dojox");dhm.getFontMeasurements=function(){var _291={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(has("ie")){_28e.doc.documentElement.style.fontSize="100%";}var div=_28e.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";_28e.body().appendChild(div);for(var p in _291){ds.fontSize=p;_291[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_28e.body().removeChild(div);div=null;return _291;};var _292=null;dhm.getCachedFontMeasurements=function(_293){if(_293||!_292){_292=dhm.getFontMeasurements();}return _292;};var _294=null,_295={};dhm.getTextBox=function(text,_296,_297){var m,s;if(!_294){m=_294=_28e.doc.createElement("div");var c=_28e.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";_28e.body().appendChild(c);}else{m=_294;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_296){for(var i in _296){if(i in _295){continue;}s[i]=_296[i];}}if(arguments.length>2&&_297){m.className=_297;}m.innerHTML=text;var box=_28f.position(m);box.w=m.parentNode.scrollWidth;return box;};var _298={w:16,h:16};dhm.getScrollbar=function(){return {w:_298.w,h:_298.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_299){var f=dhm._fontResizeNode=_28e.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";fs.display="none";if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[_290._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[_290._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");_28e.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};_28d.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(has("ie")&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});_28c(function(){try{var n=_28e.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";_28e.body().appendChild(n);_298.w=n.offsetWidth-n.clientWidth;_298.h=n.offsetHeight-n.clientHeight;_28e.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in _28b.config&&!!_28b.config.fontSizeWatch){dhm.initOnFontResize();}});return dhm;});},"esri/dijit/editing/tools/MenuItemBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","dijit/MenuItem","esri/dijit/editing/tools/ToolBase","esri/kernel"],function(_29a,lang,has,_29b,_29c,_29d){var MIB=_29a([_29b,_29c],{declaredClass:"esri.dijit.editing.tools.MenuItemBase",destroy:function(){_29b.prototype.destroy.apply(this,arguments);_29c.prototype.destroy.apply(this,arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.MenuItemBase",MIB,_29d);}return MIB;});},"esri/dijit/editing/tools/Union":function(){define("esri/dijit/editing/tools/Union",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/graphicsUtils","esri/graphic","esri/toolbars/draw","esri/dijit/editing/Union","esri/dijit/editing/tools/ButtonToolBase","esri/kernel"],function(_29e,lang,_29f,has,_2a0,_2a1,Draw,_2a2,_2a3,_2a4){var _2a5=_29e([_2a3],{declaredClass:"esri.dijit.editing.tools.Union",id:"btnFeatureUnion",_enabledIcon:"toolbarIcon unionIcon",_disabledIcon:"toolbarIcon unionIcon",_drawType:Draw.POLYLINE,_enabled:true,_label:"NLS_unionLbl",_onClick:function(evt){this._settings.editor._activeTool="UNION";var _2a6=this._settings.layers;var _2a7=_29f.filter(_2a6,function(item){return (item.geometryType==="esriGeometryPolygon")&&(item.visible&&item._isMapAtVisibleScale());});var _2a8=[];var _2a9=0;_29f.forEach(_2a7,function(_2aa,idx){var _2ab=_2aa.getSelectedFeatures();if(_2ab.length>=2){_2a9++;var _2ac=_29f.map(_2ab,function(item){return new _2a1(lang.clone(item.toJson()));});this._settings.geometryService.union(_2a0.getGeometries(_2ab),lang.hitch(this,function(_2ad){var _2ae=[_2ab.pop().setGeometry(_2ad)];_2a8.push({layer:_2aa,updates:_2ae,deletes:_2ab,preUpdates:_2ac});_2a9--;if(_2a9<=0){this.onApplyEdits(_2a8,lang.hitch(this,function(){if(this._settings.undoRedoManager){var _2af=this._settings.undoRedoManager;_29f.forEach(this._edits,lang.hitch(this,function(edit){_2af.add(new _2a2({featureLayer:edit.layer,addedGraphics:edit.deletes,preUpdatedGraphics:edit.preUpdates,postUpdatedGraphics:edit.updates}));}),this);}this._settings.editor._selectionHelper.clearSelection(false);this.onFinished();}));}}));}},this);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Union",_2a5,_2a4);}return _2a5;});},"dijit/form/_ComboBoxMenuMixin":function(){define("dijit/form/_ComboBoxMenuMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/i18n","dojo/i18n!./nls/ComboBox"],function(_2b0,_2b1,_2b2,i18n){return _2b1("dijit.form._ComboBoxMenuMixin",null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=i18n.getLocalization("dijit.form","ComboBox",this.lang);},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages["previousMessage"];this.nextButton.innerHTML=this._messages["nextMessage"];},_setValueAttr:function(_2b3){this.value=_2b3;this.onChange(_2b3);},onClick:function(node){if(node==this.previousButton){this._setSelectedAttr(null);this.onPage(-1);}else{if(node==this.nextButton){this._setSelectedAttr(null);this.onPage(1);}else{this.onChange(node);}}},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null);},_createOption:function(item,_2b4){var _2b5=this._createMenuItem();var _2b6=_2b4(item);if(_2b6.html){_2b5.innerHTML=_2b6.label;}else{_2b5.appendChild(_2b5.ownerDocument.createTextNode(_2b6.label));}if(_2b5.innerHTML==""){_2b5.innerHTML="&#160;";}this.applyTextDir(_2b5,(_2b5.innerText||_2b5.textContent||""));return _2b5;},createOptions:function(_2b7,_2b8,_2b9){this.items=_2b7;this.previousButton.style.display=(_2b8.start==0)?"none":"";_2b2.set(this.previousButton,"id",this.id+"_prev");_2b0.forEach(_2b7,function(item,i){var _2ba=this._createOption(item,_2b9);_2ba.setAttribute("item",i);_2b2.set(_2ba,"id",this.id+i);this.nextButton.parentNode.insertBefore(_2ba,this.nextButton);},this);var _2bb=false;if(_2b7.total&&!_2b7.total.then&&_2b7.total!=-1){if((_2b8.start+_2b8.count)<_2b7.total){_2bb=true;}else{if((_2b8.start+_2b8.count)>_2b7.total&&_2b8.count==_2b7.length){_2bb=true;}}}else{if(_2b8.count==_2b7.length){_2bb=true;}}this.nextButton.style.display=_2bb?"":"none";_2b2.set(this.nextButton,"id",this.id+"_next");},clearResultList:function(){var _2bc=this.containerNode;while(_2bc.childNodes.length>2){_2bc.removeChild(_2bc.childNodes[_2bc.childNodes.length-2]);}this._setSelectedAttr(null);},highlightFirstOption:function(){this.selectFirstNode();},highlightLastOption:function(){this.selectLastNode();},selectFirstNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.previousButton){this.selectNextNode();}},selectLastNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.nextButton){this.selectPreviousNode();}},getHighlightedOption:function(){return this.selected;}});});},"dijit/form/_SearchMixin":function(){define("dijit/form/_SearchMixin",["dojo/data/util/filter","dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/sniff","dojo/string","dojo/when","../registry"],function(_2bd,_2be,_2bf,keys,lang,_2c0,has,_2c1,when,_2c2){return _2be("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:true,_abortQuery:function(){if(this.searchTimer){this.searchTimer=this.searchTimer.remove();}if(this._queryDeferHandle){this._queryDeferHandle=this._queryDeferHandle.remove();}if(this._fetchHandle){if(this._fetchHandle.abort){this._cancelingQuery=true;this._fetchHandle.abort();this._cancelingQuery=false;}if(this._fetchHandle.cancel){this._cancelingQuery=true;this._fetchHandle.cancel();this._cancelingQuery=false;}this._fetchHandle=null;}},_processInput:function(evt){if(this.disabled||this.readOnly){return;}var key=evt.charOrCode;if(evt.altKey||((evt.ctrlKey||evt.metaKey)&&(key!="x"&&key!="v"))||key==keys.SHIFT){return;}var _2c3=false;this._prev_key_backspace=false;switch(key){case keys.DELETE:case keys.BACKSPACE:this._prev_key_backspace=true;this._maskValidSubsetError=true;_2c3=true;break;default:_2c3=typeof key=="string"||key==229;}if(_2c3){if(!this.store){this.onSearch();}else{this.searchTimer=this.defer("_startSearchFromInput",1);}}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));},_startSearch:function(text){this._abortQuery();var _2c4=this,_2c0=lang.clone(this.query),_2c5={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:true}},qs=_2c1.substitute(this.queryExpr,[text]),q,_2c6=function(){var _2c7=_2c4._fetchHandle=_2c4.store.query(_2c0,_2c5);if(_2c4.disabled||_2c4.readOnly||(q!==_2c4._lastQuery)){return;}when(_2c7,function(res){_2c4._fetchHandle=null;if(!_2c4.disabled&&!_2c4.readOnly&&(q===_2c4._lastQuery)){when(_2c7.total,function(_2c8){res.total=_2c8;var _2c9=_2c4.pageSize;if(isNaN(_2c9)||_2c9>res.total){_2c9=res.total;}res.nextPage=function(_2ca){_2c5.direction=_2ca=_2ca!==false;_2c5.count=_2c9;if(_2ca){_2c5.start+=res.length;if(_2c5.start>=res.total){_2c5.count=0;}}else{_2c5.start-=_2c9;if(_2c5.start<0){_2c5.count=Math.max(_2c9+_2c5.start,0);_2c5.start=0;}}if(_2c5.count<=0){res.length=0;_2c4.onSearch(res,_2c0,_2c5);}else{_2c6();}};_2c4.onSearch(res,_2c0,_2c5);});}},function(err){_2c4._fetchHandle=null;if(!_2c4._cancelingQuery){console.error(_2c4.declaredClass+" "+err.toString());}});};lang.mixin(_2c5,this.fetchProperties);if(this.store._oldAPI){q=qs;}else{q=_2bd.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_2c0[this.searchAttr]=q;this._queryDeferHandle=this.defer(_2c6,this.searchDelay);},constructor:function(){this.query={};this.fetchProperties={};},postMixInProperties:function(){if(!this.store){var list=this.list;if(list){this.store=_2c2.byId(list);}}this.inherited(arguments);}});});},"dojox/grid/_RowSelector":function(){define("dojox/grid/_RowSelector",["dojo/_base/declare","./_View"],function(_2cb,_2cc){return _2cb("dojox.grid._RowSelector",_2cc,{defaultWidth:"2em",noscroll:true,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility="hidden";},getWidth:function(){return this.viewWidth||this.defaultWidth;},buildRowContent:function(_2cd,_2ce){var w=this.contentWidth||0;_2ce.innerHTML="<table class=\"dojoxGridRowbarTable\" style=\"width:"+w+"px;height:1px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"><tr><td class=\"dojoxGridRowbarInner\">&nbsp;</td></tr></table>";},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight();},adaptWidth:function(){if(!("contentWidth" in this)&&this.contentNode&&this.contentNode.offsetWidth>0){this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth;}},doStyleRowNode:function(_2cf,_2d0){var n=["dojoxGridRowbar dojoxGridNonNormalizedCell"];if(this.grid.rows.isOver(_2cf)){n.push("dojoxGridRowbarOver");}if(this.grid.selection.isSelected(_2cf)){n.push("dojoxGridRowbarSelected");}_2d0.className=n.join(" ");},domouseover:function(e){this.grid.onMouseOverRow(e);},domouseout:function(e){if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}});});},"esri/dijit/BasemapGallery":function(){require({cache:{"url:esri/dijit/templates/BasemapGallery.html":"<div class=\"esriBasemapGallery\">\r\n  <div dojoAttachPoint=\"flowContainer\">\r\n  </div>\r\n</div>"}});define("esri/dijit/BasemapGallery",["require","dojo/_base/declare","dojo/_base/array","dojo/_base/connect","dojo/_base/lang","dojo/_base/kernel","dojo/_base/sniff","dojo/has","dojo/query","dojo/DeferredList","dojo/dom","dojo/dom-construct","dojo/dom-class","dijit/_Widget","dijit/_Templated","esri/kernel","esri/urlUtils","esri/request","esri/geometry/Extent","esri/virtualearth/VETiledLayer","esri/layers/OpenStreetMapLayer","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ArcGISImageServiceLayer","esri/layers/ImageServiceParameters","esri/dijit/Basemap","esri/dijit/_EventedWidget","dojo/text!esri/dijit/templates/BasemapGallery.html"],function(_2d1,_2d2,_2d3,_2d4,lang,_2d5,_2d6,has,_2d7,_2d8,dom,_2d9,_2da,_2db,_2dc,_2dd,_2de,_2df,_2e0,_2e1,_2e2,_2e3,_2e4,_2e5,_2e6,_2e7,_2e8,_2e9){var BMG=_2d2([_2e8,_2db,_2dc],{declaredClass:"esri.dijit.BasemapGallery",widgetsInTemplate:true,templateString:_2e9,basePath:_2d1.toUrl("esri/dijit")+"/",loaded:false,basemaps:[],bingMapsKey:null,flowContainer:null,_hasUI:false,_selectedBasemap:null,_selectBasemapInProgress:false,_eventMap:{"load":true,"selection-change":true,"add":["basemap"],"remove":["basemap"],"error":["message"]},constructor:function(_2ea,_2eb){_2ea=_2ea||{};if(!_2ea.map){console.error("esri.dijit.BasemapGallery: Unable to find the 'map' property in parameters");}this.map=_2ea.map;this._hasUI=_2eb?true:false;this.bingMapsKey=(_2ea.bingMapsKey&&_2ea.bingMapsKey.length>0)?_2ea.bingMapsKey:null;this.showArcGISBasemaps=(_2ea.showArcGISBasemaps===false)?false:true;this.basemaps=_2ea.basemaps||[];this.basemapIds=_2ea.basemapIds;this.referenceIds=_2ea.referenceIds;this.basemapsGroup=_2ea.basemapsGroup;if(location.protocol==="https:"){_2dd.dijit._arcgisUrl=_2dd.dijit._arcgisUrl.replace("http:","https:");}this.init();},init:function(){this.inherited(arguments);_2d3.forEach(this.basemaps,function(_2ec,i){if(!_2ec.id||_2ec.id.length===0){_2ec.id=this._getUniqueId();}_2d3.forEach(_2ec.layers,function(_2ed){_2ed.opacity=(_2ed.opacity>=0)?_2ed.opacity:1;_2ed.visibility=true;},this);},this);if(this.basemapIds&&this.basemapIds.length>0){_2d3.forEach(this.basemapIds,function(_2ee){var _2ef=this.map.getLayer(_2ee);_2ef._basemapGalleryLayerType="basemap";},this);}if(this.referenceIds&&this.referenceIds.length>0){_2d3.forEach(this.referenceIds,function(_2f0){var _2f1=this.map.getLayer(_2f0);_2f1._basemapGalleryLayerType="reference";},this);}if(this.basemapsGroup&&((this.basemapsGroup.owner&&this.basemapsGroup.title)||this.basemapsGroup.id)){this._findCustomBasemapsGroup(lang.hitch(this,"_handleArcGISBasemapsResponse"));}else{if(this.showArcGISBasemaps){this._findArcGISBasemapsGroup(lang.hitch(this,"_handleArcGISBasemapsResponse"));}else{this._finishStartup();}}},startup:function(){if(this.loaded){this._refreshUI();}else{_2d4.connect(this,"onLoad",lang.hitch(this,function(){this._refreshUI();}));}},select:function(id){this._select(id);},getSelected:function(){return this._selectedBasemap;},get:function(id){var i;for(i=0;i<this.basemaps.length;i++){if(this.basemaps[i].id==id){return this.basemaps[i];}}return null;},add:function(_2f2){if(_2f2&&!_2f2.id){_2f2.id=this._getUniqueId();this.basemaps.push(_2f2);this._refreshUI();this.onAdd(_2f2);return true;}else{if(_2f2&&this._isUniqueId(_2f2.id)){this.basemaps.push(_2f2);this._refreshUI();this.onAdd(_2f2);return true;}}return false;},remove:function(id){var i;for(i=0;i<this.basemaps.length;i++){var _2f3=this.basemaps[i];if(_2f3.id===id){if(this._selectedBasemap&&this._selectedBasemap.id===_2f3.id){this._selectedBasemap=null;}this.basemaps.splice(i,1);this._refreshUI();this.onRemove(_2f3);return _2f3;}}return null;},onLoad:function(){},onSelectionChange:function(){},onAdd:function(_2f4){},onRemove:function(_2f5){},onError:function(msg){},_defaultBasemapGalleryGroupQuery:"title:\"ArcGIS Online Basemaps\" AND owner:esri",_basemapGalleryGroupQuery:null,_finishStartup:function(){this.loaded=true;this.onLoad();if(this.map.layerIds.length===0&&this.basemaps.length>0&&!this._selectBasemapInProgress){this._select(this.basemaps[0].id);}},_findCustomBasemapsGroup:function(_2f6){if(this.basemapsGroup&&this.basemapsGroup.id){this._findArcGISBasemaps(this.basemapsGroup.id,_2f6);}else{this._basemapGalleryGroupQuery="title:\""+this.basemapsGroup.title+"\" AND owner:"+this.basemapsGroup.owner;this._findArcGISBasemapsGroup(_2f6);}},_findArcGISBasemapsGroup:function(_2f7){if(!this._basemapGalleryGroupQuery){var url=_2dd.dijit._arcgisUrl+"/accounts/self";var _2f8={};_2f8.f="json";_2f8.culture=_2d5.locale;_2df({url:url,content:_2f8,callbackParamName:"callback",load:lang.hitch(this,function(_2f9,args){if(_2f9&&_2f9.basemapGalleryGroupQuery){this._basemapGalleryGroupQuery=_2f9.basemapGalleryGroupQuery;}else{this._basemapGalleryGroupQuery=this._defaultBasemapGalleryGroupQuery;}this._findArcGISBasemapsGroupContent(_2f7);}),error:lang.hitch(this,function(_2fa,args){this._basemapGalleryGroupQuery=this._defaultBasemapGalleryGroupQuery;})});}else{this._findArcGISBasemapsGroupContent(_2f7);}},_findArcGISBasemapsGroupContent:function(_2fb){var _2fc=lang.hitch(this,"_findArcGISBasemaps");var url=_2dd.dijit._arcgisUrl+"/community/groups";var _2fd={};_2fd.q=this._basemapGalleryGroupQuery;_2fd.f="json";_2df({url:url,content:_2fd,callbackParamName:"callback",load:lang.hitch(this,function(_2fe,args){if(_2fe.results.length>0){_2fc(_2fe.results[0].id,_2fb);}else{var msg="esri.dijit.BasemapGallery: could not find group for basemaps.";this.onError(msg);}}),error:lang.hitch(this,function(_2ff){var msg="esri.dijit.BasemapGallery: could not find group for basemaps.";this.onError(msg);})});},_findArcGISBasemaps:function(_300,_301){var url=_2dd.dijit._arcgisUrl+"/search";var _302={};_302.q="group:"+_300+" AND type:\"web map\"";_302.sortField="name";_302.sortOrder="desc";_302.num=50;_302.f="json";_2df({url:url,content:_302,callbackParamName:"callback",load:lang.hitch(this,function(_303,args){if(_303.results.length>0){_301(_303.results);}else{var msg="esri.dijit.BasemapGallery: could not find group for basemaps.";this.onError(msg);}}),error:lang.hitch(this,function(_304,args){var msg="esri.dijit.BasemapGallery: could not find group for basemaps.";this.onError(msg);})});},_handleArcGISBasemapsResponse:function(_305){if(_305.length>0){_2d3.forEach(_305,function(item,i){if(this.bingMapsKey||(!this.bingMapsKey&&item.title&&item.title.indexOf("Bing Maps")==-1)){var _306={};_306.id=this._getUniqueId();_306.title=item.title;_306.thumbnailUrl="";if(item.thumbnail&&item.thumbnail.length){_306.thumbnailUrl=(_2dd.dijit._arcgisUrl+"/content/items/"+item.id+"/info/"+item.thumbnail);if(_2dd.id){var _307=_2dd.id.findCredential(_2de.urlToObject(_2dd.dijit._arcgisUrl).path);if(_307){_306.thumbnailUrl+="?token="+_307.token;}}}_306.itemId=item.id;var _308=new _2e7(_306,this);this.basemaps.splice(0,0,_308);}},this);this._finishStartup();}},_refreshUI:function(){if(this._hasUI){_2d9.empty(this.flowContainer);_2d3.forEach(this.basemaps,function(_309,i){if(!_309.id){_309.id="basemap_"+i;}this.flowContainer.appendChild(this._buildNodeLayout(_309));},this);_2d9.create("br",{style:{clear:"both"}},this.flowContainer);this._markSelected(this._selectedBasemap);}},_buildNodeLayout:function(_30a){var nId="galleryNode_"+_30a.id;var n=_2d9.create("div",{id:nId,"class":"esriBasemapGalleryNode"});var _30b=_2d9.create("a",{href:"javascript:void(0);"},n);_2d4.connect(_30b,"onclick",lang.hitch(this,"_onNodeClick",_30a));if(_30a.thumbnailUrl){_2d9.create("img",{"class":"esriBasemapGalleryThumbnail",src:_30a.thumbnailUrl},_30b);}else{_2d9.create("img",{"class":"esriBasemapGalleryThumbnail",src:this.basePath.toString()+"images/transparent.gif"},_30b);}var _30c=_2d9.create("div",{"class":"esriBasemapGalleryLabelContainer"},n);var _30d=_30a.title||"";_2d9.create("span",{innerHTML:_30d,alt:_30d,title:_30d},_30c);return n;},_onNodeClick:function(_30e,e){e.preventDefault();this._markSelected(_30e);this.select(_30e.id);},_markSelected:function(_30f){if(_30f){_2d3.forEach(_2d5.query(".esriBasemapGallerySelectedNode",this.domNode),function(node){_2da.remove(node,"esriBasemapGallerySelectedNode");});var _310=dom.byId("galleryNode_"+_30f.id);if(_310){_2da.add(_310,"esriBasemapGallerySelectedNode");}}},_select:function(id){this._selectBasemapInProgress=true;var _311=this.get(id);if(_311){if(_311.layers){this._getServiceInfos(_311);}else{var _312=_311.getLayers();if(lang.isArray(_312)){this._getServiceInfos(_311);}else{_312.addCallback(lang.hitch(this,function(_313){this._getServiceInfos(_311);}));}}this._markSelected(_311);}else{this._selectBasemapInProgress=false;}},_getServiceInfos:function(_314){if(location.protocol=="https:"){_2d3.forEach(_314.layers,function(_315){if(this._isAgolService(_315.url)||this._isHostedService(_315.url)){_315.url=_315.url.replace("http:","https:");}},this);}this._selectedBasemap=_314;var _316=[];_2d3.forEach(_314.layers,function(_317){if(_317.url&&_317.url.length>0&&!_317.isReference){_317.deferredsPos=_316.length;_316.push(this._getServiceInfo(_317.url));}},this);if(_316.length>0){var _318=new _2d8(_316);_318.addCallback(lang.hitch(this,function(_319){var _31a=null;_2d3.forEach(_314.layers,function(_31b){if(_31b.deferredsPos===0||_31b.deferredsPos){_31b.serviceInfoResponse=_319[_31b.deferredsPos][1];var ext=_31b.serviceInfoResponse.fullExtent;if(!ext){ext=_31b.serviceInfoResponse.extent;}if(!_31a){_31a=new _2e0(ext);}else{_31a=_31a.union(new _2e0(ext));}}},this);if(this.map.extent){var _31c=this._getIntersectionPercent(_31a,this.map.extent);if(_31c<5){this.map.setExtent(_31a,true);}}this._switchBasemapLayers(_314);this._updateReferenceLayer(_314);}));}else{this._switchBasemapLayers(_314);this._updateReferenceLayer(_314);}},_switchBasemapLayers:function(_31d){var _31e=_31d.layers;if(this.map.layerIds.length>0&&this.map.getNumLevels()===0&&(_31e[0].type==="OpenStreetMap"||(_31e[0].type&&_31e[0].type.indexOf("BingMaps")>-1))){var msg="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.";this.onError(msg);return;}_2d3.forEach(_31e,function(_31f){if(!_31f.isReference&&_31f.type&&_31f.type.indexOf("BingMaps")>-1&&!this.bingMapsKey){var msg="esri.dijit.BasemapGallery: Invalid Bing Maps key.";this.onError(msg);return;}},this);this._removeBasemapLayers();_2d3.forEach(_31e,function(_320){if(!_320.isReference){var _321,msg;if(_320.type==="OpenStreetMap"){if(this.map.layerIds.length>0&&this.map.getNumLevels()===0){msg="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.";this.onError(msg);return;}_321=new _2e2({id:"layer_osm",opacity:_320.opacity});}else{if(_320.type&&_320.type.indexOf("BingMaps")>-1){if(this.map.layerIds.length>0&&this.map.getNumLevels()===0){msg="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.";this.onError(msg);return;}var _322=_2e1.MAP_STYLE_AERIAL_WITH_LABELS;if(_320.type=="BingMapsAerial"){_322=_2e1.MAP_STYLE_AERIAL;}else{if(_320.type=="BingMapsRoad"){_322=_2e1.MAP_STYLE_ROAD;}}_321=new _2e1({id:"layer_bing",bingMapsKey:this.bingMapsKey,mapStyle:_322,opacity:_320.opacity});}else{if(_320.serviceInfoResponse&&_320.serviceInfoResponse.mapName){if((this.map.layerIds.length===0||this.map.getNumLevels()>0)&&_320.serviceInfoResponse.singleFusedMapCache===true){_321=this._loadAsCached(_320);}else{_321=this._loadAsDynamic(_320);}}else{if(_320.serviceInfoResponse&&_320.serviceInfoResponse.pixelSizeX){var _323=new _2e6();_323.bandIds=_320.bandIds;if(!_320.bandIds&&_320.serviceInfoResponse.bandCount&&parseInt(_320.serviceInfoResponse.bandCount)>3){_323.bandIds=[0,1,2];}_321=new _2e5(_320.url,{resourceInfo:_320.serviceInfoResponse,opacity:_320.opacity,visible:_320.visibility,imageServiceParameters:_323});}}}}if(_321){_321._basemapGalleryLayerType="basemap";this.map.addLayer(_321,0);}}},this);this._selectBasemapInProgress=false;this.onSelectionChange();},_removeBasemapLayers:function(){var _324=this.map.layerIds;var _325=[];_2d3.forEach(_324,function(id){var _326=this.map.getLayer(id);if(_326._basemapGalleryLayerType==="basemap"){_325.push(_326);}},this);if(_325.length===0&&_324.length>0){_325.push(this.map.getLayer(_324[0]));}if(_325.length>0){_2d3.forEach(_325,function(_327){this.map.removeLayer(_327);},this);}},_updateReferenceLayer:function(_328){var i;this._removeReferenceLayer();for(i=0;i<_328.layers.length;i++){if(_328.layers[i].isReference===true){this._addReferenceLayer(_328.layers[i]);}}},_removeReferenceLayer:function(){var i;for(i=this.map.layerIds.length-1;i>=0;i--){var id=this.map.layerIds[i];var _329=this.map.getLayer(id);if(_329._basemapGalleryLayerType==="reference"){this.map.removeLayer(_329);}}},_addReferenceLayer:function(_32a){this._getServiceInfo(_32a.url,lang.hitch(this,"_handleReferenceServiceInfoResponse",_32a));},_handleReferenceServiceInfoResponse:function(_32b,_32c,args){var _32d;_32b.serviceInfoResponse=_32c;if(_32c&&_32c.mapName){if(_32c.singleFusedMapCache===true){_32d=this._loadAsCached(_32b);}else{_32d=this._loadAsDynamic(_32b);}}else{if(_32c&&_32c.pixelSizeX){var _32e=new _2e6();_32e.bandIds=_32b.bandIds;if(!_32b.bandIds&&_32c.bandCount&&parseInt(_32c.bandCount)>3){_32e.bandIds=[0,1,2];}_32d=new _2e5(_32b.url,{resourceInfo:_32c,opacity:_32b.opacity,visible:_32b.visibility,imageServiceParameters:_32e});}}if(_32d){_32d._basemapGalleryLayerType="reference";this.map.addLayer(_32d);}},_getServiceInfo:function(url,_32f){var _330={};_330.f="json";var _331=_2df({url:url,content:_330,callbackParamName:"callback",load:function(_332,args){if(_32f){_32f(_332,args);}},error:lang.hitch(this,function(_333,args){var msg="esri.dijit.BasemapGallery: service not accessible.";this.onError(msg);})});return _331;},_loadAsCached:function(_334){var _335=[];if(!_334.displayLevels){_335=_2d3.map(_334.serviceInfoResponse.tileInfo.lods,function(lod){return lod.level;});}var _336=new _2e3(_334.url,{resourceInfo:_334.serviceInfoResponse,opacity:_334.opacity,visible:_334.visibility,displayLevels:_334.displayLevels||_335});return _336;},_loadAsDynamic:function(_337){var _338=new _2e4(_337.url,{resourceInfo:_337.serviceInfoResponse,opacity:_337.opacity,visible:_337.visibility});if(_337.visibleLayers){_338.setVisibleLayers(_337.visibleLayers);}return _338;},_getIntersectionPercent:function(_339,_33a){var _33b=_33a.intersects(_339);if(_33b){var _33c=_33b.getWidth()*_33b.getHeight();var _33d=_33a.getWidth()*_33a.getHeight();return (_33c/_33d)*100;}else{return 0;}},_getIds:function(){var ids=[];_2d3.forEach(this.basemaps,function(_33e){ids.push(_33e.id);},this);return ids;},_getUniqueId:function(){var _33f=","+this._getIds().toString()+",";var _340=0;while(true){if(_33f.indexOf(",basemap_"+_340+",")>-1){_340++;}else{return "basemap_"+_340;}}},_isUniqueId:function(id){var _341=","+this._getIds().toString()+",";if(_341.indexOf(","+id+",")===-1){return true;}return false;},_isAgolService:function(url){if(!url){return false;}return (url.indexOf("/services.arcgisonline.com/")!==-1||url.indexOf("/server.arcgisonline.com/")!==-1);},_isHostedService:function(url){if(!url){return false;}return (url.indexOf(".arcgis.com/")!==-1);}});if(has("extend-esri")){lang.setObject("dijit.BasemapGallery",BMG,_2dd);}return BMG;});},"dojo/dnd/Manager":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../_base/window","../dom-class","../Evented","../has","../keys","../on","../topic","../touch","./common","./autoscroll","./Avatar"],function(_342,_343,_344,lang,win,_345,_346,has,keys,on,_347,_348,dnd,_349,_34a){var _34b=_343("dojo.dnd.Manager",[_346],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:has("touch")?0:16,OFFSET_Y:has("touch")?-64:16,overSource:function(_34c){if(this.avatar){this.target=(_34c&&_34c.targetState!="Disabled")?_34c:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}_347.publish("/dnd/source/over",_34c);},outSource:function(_34d){if(this.avatar){if(this.target==_34d){this.target=null;this.canDropFlag=false;this.avatar.update();_347.publish("/dnd/source/over",null);}}else{_347.publish("/dnd/source/over",null);}},startDrag:function(_34e,_34f,copy){_349.autoScrollStart(win.doc);this.source=_34e;this.nodes=_34f;this.copy=Boolean(copy);this.avatar=this.makeAvatar();win.body().appendChild(this.avatar.node);_347.publish("/dnd/start",_34e,_34f,this.copy);this.events=[on(win.doc,_348.move,lang.hitch(this,"onMouseMove")),on(win.doc,_348.release,lang.hitch(this,"onMouseUp")),on(win.doc,"keydown",lang.hitch(this,"onKeyDown")),on(win.doc,"keyup",lang.hitch(this,"onKeyUp")),on(win.doc,"dragstart",_344.stop),on(win.body(),"selectstart",_344.stop)];var c="dojoDnd"+(copy?"Copy":"Move");_345.add(win.body(),c);},canDrop:function(flag){var _350=Boolean(this.target&&flag);if(this.canDropFlag!=_350){this.canDropFlag=_350;this.avatar.update();}},stopDrag:function(){_345.remove(win.body(),["dojoDndCopy","dojoDndMove"]);_342.forEach(this.events,function(_351){_351.remove();});this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new _34a(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){_349.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}if(has("touch")){e.preventDefault();}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));_347.publish("/dnd/drop/before",this.source,this.nodes,copy,this.target,e);_347.publish("/dnd/drop",this.source,this.nodes,copy,this.target,e);}else{_347.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case keys.ESCAPE:_347.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();_345.replace(win.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dnd._manager=null;_34b.manager=dnd.manager=function(){if(!dnd._manager){dnd._manager=new _34b();}return dnd._manager;};return _34b;});},"esri/layers/GridLayout":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/SpatialReference","esri/geometry/Extent","esri/geometry/Polyline"],function(_352,lang,_353,has,_354,_355,_356,_357){var _358=_352(null,{declaredClass:"esri.layers._GridLayout",constructor:function(_359,_35a,_35b,_35c){this.origin=_359;this.cellWidth=_35a.width;this.cellHeight=_35a.height;this.mapWidth=_35b.width;this.mapHeight=_35b.height;this.srInfo=_35c;},setResolution:function(_35d){this._resolution=(_35d.xmax-_35d.xmin)/this.mapWidth;if(this.srInfo){var _35e=Math.round((2*this.srInfo.valid[1])/this._resolution),_35f=Math.round(_35e/this.cellWidth);this._frameStats=[_35f,0,_35f-1];}},getCellCoordinates:function(_360){var res=this._resolution,_361=this.origin;return {row:Math.floor((_361.y-_360.y)/(this.cellHeight*res)),col:Math.floor((_360.x-_361.x)/(this.cellWidth*res))};},normalize:function(col){var _362=this._frameStats;if(_362){var _363=_362[0],m180=_362[1],p180=_362[2];if(col<m180){col=col%_363;col=col<m180?col+_363:col;}else{if(col>p180){col=col%_363;}}}return col;},intersects:function(_364,_365){var _366=this.srInfo;if(_366){return _353.some(_365._getParts(_366),function(_367){return _364.intersects(_367.extent);});}else{return _364.intersects(_365);}},getCellExtent:function(row,col){var res=this._resolution,_368=this.origin,_369=this.cellWidth,_36a=this.cellHeight;return new _356((col*_369*res)+_368.x,_368.y-((row+1)*_36a*res),((col+1)*_369*res)+_368.x,_368.y-(row*_36a*res),new _355(_368.spatialReference.toJson()));},getLatticeID:function(_36b){var _36c=this.getCellCoordinates({x:_36b.xmin,y:_36b.ymax}),_36d=this.getCellCoordinates({x:_36b.xmax,y:_36b.ymin}),_36e=_36c.row,_36f=_36d.row,_370=this.normalize(_36c.col),_371=this.normalize(_36d.col);return _36e+"_"+_36f+"_"+_370+"_"+_371;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_372,_373){var _374=this.getCellCoordinates({x:_372.xmin,y:_372.ymax}),_375=this.getCellCoordinates({x:_372.xmax,y:_372.ymin}),_376=_374.row,_377=_375.row,_378=_374.col,_379=_375.col,_37a=[],i,j,nj,_37b=[],_37c=[],len,xmin,xmax,ymin,ymax,_37d=[],_37e,_37f;for(i=_376;i<=_377;i++){for(j=_378;j<=_379;j++){nj=this.normalize(j);_372=this.getCellExtent(i,nj);_37a.push({row:i,col:nj,extent:_372,resolution:this._resolution});if(_373){_37b.push(_372.xmin,_372.xmax);_37c.push(_372.ymin,_372.ymax);}}}_378=this.normalize(_378);_379=this.normalize(_379);_37b.sort(this.sorter);_37c.sort(this.sorter);len=_37b.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_37b[i]===_37b[i+1]){_37b.splice(i,1);}}}len=_37c.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_37c[i]===_37c[i+1]){_37c.splice(i,1);}}}if(_37b.length&&_37c.length){xmin=_37b[0];xmax=_37b[_37b.length-1];ymin=_37c[0];ymax=_37c[_37c.length-1];len=_37b.length;for(i=0;i<len;i++){_37d.push([[_37b[i],ymax],[_37b[i],ymin]]);}len=_37c.length;for(i=0;i<len;i++){_37d.push([[xmin,_37c[i]],[xmax,_37c[i]]]);}_37e=new _357({paths:_37d,spatialReference:this.origin.spatialReference.toJson()});_37f=_376+"_"+_377+"_"+_378+"_"+_379;_37a.push({latticeID:_37f,lattice:_37e,resolution:this._resolution});}return {minRow:_376,maxRow:_377,minCol:_378,maxCol:_379,cells:_37a};}});if(has("extend-esri")){lang.setObject("layers._GridLayout",_358,_354);}return _358;});},"esri/layers/FeatureTemplate":function(){define("esri/layers/FeatureTemplate",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/lang","esri/graphic"],function(_380,lang,has,_381,_382,_383){var _384=_380(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(json){if(json&&lang.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _385=json.prototype;this.prototype=new _383(_385.geometry,null,_385.attributes);}},toJson:function(){return _382.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});lang.mixin(_384,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});if(has("extend-esri")){lang.setObject("layers.FeatureTemplate",_384,_381);}return _384;});},"dijit/form/NumberSpinner":function(){define("dijit/form/NumberSpinner",["dojo/_base/declare","dojo/_base/event","dojo/keys","./_Spinner","./NumberTextBox"],function(_386,_387,keys,_388,_389){return _386("dijit.form.NumberSpinner",[_388,_389.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(val,_38a){var tc=this.constraints,v=isNaN(val),_38b=!isNaN(tc.max),_38c=!isNaN(tc.min);if(v&&_38a!=0){val=(_38a>0)?_38c?tc.min:_38b?tc.max:0:_38b?this.constraints.max:_38c?tc.min:0;}var _38d=val+_38a;if(v||isNaN(_38d)){return val;}if(_38b&&(_38d>tc.max)){_38d=tc.max;}if(_38c&&(_38d<tc.min)){_38d=tc.min;}return _38d;},_onKeyPress:function(e){if((e.charOrCode==keys.HOME||e.charOrCode==keys.END)&&!(e.ctrlKey||e.altKey||e.metaKey)&&typeof this.get("value")!="undefined"){var _38e=this.constraints[(e.charOrCode==keys.HOME?"min":"max")];if(typeof _38e=="number"){this._setValueAttr(_38e,false);}_387.stop(e);}}});});},"esri/dijit/editing/tools/Selection":function(){define("esri/dijit/editing/tools/Selection",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/Color","dojo/has","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/dijit/editing/tools/Edit","esri/dijit/editing/tools/SelectionTools","esri/dijit/editing/tools/DropDownToolBase","esri/kernel"],function(_38f,lang,_390,_391,_392,has,_393,_394,_395,Edit,_396,_397,_398){var _399=_38f([_397],{declaredClass:"esri.dijit.editing.tools.Selection",_enabled:true,activate:function(){this.inherited(arguments);this._sConnect=_391.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");},deactivate:function(){this.inherited(arguments);_391.disconnect(this._sConnect);delete this._sConnect;},_initializeTool:function(){this._createSymbols();this._initializeLayers();this._toolTypes=["select","selectadd","selectremove"];},_onDrawEnd:function(_39a){this.inherited(arguments);this._settings.editor._hideAttributeInspector();var _39b=this._settings.layers;this._selectMethod=this._activeTool._selectMethod;this._settings.editor._selectionHelper.selectFeaturesByGeometry(_39b,_39a,this._selectMethod,lang.hitch(this,"onFinished"));},_createSymbols:function(){this._pointSelectionSymbol=new _393(_393.STYLE_CIRCLE,10,new _394(_394.STYLE_SOLID,new _392([0,0,0]),1),new _392([255,0,0,0.5]));this._polylineSelectionSymbol=new _394(_394.STYLE_SOLID,new _392([0,200,255]),2);this._polygonSelectionSymbol=new _395(_395.STYLE_SOLID,new _394(_394.STYLE_SOLID,new _392([0,0,0]),1),new _392([0,200,255,0.5]));},_initializeLayers:function(){var _39c=this._settings.layers;_390.forEach(_39c,this._setSelectionSymbol,this);},_setSelectionSymbol:function(_39d){var _39e=null;switch(_39d.geometryType){case "esriGeometryPoint":_39e=this._pointSelectionSymbol;break;case "esriGeometryPolyline":_39e=this._polylineSelectionSymbol;break;case "esriGeometryPolygon":_39e=this._polygonSelectionSymbol;break;}_39d.setSelectionSymbol(_39d._selectionSymbol||_39e);},_createTools:function(){_390.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments);},_createTool:function(_39f){var _3a0=lang.mixin(_396[_39f],{settings:this._settings,onClick:lang.hitch(this,"onItemClicked",_396[_39f].id)});this._tools[_39f.toUpperCase()]=new Edit(_3a0);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Selection",_399,_398);}return _399;});},"dijit/form/DateTextBox":function(){define("dijit/form/DateTextBox",["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(_3a1,_3a2,_3a3){return _3a1("dijit.form.DateTextBox",_3a3,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:_3a2,_selector:"date",value:new Date("")});});},"esri/dijit/Print":function(){define("esri/dijit/Print",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dojo/dom","dojo/dom-class","dojo/dom-construct","dijit/Menu","dijit/MenuItem","dijit/form/Button","dijit/form/ComboButton","esri/tasks/PrintTask","esri/tasks/PrintParameters","esri/kernel","esri/domUtils","esri/Evented","dojo/i18n!esri/nls/jsapi"],function(_3a4,lang,_3a5,_3a6,has,dom,_3a7,_3a8,Menu,_3a9,_3aa,_3ab,_3ac,_3ad,_3ae,_3af,_3b0,_3b1){var _3b2=_3a4([_3b0],{declaredClass:"esri.dijit.Print",_eventMap:{"print-complete":["result"],"error":true,"print-start":true},onPrintComplete:function(){},onError:function(){},onPrintStart:function(){},constructor:function(_3b3,_3b4){_3b3=_3b3||{};this.url=_3b3.url;this.async=_3b3.async;this.map=_3b3.map;this.templates=_3b3.templates;this.extraParams=_3b3.extraParameters;var _3b5=_3b1.widgets.print;this._printText=_3b5.NLS_print;this._printingText=_3b5.NLS_printing;this._printoutText=_3b5.NLS_printout;if(!this.templates){this.templates=[{label:this._printText,format:"PNG32",layout:"MAP_ONLY",exportOptions:{width:800,height:1100,dpi:96}}];}this.printDomNode=_3a8.create("div");_3a7.add(this.printDomNode,"esriPrint");_3b4=dom.byId(_3b4);_3b4.appendChild(this.printDomNode);},startup:function(){this._createPrintButton();},destroy:function(){this.map=null;_3a8.destroy(this.printDomNode);},hide:function(){_3af.hide(this.printDomNode);},show:function(){_3af.show(this.printDomNode);},printMap:function(_3b6){this.onPrintStart();this._printButton.setAttribute("label",this._printingText);this._printButton.setAttribute("disabled",true);var map=this.map;var _3b7=new _3ac(this.url,{async:this.async});var _3b8=new _3ad();_3b8.map=map;_3b8.template=_3b6;_3b8.extraParameters=this.extraParams;_3b7.execute(_3b8,lang.hitch(this,this._printComplete),lang.hitch(this,this._printError));},_createPrintButton:function(){var _3b9=this.templates;if(_3b9.length===1){this._printButton=new _3aa({label:this._printText,onClick:lang.hitch(this,function(){this.printMap(_3b9[0]);})});this.printDomNode.appendChild(this._printButton.domNode);}else{this._printButton=new _3ab({label:this._printText,onClick:lang.hitch(this,function(){this.printMap(_3b9[0]);})});this.printDomNode.appendChild(this._printButton.domNode);var menu=new Menu({style:"display: none;"});_3a6.forEach(_3b9,function(_3ba){var _3bb=new _3a9({label:_3ba.label,onClick:lang.hitch(this,function(){this.printMap(_3ba);})});menu.addChild(_3bb);},this);this._printButton.setAttribute("dropDown",menu);}_3a7.add(this._printButton.domNode,"esriPrintButton");},_printComplete:function(_3bc){this.onPrintComplete(_3bc);var _3bd=window.location.host.split(".");var _3be=_3bd.length>1?_3bd[_3bd.length-2]+"."+_3bd[_3bd.length-1]:window.location.host;var _3bf=_3bc.url.split("://")[1].split("/")[0].split(".");var _3c0=_3bf.length>1?_3bf[_3bf.length-2]+"."+_3bf[_3bf.length-1]:_3bc.url.split("://")[1].split("/")[0];if(_3be.toLowerCase()===_3c0.toLowerCase()){window.open(_3bc.url);this._removeAllChildren(this.printDomNode);this._createPrintButton();}else{this._printButton.domNode.style.display="none";var _3c1=_3a8.create("a",{href:_3bc.url,target:"_blank",innerHTML:this._printoutText});_3a5.connect(_3c1,"onclick",lang.hitch(this,this._hyperlinkClick));this._removeAllChildren(this.printDomNode);_3a7.add(_3c1,"esriPrintout");this.printDomNode.appendChild(_3c1);}},_printError:function(err){this._removeAllChildren(this.printDomNode);this._createPrintButton();console.error(err);this.onError(err);},_hyperlinkClick:function(){this._removeAllChildren(this.printDomNode);this._createPrintButton();},_removeAllChildren:function(_3c2){while(_3c2.hasChildNodes()){_3c2.removeChild(_3c2.lastChild);}}});if(has("extend-esri")){lang.setObject("dijit.Print",_3b2,_3ae);}return _3b2;});},"url:dijit/templates/Calendar.html":"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\" role=\"grid\" aria-labelledby=\"${id}_mddb ${id}_year\">\n\t<thead>\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"decrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\n\t\t\t</th>\n\t\t\t<th class='dijitReset' colspan=\"5\">\n\t\t\t\t<div data-dojo-attach-point=\"monthNode\">\n\t\t\t\t</div>\n\t\t\t</th>\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"incrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\n\t\t\t</th>\n\t\t</tr>\n\t\t<tr role=\"row\">\n\t\t\t${!dayCellsHtml}\n\t\t</tr>\n\t</thead>\n\t<tbody data-dojo-attach-point=\"dateRowsNode\" data-dojo-attach-event=\"onclick: _onDayClick\" class=\"dijitReset dijitCalendarBodyContainer\">\n\t\t\t${!dateRowsHtml}\n\t</tbody>\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\n\t\t<tr>\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\" role=\"presentation\">\n\t\t\t\t<div class=\"dijitCalendarYearLabel\">\n\t\t\t\t\t<span data-dojo-attach-point=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\" role=\"button\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\" role=\"button\" id=\"${id}_year\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\" role=\"button\"></span>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</tfoot>\n</table>\n","dijit/form/_AutoCompleterMixin":function(){define("dijit/form/_AutoCompleterMixin",["dojo/data/util/filter","dojo/_base/declare","dojo/dom-attr","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/regexp","dojo/sniff","dojo/string","./DataList","../registry","./_TextBoxMixin","./_SearchMixin"],function(_3c3,_3c4,_3c5,_3c6,keys,lang,_3c7,_3c8,has,_3c9,_3ca,_3cb,_3cc,_3cd){return _3c4("dijit.form._AutoCompleterMixin",_3cd,{item:null,autoComplete:true,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:false,_getCaretPos:function(_3ce){var pos=0;if(typeof (_3ce.selectionStart)=="number"){pos=_3ce.selectionStart;}else{if(has("ie")){var tr=_3ce.ownerDocument.selection.createRange().duplicate();var ntr=_3ce.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);pos=String(ntr.text).replace(/\r/g,"").length;}catch(e){}}}return pos;},_setCaretPos:function(_3cf,_3d0){_3d0=parseInt(_3d0);_3cc.selectInputText(_3cf,_3d0,_3d0);},_setDisabledAttr:function(_3d1){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",_3d1?"true":"false");},_onKey:function(evt){if(evt.charCode>=32){return;}var key=evt.charCode||evt.keyCode;if(key==keys.ALT||key==keys.CTRL||key==keys.META||key==keys.SHIFT){return;}var pw=this.dropDown;var _3d2=null;this._abortQuery();this.inherited(arguments);if(evt.altKey||evt.ctrlKey||evt.metaKey){return;}if(this._opened){_3d2=pw.getHighlightedOption();}switch(key){case keys.PAGE_DOWN:case keys.DOWN_ARROW:case keys.PAGE_UP:case keys.UP_ARROW:if(this._opened){this._announceOption(_3d2);}_3c6.stop(evt);break;case keys.ENTER:if(_3d2){if(_3d2==pw.nextButton){this._nextSearch(1);_3c6.stop(evt);break;}else{if(_3d2==pw.previousButton){this._nextSearch(-1);_3c6.stop(evt);break;}}_3c6.stop(evt);}else{this._setBlurValue();this._setCaretPos(this.focusNode,this.focusNode.value.length);}case keys.TAB:var _3d3=this.get("displayedValue");if(pw&&(_3d3==pw._messages["previousMessage"]||_3d3==pw._messages["nextMessage"])){break;}if(_3d2){this._selectOption(_3d2);}case keys.ESCAPE:if(this._opened){this._lastQuery=null;this.closeDropDown();}break;}},_autoCompleteText:function(text){var fn=this.focusNode;_3cc.selectInputText(fn,fn.value.length);var _3d4=this.ignoreCase?"toLowerCase":"substr";if(text[_3d4](0).indexOf(this.focusNode.value[_3d4](0))==0){var cpos=this.autoComplete?this._getCaretPos(fn):fn.value.length;if((cpos+1)>fn.value.length){fn.value=text;_3cc.selectInputText(fn,cpos);}}else{fn.value=text;_3cc.selectInputText(fn);}},_openResultList:function(_3d5,_3d6,_3d7){var _3d8=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();if(!_3d5.length&&_3d7.start==0){this.closeDropDown();return;}this._nextSearch=this.dropDown.onPage=lang.hitch(this,function(_3d9){_3d5.nextPage(_3d9!==-1);this.focus();});this.dropDown.createOptions(_3d5,_3d7,lang.hitch(this,"_getMenuLabelFromItem"));this._showResultList();if("direction" in _3d7){if(_3d7.direction){this.dropDown.highlightFirstOption();}else{if(!_3d7.direction){this.dropDown.highlightLastOption();}}if(_3d8){this._announceOption(this.dropDown.getHighlightedOption());}}else{if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_3d6[this.searchAttr].toString())){this._announceOption(this.dropDown.containerNode.firstChild.nextSibling);}}},_showResultList:function(){this.closeDropDown(true);this.openDropDown();this.domNode.setAttribute("aria-expanded","true");},loadDropDown:function(){this._startSearchAll();},isLoaded:function(){return false;},closeDropDown:function(){this._abortQuery();if(this._opened){this.inherited(arguments);this.domNode.setAttribute("aria-expanded","false");this.focusNode.removeAttribute("aria-activedescendant");}},_setBlurValue:function(){var _3da=this.get("displayedValue");var pw=this.dropDown;if(pw&&(_3da==pw._messages["previousMessage"]||_3da==pw._messages["nextMessage"])){this._setValueAttr(this._lastValueReported,true);}else{if(typeof this.item=="undefined"){this.item=null;this.set("displayedValue",_3da);}else{if(this.value!=this._lastValueReported){this._handleOnChange(this.value,true);}this._refreshState();}}},_setItemAttr:function(item,_3db,_3dc){var _3dd="";if(item){if(!_3dc){_3dc=this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr];}_3dd=this._getValueField()!=this.searchAttr?this.store.getIdentity(item):_3dc;}this.set("value",_3dd,_3db,_3dc,item);},_announceOption:function(node){if(!node){return;}var _3de;if(node==this.dropDown.nextButton||node==this.dropDown.previousButton){_3de=node.innerHTML;this.item=undefined;this.value="";}else{var item=this.dropDown.items[node.getAttribute("item")];_3de=(this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr]).toString();this.set("item",item,false,_3de);}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",_3c5.get(node,"id"));this._autoCompleteText(_3de);},_selectOption:function(_3df){this.closeDropDown();if(_3df){this._announceOption(_3df);}this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,true);},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this.item=undefined;this.inherited(arguments);},_startSearch:function(key){if(!this.dropDown){var _3e0=this.id+"_popup",_3e1=lang.isString(this.dropDownClass)?lang.getObject(this.dropDownClass,false):this.dropDownClass;this.dropDown=new _3e1({onChange:lang.hitch(this,this._selectOption),id:_3e0,dir:this.dir,textDir:this.textDir});this.focusNode.removeAttribute("aria-activedescendant");this.textbox.setAttribute("aria-owns",_3e0);}this._lastInput=key;this.inherited(arguments);},_getValueField:function(){return this.searchAttr;},postMixInProperties:function(){this.inherited(arguments);if(!this.store){var _3e2=this.srcNodeRef;this.store=new _3ca({},_3e2);if(!("value" in this.params)){var item=(this.item=this.store.fetchSelectedItem());if(item){var _3e3=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(item,_3e3):item[_3e3];}}}},postCreate:function(){var _3e4=_3c7("label[for=\""+this.id+"\"]");if(_3e4.length){if(!_3e4[0].id){_3e4[0].id=this.id+"_label";}this.domNode.setAttribute("aria-labelledby",_3e4[0].id);}this.inherited(arguments);this.connect(this,"onSearch","_openResultList");},_getMenuLabelFromItem:function(item){var _3e5=this.labelFunc(item,this.store),_3e6=this.labelType;if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){_3e5=this.doHighlight(_3e5,this._lastInput);_3e6="html";}return {html:_3e6=="html",label:_3e5};},doHighlight:function(_3e7,find){var _3e8=(this.ignoreCase?"i":"")+(this.highlightMatch=="all"?"g":""),i=this.queryExpr.indexOf("${0}");find=_3c8.escapeString(find);return this._escapeHtml(_3e7.replace(new RegExp((i==0?"^":"")+"("+find+")"+(i==(this.queryExpr.length-4)?"$":""),_3e8),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");},_escapeHtml:function(str){str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");return str;},reset:function(){this.item=null;this.inherited(arguments);},labelFunc:function(item,_3e9){return (_3e9._oldAPI?_3e9.getValue(item,this.labelAttr||this.searchAttr):item[this.labelAttr||this.searchAttr]).toString();},_setValueAttr:function(_3ea,_3eb,_3ec,item){this._set("item",item||null);if(_3ea==null){_3ea="";}this.inherited(arguments);},_setTextDirAttr:function(_3ed){this.inherited(arguments);if(this.dropDown){this.dropDown._set("textDir",_3ed);}}});});},"dojox/grid/Selection":function(){define("dojox/grid/Selection",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(_3ee,_3ef,lang,_3f0){return _3ee("dojox.grid.Selection",null,{constructor:function(_3f1){this.grid=_3f1;this.selected=[];this.setMode(_3f1.selectionMode);},mode:"extended",selected:null,updating:0,selectedIndex:-1,rangeStartIndex:-1,setMode:function(mode){if(this.selected.length){this.deselectAll();}if(mode!="extended"&&mode!="multiple"&&mode!="single"&&mode!="none"){this.mode="extended";}else{this.mode=mode;}},onCanSelect:function(_3f2){return this.grid.onCanSelect(_3f2);},onCanDeselect:function(_3f3){return this.grid.onCanDeselect(_3f3);},onSelected:function(_3f4){},onDeselected:function(_3f5){},onChanging:function(){},onChanged:function(){},isSelected:function(_3f6){if(this.mode=="none"){return false;}return this.selected[_3f6];},getFirstSelected:function(){if(!this.selected.length||this.mode=="none"){return -1;}for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getNextSelected:function(_3f7){if(this.mode=="none"){return -1;}for(var i=_3f7+1,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getSelected:function(){var _3f8=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_3f8.push(i);}}return _3f8;},getSelectedCount:function(){var c=0;for(var i=0;i<this.selected.length;i++){if(this.selected[i]){c++;}}return c;},_beginUpdate:function(){if(this.updating===0){this.onChanging();}this.updating++;},_endUpdate:function(){this.updating--;if(this.updating===0){this.onChanged();}},select:function(_3f9){if(this.mode=="none"){return;}if(this.mode!="multiple"){this.deselectAll(_3f9);this.addToSelection(_3f9);}else{this.toggleSelect(_3f9);}},addToSelection:function(_3fa){if(this.mode=="none"){return;}if(lang.isArray(_3fa)){_3ef.forEach(_3fa,this.addToSelection,this);return;}_3fa=Number(_3fa);if(this.selected[_3fa]){this.selectedIndex=_3fa;}else{if(this.onCanSelect(_3fa)!==false){this.selectedIndex=_3fa;var _3fb=this.grid.getRowNode(_3fa);if(_3fb){_3f0.set(_3fb,"aria-selected","true");}this._beginUpdate();this.selected[_3fa]=true;this.onSelected(_3fa);this._endUpdate();}}},deselect:function(_3fc){if(this.mode=="none"){return;}if(lang.isArray(_3fc)){_3ef.forEach(_3fc,this.deselect,this);return;}_3fc=Number(_3fc);if(this.selectedIndex==_3fc){this.selectedIndex=-1;}if(this.selected[_3fc]){if(this.onCanDeselect(_3fc)===false){return;}var _3fd=this.grid.getRowNode(_3fc);if(_3fd){_3f0.set(_3fd,"aria-selected","false");}this._beginUpdate();delete this.selected[_3fc];this.onDeselected(_3fc);this._endUpdate();}},setSelected:function(_3fe,_3ff){this[(_3ff?"addToSelection":"deselect")](_3fe);},toggleSelect:function(_400){if(lang.isArray(_400)){_3ef.forEach(_400,this.toggleSelect,this);return;}this.setSelected(_400,!this.selected[_400]);},_range:function(_401,inTo,func){var s=(_401>=0?_401:inTo),e=inTo;if(s>e){e=s;s=inTo;}for(var i=s;i<=e;i++){func(i);}},selectRange:function(_402,inTo){this._range(_402,inTo,lang.hitch(this,"addToSelection"));},deselectRange:function(_403,inTo){this._range(_403,inTo,lang.hitch(this,"deselect"));},insert:function(_404){this.selected.splice(_404,0,false);if(this.selectedIndex>=_404){this.selectedIndex++;}},remove:function(_405){this.selected.splice(_405,1);if(this.selectedIndex>=_405){this.selectedIndex--;}},deselectAll:function(_406){for(var i in this.selected){if((i!=_406)&&(this.selected[i]===true)){this.deselect(i);}}},clickSelect:function(_407,_408,_409){if(this.mode=="none"){return;}this._beginUpdate();if(this.mode!="extended"){this.select(_407);}else{if(!_409||this.rangeStartIndex<0){this.rangeStartIndex=_407;}if(!_408){this.deselectAll(_407);}if(_409){this.selectRange(this.rangeStartIndex,_407);}else{if(_408){this.toggleSelect(_407);}else{this.addToSelection(_407);}}}this._endUpdate();},clickSelectEvent:function(e){this.clickSelect(e.rowIndex,dojo.isCopyKey(e),e.shiftKey);},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate();}});});},"dijit/form/MappedTextBox":function(){define("dijit/form/MappedTextBox",["dojo/_base/declare","dojo/dom-construct","./ValidationTextBox"],function(_40a,_40b,_40c){return _40a("dijit.form.MappedTextBox",_40c,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting="";},_setNameAttr:null,serialize:function(val){return val.toString?val.toString():"";},toString:function(){var val=this.filter(this.get("value"));return val!=null?(typeof val=="string"?val:this.serialize(val,this.constraints)):"";},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.valueNode=_40b.place("<input type='hidden'"+(this.name?" name=\""+this.name.replace(/"/g,"&quot;")+"\"":"")+"/>",this.textbox,"after");},reset:function(){this.valueNode.value="";this.inherited(arguments);}});});},"dijit/form/ComboBoxMixin":function(){require({cache:{"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"button presentation\" aria-hidden=\"true\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n"}});define("dijit/form/ComboBoxMixin",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/kernel","dojo/_base/lang","dojo/store/util/QueryResults","./_AutoCompleterMixin","./_ComboBoxMenu","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(_40d,_40e,_40f,lang,_410,_411,_412,_413,_414){return _40d("dijit.form.ComboBoxMixin",[_413,_411],{dropDownClass:_412,hasDownArrow:true,templateString:_414,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},_setHasDownArrowAttr:function(val){this._set("hasDownArrow",val);this._buttonNode.style.display=val?"":"none";},_showResultList:function(){this.displayMessage("");this.inherited(arguments);},_setStoreAttr:function(_415){if(!_415.get){lang.mixin(_415,{_oldAPI:true,get:function(id){var _416=new _40e();this.fetchItemByIdentity({identity:id,onItem:function(_417){_416.resolve(_417);},onError:function(_418){_416.reject(_418);}});return _416.promise;},query:function(_419,_41a){var _41b=new _40e(function(){_41c.abort&&_41c.abort();});_41b.total=new _40e();var _41c=this.fetch(lang.mixin({query:_419,onBegin:function(_41d){_41b.total.resolve(_41d);},onComplete:function(_41e){_41b.resolve(_41e);},onError:function(_41f){_41b.reject(_41f);}},_41a));return _410(_41b);}});}this._set("store",_415);},postMixInProperties:function(){var _420=this.params.store||this.store;if(_420){this._setStoreAttr(_420);}this.inherited(arguments);if(!this.params.store&&!this.store._oldAPI){var _421=this.declaredClass;lang.mixin(this.store,{getValue:function(item,attr){_40f.deprecated(_421+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return item[attr];},getLabel:function(item){_40f.deprecated(_421+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return item.name;},fetch:function(args){_40f.deprecated(_421+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");var shim=["dojo/data/ObjectStore"];require(shim,lang.hitch(this,function(_422){new _422({objectStore:this}).fetch(args);}));}});}}});});},"dojo/_base/query":function(){define(["../query","./NodeList"],function(_423){return _423;});},"url:esri/dijit/templates/Measurement.html":"<div class=\"esriMeasurement\">\r\n  <div dojoType='dijit.form.ToggleButton' baseClass='esriButton' dojoAttachPoint='area' checked='false' iconClass='areaIcon' showLabel='false' dojoAttachEvent='onClick:areaToggleButton'></div>\r\n  <div dojoType='dijit.form.ToggleButton' baseClass='esriButton' dojoAttachPoint='distance' iconClass='distanceIcon' showLabel='false' dojoAttachEvent='onClick:distanceToggleButton'></div>\r\n  <div dojoType='dijit.form.ToggleButton' baseClass='esriButton' dojoAttachPoint='location' iconClass='locationIcon' showLabel='false' dojoAttachEvent='onClick:locationToggleButton'></div>\r\n  <div style=\"display:inline;margin-left:2px;margin-right:2px;padding-top:2px;\">|</div>\r\n  <button dojoType='dijit.form.DropDownButton' baseClass='esriToggleButton' dojoAttachPoint='unit' label='unit' value='unit' style='visibility:hidden;'></button>\r\n  <div dojoType='dijit.layout.ContentPane' dojoAttachPoint='resultLabel' class='resultLabel'></div>\r\n  <div dojoType='dijit.layout.ContentPane' dojoAttachPoint='resultValue' align='left' class='result'></div>\r\n</div>","dijit/form/SimpleTextarea":function(){define("dijit/form/SimpleTextarea",["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(_424,_425,has,_426){return _424("dijit.form.SimpleTextarea",_426,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"<textarea ${!nameAttrSetting} data-dojo-attach-point='focusNode,containerNode,textbox' autocomplete='off'></textarea>",postMixInProperties:function(){if(!this.value&&this.srcNodeRef){this.value=this.srcNodeRef.value;}this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);if(has("ie")&&this.cols){_425.add(this.textbox,"dijitTextAreaCols");}},filter:function(_427){if(_427){_427=_427.replace(/\r/g,"");}return this.inherited(arguments);},_onInput:function(e){if(this.maxLength){var _428=parseInt(this.maxLength);var _429=this.textbox.value.replace(/\r/g,"");var _42a=_429.length-_428;if(_42a>0){var _42b=this.textbox;if(_42b.selectionStart){var pos=_42b.selectionStart;var cr=0;if(has("opera")){cr=(this.textbox.value.substring(0,pos).match(/\r/g)||[]).length;}this.textbox.value=_429.substring(0,pos-_42a-cr)+_429.substring(pos-cr);_42b.setSelectionRange(pos-_42a,pos-_42a);}else{if(this.ownerDocument.selection){_42b.focus();var _42c=this.ownerDocument.selection.createRange();_42c.moveStart("character",-_42a);_42c.text="";_42c.select();}}}}this.inherited(arguments);}});});},"url:esri/dijit/templates/OverviewMap.html":"<div class=\"esriOverviewMap\">\r\n  <div class=\"ovwContainer\" dojoattachpoint=\"_body\" style=\"width: ${width}px; height: ${height}px;\">\r\n    <div id=\"${id}-map\" style=\"width: 100%; height: 100%;\">\r\n      <div class=\"ovwHighlight\" dojoattachpoint=\"_focusDiv\" title=\"${NLS_drag}\" style=\"border: 1px solid ${color}; background-color: ${color};\"></div>\r\n    </div>\r\n  </div>\r\n  <div class=\"ovwButton ovwController\" title=\"${NLS_show}\" dojoattachpoint=\"_controllerDiv\" dojoattachevent=\"onclick: _visibilityHandler\">\r\n  </div>\r\n  <div class=\"ovwButton ovwMaximizer\" title=\"${NLS_maximize}\" dojoattachpoint=\"_maximizerDiv\" dojoattachevent=\"onclick: _maximizeHandler\">\r\n  </div>\r\n</div>\r\n","url:esri/dijit/editing/templates/TemplatePicker.html":"<div class=\"templatePicker\">\r\n\r\n  <table dojoType=\"dojox.grid.DataGrid\" noDataMessage=\"${emptyMessage}\" selectionMode=\"none\" autoHeight=\"${_rows}\" autoWidth=\"${_autoWidth}\"\r\n         query=\"{ query: '*' }\" dojoAttachPoint=\"grid\" class=\"grid\">\r\n  </table>\r\n  \r\n</div>","esri/toolbars/_Box":function(){define("esri/toolbars/_Box",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/matrix","esri/kernel","esri/lang","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/webMercatorUtils","esri/geometry/jsonUtils","esri/graphic"],function(_42d,lang,_42e,_42f,has,_430,_431,_432,_433,_434,_435,_436,_437,_438,_439){var BOX=_42d(null,{declaredClass:"esri.toolbars._Box",constructor:function(_43a,map,_43b,_43c,_43d,_43e){this._graphic=_43a;this._map=map;this._toolbar=_43b;this._scale=_43c;this._rotate=_43d;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=_43e;var _43f=_43b._options;this._markerSymbol=_43f.boxHandleSymbol;this._lineSymbol=_43f.boxLineSymbol;this._moveStartHandler=lang.hitch(this,this._moveStartHandler);this._firstMoveHandler=lang.hitch(this,this._firstMoveHandler);this._moveStopHandler=lang.hitch(this,this._moveStopHandler);this._moveHandler=lang.hitch(this,this._moveHandler);this._init();},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null;},refresh:function(){this._draw();},suspend:function(){_42e.forEach(this._getAllGraphics(),function(g){g.hide();});},resume:function(){_42e.forEach(this._getAllGraphics(),function(g){g.show();});this._draw();},_init:function(){this._draw();},_cleanUp:function(){if(this._connects){_42e.forEach(this._connects,_42f.disconnect);}var _440=this._toolbar._scratchGL;if(this._anchors){_42e.forEach(this._anchors,function(info){_440.remove(info.graphic);var mov=info.moveable;if(mov){mov.destroy();}});}if(this._box){_440.remove(this._box);}this._box=this._anchors=this._connects=null;},_draw:function(){if(!this._graphic.getDojoShape()){this._cleanUp();return;}var map=this._map,_441=this._toolbar._scratchGL;var _442=this._getBoxCoords();var _443=new _436(map.spatialReference);var path=lang.clone(_42e.filter(_442,function(pt,_444){return (_444!==8&&_444%2===0);}));if(path[0]){path.push([path[0][0],path[0][1]]);}_443.addPath(path);if(this._rotate){_443.addPath([_442[1],_442[8]]);}if(this._box){this._box.setGeometry(_443);}else{this._box=new _439(_443,this._lineSymbol);_441.add(this._box);}if(this._anchors){_42e.forEach(this._anchors,function(info,_445){if(!this._scale){_445=8;}var _446=new _435(_442[_445],map.spatialReference);info.graphic.setGeometry(_446);var mov=info.moveable,_447=info.graphic.getDojoShape();if(_447){if(!mov){info.moveable=this._getMoveable(info.graphic,_445);}else{if(_447!==mov.shape){mov.destroy();info.moveable=this._getMoveable(info.graphic,_445);}}}},this);}else{this._anchors=[];this._connects=[];_42e.forEach(_442,function(_448,_449){if(!this._scale&&_449<8){return;}_448=new _435(_448,map.spatialReference);var _44a=new _439(_448,this._markerSymbol);_441.add(_44a);this._anchors.push({graphic:_44a,moveable:this._getMoveable(_44a,_449)});},this);}},_getBoxCoords:function(_44b){var _44c=this._graphic,map=this._map,bbox=this._getTransformedBoundingBox(_44c),_44d=[],pt,next,_44e;_42e.forEach(bbox,function(_44f,_450,arr){pt=_44f;next=arr[_450+1];if(!next){next=arr[0];}_44e={x:(pt.x+next.x)/2,y:(pt.y+next.y)/2};if(!_44b){pt=map.toMap(pt);_44e=map.toMap(_44e);}_44d.push([pt.x,pt.y]);_44d.push([_44e.x,_44e.y]);});if(this._rotate){var _451=lang.clone(_44d[1]);_451=_44b?{x:_451[0],y:_451[1]}:map.toScreen({x:_451[0],y:_451[1],spatialReference:map.spatialReference});_451.y-=this._toolbar._options.rotateHandleOffset;if(!_44b){_451=map.toMap(_451);}_44d.push([_451.x,_451.y]);}return _44d;},_getTransformedBoundingBox:function(_452){var map=this._map,_453=_452.geometry.getExtent(),_454=_452.geometry.spatialReference,_455=new _435(_453.xmin,_453.ymax,_454),_456=new _435(_453.xmax,_453.ymin,_454);_455=map.toScreen(_455);_456=map.toScreen(_456);return [{x:_455.x,y:_455.y},{x:_456.x,y:_455.y},{x:_456.x,y:_456.y},{x:_455.x,y:_456.y}];},_getAllGraphics:function(){var _457=[this._box];if(this._anchors){_42e.forEach(this._anchors,function(_458){_457.push(_458.graphic);});}_457=_42e.filter(_457,_434.isDefined);return _457;},_getMoveable:function(_459,_45a){var _45b=_459.getDojoShape();if(!_45b){return;}var _45c=new _431(_45b);_45c._index=_45a;this._connects.push(_42f.connect(_45c,"onMoveStart",this._moveStartHandler));this._connects.push(_42f.connect(_45c,"onFirstMove",this._firstMoveHandler));this._connects.push(_42f.connect(_45c,"onMoveStop",this._moveStopHandler));_45c.onMove=this._moveHandler;var node=_45b.getEventSource();if(node){_430.set(node,"cursor",this._toolbar._cursors["box"+_45a]);}return _45c;},_moveStartHandler:function(_45d){this._toolbar["on"+(_45d.host._index===8?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic);},_firstMoveHandler:function(_45e){var _45f=_45e.host._index,_460=(this._wrapOffset=_45e.host.shape._wrapOffsets[0]||0),_461=this._graphic.getLayer()._div.getTransform(),mx=_432,_462,_463,_464,_465=_42e.map(this._getBoxCoords(true),function(arr){return {x:arr[0]+_460,y:arr[1]};});_464={x:_465[1].x,y:_465[3].y};this._centerCoord=mx.multiplyPoint(mx.invert(_461),_464);if(_45f===8){_462=mx.multiplyPoint(mx.invert(_461),_465[1]);this._startLine=[this._centerCoord,_462];this._moveLine=lang.clone(this._startLine);}else{_462=mx.multiplyPoint(mx.invert(_461),_465[_45f]);_463=mx.multiplyPoint(mx.invert(_461),_465[(_45f+4)%8]);this._firstMoverToCenter=Math.sqrt((_462.x-this._centerCoord.x)*(_462.x-this._centerCoord.x)+(_462.y-this._centerCoord.y)*(_462.y-this._centerCoord.y));this._startBox=_463;this._startBox.width=(_465[4].x-_465[0].x);this._startBox.height=(_465[4].y-_465[0].y);this._moveBox=lang.clone(this._startBox);this._xfactor=_462.x>_463.x?1:-1;this._yfactor=_462.y>_463.y?1:-1;if(_45f===1||_45f===5){this._xfactor=0;}else{if(_45f===3||_45f===7){this._yfactor=0;}}}this._toolbar._beginOperation("BOX");this._toolbar["on"+(_45f===8?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic);},_moveHandler:function(_466,_467){var _468=_466.host._index,args=this._defaultEventArgs,_469,move,tx,pt,_46a,_46b,_46c,_46d=0,_46e=0,_46f,_470,_471;args.angle=0;args.scaleX=1;args.scaleY=1;if(_468===8){_469=this._startLine;move=this._moveLine;pt=move[1];pt.x+=_467.dx;pt.y+=_467.dy;_46a=this._getAngle(_469,move);tx=_432.rotategAt(_46a,_469[0]);this._graphic.getDojoShape().setTransform(tx);args.transform=tx;args.angle=_46a;args.around=_469[0];}else{_469=this._startBox;move=this._moveBox;move.width+=(_467.dx*this._xfactor);move.height+=(_467.dy*this._yfactor);if(this._uniformScaling){_46f=move.x+this._xfactor*move.width;_470=move.y+this._yfactor*move.height;_471=Math.sqrt((_46f-this._centerCoord.x)*(_46f-this._centerCoord.x)+(_470-this._centerCoord.y)*(_470-this._centerCoord.y));_46b=_46c=_471/this._firstMoverToCenter;_46d=this._xfactor*_469.width/2;_46e=this._yfactor*_469.height/2;}else{_46b=move.width/_469.width;_46c=move.height/_469.height;}if(isNaN(_46b)||_46b===Infinity||_46b===-Infinity){_46b=1;}if(isNaN(_46c)||_46c===Infinity||_46c===-Infinity){_46c=1;}tx=_432.scaleAt(_46b,_46c,_469.x+_46d,_469.y+_46e);this._graphic.getDojoShape().setTransform(tx);args.transform=tx;args.scaleX=_46b;args.scaleY=_46c;args.around={x:_469.x+_46d,y:_469.y+_46e};}this._toolbar["on"+(_468===8?this._rotateEvent:this._scaleEvent)](this._graphic,args);},_moveStopHandler:function(_472){var _473=this._graphic,_474=this._toolbar,_475=_474._geo?_437.geographicToWebMercator(_473.geometry):_473.geometry,_476=_475.spatialReference,_477=_473.getDojoShape(),_478=_477.getTransform(),_479=_473.getLayer()._div.getTransform();_475=_475.toJson();this._updateSegments(_475.paths||_475.rings,_478,_479,_476);_477.setTransform(null);_475=_438.fromJson(_475);_473.setGeometry(_474._geo?_437.webMercatorToGeographic(_475,true):_475);this._draw();this._startBox=this._moveBox=this._xfactor=this._yfactor=null;this._startLine=this._moveLine=null;_474._endOperation("BOX");this._defaultEventArgs.transform=_478;_474["on"+(_472.host._index===8?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs);},_updateSegments:function(_47a,_47b,_47c,_47d){var mx=_432,map=this._map,_47e=this._wrapOffset||0;_42e.forEach(_47a,function(_47f){_42e.forEach(_47f,function(_480){var _481=map.toScreen({x:_480[0],y:_480[1],spatialReference:_47d},true);_481.x+=_47e;_481=mx.multiplyPoint([_47c,_47b,mx.invert(_47c)],_481);_481.x-=_47e;var _482=map.toMap(_481);_480[0]=_482.x;_480[1]=_482.y;});});},_getAngle:function(_483,_484){var _485=Math.atan2(_483[0].y-_483[1].y,_483[0].x-_483[1].x)*180/Math.PI,_486=Math.atan2(_484[0].y-_484[1].y,_484[0].x-_484[1].x)*180/Math.PI;return _486-_485;}});if(has("extend-esri")){lang.setObject("toolbars._Box",BOX,_433);}return BOX;});},"dijit/_editor/plugins/TextColor":function(){define("dijit/_editor/plugins/TextColor",["require","dojo/colors","dojo/_base/declare","dojo/_base/lang","../_Plugin","../../form/DropDownButton"],function(_487,_488,_489,lang,_48a,_48b){var _48c=_489("dijit._editor.plugins.TextColor",_48a,{buttonClass:_48b,useDefaultCommand:false,_initButton:function(){this.inherited(arguments);var self=this;this.button.loadDropDown=function(_48d){_487(["../../ColorPalette"],lang.hitch(this,function(_48e){this.dropDown=new _48e({dir:self.editor.dir,ownerDocument:self.editor.ownerDocument,value:self.value,onChange:function(_48f){self.editor.execCommand(self.command,_48f);}});_48d();}));};},updateState:function(){var _490=this.editor;var _491=this.command;if(!_490||!_490.isLoaded||!_491.length){return;}if(this.button){var _492=this.get("disabled");this.button.set("disabled",_492);if(_492){return;}var _493;try{_493=_490.queryCommandValue(_491)||"";}catch(e){_493="";}}if(_493==""){_493="#000000";}if(_493=="transparent"){_493="#ffffff";}if(typeof _493=="string"){if(_493.indexOf("rgb")>-1){_493=_488.fromRgb(_493).toHex();}}else{_493=((_493&255)<<16)|(_493&65280)|((_493&16711680)>>>16);_493=_493.toString(16);_493="#000000".slice(0,7-_493.length)+_493;}this.value=_493;var _494=this.button.dropDown;if(_494&&_493!==_494.get("value")){_494.set("value",_493,false);}}});_48a.registry["foreColor"]=function(){return new _48c({command:"foreColor"});};_48a.registry["hiliteColor"]=function(){return new _48c({command:"hiliteColor"});};return _48c;});},"esri/dijit/editing/tools/ButtonToolBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","dijit/form/Button","esri/dijit/editing/tools/ToolBase","esri/kernel"],function(_495,lang,has,_496,_497,_498){var BTB=_495([_496,_497],{declaredClass:"esri.dijit.editing.tools.ButtonToolBase",postCreate:function(){this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){_496.prototype.destroy.apply(this,arguments);_497.prototype.destroy.apply(this,arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.ButtonToolBase",BTB,_498);}return BTB;});},"esri/dijit/editing/tools/Editing":function(){define("esri/dijit/editing/tools/Editing",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/layers/FeatureTemplate","esri/dijit/editing/tools/Edit","esri/dijit/editing/tools/EditingTools","esri/dijit/editing/tools/DropDownToolBase","esri/kernel","esri/lang"],function(_499,lang,_49a,has,_49b,Edit,_49c,_49d,_49e,_49f){var _4a0=_499([_49d],{declaredClass:"esri.dijit.editing.tools.Editing",_enabled:false,deactivate:function(){if(!this._enabled){return;}this._enabled=false;this.inherited(arguments);this._settings.templatePicker.clearSelection();},onItemClicked:function(_4a1,evt){this.inherited(arguments);if(this._activeTool===this._tools.AUTOCOMPLETE){this._settings.editor._drawingTool=_49b.TOOL_AUTO_COMPLETE_POLYGON;}},_activateTool:function(_4a2,_4a3){var i;this.enable(_4a3);for(i in this._tools){if(this._tools.hasOwnProperty(i)){this.dropDown.removeChild(this._tools[i]);if(this._tools[i]._enabled===true){this.dropDown.addChild(this._tools[i]);}}}if(this._geometryType!==_4a3||this._activeTool._enabled===false){this._activeTool=this._tools[_4a2.toUpperCase()];}this._geometryType=_4a3;this._activeTool.activate();this._activeTool.setChecked(true);this._updateUI();},_initializeTool:function(_4a4){this.inherited(arguments);this._initializeTools();},_initializeTools:function(){var _4a5=this._settings.layers;var _4a6=this._settings.editor;var _4a7=false,line=false,poly=false;var _4a8=this._toolTypes=[];var _4a9;_49a.forEach(_4a5,function(_4aa){_4a9=_4aa.geometryType;_4a7=_4a7||_4a9==="esriGeometryPoint";line=line||_4a9==="esriGeometryPolyline";poly=poly||_4a9==="esriGeometryPolygon";_4a8=_4a8.concat(_49a.map(this._getTemplatesFromLayer(_4aa),lang.hitch(this,function(_4ab){return _4a6._toDrawTool(_4ab.drawingTool,_4aa);})));},this);var _4ac=this._settings.createOptions;if(_4a7){this._toolTypes.push("point");}if(line){this._toolTypes=this._toolTypes.concat(_4ac.polylineDrawTools);}if(poly){this._toolTypes=this._toolTypes.concat(_4ac.polygonDrawTools);}this._toolTypes=this._toUnique(this._toolTypes.concat(_4a8));},_toUnique:function(arr){var test={};return _49a.filter(arr,function(val){return test[val]?false:(test[val]=true);});},_getTemplatesFromLayer:function(_4ad){var _4ae=_4ad.templates||[];var _4af=_4ad.types;_49a.forEach(_4af,function(type){_4ae=_4ae.concat(type.templates);});return _49a.filter(_4ae,_49f.isDefined);},_createTools:function(){_49a.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments);},_createTool:function(_4b0){var _4b1=lang.mixin(_49c[_4b0],{settings:this._settings,onClick:lang.hitch(this,"onItemClicked",_49c[_4b0].id)});this._tools[_4b0.toUpperCase()]=new Edit(_4b1);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Editing",_4a0,_49e);}return _4a0;});},"esri/dijit/PopupMobile":function(){define("esri/dijit/PopupMobile",["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/window","dojo/_base/kernel","dojo/has","dojo/query","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","esri/InfoWindowBase","esri/PopupBase","esri/dijit/InfoView","esri/dijit/NavigationBar","esri/kernel","esri/domUtils","dojo/i18n!esri/nls/jsapi","dojo/NodeList-dom"],function(_4b2,_4b3,lang,_4b4,_4b5,win,_4b6,has,_4b7,dom,_4b8,_4b9,_4ba,_4bb,_4bc,_4bd,_4be,_4bf,_4c0,_4c1,_4c2,_4c3){var PUM=_4b3([_4bd,_4be],{declaredClass:"esri.dijit.PopupMobile",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:10,marginTop:10,highlight:true,popupNavigationBar:null,popupInfoView:null,location:null,xIcon:_4b2.toUrl("esri/dijit/images/whitex.png"),dArrowIcon:_4b2.toUrl("esri/dijit/images/whitedown.png"),lArrowIcon:_4b2.toUrl("esri/dijit/images/whitel.png"),rArrowIcon:_4b2.toUrl("esri/dijit/images/whiter.png"),constructor:function(_4c4,_4c5){this.initialize();lang.mixin(this,_4c4);this.domNode=dom.byId(_4c5);var nls=this._nls=lang.mixin({},_4c3.widgets.popup);var _4c6=this.domNode;_4b9.add(_4c6,"esriPopupMobile");var _4c7="<div class='sizer'>"+"<div class='titlePane'>"+"<div class='spinner hidden'>"+"</div>"+"<div class='title'></div>"+"<div style='text-align:center'>"+"<div class='titleButton prev hidden'></div>"+"<div class='footer' style='display:inline-block;width:60px;height:15px;'></div>"+"<div class='titleButton next hidden'></div>"+"</div>"+"<div class='titleButton close'></div>"+"<div class='titleButton arrow hidden'></div>"+"</div>"+"</div>"+"<div class='pointer top hidden'></div>"+"<div class='pointer bottom hidden'></div>";_4b8.set(_4c6,"innerHTML",_4c7);var _4c8=_4b6.query(".titlePane",_4c6)[0];this._arrowButton=_4b6.query(".arrow",_4c8)[0];this._pointerTop=_4b6.query(".top",_4c6)[0];this._pointerBottom=_4b6.query(".bottom",_4c6)[0];this._title=_4b6.query(".title",_4c8)[0];this._footer=_4b6.query(".footer",_4c8)[0];this._prev=_4b6.query(".prev",_4c8)[0];this._next=_4b6.query(".next",_4c8)[0];this._spinner=_4b6.query(".spinner",_4c8)[0];this._eventConnections=[_4b4.connect(_4b6.query(".close",_4c8)[0],"onclick",this,this.hide),_4b4.connect(this._arrowButton,"onclick",this,this._toggleView),_4b4.connect(this._prev,"onclick",this,function(){this.selectPrevious();this._updateUI();}),_4b4.connect(this._next,"onclick",this,function(){this.selectNext();this._updateUI();})];this._initPopupNavigationBar();this._initPopupInfoView();_4c2.hide(_4c6);this.isShowing=false;},setMap:function(map){this.inherited(arguments);_4ba.place(this.domNode,map.root);if(this.highlight){this.enableHighlight(map);}},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments);},setTitle:function(_4c9,_4ca){this.destroyDijits(this._title);this.place(_4c9,this._title);this.destroyDijits(this._footer);this.place(_4ca,this._footer);if(this.isShowing){this.startupDijits(this._title);this.startupDijits(this._footer);}},setContent:function(_4cb){this.destroyDijits(this._contentPane);this.place(_4cb,this._contentPane);this.startupDijits(this._contentPane);},show:function(_4cc){if(!_4cc){_4c2.show(this.domNode);this.isShowing=true;return;}var map=this.map,_4cd;if(_4cc.spatialReference){this._location=_4cc;_4cd=map.toScreen(_4cc);}else{this._location=map.toMap(_4cc);_4cd=_4cc;}if(this._maximized){this.restore();}else{this._setPosition(_4cd);}if(!this.isShowing){_4c2.show(this.domNode);this.isShowing=true;this.onShow();}},hide:function(){if(this.isShowing){_4c2.hide(this.domNode);this.isShowing=false;this.onHide();}},onShow:function(){this._followMap();this.startupDijits(this._title);this.showHighlight();},onHide:function(){this._unfollowMap();this.hideHighlight();},destroy:function(){if(this.map){this.unsetMap();}this.cleanup();if(this.isShowing){this.hide();}this.destroyDijits(this._title);this.destroyDijits(this._footer);_4b5.forEach(this._eventConnections,_4b4.disconnect);_4ba.destroy(this.domNode);},selectNext:function(){this.select(this.selectedIndex+1);},selectPrevious:function(){this.select(this.selectedIndex-1);},setFeatures:function(){this.inherited(arguments);this._updateUI();},onSetFeatures:function(){},onClearFeatures:function(){this.setTitle("&nbsp;","&nbsp;");_4b9.add(this._arrowButton,"hidden");this._updateUI();this.hideHighlight();},onSelectionChange:function(){var ptr=this.selectedIndex;this._updateUI();if(ptr>=0){this.setContent(this.features[ptr].getContent());this.updateHighlight(this.map,this.features[ptr]);if(this.isShowing){this.showHighlight();}}},onDfdComplete:function(){this._updateUI();},_followMap:function(){this._unfollowMap();var map=this.map;this._handles=[_4b4.connect(map,"onPanStart",this,this._onPanStart),_4b4.connect(map,"onPan",this,this._onPan),_4b4.connect(map,"onZoomStart",this,this._onZoomStart),_4b4.connect(map,"onExtentChange",this,this._onExtentChange)];},_unfollowMap:function(){var _4ce=this._handles;if(_4ce){_4b5.forEach(_4ce,_4b4.disconnect);this._handles=null;}},_onPanStart:function(){var _4cf=this.domNode.style;this._panOrigin={left:_4cf.left,top:_4cf.top,right:_4cf.right,bottom:_4cf.bottom};},_onPan:function(_4d0,_4d1){var _4d2=this._panOrigin,dx=_4d1.x,dy=_4d1.y,left=_4d2.left,top=_4d2.top,_4d3=_4d2.right,_4d4=_4d2.bottom;if(left){left=(parseFloat(left)+dx)+"px";}if(top){top=(parseFloat(top)+dy)+"px";}if(_4d3){_4d3=(parseFloat(_4d3)-dx)+"px";}if(_4d4){_4d4=(parseFloat(_4d4)-dy)+"px";}_4bc.set(this.domNode,{left:left,top:top,right:_4d3,bottom:_4d4});},_onZoomStart:function(){_4c2.hide(this.domNode);},_onExtentChange:function(_4d5,_4d6,_4d7){if(_4d7){_4c2.show(this.domNode);this.show(this._targetLocation||this._location);this._targetLocation=null;}},_setPosition:function(_4d8){var posX=_4d8.x,posY=_4d8.y,_4d9=_4bb.getContentBox(this.map.container),_4da=_4d9.w,_4db=_4d9.h;var _4dc=0,_4dd=posY+10,_4de=118,_4df=18,_4e0=_4da-_4df;if(posX>_4df&&posX<_4e0){_4dc=posX-130;if(_4dc<0){_4dc=0;}else{if(_4dc>_4da-260){_4dc=_4da-260;}}}else{if(posX<=_4df){_4dc=posX-_4df;}else{if(posX>=_4e0){_4dc=(_4da-260)+(posX-_4e0);}}}if(posX>118&&posX<_4da-130){_4de=118;}else{if(posX<=118){if(posX>_4df){_4de=posX-12;}else{if(posX<=_4df){_4de=6;}}}else{if(posX>=_4da-130){if(posX<_4e0){_4de=118+posX-(_4da-130);}else{if(posX>=_4e0){_4de=118+_4e0-(_4da-130);}}}}}if(posY<=_4db/2){_4bc.set(this.domNode,{left:_4dc+"px",top:_4dd+"px",bottom:null});_4bc.set(this._pointerTop,{left:_4de+"px"});_4b9.add(this._pointerBottom,"hidden");_4b9.remove(this._pointerTop,"hidden");}else{_4bc.set(this.domNode,{left:_4dc+"px",top:_4dd-64+"px",bottom:null});_4bc.set(this._pointerBottom,{left:_4de+"px"});_4b9.add(this._pointerTop,"hidden");_4b9.remove(this._pointerBottom,"hidden");}},_showPointer:function(_4e1){var _4e2=["topLeft","topRight","bottomRight","bottomLeft"];_4b5.forEach(_4e2,function(ptr){if(ptr===_4e1){_4b6.query(".pointer."+ptr,this.domNode).removeClass("hidden");}else{_4b6.query(".pointer."+ptr,this.domNode).addClass("hidden");}},this);},_toggleView:function(){if(!this.popupNavigationBar){this._initPopupNavigationBar();}if(!this.popupInfoView){this._initPopupInfoView();}this.hide();_4c2.show(this.popupNavigationBar.container);_4c2.show(this.popupInfoView.container);var _4e3="";if(this.selectedIndex>=0){_4e3=(this.selectedIndex+1)+" of "+this.features.length;this.setContent(this.features[this.selectedIndex].getContent());}},_handleNavigationBar:function(item){this.popupInfoView.animateTo(0);switch(item.name){case "CloseButton":_4c2.hide(this.popupNavigationBar.container);_4c2.hide(this.popupInfoView.container);this.hide();break;case "ToggleButton":_4c2.hide(this.popupNavigationBar.container);_4c2.hide(this.popupInfoView.container);this.show(this._location);break;case "PreviousButton":this.selectPrevious();this._updateUI();break;case "NextButton":this.selectNext();this._updateUI();break;}},_initPopupNavigationBar:function(){var _4e4={};_4e4.items=[{name:"CloseButton",type:"img",src:this.xIcon,srcAlt:this.xIcon,position:"left"},{name:"Title",type:"span",text:"",position:"center"},{name:"ToggleButton",type:"img",src:this.dArrowIcon,srcAlt:this.dArrowIcon,position:"right",toggleGroup:"toggle"},{name:"PreviousButton",type:"img",src:this.lArrowIcon,srcAlt:this.lArrowIcon,position:"right2",toggleGroup:"previous"},{name:"NextButton",type:"img",src:this.rArrowIcon,srcAlt:this.rArrowIcon,position:"right1",toggleGroup:"next"}];this.popupNavigationBar=new _4c0(_4e4,_4ba.create("div",{},win.body()));_4b4.connect(this.popupNavigationBar,"onCreate",this,function(_4e5){this._prevFeatureButton=_4e5[3]._node;this._nextFeatureButton=_4e5[4]._node;});_4b4.connect(this.popupNavigationBar,"onSelect",this,this._handleNavigationBar);_4b4.connect(this.popupNavigationBar,"onUnSelect",this,this._handleNavigationBar);this.popupNavigationBar.startup();_4c2.hide(this.popupNavigationBar.container);},_initPopupInfoView:function(){var _4e6={items:[{name:"Navigator",type:"div",text:""},{name:"content",type:"div",text:""},{name:"attachment",type:"div",text:""}]};this.popupInfoView=new _4bf(_4e6,_4ba.create("div",{},win.body()));_4b9.add(this.popupInfoView.container,"esriMobilePopupInfoView");this.popupInfoView.enableTouchScroll();_4b4.connect(this.popupInfoView,"onCreate",this,function(_4e7){this._contentPane=_4e7[1]._node;if(this.selectedIndex>=0){this.setContent(this.features[this.selectedIndex].getContent());}});_4b4.connect(this.popupInfoView,"onSwipeLeft",this,function(){});_4b4.connect(this.popupInfoView,"onSwipeRight",this,function(){});this.popupInfoView.startup();},_updateUI:function(){var _4e8="&nbsp;",_4e9="&nbsp;",ptr=this.selectedIndex,_4ea=this.features,_4eb=this.deferreds,prev=this._prevFeatureButton.parentNode,next=this._nextFeatureButton.parentNode,_4ec=this._spinner,_4ed=this._actionList,nls=this._nls;if(_4ea&&_4ea.length>=1){_4e8=_4ea[ptr].getTitle();_4e9=(ptr+1)+" of "+_4ea.length;_4b9.remove(this._arrowButton,"hidden");if(ptr===0){_4b9.add(prev,"hidden");_4b9.add(this._prev,"hidden");}else{_4b9.remove(prev,"hidden");_4b9.remove(this._prev,"hidden");}if(ptr===_4ea.length-1){_4b9.add(next,"hidden");_4b9.add(this._next,"hidden");}else{_4b9.remove(next,"hidden");_4b9.remove(this._next,"hidden");}}else{_4b9.add(this._arrowButton,"hidden");_4b9.add(prev,"hidden");_4b9.add(next,"hidden");_4b9.add(this._prev,"hidden");_4b9.add(this._next,"hidden");}this.setTitle(_4e8,_4e9);this.popupNavigationBar.getItems()[1]._node.innerHTML=_4e9;if(_4eb&&_4eb.length){_4b9.remove(_4ec,"hidden");this.setTitle(nls.NLS_searching+"...","&nbsp;");}else{_4b9.add(_4ec,"hidden");if(!_4ea||!_4ea.length){this.setTitle("No Information","&nbsp;");}}}});if(has("extend-esri")){lang.setObject("dijit.PopupMobile",PUM,_4c1);}return PUM;});},"dojox/widget/gauge/AnalogArcIndicator":function(){define("dojox/widget/gauge/AnalogArcIndicator",["dijit","dojo","dojox","dojo/require!dojox/gauges/AnalogArcIndicator"],function(_4ee,dojo,_4ef){dojo.provide("dojox.widget.gauge.AnalogArcIndicator");dojo.require("dojox.gauges.AnalogArcIndicator");_4ef.widget.gauge.AnalogArcIndicator=_4ef.gauges.AnalogArcIndicator;});},"url:dijit/form/templates/HorizontalSlider.html":"<table class=\"dijit dijitReset dijitSlider dijitSliderH\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" data-dojo-attach-event=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\"\n\trole=\"presentation\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td data-dojo-attach-point=\"topDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderDecrementIconH\" style=\"display:none\" data-dojo-attach-point=\"decrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper\" data-dojo-attach-event=\"press:_onClkDecBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><input data-dojo-attach-point=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\n\t\t\t/><div class=\"dijitReset dijitSliderBarContainerH\" role=\"presentation\" data-dojo-attach-point=\"sliderBarContainer\"\n\t\t\t\t><div role=\"presentation\" data-dojo-attach-point=\"progressBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH\" data-dojo-attach-event=\"press:_onBarClick\"\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableH\"\n\t\t\t\t\t\t><div data-dojo-attach-point=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleH\" data-dojo-attach-event=\"press:_onHandleClick\" role=\"slider\"></div\n\t\t\t\t\t></div\n\t\t\t\t></div\n\t\t\t\t><div role=\"presentation\" data-dojo-attach-point=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH\" data-dojo-attach-event=\"press:_onBarClick\"></div\n\t\t\t></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper\" data-dojo-attach-event=\"press:_onClkIncBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderIncrementIconH\" style=\"display:none\" data-dojo-attach-point=\"incrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td data-dojo-attach-point=\"containerNode,bottomDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n></table>\n","esri/dijit/AttributeInspector":function(){require({cache:{"url:esri/dijit/templates/AttributeInspector.html":"<div class=\"esriAttributeInspector\">\r\n    <div class=\"atiLayerName\" dojoAttachPoint=\"layerName\"></div>\r\n    <div class=\"atiAttributes\" dojoAttachPoint=\"attributeTable\"></div>\r\n    <div dojoAttachPoint=\"attachmentEditor\"></div>\r\n    <div class=\"atiEditorTrackingInfo\" dojoAttachPoint=\"editorTrackingInfoDiv\"></div>\r\n    <div class=\"atiButtons\" dojoAttachPoint=\"editButtons\">\r\n        <button  dojoType=\"dijit.form.Button\" class=\"atiButton atiDeleteButton\"  dojoAttachPoint=\"deleteBtn\" dojoAttachEvent=\"onClick: onDeleteBtn\" showLabel=\"true\" type=\"button\">${NLS_deleteFeature}</button>\r\n        <div class=\"atiNavButtons\" dojoAttachPoint=\"navButtons\">\r\n            <div class=\"atiNavMessage\" dojoAttachPoint=\"navMessage\"></div>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiFirstIcon\" dojoAttachPoint=\"firstFeatureButton\" dojoAttachEvent=\"onClick: onFirstFeature\" showLabel=\"false\" type=\"button\">${NLS_first}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiPrevIcon\" dojoAttachPoint=\"prevFeatureButton\" dojoAttachEvent=\"onClick: onPreviousFeature\" showLabel=\"false\" type=\"button\">${NLS_previous}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiNextIcon\" dojoAttachPoint=\"nextFeatureButton\" dojoAttachEvent=\"onClick: onNextFeature\" showLabel=\"false\" type=\"button\">${NLS_next}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiLastIcon\" dojoAttachPoint=\"lastFeatureButton\" dojoAttachEvent=\"onClick: onLastFeature\" showLabel=\"false\" type=\"button\">${NLS_last}</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n"}});define("esri/dijit/AttributeInspector",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/sniff","dojo/_base/kernel","dojo/has","dojo/dom-style","dojo/dom-construct","esri/kernel","esri/lang","esri/domUtils","esri/layers/InheritedDomain","esri/layers/FeatureLayer","dojo/i18n!esri/nls/jsapi","dojo/fx","dojox/gfx","dijit/_Widget","dijit/_Templated","dijit/Editor","dijit/_editor/plugins/LinkDialog","dijit/_editor/plugins/TextColor","esri/dijit/_EventedWidget","esri/dijit/editing/AttachmentEditor","esri/dijit/editing/Util","esri/tasks/query","dijit/form/DateTextBox","dijit/form/TextBox","dijit/form/NumberTextBox","dijit/form/FilteringSelect","dijit/form/NumberSpinner","dijit/form/Button","dijit/form/SimpleTextarea","dijit/Tooltip","dojo/data/ItemFileReadStore","dojox/date/islamic","dojox/date/islamic/Date","dojox/date/islamic/locale","dojo/text!esri/dijit/templates/AttributeInspector.html"],function(_4f0,lang,_4f1,_4f2,_4f3,_4f4,has,_4f5,_4f6,_4f7,_4f8,_4f9,_4fa,_4fb,_4fc,fx,gfx,_4fd,_4fe,_4ff,_500,_501,_502,_503,Util,_504,_505,_506,_507,_508,_509,_50a,_50b,_50c,_50d,_50e,_50f,_510,_511){var ATI=_4f0([_502,_4fd,_4fe],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:true,templateString:_511,_navMessage:"( ${idx} ${of} ${numFeatures} )",onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},_eventMap:{"update":true,"delete":["feature"],"attribute-change":["feature","fieldName","fieldValue"],"next":["feature"],"reset":true,"cancel":true},constructor:function(_512,_513){lang.mixin(this,_4fc.widgets.attributeInspector);_512=_512||{};if(!_512.featureLayer&&!_512.layerInfos){console.error("esri.AttributeInspector: please provide correct parameter in the constructor");}this._datePackage=this._getDatePackage(_512);this._layerInfos=_512.layerInfos||[{featureLayer:_512.featureLayer,options:_512.options||[]}];this._aiConnects=[];this._selection=[];this._toolTips=[];this._numFeatures=0;this._featureIdx=0;this._currentLInfo=null;this._currentFeature=null;this._hideNavButtons=_512.hideNavButtons||false;},postCreate:function(){if(_4f1.every(this._layerInfos,function(_514){return _514.featureLayer.loaded;})){this._initLayerInfos();this._createAttachmentEditor();this.onFirstFeature();}else{var _515=this._layerInfos.length;_4f1.forEach(this._layerInfos,function(_516){var _517=_516.featureLayer;if(_517.loaded){_515--;}else{var _518=_4f2.connect(_517,"onLoad",this,function(_519){_4f2.disconnect(_518);_518=null;_515--;if(!_515){this._initLayerInfos();this._createAttachmentEditor();this.onFirstFeature();}});}},this);}},destroy:function(){this._destroyAttributeTable();_4f1.forEach(this._aiConnects,_4f2.disconnect);delete this._aiConnects;if(this._attachmentEditor){this._attachmentEditor.destroy();delete this._attachmentEditor;}delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments);},refresh:function(){this._updateSelection();},first:function(){this.onFirstFeature();},last:function(){this.onLastFeature();},next:function(){this.onNextFeature();},previous:function(){this.onPreviousFeature();},showFeature:function(_51a,_51b){if(_51b){this._createOnlyFirstTime=true;}this._updateSelection([_51a],_51b);this._updateUI();},onLayerSelectionChange:function(_51c,_51d,_51e){this._createOnlyFirstTime=false;this._featureIdx=(_51e===_4fb.SELECTION_NEW)?0:this._featureIdx;this._updateSelection();this._updateUI();},onLayerSelectionClear:function(){if(!this._selection||this._selection.length<=0){return;}this._numFeatures=0;this._featureIdx=0;this._selection=[];this._currentFeature=null;this._currentLInfo=null;this._updateUI();},onLayerEditsComplete:function(_51f,adds,_520,_521){_521=_521||[];if(_521.length){var _522=this._selection;var _523=_51f.featureLayer.objectIdField;_4f1.forEach(_521,lang.hitch(this,function(del){_4f1.some(_522,lang.hitch(this,function(item,idx){if(item.attributes[_523]!==del.objectId){return false;}this._selection.splice(idx,1);return true;}));}));}adds=adds||[];if(adds.length){this._selection=Util.findFeatures(adds,_51f.featureLayer);this._featureIdx=0;}var _524=this._numFeatures=this._selection?this._selection.length:0;if(adds.length){var _525=_524?this._selection[this._featureIdx]:null;if(_525){var _526=_525.getLayer();var _527=_526.getEditCapabilities();if(!(_527.canCreate&&!_527.canUpdate)){this._showFeature(_525);}}}this._updateUI();},onFieldValueChange:function(_528,_529){_529=(typeof _529==="undefined")?null:_529;var _52a=_528.field;if(_52a.type==="esriFieldTypeDate"){_529=(_529&&_529.getTime)?_529.getTime():(_529&&_529.toGregorian?_529.toGregorian().getTime():_529);}if(this._currentFeature.attributes[_52a.name]===_529){return;}var _52b=this._currentLInfo;var _52c=this._currentFeature;var _52d=_52a.name;if(_52d===_52b.typeIdField){var type=this._findFirst(_52b.types,"id",_529);var _52e=_52b.fieldInfos;_4f1.forEach(_52e,function(_52f){_52a=_52f.field;if(!_52a||_52a.name===_52b.typeIdField){return;}var node=_52f.dijit;var _530=this._setFieldDomain(node,type,_52a);if(_530&&node){this._setValue(node,_52c.attributes[_52a.name]+"");if(node.isValid()===false){this._setValue(node,null);}}},this);}this.onAttributeChange(_52c,_52d,_529);},onDeleteBtn:function(evt){this._deleteFeature();},onNextFeature:function(evt){this._onNextFeature(1);},onPreviousFeature:function(evt){this._onNextFeature(-1);},onFirstFeature:function(evt){this._onNextFeature(this._featureIdx*-1);},onLastFeature:function(evt){this._onNextFeature((this._numFeatures-1)-this._featureIdx);},_initLayerInfos:function(){var _531=this._layerInfos;this._editorTrackingInfos={};_4f1.forEach(_531,this._initLayerInfo,this);},_initLayerInfo:function(_532){var _533=_532.featureLayer,_534,_535;this._userIds={};var _536=_533.id;if(_533.credential){this._userIds[_536]=_533.credential.userId;}if(_532.userId){this._userIds[_536]=_532.userId;}this._connect(_533,"onSelectionComplete",lang.hitch(this,"onLayerSelectionChange",_532));this._connect(_533,"onSelectionClear",lang.hitch(this,"onLayerSelectionClear",_532));this._connect(_533,"onEditsComplete",lang.hitch(this,"onLayerEditsComplete",_532));_532.showAttachments=_533.hasAttachments?(_4f8.isDefined(_532.showAttachments)?_532.showAttachments:true):false;_532.hideFields=_532.hideFields||[];_532.htmlFields=_532.htmlFields||[];_532.isEditable=_533.isEditable()?(_4f8.isDefined(_532.isEditable)?_532.isEditable:true):false;_532.typeIdField=_533.typeIdField;_532.layerId=_533.id;_532.types=_533.types;if(_533.globalIdField){_534=this._findFirst(_532.fieldInfos,"fieldName",_533.globalIdField);if(!_534&&!_532.showGlobalID){_532.hideFields.push(_533.globalIdField);}}_535=this._findFirst(_532.fieldInfos,"fieldName",_533.objectIdField);if(!_535&&!_532.showObjectID){_532.hideFields.push(_533.objectIdField);}var _537=this._getFields(_532.featureLayer);if(!_537){return;}var _538=_532.fieldInfos||[];_538=_4f1.map(_538,function(_539){return lang.mixin({},_539);});if(!_538.length){_537=_4f1.filter(_537,lang.hitch(this,function(_53a){return !this._isInFields(_53a.name,_532.hideFields);}));_532.fieldInfos=_4f1.map(_537,lang.hitch(this,function(_53b){var _53c=(this._isInFields(_53b.name,_532.htmlFields)?ATI.STRING_FIELD_OPTION_RICHTEXT:ATI.STRING_FIELD_OPTION_TEXTBOX);return {"fieldName":_53b.name,"field":_53b,"stringFieldOption":_53c};}));}else{_532.fieldInfos=_4f1.filter(_4f1.map(_538,lang.hitch(this,function(_53d){var _53e=_53d.stringFieldOption||(this._isInFields(_53d.fieldName,_532.htmlFields)?ATI.STRING_FIELD_OPTION_RICHTEXT:ATI.STRING_FIELD_OPTION_TEXTBOX);return lang.mixin(_53d,{"field":this._findFirst(_537,"name",_53d.fieldName),"stringFieldOption":_53e});})),"return item.field;");}if(_532.showGlobalID&&!_534){_538.push(this._findFirst(_537,"name",_533.globalIdField));}if(_532.showObjectID&&!_535){_538.push(this._findFirst(_537,"name",_533.objectIdField));}var _53f=[];if(_533.editFieldsInfo){if(_533.editFieldsInfo.creatorField){_53f.push(_533.editFieldsInfo.creatorField);}if(_533.editFieldsInfo.creationDateField){_53f.push(_533.editFieldsInfo.creationDateField);}if(_533.editFieldsInfo.editorField){_53f.push(_533.editFieldsInfo.editorField);}if(_533.editFieldsInfo.editDateField){_53f.push(_533.editFieldsInfo.editDateField);}}this._editorTrackingInfos[_533.id]=_53f;},_createAttachmentEditor:function(){this._attachmentEditor=null;var _540=this._layerInfos;var _541=_4f1.filter(_540,function(item){return item.showAttachments;});if(!_541||!_541.length){return;}this._attachmentEditor=new _503({"class":"atiAttachmentEditor"},this.attachmentEditor);this._attachmentEditor.startup();},_setCurrentLInfo:function(_542){var _543=this._currentLInfo?this._currentLInfo.featureLayer:null;var _544=_542.featureLayer;if(_543&&_543.id===_544.id&&!_543.ownershipBasedAccessControlForFeatures){var _545=_544.getEditCapabilities();if(!(_545.canCreate&&!_545.canUpdate)){return;}}this._currentLInfo=_542;this._createTable();},_updateSelection:function(_546,_547){this._selection=_546||[];var _548=this._layerInfos;_4f1.forEach(_548,this._getSelection,this);var _549=this._numFeatures=this._selection.length;var _54a=_549?this._selection[this._featureIdx]:null;this._showFeature(_54a,_547);},_getSelection:function(_54b){var _54c=_54b.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(_54c);},_updateUI:function(){var _54d=this._numFeatures;var _54e=this._currentLInfo;this.layerName.innerHTML=(!_54e||_54d===0)?this.NLS_noFeaturesSelected:(_54e.featureLayer?_54e.featureLayer.name:"");_4f5.set(this.attributeTable,"display",_54d?"":"none");_4f5.set(this.editButtons,"display",_54d?"":"none");_4f5.set(this.navButtons,"display",(!this._hideNavButtons&&(_54d>1)?"":"none"));this.navMessage.innerHTML=_4f8.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);if(this._attachmentEditor){_4f5.set(this._attachmentEditor.domNode,"display",((_54e&&_54e.showAttachments)&&_54d)?"":"none");}var _54f=((_54e&&_54e.showDeleteButton===false)||!this._canDelete)?false:true;_4f5.set(this.deleteBtn.domNode,"display",_54f?"":"none");if(this.domNode.parentNode&&this.domNode.parentNode.scrollTop>0){this.domNode.parentNode.scrollTop=0;}},_onNextFeature:function(_550){this._featureIdx+=_550;if(this._featureIdx<0){this._featureIdx=this._numFeatures-1;}else{if(this._featureIdx>=this._numFeatures){this._featureIdx=0;}}var _551=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(_551);this._updateUI();this.onNext(_551);},_deleteFeature:function(){this.onDelete(this._currentFeature);},_showFeature:function(_552,_553){if(!_552){return;}this._currentFeature=_552;var _554=_553?_553:_552.getLayer();var _555=_554.getEditCapabilities({feature:_552,userId:this._userIds[_554.id]});this._canUpdate=_555.canUpdate;this._canDelete=_555.canDelete;var _556=this._getLInfoFromFeatureLayer(_554);if(!_556){return;}this._setCurrentLInfo(_556);var _557=_552.attributes;var type=this._findFirst(_556.types,"id",_557[_556.typeIdField]);var node,_558=null;var _559=_556.fieldInfos;_4f1.forEach(_559,function(_55a){_558=_55a.field;node=_55a.dijit||null;if(!node){return;}var _55b=this._setFieldDomain(node,type,_558);var _55c=_557[_558.name];_55c=(_55c&&_55b&&_55b.codedValues&&_55b.codedValues.length)?(_55b.codedValues[_55c]?_55b.codedValues[_55c].name:_55c):_55c;if(!_4f8.isDefined(_55c)){_55c="";}if(node.declaredClass==="dijit.form.DateTextBox"){_55c=(_55c==="")?null:new Date(_55c);}else{if(node.declaredClass==="dijit.form.FilteringSelect"){node._lastValueReported=null;_55c=_557[_558.name]+"";}}try{this._setValue(node,_55c);if(node.declaredClass==="dijit.form.FilteringSelect"&&node.isValid()===false){this._setValue(node,null);}}catch(error){node.set("displayedValue",this.NLS_errorInvalid,false);}},this);if(this._attachmentEditor&&_556.showAttachments){this._attachmentEditor.showAttachments(this._currentFeature);}var _55d=_554.getEditSummary(_552);if(_55d){this.editorTrackingInfoDiv.innerHTML=_55d;_4f9.show(this.editorTrackingInfoDiv);}else{_4f9.hide(this.editorTrackingInfoDiv);}},_setFieldDomain:function(node,type,_55e){if(!node){return null;}var _55f=_55e.domain;if(type&&type.domains){if(type.domains[_55e.name]&&type.domains[_55e.name] instanceof _4fa===false){_55f=type.domains[_55e.name];}}if(!_55f){return null;}if(_55f.codedValues&&_55f.codedValues.length>0){node.set("store",this._toStore(_4f1.map(_55f.codedValues,function(item){return {id:item.code+="",name:item.name};})));this._setValue(node,_55f.codedValues[0].code);}else{node.constraints={min:_4f8.isDefined(_55f.minValue)?_55f.minValue:Number.MIN_VALUE,max:_4f8.isDefined(_55f.maxValue)?_55f.maxValue:Number.MAX_VALUE};this._setValue(node,node.constraints.min);}return _55f;},_setValue:function(node,_560){if(!node.set){return;}node._onChangeActive=false;node.set("value",_560,true);node._onChangeActive=true;},_getFields:function(_561){var _562=_561._getOutFields();if(!_562){return null;}var _563=_561.fields;return (_562=="*")?_563:_4f1.filter(_4f1.map(_562,lang.hitch(this,"_findFirst",_563,"name")),_4f8.isDefined);},_isInFields:function(_564,_565){if(!_564||!_565&&!_565.length){return false;}return _4f1.some(_565,function(name){return name.toLowerCase()===_564.toLowerCase();});},_findFirst:function(_566,_567,_568){var _569=_4f1.filter(_566,function(item){return item.hasOwnProperty(_567)&&item[_567]===_568;});return (_569&&_569.length)?_569[0]:null;},_getLInfoFromFeatureLayer:function(_56a){var _56b=_56a?_56a.id:null;return this._findFirst(this._layerInfos,"layerId",_56b);},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=_4f6.create("table",{cellspacing:"0",cellpadding:"0"},this.attributeTable);var _56c=_4f6.create("tbody",null,this._attributes);var _56d=this._currentFeature;var _56e=this._currentLInfo;var type=this._findFirst(_56e.types,"id",_56d.attributes[_56e.typeIdField]);var _56f=_56e.fieldInfos;_4f1.forEach(_56f,lang.hitch(this,"_createField",type,_56c),this);this._createOnlyFirstTime=false;},_createField:function(type,_570,_571){var _572=this._currentLInfo;var _573=_571.field;if(this._isInFields(_573.name,_572.hideFields)){return;}if(this._isInFields(_573.name,this._editorTrackingInfos[_572.featureLayer.id])){return;}var node=_4f6.create("tr",null,_570);var td=_4f6.create("td",{innerHTML:_571.label||_573.alias||_573.name,"class":"atiLabel"},node);td=_4f6.create("td",null,node);var _574=null;var _575=false;if(_571.customField){_4f6.place(_571.customField.domNode||_571.customField,_4f6.create("div",null,td),"first");_574=_571.customField;}else{if(_572.isEditable===false||_573.editable===false||_571.isEditable===false||_573.type==="esriFieldTypeOID"||_573.type==="esriFieldTypeGlobalID"||(!this._canUpdate&&!this._createOnlyFirstTime)){_575=true;}}if(!_574&&(_572.typeIdField&&_573.name.toLowerCase()==_572.typeIdField.toLowerCase())){_574=this._createTypeField(_573,_571,td);}else{if(!_574){_574=this._createDomainField(_573,_571,type,td);}}if(!_574){switch(_573.type){case "esriFieldTypeString":_574=this._createStringField(_573,_571,td);break;case "esriFieldTypeDate":_574=this._createDateField(_573,_571,td);break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":_574=this._createIntField(_573,_571,td);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":_574=this._createFltField(_573,_571,td);break;default:_574=this._createStringField(_573,_571,td);break;}}if(_571.tooltip&&_571.tooltip.length){this._toolTips.push(new _50c({connectId:[_574.id],label:_571.tooltip}));}_574.onChange=lang.hitch(this,"onFieldValueChange",_571);_574.set("disabled",_575);_571.dijit=_574;},_createTypeField:function(_576,_577,node){return new _508({"class":"atiField",name:_576.alias||_576.name,store:this._toStore(_4f1.map(this._currentLInfo.types,function(item){return {id:item.id,name:item.name};})),searchAttr:"name"},_4f6.create("div",null,node));},_createDomainField:function(_578,_579,type,node){var _57a=_578.domain;if(type&&type.domains){if(type.domains[_578.name]&&type.domains[_578.name] instanceof _4fa===false){_57a=type.domains[_578.name];}}if(!_57a){return null;}if(_57a.codedValues){return new _508({"class":"atiField",name:_578.alias||_578.name,searchAttr:"name",required:_578.nullable||false},_4f6.create("div",null,node));}else{return new _509({"class":"atiField"},_4f6.create("div",null,node));}},_createStringField:function(_57b,_57c,node){var _57d={"class":"atiField",trim:true,maxLength:_57b.length};if(_57c.stringFieldOption===ATI.STRING_FIELD_OPTION_TEXTAREA){_57d["class"]+=" atiTextAreaField";return new _50b(_57d,_4f6.create("div",null,node));}else{if(_57c.stringFieldOption===ATI.STRING_FIELD_OPTION_RICHTEXT){_57d["class"]+=" atiRichTextField";_57d.height="100%";_57d.width="100%";_57d.plugins=_57c.richTextPlugins||["bold","italic","underline","foreColor","hiliteColor","|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList","insertUnorderedList","indent","outdent","|","createLink"];return new _4ff(_57d,_4f6.create("div",null,node));}else{return new _506(_57d,_4f6.create("div",null,node));}}},_createDateField:function(_57e,_57f,node){var _580={"class":"atiField","trim":true};if(this._datePackage){_580.datePackage=this._datePackage;}return new _505(_580,_4f6.create("div",null,node));},_createIntField:function(_581,_582,node){return new _507({"class":"atiField",constraints:{places:0},invalidMessage:this.NLS_validationInt,trim:true},_4f6.create("div",null,node));},_createFltField:function(_583,_584,node){return new _507({"class":"atiField",trim:true,invalidMessage:this.NLS_validationFlt},_4f6.create("div",null,node));},_toStore:function(_585){return new _50d({data:{identifier:"id",label:"name",items:_585}});},_connect:function(node,evt,func){this._aiConnects.push(_4f2.connect(node,evt,func));},_getDatePackage:function(_586){if(_586.datePackage===null){return null;}else{if(_586.datePackage){return _586.datePackage;}else{if(_4f4.locale==="ar"){return "dojox.date.islamic";}}}return null;},_destroyAttributeTable:function(){var _587=this._layerInfos;_4f1.forEach(_587,function(_588){var _589=_588.fieldInfos;_4f1.forEach(_589,function(_58a){var _58b=_58a.dijit;if(_58b){_58b._onChangeHandle=null;if(_58a.customField){return;}if(_58b.destroyRecursive){_58b.destroyRecursive();}else{if(_58b.destroy){_58b.destroy();}}}_58a.dijit=null;},this);},this);var _58c=this._toolTips;_4f1.forEach(_58c,function(item){item.destroy();delete item;});this._toolTips=[];if(this._attributes){_4f6.destroy(this._attributes);}}});lang.mixin(ATI,{STRING_FIELD_OPTION_RICHTEXT:"richtext",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});if(has("extend-esri")){lang.setObject("dijit.AttributeInspector",ATI,_4f7);}return ATI;});},"esri/dijit/editing/tools/Cut":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dojo/DeferredList","esri/graphicsUtils","esri/graphic","esri/tasks/query","esri/layers/FeatureLayer","esri/toolbars/draw","esri/dijit/editing/Cut","esri/dijit/editing/tools/ToggleToolBase","esri/kernel"],function(_58d,lang,_58e,_58f,has,_590,_591,_592,_593,_594,Draw,Cut,_595,_596){var _597=_58d([_595],{declaredClass:"esri.dijit.editing.tools.Cut",id:"btnFeatureCut",_enabledIcon:"toolbarIcon cutIcon",_disabledIcon:"toolbarIcon cutIcon",_drawType:Draw.POLYLINE,_enabled:true,_label:"NLS_cutLbl",_cutConnects:[],activate:function(){this._cutConnects.push(_58f.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd"));this.inherited(arguments);},deactivate:function(){this.inherited(arguments);_58e.forEach(this._cutConnects,_58f.disconnect);this._cutConnects=[];this._edits=[];},_onDrawEnd:function(_598){var _599=this._settings.layers;var _59a=this._cutLayers=_58e.filter(_599,function(_59b){return ((_59b.geometryType==="esriGeometryPolygon")||(_59b.geometryType==="esriGeometryPolyline")&&_59b.visible&&_59b._isMapAtVisibleScale());});this._cutConnects=this._cutConnects.concat(_58e.map(_59a,lang.hitch(this,function(_59c){return _58f.connect(_59c,"onEditsComplete",lang.hitch(this,function(adds,_59d,_59e){if(this._settings.undoRedoManager){var _59f=this._settings.undoRedoManager;_58e.forEach(this._edits,lang.hitch(this,function(edit){_59f.add(new Cut({featureLayer:edit.layer,addedGraphics:edit.adds,preUpdatedGraphics:edit.preUpdates,postUpdatedGraphics:edit.updates}));}),this);}this.onFinished();}));})));var _5a0=new _593();_5a0.geometry=_598;_58e.forEach(_59a,function(_5a1,idx){this._settings.editor._selectionHelper.selectFeatures([_5a1],_5a0,_594.SELECTION_NEW,lang.hitch(this,"_cutFeatures",_5a1,_5a0));},this);},_cutFeatures:function(_5a2,_5a3,_5a4){if(!_5a4||!_5a4.length){return;}this._edits=[];var _5a5=[];_5a5.push(this._settings.geometryService.cut(_591.getGeometries(_5a4),_5a3.geometry,lang.hitch(this,"_cutHandler",_5a2,_5a4)));var _5a6=new _590(_5a5).addCallback(lang.hitch(this,function(){this.onApplyEdits(this._edits);}));},_cutHandler:function(_5a7,_5a8,_5a9){var _5aa=[];var _5ab=[];var _5ac=_58e.map(_5a8,function(item){return new _592(lang.clone(item.toJson()));});var _5ad;var _5ae;_58e.forEach(_5a9.cutIndexes,function(_5af,i){if(_5ad!=_5af){_5ad=_5af;_5ab.push(_5a8[_5af].setGeometry(_5a9.geometries[i]));}else{_5ae=new _592(_5a9.geometries[i],null,lang.mixin({},_5a8[_5af].attributes),null);_5ae.attributes[_5a8[0].getLayer().objectIdField]=null;_5aa.push(_5ae);}},this);this._edits.push({layer:_5a7,adds:_5aa,updates:_5ab,preUpdates:_5ac});}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Cut",_597,_596);}return _597;});},"esri/dijit/editing/tools/Edit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/dijit/editing/tools/MenuItemBase","esri/kernel"],function(_5b0,lang,has,_5b1,_5b2){var Edit=_5b0([_5b1],{declaredClass:"esri.dijit.editing.tools.Edit",enable:function(_5b3){this._enabled=_5b3===this._geomType;this.inherited(arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Edit",Edit,_5b2);}return Edit;});},"esri/dijit/editing/Editor":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/kernel","dojo/has","dojo/query","dojo/DeferredList","dojo/dom-class","dojo/dom-construct","dijit/_Widget","dijit/_Templated","esri/domUtils","esri/graphicsUtils","esri/geometry/Polyline","esri/geometry/Polygon","esri/graphic","esri/undoManager","esri/tasks/query","esri/layers/FeatureLayer","esri/layers/FeatureTemplate","esri/toolbars/draw","esri/toolbars/edit","esri/dijit/AttributeInspector","esri/dijit/editing/Util","esri/dijit/editing/Add","esri/dijit/editing/Update","esri/dijit/editing/Delete","esri/dijit/editing/toolbars/Drawing","esri/dijit/editing/SelectionHelper","esri/dijit/editing/TemplatePicker","esri/kernel","esri/config","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/editing/templates/Editor.html","dijit/ProgressBar","dojo/NodeList-dom"],function(_5b4,lang,_5b5,_5b6,_5b7,has,_5b8,_5b9,_5ba,_5bb,_5bc,_5bd,_5be,_5bf,_5c0,_5c1,_5c2,_5c3,_5c4,_5c5,_5c6,Draw,_5c7,_5c8,_5c9,Add,_5ca,_5cb,_5cc,_5cd,_5ce,_5cf,_5d0,_5d1,_5d2){var _5d3=_5b4([_5bc,_5bd],{declaredClass:"esri.dijit.editing.Editor",widgetsInTemplate:true,templateString:_5d2,constructor:function(_5d4,_5d5){_5d4=_5d4||{};if(!_5d4.settings){console.error("Editor: please provide 'settings' parameter in the constructor");}if(!_5d4.settings.layerInfos){console.error("Editor: please provide 'layerInfos' parameter in the constructor");}this._settings=_5d4.settings;this._eConnects=[];},postCreate:function(){this._setDefaultOptions();var _5d6=this._settings.layerInfos;if(_5b5.every(_5d6,function(_5d7){return _5d7.featureLayer.loaded;})){this._initLayers();this._connectEvents();this._createWidgets();}else{var _5d8=_5d6.length;_5b5.forEach(_5d6,function(_5d9){var _5da=_5d9.featureLayer;if(_5da.loaded){_5d8--;}else{var _5db=_5b6.connect(_5da,"onLoad",this,function(_5dc){_5b6.disconnect(_5db);_5db=null;_5d8--;if(!_5d8){this._initLayers();this._connectEvents();this._createWidgets();}});}},this);}this._reset();this._enableMapClickHandler();},stopEditing:function(_5dd){this._updateCurrentFeature(lang.hitch(this,function(){this._clearSelection(false);_5dd&&_5dd();}));},destroy:function(){if(this.drawingToolbar){this.drawingToolbar.destroy();}if(this.attributeInspector){this.attributeInspector.destroy();}if(this.templatePicker){this.templatePicker.destroy();}if(this._selectionHelper){this._selectionHelper.destroy();}if(this._drawToolbar){this._drawToolbar.deactivate();}this._reset();this._disableMapClickHandler();_5b5.forEach(this._eConnects,_5b6.disconnect);_5b6.disconnect(this._dtConnect);_5b6.disconnect(this._templatePickerOnSelectionChangeEvent);this._layer=this._currentGraphic=this._activeType=this._activeTemplate=this._drawingTool=this._drawToolbar=this._editToolbar=this.drawingToolbar=this.attributeInspector=this.templatePicker=this.undoManager=null;if(this._settings.map.infoWindow&&this._settings.map.infoWindow.clearFeatures){this._settings.map.infoWindow.clearFeatures();}this.inherited(arguments);},_setDefaultOptions:function(){this._drawToolbar=this._settings.drawToolbar||new Draw(this._settings.map);this._settings.drawToolbar=this._drawToolbar;this._editToolbar=this._settings.editToolbar||new _5c7(this._settings.map);this._settings.editToolbar=this._editToolbar;this._settings.toolbarVisible=this._settings.toolbarVisible||false;this._settings.toolbarOptions=lang.mixin({reshapeVisible:false,cutVisible:false,mergeVisible:false},this._settings.toolbarOptions);this._settings.createOptions=lang.mixin({polylineDrawTools:[_5d3.CREATE_TOOL_POLYLINE],polygonDrawTools:[_5d3.CREATE_TOOL_POLYGON],editAttributesImmediately:true},this._settings.createOptions);this._settings.singleSelectionTolerance=this._settings.singleSelectionTolerance||3;this._settings.maxUndoRedoOperations=this._settings.maxUndoRedoOperations||10;this._settings.editor=this;this._usePopup=this._settings.usePopup=this._settings.map.infoWindow._setPagerCallbacks?true:false;this._datePackage=this._settings.datePackage;var _5de=_5d0.defaults;this._settings.geometryService=this._settings.geometryService||_5de.geometryService;_5de.geometryService=_5de.geometryService||this._settings.geometryService;},_initLayers:function(){this._settings.layers=[];this._settings.userIds={};this._settings.createOnlyLayer={};var _5df=this._settings.layerInfos;_5b5.forEach(_5df,function(_5e0){if(_5e0.featureLayer&&_5e0.featureLayer.loaded){this._settings.layers.push(_5e0.featureLayer);var _5e1=_5e0.featureLayer.id;if(_5e0.featureLayer.credential){this._settings.userIds[_5e1]=_5e0.featureLayer.credential.userId;}if(_5e0.userId){this._settings.userIds[_5e1]=_5e0.userId;}var _5e2=_5e0.featureLayer.getEditCapabilities();if(_5e2.canCreate&&!_5e2.canUpdate){this._settings.createOnlyLayer[_5e1]=true;}else{this._settings.createOnlyLayer[_5e1]=false;}}},this);},_reset:function(){this._hideAttributeInspector();this._editToolbar.deactivate();this._editVertices=true;this._layer=null;this._currentGraphic=null;this._activeType=null;this._activeTemplate=null;this._drawingTool=null;this._attributeChanged=false;},_saveFeatureOnClient:function(_5e3){var _5e4=this.templatePicker.getSelected();var _5e5;if(_5e4.template){_5e5=_5e4.featureLayer.renderer.getSymbol(_5e4.template.prototype);}else{_5e5=_5e4.symbolInfo.symbol;}var _5e6=_5e4.featureLayer.fields;var att={};_5b5.forEach(_5e6,function(_5e7,idx){att[_5e7.name]=null;});this._tempGraphic=new _5c2(_5e3,_5e5,att,null);var map=this._settings.map;map.graphics.add(this._tempGraphic);var _5e8=this._findCenterPoint(_5e3);this._createAttributeInspector(true);map.infoWindow.setTitle(_5e4.featureLayer?_5e4.featureLayer.name:_5d1.widgets.attributeInspector.NLS_title);this.attributeInspector.showFeature(this._tempGraphic,_5e4.featureLayer);this._showInfoWindow(_5e8,map.getInfoWindowAnchor(_5e8));if(this._settings.createOnlyLayer[_5e4.featureLayer.id]){this._infoWindowHideEvent=_5b6.connect(map.infoWindow,"onHide",this,"_infoWindowHide");}_5b6.disconnect(this._templatePickerOnSelectionChangeEvent);this.templatePicker.clearSelection();this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}this._templatePickerOnSelectionChangeEvent=_5b6.connect(this.templatePicker,"onSelectionChange",lang.hitch(this,"_onCreateFeature"));},_saveAttributesOnClient:function(_5e9,_5ea,_5eb){this._tempGraphic.attributes[_5ea]=(typeof (_5eb)==="number"&&isNaN(_5eb))?null:_5eb;},_infoWindowHide:function(){this._createFeature(this._tempGraphic.geometry,this._tempGraphic.attributes);_5b6.disconnect(this._infoWindowHideEvent);},_createFeature:function(_5ec,_5ed){this._editClickPoint=this._findCenterPoint(_5ec);if(!_5ec.rings){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_5ec,_5ed)]}]);return;}this._simplify(_5ec,lang.hitch(this,function(_5ee){if(this._drawingTool!==_5c6.TOOL_AUTO_COMPLETE_POLYGON){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_5ee,_5ed)]}]);}else{this._autoComplete(_5ee,lang.hitch(this,function(_5ef){if(_5ef&&_5ef.length){this._applyEdits([{layer:this._layer,adds:_5b5.map(_5ef,lang.hitch(this,function(_5f0){return this._createGraphic(_5f0,_5ed);}))}]);}}));}}));},_updateCurrentFeature:function(_5f1){var _5f2=this._isModified();if(_5f2){this._updateFeature(_5f2,_5f1);}else{if(_5f1){_5f1(false);}}},_updateFeature:function(_5f3,_5f4){var geom=_5f3.geometry;if(!geom.rings){this._applyEdits([{layer:_5f3.getLayer(),updates:[_5f3]}],_5f4);}else{this._simplify(geom,lang.hitch(this,function(_5f5){this._applyEdits([{layer:_5f3.getLayer(),updates:[lang.mixin(_5f3,{geometry:_5f5})]}],_5f4);}));}},_deleteFeature:function(_5f6,_5f7){var _5f8=[];if(!_5f6){var _5f9=this._settings.layers;_5f8=_5b5.map(_5b5.filter(_5f9,function(_5fa){return _5fa.getSelectedFeatures().length>0;}),function(item){return {layer:item,deletes:item.getSelectedFeatures()};});if((!_5f8||!_5f8.length)&&this._currentGraphic){_5f8.push({layer:this._layer,deletes:[this._currentGraphic]});}}else{_5f8.push({layer:_5f6.getLayer(),deletes:[_5f6]});}this._applyEdits(_5f8,(_5f7));},_stopEditing:function(_5fb,adds,_5fc,_5fd){_5be.hide(this.progressBar.domNode);this._undoRedoAdd();var _5fe;if(_5fb._isSelOnly===true){if(adds&&adds.length){this.templatePicker.clearSelection();var _5ff=new _5c4();_5ff.objectIds=[adds[0].objectId];if(!this._settings.createOnlyLayer[_5fb.id]){this._selectFeatures([_5fb],_5ff,lang.hitch(this,"_onEditFeature"));}else{this._settings.map.graphics.remove(this._tempGraphic);}}}else{_5fe=this._selectionHelper.findMapService(this._settings.map,_5fb);if(_5fe){_5fe.refresh();}if(adds&&adds.length){this.templatePicker.clearSelection();if(!this._settings.createOnlyLayer[_5fb.id]){_5c9.findFeatures(adds,_5fb,lang.hitch(this,"_onEditFeature"));}else{this._settings.map.graphics.remove(this._tempGraphic);}}}if(_5fd&&_5fd.length){this._clearSelection(true);if(this._undoRedo){_5fe=this._selectionHelper.findMapService(_5fb,this._settings.map);if(_5fe){_5fe.refresh();}}}if(this._undoRedo&&_5fc&&_5fc.length){_5fe=this._selectionHelper.findMapService(_5fb,this._settings.map);if(_5fe){_5fe.refresh();}this.attributeInspector.refresh();this._undoRedo=false;}if(this.drawingToolbar){this.drawingToolbar._updateUI();}this._undoRedo=false;},_undoRedoAdd:function(){this._settings._isApplyEditsCall=false;if(!this._settings.undoManager){return;}if(this._activeTool==="CUT"||this._activeTool==="UNION"){return;}var edit=(this._edits&&this._edits.length)?this._edits[0]:null;if(!edit){return;}var adds=edit.adds||[];var _600=edit.updates||[];var _601=edit.deletes||[];var _602={featureLayer:edit.layer};if(adds.length){this.undoManager.add(new Add(lang.mixin(_602,{addedGraphics:adds})));}else{if(_601.length){this.undoManager.add(new _5cb(lang.mixin(_602,{deletedGraphics:_601})));}else{if(_600.length){this.undoManager.add(new _5ca(lang.mixin(_602,{preUpdatedGraphics:[this._preUpdates],postUpdatedGraphics:_600})));}}}this._edits=null;this._preUpdates=null;},_activateDrawToolbar:function(_603){this._layer=_603.featureLayer;this._activeType=_603.type;this._activeTemplate=_603.template;this._drawingTool=this._activeTemplate?this._activeTemplate.drawingTool:null;this._drawTool=this._toDrawTool(this._drawingTool,_603.featureLayer);_5b6.disconnect(this._dtConnect);if(this._settings.createOnlyLayer[_603.featureLayer.id]){this._dtConnect=_5b6.connect(this._drawToolbar,"onDrawEnd",this,"_saveFeatureOnClient");}else{this._dtConnect=_5b6.connect(this._drawToolbar,"onDrawEnd",this,"_createFeature");}this._editToolbar.deactivate();this._disableMapClickHandler();if(!this.drawingToolbar){this._drawToolbar.activate(this._drawTool);}else{this.drawingToolbar.activateEditing(this._drawTool,this._layer);}},_activateEditToolbar:function(_604,info){var _605=_604.getLayer();var _606=_605?_605.geometryType:null;var _607=_5c7.MOVE;if(_606!=="esriGeometryPoint"&&this._isNotesFeature(_604)===true){_607=_607|_5c7.ROTATE|_5c7.SCALE;this._editVertices=false;}else{if(_606!=="esriGeometryPoint"&&this._editVertices===true){_607=_607|_5c7.ROTATE|_5c7.SCALE;this._editVertices=false;}else{_607=_607|_5c7.EDIT_VERTICES;this._editVertices=true;}}this._attributeChanged=this._isModified();this._preUpdates=new _5c2(lang.clone(_604.toJson()));var _608=_605.getEditCapabilities({feature:_604,userId:this._settings.userIds[_605.id]});var _609=_5b5.filter(this._settings.layerInfos,function(item){return item.featureLayer["layerId"]===_605.layerId;})[0];if(_608.canUpdate&&!_609.disableGeometryUpdate&&_605.allowGeometryUpdates){this._editToolbar.activate(_607,_604);}if(!this._settings.map.infoWindow.isShowing){var _60a=(info&&info.screenPoint)||this._findCenterPoint(_604);this._showInfoWindow(_60a,this._settings.map.getInfoWindowAnchor(_60a));}},_createGraphic:function(_60b,_60c){var _60d=(this._activeType&&this._activeType.symbol)||this._layer.defaultSymbol;var _60e=new _5c2(_60b,_60d,_60c);if(this._activeTemplate||_60c){_60e.attributes=_60c||lang.mixin({},this._activeTemplate.prototype.attributes);}else{_60e.attributes=_60e.attributes||[];_5b5.forEach(this._layer.fields,function(_60f){_60e.attributes[_60f.name]=null;},this);}return _60e;},_connectEvents:function(){var _610=this._settings.layers;_5b5.forEach(_610,function(item){this._connect(item,"onEditsComplete",lang.hitch(this,"_stopEditing",item));},this);_5b5.forEach(_610,function(item){this._connect(item,"onBeforeApplyEdits",lang.hitch(this,function(){_5be.show(this.progressBar.domNode);this._settings._isApplyEditsCall=true;}));},this);this._connect(this._editToolbar,"onGraphicClick",lang.hitch(this,"_activateEditToolbar"));this._connect(this._editToolbar,"onGraphicFirstMove",lang.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onVertexFirstMove",lang.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onScaleStart",lang.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onRotateStart",lang.hitch(this,"_hideAttributeInspector"));},_connect:function(node,evt,func){this._eConnects.push(_5b6.connect(node,evt,func));},_createWidgets:function(){this._selectionHelper=new _5cd(this._settings);this._createTemplatePicker();this._createAttributeInspector();this._createDrawingToolbar();this._createUndoRedoManager();},_createTemplatePicker:function(){if(!this._settings.templatePicker){var _611=_5b5.filter(this._settings.layers,function(item){return item.getEditCapabilities().canCreate;});this.templatePicker=new _5ce({"class":"esriTemplatePicker",featureLayers:_611,showTooltip:true,maxLabelLength:this._settings.typesCharacterLimit,columns:"auto",rows:"auto"},this.templatePickerDiv);this.templatePicker.startup();this._settings.templatePicker=this.templatePicker;}else{this.templatePicker=this._settings.templatePicker;_5be.hide(this.templatePickerDiv);}this._templatePickerOnSelectionChangeEvent=_5b6.connect(this.templatePicker,"onSelectionChange",lang.hitch(this,"_onCreateFeature"));},_createAttributeInspector:function(_612){if(!this._settings.attributeInspector){this._customAttributeInspector=false;var map=this._settings.map;this.attributeInspector=new _5c8({layerInfos:this._settings.layerInfos,hideNavButtons:this._usePopup,datePackage:this._datePackage},_5bb.create("div"));this.attributeInspector.startup();map.infoWindow.setContent(this.attributeInspector.domNode);map.infoWindow.setTitle(_5d1.widgets.attributeInspector.NLS_title);map.infoWindow.resize(350,375);_5b7.query(".esriAttributeInspector .atiLayerName").style({display:"none"});}else{this._customAttributeInspector=true;this.attributeInspector=this._settings.attributeInspector;}this._connect(this.attributeInspector,"onDelete",lang.hitch(this,"_deleteFeature"));this._connect(this.attributeInspector,"onNext",lang.hitch(this,function(_613){this._updateCurrentFeature(lang.hitch(this,function(){this._attributeChanged=false;this._onEditFeature(_613);}));}));if(this._usePopup){this._settings.map.infoWindow._setPagerCallbacks(this.attributeInspector,lang.hitch(this.attributeInspector,"next"),lang.hitch(this.attributeInspector,"previous"));}if(_612){this._connect(this.attributeInspector,"onAttributeChange",lang.hitch(this,"_saveAttributesOnClient"));}else{this._connect(this.attributeInspector,"onAttributeChange",lang.hitch(this,function(_614,_615,_616){this._preUpdates=new _5c2(lang.clone(_614.toJson()));this._currentGraphic.attributes[_615]=(typeof (_616)==="number"&&isNaN(_616))?null:_616;this._updateFeature(this._currentGraphic,null);this._attributeChanged=false;}));}},_createDrawingToolbar:function(){if(this._settings.toolbarVisible===true){this.drawingToolbar=new _5cc({"class":"esriDrawingToolbar",drawToolbar:this._drawToolbar,editToolbar:this._editToolbar,settings:this._settings,onDelete:lang.hitch(this,"_deleteFeature"),onApplyEdits:lang.hitch(this,"_applyEdits"),onShowAttributeInspector:lang.hitch(this,"_onEditFeature")},this.drawingToolbarDiv);}},_createUndoRedoManager:function(){if(!this._settings.enableUndoRedo&&!this._settings.undoManager){return;}this._settings.enableUndoRedo=true;this.undoManager=this._settings.undoManager;if(!this.undoManager){this.undoManager=this._settings.undoManager=new _5c3({maxOperations:this._settings.maxUndoRedoOperations});}this._connect(document,"onkeypress",lang.hitch(this,function(evt){if(evt.metaKey||evt.ctrlKey){if(evt.charOrCode==="z"){this._undo();}if(evt.charOrCode==="y"){this._redo();}}}));},_enableMapClickHandler:function(){this._mapClickHandler=_5b6.connect(this._settings.map,"onClick",lang.hitch(this,function(evt){if(this._drawToolbar._geometryType){return;}if(this._activeTool==="SELECT"){this._activeTool="";return;}this._updateCurrentFeature(lang.hitch(this,function(){this._reset();this._updateSelection(evt);}));}));},_disableMapClickHandler:function(){_5b6.disconnect(this._mapClickHandler);},_onCreateFeature:function(){var _617=this.templatePicker.getSelected();if(_617){this._updateCurrentFeature(lang.hitch(this,function(){if(this._currentGraphic){this._clearSelection(false);}this._reset();this._activateDrawToolbar(_617);}));}else{this._reset();_5b6.disconnect(this._dtConnect);this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}}},_onEditFeature:function(_618,_619){_618=(lang.isArray(_618)?_618[0]:_618)||null;if(!_618){return;}if(!this._customAttributeInspector){_619=_619||this._editClickPoint||this._findCenterPoint(_618);var _61a=_618.getLayer();this._settings.map.infoWindow.setTitle(_61a?_61a.name:_5d1.widgets.attributeInspector.NLS_title);if(this.drawingToolbar||!this._settings.map.infoWindow.isShowing){this._showInfoWindow(_619,this._settings.map.getInfoWindowAnchor(_619));}this._editClickPoint=null;}if(_618===this._currentGraphic){return;}this._editVertices=true;this._layer=_618.getLayer();this._currentGraphic=_618;if(_618.getDojoShape()){_618.getDojoShape().moveToFront();}this._activateEditToolbar(_618);},_applyEdits:function(_61b,_61c){_61b=_61b||[];if(_61b.length<=0){return;}this._edits=_61b;var _61d=_5b5.map(_61b,function(edit){return edit.layer.applyEdits(edit.adds,edit.updates,edit.deletes);});this._deferredsList=new _5b9(_61d).addCallback(lang.hitch(this,function(){_5be.hide(this.progressBar.domNode);if(_61c){_61c();}var map=this._settings.map;if(map&&map.infoWindow.reposition&&map.infoWindow.isShowing){map.infoWindow.reposition();}}));},_undo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.undo();}},_redo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.redo();}},_simplify:function(_61e,_61f){if(_5c1.prototype.isSelfIntersecting(_61e)){this._settings.geometryService.simplify([_61e],function(_620){var _621=(_620&&_620.length)?_620[0]:_621;if(_61f){_61f(_621);}});}else{if(_61f){_61f(_61e);}}},_autoComplete:function(_622,_623){var _624=this._getLayers("esriGeometryPolygon");var _625=new _5c4();_625.geometry=_622;_625.returnGeometry=true;this._selectFeatures(_624,_625,lang.hitch(this,function(_626){if(!_626||_626.length<=0){if(_623){_623([_622]);}}else{this._settings.geometryService.autoComplete(_5bf.getGeometries(_626),this._toPolylines([_625.geometry]),function(_627){if(_623){_623(_627);}});}}));},_getLayers:function(_628){var _629=this._settings.layers;return _5b5.filter(_629,function(_62a){return _62a.geometryType===_628;});},_selectFeatures:function(_62b,_62c,_62d,mode){this._selectionHelper.selectFeatures(_62b,_62c,mode||_5c5.SELECTION_NEW,_62d);},_updateSelection:function(evt){var _62e=evt.mapPoint;var _62f=evt.graphic;this._selectionHelper.selectFeaturesByGeometry(this._settings.layers,_62e,_5c5.SELECTION_NEW,lang.hitch(this,function(_630){var _631=_5b5.some(_630,lang.hitch(this,function(item){return item==_62f;}));if(_62f&&!_631){var _632=_62f.getLayer();if(this._isValidLayer(_632)){var _633=new _5c4();_633.objectIds=[_62f.attributes[_632.objectIdField]];this._selectionHelper.selectFeatures([_632],_633,_5c5.SELECTION_ADD,lang.hitch(this,function(_634){this._updatePopupButtons(_634);this._onEditFeature(_634,_62e);}));}else{this._clearSelection();}}else{if(_630&&_630.length){this._updatePopupButtons(_630);this._onEditFeature(_630,_62e);}else{this._clearSelection();}}}));},_updatePopupButtons:function(_635){if(!this._usePopup||!_635){return;}var _636=_635.length;var _637=[this._settings.map.infoWindow._prevFeatureButton,this._settings.map.infoWindow._nextFeatureButton];_5b5.forEach(_637,lang.hitch(this,function(item){(_636>1)?_5ba.remove(item,"hidden"):_5ba.add(item,"hidden");}));},_clearSelection:function(_638){this._selectionHelper.clearSelection(_638||false);this._reset();},_findCenterPoint:function(_639){var _63a=_639.geometry||_639;var _63b;switch(_63a.type){case "point":_63b=_63a;break;case "polyline":var _63c=_63a.paths[0].length;_63b=_63a.getPoint(0,Math.ceil(_63c/2));break;case "polygon":var _63d=_63a.rings.length-1;var _63e=_63a.rings[_63d].length-1;_63b=_63a.getPoint(_63d,_63e);break;}return this._settings.map.toScreen(_63b);},_hideAttributeInspector:function(){if(!this._customAttributeInspector&&this._settings.map.infoWindow){this._settings.map.infoWindow.hide();}},_toPolylines:function(_63f){var _640=_5b5.map(_63f,function(_641){var _642=new _5c0(_641.spatialReference);_5b5.forEach(_641.rings,function(ring){_642.addPath(ring);});return _642;});return _640;},_isNotesFeature:function(_643){var _644=_643.getLayer();var _645=_644?_644.types||null:null;if(!_645){return false;}var _646=_643.attributes[_644.typeIdField];var _647;_5b5.some(_645,function(type){if(type.id===_646){_647=type.templates;return true;}return false;});if(!_647){return false;}var _648=_647[0]||null;if(!_648){return false;}var _649=this._isShapeTool(_648.drawingTool)||null;return _649?true:false;},_isValidLayer:function(_64a){var i;var _64b=this._settings.layerInfos;for(i=0;i<_64b.length;i++){var _64c=_64b[i];if(_64a.id==_64c.layerId){return true;}}return false;},_isShapeTool:function(_64d){switch(_64d){case _5c6.TOOL_ARROW:return Draw.ARROW;case _5c6.TOOL_LEFT_ARROW:return Draw.LEFT_ARROW;case _5c6.TOOL_RIGHT_ARROW:return Draw.RIGHT_ARROW;case _5c6.TOOL_UP_ARROW:return Draw.UP_ARROW;case _5c6.TOOL_DOWN_ARROW:return Draw.DOWN_ARROW;case _5c6.TOOL_CIRCLE:return Draw.CIRCLE;case _5c6.TOOL_ELLIPSE:return Draw.ELLIPSE;case _5c6.TOOL_TRIANGLE:return Draw.TRIANGLE;case _5c6.TOOL_RECTANGLE:return Draw.RECTANGLE;default:return null;}},_toDrawTool:function(_64e,_64f){var _650=_64f.geometryType;switch(_64e){case _5c6.TOOL_POINT:return Draw.POINT;case _5c6.TOOL_ARROW:return Draw.ARROW;case _5c6.TOOL_LEFT_ARROW:return Draw.LEFT_ARROW;case _5c6.TOOL_RIGHT_ARROW:return Draw.RIGHT_ARROW;case _5c6.TOOL_UP_ARROW:return Draw.UP_ARROW;case _5c6.TOOL_DOWN_ARROW:return Draw.DOWN_ARROW;case _5c6.TOOL_CIRCLE:return Draw.CIRCLE;case _5c6.TOOL_ELLIPSE:return Draw.ELLIPSE;case _5c6.TOOL_TRIANGLE:return Draw.TRIANGLE;case _5c6.TOOL_RECTANGLE:return Draw.RECTANGLE;case _5c6.TOOL_LINE:return Draw.POLYLINE;case _5c6.TOOL_POLYGON:return Draw.POLYGON;case _5c6.TOOL_FREEHAND:if(_650==="esriGeometryPolyline"){return Draw.FREEHAND_POLYLINE;}else{return Draw.FREEHAND_POLYGON;}break;default:var _651=Draw.POINT;if(_650==="esriGeometryPolyline"){_651=Draw.POLYLINE;if(this._settings.createOptions.polylineDrawTools[0]===_5d3.CREATE_TOOL_FREEHAND_POLYLINE){_651=Draw.FREEHAND_POLYLINE;}}else{if(_650==="esriGeometryPolygon"){_651=Draw.POLYGON;if(this._settings.createOptions.polygonDrawTools[0]===_5d3.CREATE_TOOL_FREEHAND_POLYGON){_651=Draw.FREEHAND_POLYGON;}}}return _651;}},_isModified:function(){var _652=this._editToolbar.getCurrentState();return ((_652.isModified||this._attributeChanged)&&_652.graphic)?_652.graphic:null;},_showInfoWindow:function(_653,_654){if(!this._customAttributeInspector){this._settings.map.infoWindow.show(_653,_654);}}});lang.mixin(_5d3,{CREATE_TOOL_POLYLINE:"polyline",CREATE_TOOL_FREEHAND_POLYLINE:"freehandpolyline",CREATE_TOOL_POLYGON:"polygon",CREATE_TOOL_FREEHAND_POLYGON:"freehandpolygon",CREATE_TOOL_AUTOCOMPLETE:"autocomplete",CREATE_TOOL_RECTANGLE:"rectangle",CREATE_TOOL_TRIANGLE:"triangle",CREATE_TOOL_CIRCLE:"circle",CREATE_TOOL_ELLIPSE:"ellipse",CREATE_TOOL_ARROW:"arrow",CREATE_TOOL_UP_ARROW:"uparrow",CREATE_TOOL_DOWN_ARROW:"downarrow",CREATE_TOOL_RIGHT_ARROW:"rightarrow",CREATE_TOOL_LEFT_ARROW:"leftarrow"});if(has("extend-esri")){lang.setObject("dijit.editing.Editor",_5d3,_5cf);}return _5d3;});},"esri/dijit/editing/tools/DropDownToolBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","dojo/dom-style","dijit/registry","dijit/Menu","dijit/form/ComboButton","esri/dijit/editing/tools/ToolBase","esri/kernel","esri/lang"],function(_655,lang,has,_656,_657,Menu,_658,_659,_65a,_65b){var DDTB=_655([_658,_659],{declaredClass:"esri.dijit.editing.tools.DropDownToolBase",_enabled:false,_checked:false,postCreate:function(){this._tools=[];this._createTools();this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){var tool;var _65c=this._tools;for(tool in _65c){if(_65c.hasOwnProperty(tool)&&_65b.isDefined(_65c[tool])){_65c[tool].destroy();}}this.inherited(arguments);},_createTools:function(){var i;var mnu=new Menu();this.dropDown=mnu;for(i in this._tools){if(this._tools.hasOwnProperty(i)){mnu.addChild(this._tools[i]);}}this._activeTool=mnu.getChildren()[0];this._updateUI();},activate:function(_65d){this.inherited(arguments);if(!this._activeTool){this._activateDefaultTool();}else{this._activeTool.activate();}},deactivate:function(){this.inherited(arguments);if(this._activeTool){this._activeTool.deactivate();}},enable:function(_65e){var tool;for(tool in this._tools){if(this._tools.hasOwnProperty(tool)){this._tools[tool].enable(_65e);}}this.setEnabled(true);this.inherited(arguments);},setChecked:function(_65f){this._checked=_65f;this._updateUI();},_onDrawEnd:function(_660){},onLayerChange:function(_661,type,_662){this._activeTool=null;this._activeType=type;this._activeTemplate=_662;this._activeLayer=_661;},onItemClicked:function(_663,evt){if(this._activeTool){this._activeTool.deactivate();}this._activeTool=_657.byId(_663);if(this._checked===false){this._onClick();}else{this._updateUI();if(this._activeTool){this._activeTool.activate();this._activeTool.setChecked(true);}}},_onClick:function(evt){if(this._enabled===false){return;}this._checked=!this._checked;this.inherited(arguments);},_updateUI:function(){this.attr("disabled",!this._enabled);_656.set(this.focusNode,{outline:"none"});_656.set(this.titleNode,{padding:"0px",border:"none"});if(this._checked){_656.set(this.titleNode,{backgroundColor:"#D4DFF2",border:"1px solid #316AC5"});}else{_656.set(this.titleNode,{backgroundColor:"",border:""});}if(this._activeTool){this.attr("iconClass",this._checked?this._activeTool._enabledIcon:this._activeTool._disabledIcon);this.attr("label",this._activeTool.label);}}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.DropDownToolBase",DDTB,_65a);}return DDTB;});},"esri/dijit/Legend":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/json","dojo/has","dojo/sniff","dojo/DeferredList","dojo/json","dojo/dom","dojo/dom-construct","dojo/dom-style","dijit/_Widget","dojox/gfx","dojox/html/entities","esri/kernel","esri/config","esri/request","esri/renderers/SimpleRenderer","esri/renderers/UniqueValueRenderer","esri/renderers/ClassBreaksRenderer","esri/symbols/jsonUtils","esri/dijit/_EventedWidget","dojo/i18n!esri/nls/jsapi"],function(_664,lang,_665,_666,_667,has,_668,_669,json,dom,_66a,_66b,_66c,gfx,_66d,_66e,_66f,_670,_671,_672,_673,_674,_675,_676){var _677=_664([_675,_66c],{declaredClass:"esri.dijit.Legend",widgetsInTemplate:false,layers:null,alignRight:false,hoverLabelShowing:false,_ieTimer:100,constructor:function(_678,_679){lang.mixin(this,_676.widgets.legend);_678=_678||{};if(!_678.map){console.error("esri.dijit.Legend: unable to find the 'map' property in parameters");return;}if(!_679){console.error("esri.dijit.Legend: must specify a container for the legend");return;}this.map=_678.map;this.layerInfos=_678.layerInfos;this._respectCurrentMapScale=(_678.respectCurrentMapScale===false)?false:true;this.arrangement=(_678.arrangement===_677.ALIGN_RIGHT)?_677.ALIGN_RIGHT:_677.ALIGN_LEFT;if(this.arrangement===_677.ALIGN_RIGHT){this.alignRight=true;}this.autoUpdate=(_678.autoUpdate===false)?false:true;this._surfaceItems=[];},startup:function(){this.inherited(arguments);this._initialize();if(has("ie")){this._repaintItems=lang.hitch(this,this._repaintItems);setTimeout(this._repaintItems,this._ieTimer);}},destroy:function(){this._deactivate();this._removeHoverHandlers();this.inherited(arguments);},refresh:function(_67a){var i;if(!this.domNode){return;}if(_67a){this.layerInfos=_67a;this.layers=[];_665.forEach(this.layerInfos,function(_67b){if(this._isSupportedLayerType(_67b.layer)){if(_67b.title){_67b.layer._titleForLegend=_67b.title;}_67b.layer._hideDefaultSymbol=(_67b.defaultSymbol===false)?true:false;if(_67b.hideLayers){_67b.layer._hideLayersInLegend=_67b.hideLayers;this._addSubLayersToHide(_67b);}else{_67b.layer._hideLayersInLegend=[];}if(_67b.hoverLabel){_67b.layer._hoverLabel=_67b.hoverLabel;}if(_67b.hoverLabels){_67b.layer._hoverLabels=_67b.hoverLabels;}this.layers.push(_67b.layer);}},this);}else{if(this.useAllMapLayers){this.layerInfos=null;this.layers=null;}}for(i=this.domNode.children.length-1;i>=0;i--){_66a.destroy(this.domNode.children[i]);}this._removeHoverHandlers();this.startup();},_legendUrl:"http://utility.arcgis.com/sharing/tools/legend",_initialize:function(){if(this.layerInfos){this.layers=[];_665.forEach(this.layerInfos,function(_67c){if(this._isSupportedLayerType(_67c.layer)){if(_67c.title){_67c.layer._titleForLegend=_67c.title;}_67c.layer._hideDefaultSymbol=(_67c.defaultSymbol===false)?true:false;if(_67c.hideLayers){_67c.layer._hideLayersInLegend=_67c.hideLayers;this._addSubLayersToHide(_67c);}else{_67c.layer._hideLayersInLegend=[];}if(_67c.hoverLabel){_67c.layer._hoverLabel=_67c.hoverLabel;}if(_67c.hoverLabels){_67c.layer._hoverLabels=_67c.hoverLabels;}this.layers.push(_67c.layer);}},this);}this.useAllMapLayers=false;if(!this.layers){this.useAllMapLayers=true;this.layers=[];var _67d=[];var _67e=[];_665.forEach(this.map.layerIds,function(_67f){var _680=this.map.getLayer(_67f),_681;if(this._isSupportedLayerType(_680)){if(_680.arcgisProps&&_680.arcgisProps.title){_680._titleForLegend=_680.arcgisProps.title;}this.layers.push(_680);}if(_680.declaredClass=="esri.layers.KMLLayer"){_681=_680.getLayers();_665.forEach(_681,function(_682){_67d.push(_682.id);},this);}if(_680.declaredClass=="esri.layers.GeoRSSLayer"){_681=_680.getFeatureLayers();_665.forEach(_681,function(_683){_67e.push(_683.id);},this);}},this);_665.forEach(this.map.graphicsLayerIds,function(_684){var _685=this.map.getLayer(_684);if(_665.indexOf(_67d,_684)==-1&&_665.indexOf(_67e,_684)==-1){if(this._isSupportedLayerType(_685)&&_685._params&&_685._params.drawMode){if(_685.arcgisProps&&_685.arcgisProps.title){_685._titleForLegend=_685.arcgisProps.title;}this.layers.push(_685);}}},this);}this._createLegend();},_activate:function(){this._deactivate();if(!this.autoUpdate){return;}if(this._respectCurrentMapScale){this._ozeConnect=_666.connect(this.map,"onZoomEnd",this,"_refreshLayers");}if(this.useAllMapLayers){this._olaConnect=_666.connect(this.map,"onLayerAdd",this,"_updateAllMapLayers");this._olrConnect=_666.connect(this.map,"onLayerRemove",this,"_updateAllMapLayers");this._olroConnect=_666.connect(this.map,"onLayersReordered",this,"_updateAllMapLayers");}_665.forEach(this.layers,function(_686){_686.ovcConnect=_666.connect(_686,"onVisibilityChange",this,"_refreshLayers");_686.oscConnect=_666.connect(_686,"onScaleRangeChange",this,"_refreshLayers");if(_686.declaredClass==="esri.layers.ArcGISDynamicMapServiceLayer"&&_686.supportsDynamicLayers){_686.odcConnect=_666.connect(_686,"_onDynamicLayersChange",lang.hitch(this,"_updateDynamicLayers",_686));}if(_686.declaredClass==="esri.layers.ArcGISImageServiceLayer"){_686.oirConnect=_666.connect(_686,"onRenderingChange",lang.partial(this._updateImageServiceLayers,this,_686));}},this);},_deactivate:function(){if(this._ozeConnect){_666.disconnect(this._ozeConnect);}if(this._olaConnect){_666.disconnect(this._olaConnect);}if(this._olroConnect){_666.disconnect(this._olroConnect);}if(this._olrConnect){_666.disconnect(this._olrConnect);}_665.forEach(this.layers,function(_687){if(_687.ovcConnect){_666.disconnect(_687.ovcConnect);}if(_687.oscConnect){_666.disconnect(_687.oscConnect);}if(_687.odcConnect){_666.disconnect(_687.odcConnect);}if(_687.oirConnect){_666.disconnect(_687.oirConnect);}},this);},_updateDynamicLayers:function(_688){delete _688.legendResponse;this._refreshLayers();},_updateImageServiceLayers:function(self,_689){delete _689.legendResponse;self._refreshLayers();},_refreshLayers:function(){this.refresh();},_updateAllMapLayers:function(){this.layers=[];_665.forEach(this.map.layerIds,function(_68a){var _68b=this.map.getLayer(_68a);if(this._isSupportedLayerType(_68b)){this.layers.push(_68b);}},this);_665.forEach(this.map.graphicsLayerIds,function(_68c){var _68d=this.map.getLayer(_68c);if(this._isSupportedLayerType(_68d)&&_68d._params&&_68d._params.drawMode){this.layers.push(_68d);}},this);this.refresh();},_createLegend:function(){var _68e=false;_66b.set(this.domNode,"position","relative");_66a.create("div",{id:this.id+"_msg",innerHTML:this.NLS_creatingLegend+"..."},this.domNode);var _68f=[];_665.forEach(this.layers,function(_690){if(_690.declaredClass=="esri.layers.KMLLayer"||_690.declaredClass=="esri.layers.GeoRSSLayer"){var _691;if(!_690.loaded){_666.connect(_690,"onLoad",lang.hitch(this,function(){this.refresh(this.layerInfos);}));}else{if(_690.declaredClass=="esri.layers.KMLLayer"){_691=_690.getLayers();}else{if(_690.declaredClass=="esri.layers.GeoRSSLayer"){_691=_690.getFeatureLayers();if(_690._hideLayersInLegend){_691=_665.filter(_691,function(_692){return (_665.indexOf(_690._hideLayersInLegend,_692.id)==-1);});}}}_665.forEach(_691,function(_693){if(_693.declaredClass=="esri.layers.FeatureLayer"&&_690._titleForLegend){_693._titleForLegend=_690._titleForLegend+" - ";if(_693.geometryType=="esriGeometryPoint"){_693._titleForLegend+=this.NLS_points;}else{if(_693.geometryType=="esriGeometryPolyline"){_693._titleForLegend+=this.NLS_lines;}else{if(_693.geometryType=="esriGeometryPolygon"){_693._titleForLegend+=this.NLS_polygons;}}}_68f.push(_693);}},this);}}else{if(_690.declaredClass==="esri.layers.WMSLayer"){if(!_690.loaded){_666.connect(_690,"onLoad",lang.hitch(this,function(){this.refresh(this.layerInfos);}));}else{if(_690.visible&&_690.layerInfos.length>0&&_665.some(_690.layerInfos,function(_694){return _694.legendURL;})){var _695=_690._titleForLegend||_690.name||_690.id;_66a.create("div",{innerHTML:"<span class='esriLegendServiceLabel'>"+_695+"</span>"},this.domNode);_665.forEach(_690.layerInfos,function(_696){if(_665.indexOf(_690.visibleLayers,_696.name)>-1){_66a.create("div",{innerHTML:"<img src='"+_696.legendURL+"'/>"},this.domNode);_68e=true;}},this);}}}else{_68f.push(_690);}}},this);var _697=[];_665.forEach(_68f,function(_698){if(!_698.loaded){var _699=_666.connect(_698,"onLoad",this,function(_69a){_666.disconnect(_699);_699=null;this.refresh();});}else{if(_698.visible===true&&(_698.layerInfos||_698.renderer||_698.declaredClass=="esri.layers.ArcGISImageServiceLayer")){var d=_66a.create("div",{id:this.id+"_"+_698.id,style:"display: none;","class":"esriLegendService"});_66a.create("span",{innerHTML:this._getServiceTitle(_698),"class":"esriLegendServiceLabel"},_66a.create("td",{align:(this.alignRight?"right":"left")},_66a.create("tr",{},_66a.create("tbody",{},_66a.create("table",{width:"95%"},d)))));_66a.place(d,this.id,"first");if(has("ie")){_66b.set(dom.byId(this.id+"_"+_698.id),"display","none");}if(_698.legendResponse||_698.renderer){this._createLegendForLayer(_698);}else{_697.push(this._legendRequest(_698));}}}},this);if(_697.length===0&&!_68e){dom.byId(this.id+"_msg").innerHTML=this.NLS_noLegend;this._activate();}else{var _69b=new _669(_697);_69b.addCallback(lang.hitch(this,function(_69c){if(!_68e){dom.byId(this.id+"_msg").innerHTML=this.NLS_noLegend;}else{dom.byId(this.id+"_msg").innerHTML="";}this._activate();}));}},_createLegendForLayer:function(_69d){if(_69d.legendResponse||_69d.renderer){var _69e=false;if(_69d.legendResponse){var _69f=_69d.dynamicLayerInfos||_69d.layerInfos;if(_69f){_665.forEach(_69f,function(_6a0,i){if(!_69d._hideLayersInLegend||_665.indexOf(_69d._hideLayersInLegend,_6a0.id)==-1){var f=this._buildLegendItems(_69d,_6a0,i);_69e=_69e||f;}},this);}else{if(_69d.declaredClass=="esri.layers.ArcGISImageServiceLayer"){_69e=this._buildLegendItems(_69d,{id:0,name:null,title:_69d.name,subLayerIds:null,parentLayerId:-1},0);}}}else{if(_69d.renderer){var id;if(!_69d.url){id="fc_"+_69d.id;}else{id=_69d.url.substring(_69d.url.lastIndexOf("/")+1,_69d.url.length);}_69e=this._buildLegendItems(_69d,{id:id,name:null,subLayerIds:null,parentLayerId:-1},0);}}if(_69e){_66b.set(dom.byId(this.id+"_"+_69d.id),"display","block");_66b.set(dom.byId(this.id+"_msg"),"display","none");}}},_legendRequest:function(_6a1){if(!_6a1.loaded){_666.connect(_6a1,"onLoad",lang.hitch(this,"_legendRequest"));return;}if(_6a1.version>=10.01){return this._legendRequestServer(_6a1);}else{return this._legendRequestTools(_6a1);}},_legendRequestServer:function(_6a2){var url=_6a2.url;var pos=url.indexOf("?");if(pos>-1){url=url.substring(0,pos)+"/legend"+url.substring(pos);}else{url+="/legend";}var _6a3=_6a2._getToken();if(_6a3){url+="?token="+_6a3;}var _6a4=lang.hitch(this,"_processLegendResponse");var _6a5={};_6a5.f="json";if(_6a2._params.dynamicLayers){_6a5.dynamicLayers=json.stringify(this._createDynamicLayers(_6a2));if(_6a5.dynamicLayers==="[{}]"){_6a5.dynamicLayers="[]";}}if(_6a2._params.bandIds){_6a5.bandIds=_6a2._params.bandIds;}if(_6a2._params.renderingRule){_6a5.renderingRule=_6a2._params.renderingRule;}var _6a6=_670({url:url,content:_6a5,callbackParamName:"callback",load:function(_6a7,args){_6a4(_6a2,_6a7,args);},error:_66f.defaults.io.errorHandler});return _6a6;},_legendRequestTools:function(_6a8){var p=_6a8.url.toLowerCase().indexOf("/rest/");var _6a9=_6a8.url.substring(0,p)+_6a8.url.substring(p+5,_6a8.url.length);var url=this._legendUrl+"?soapUrl="+window.escape(_6a9);if(!has("ie")||has("ie")>8){url+="&returnbytes=true";}var _6aa=lang.hitch(this,"_processLegendResponse");var _6ab={};_6ab.f="json";var _6ac=_670({url:url,content:_6ab,callbackParamName:"callback",load:function(_6ad,args){_6aa(_6a8,_6ad,args);},error:_66f.defaults.io.errorHandler});return _6ac;},_processLegendResponse:function(_6ae,_6af){if(_6af&&_6af.layers){_6ae.legendResponse=_6af;if(dom.byId(this.id+"_"+_6ae.id)){_66a.empty(dom.byId(this.id+"_"+_6ae.id));}_66a.create("span",{innerHTML:this._getServiceTitle(_6ae),"class":"esriLegendServiceLabel"},_66a.create("td",{align:(this.alignRight?"right":"left")},_66a.create("tr",{},_66a.create("tbody",{},_66a.create("table",{width:"95%"},dom.byId(this.id+"_"+_6ae.id))))));this._createLegendForLayer(_6ae);}else{console.log("Legend could not get generated for "+_6ae.url+": "+_667.toJson(_6af));}},_buildLegendItems:function(_6b0,_6b1,pos){var _6b2=false;var _6b3=dom.byId(this.id+"_"+_6b0.id);var _6b4=_6b1.subLayerIds;var _6b5=_6b1.parentLayerId;if(_6b4){var node=_66a.create("div",{id:this.id+"_"+_6b0.id+"_"+_6b1.id+"_group",style:"display: none;","class":(_6b5==-1)?((pos>0)?"esriLegendGroupLayer":""):(this.alignRight?"esriLegendRight":"esriLegendLeft")},(_6b5==-1)?_6b3:dom.byId(this.id+"_"+_6b0.id+"_"+_6b5+"_group"));if(has("ie")){_66b.set(dom.byId(this.id+"_"+_6b0.id+"_"+_6b1.id+"_group"),"display","none");}_66a.create("td",{innerHTML:_6b1.name.replace(/[\<]/g,"&lt;").replace(/[\>]/g,"&gt;"),align:(this.alignRight?"right":"left")},_66a.create("tr",{},_66a.create("tbody",{},_66a.create("table",{width:"95%","class":"esriLegendLayerLabel"},node))));}else{if(_6b0.visibleLayers&&(","+_6b0.visibleLayers+",").indexOf(","+_6b1.id+",")==-1){return _6b2;}var d=_66a.create("div",{id:this.id+"_"+_6b0.id+"_"+_6b1.id,style:"display:none;","class":(_6b5>-1)?(this.alignRight?"esriLegendRight":"esriLegendLeft"):""},(_6b5==-1)?_6b3:dom.byId(this.id+"_"+_6b0.id+"_"+_6b5+"_group"));if(has("ie")){_66b.set(dom.byId(this.id+"_"+_6b0.id+"_"+_6b1.id),"display","none");}_66a.create("td",{innerHTML:(_6b1.name)?_6b1.name.replace(/[\<]/g,"&lt;").replace(/[\>]/g,"&gt;"):"",align:(this.alignRight?"right":"left")},_66a.create("tr",{},_66a.create("tbody",{},_66a.create("table",{width:"95%","class":"esriLegendLayerLabel"},d))));if(_6b0.legendResponse){_6b2=_6b2||this._buildLegendItems_Tools(_6b0,_6b1,d);}else{if(_6b0.renderer){_6b2=_6b2||this._buildLegendItems_Renderer(_6b0,_6b1,d);}}}return _6b2;},_buildLegendItems_Tools:function(_6b6,_6b7,node){var _6b8=_6b7.parentLayerId;var _6b9=this.map.getScale();var _6ba=false;var _6bb=function(_6bc,_6bd){var i,k;for(i=0;i<_6bc.length;i++){if(_6bd.dynamicLayerInfos){for(k=0;k<_6bd.dynamicLayerInfos[k].length;k++){if(_6bd.dynamicLayerInfos[k].mapLayerId==_6bc[i].layerId){return _6bc[i];}}}else{if(_6bd.id==_6bc[i].layerId){return _6bc[i];}}}return {};};if(!this._respectCurrentMapScale||(this._respectCurrentMapScale&&this._isLayerInScale(_6b6,_6b7,_6b9))){var _6be=_6bb(_6b6.legendResponse.layers,_6b7);var _6bf=_6be.legend;if(!_6bf){}else{var _6c0=_66a.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},node);var _6c1=_66a.create("tbody",{},_6c0);if(_6b6._hoverLabel||_6b6._hoverLabels){this._createHoverAction(_6c0,_6b6,_6b7);}_665.forEach(_6bf,function(_6c2){if(_6b6.version>=10.1&&!_6c2.values&&_6bf.length>1&&(_6b6._hideDefaultSymbol||_6c2.label==="<all other values>"||!_6c2.label)){}else{if((_6c2.url&&_6c2.url.indexOf("http")===0)||(_6c2.imageData&&_6c2.imageData.length>0)){_6ba=true;this._buildRow_Tools(_6c2,_6c1,_6b6,_6b7.id);}}},this);}}if(_6ba){_66b.set(dom.byId(this.id+"_"+_6b6.id+"_"+_6b7.id),"display","block");if(_6b8>-1){_66b.set(dom.byId(this.id+"_"+_6b6.id+"_"+_6b8+"_group"),"display","block");this._findParentGroup(_6b6.id,_6b6,_6b8);}}return _6ba;},_buildRow_Tools:function(_6c3,_6c4,_6c5,_6c6){var tr=_66a.create("tr",{},_6c4);var _6c7;var _6c8;if(this.alignRight){_6c7=_66a.create("td",{align:"right"},tr);_6c8=_66a.create("td",{align:"right",width:35},tr);}else{_6c8=_66a.create("td",{width:35},tr);_6c7=_66a.create("td",{},tr);}var src=_6c3.url;if((!has("ie")||has("ie")>8)&&_6c3.imageData&&_6c3.imageData.length>0){src="data:image/png;base64,"+_6c3.imageData;}else{if(_6c3.url.indexOf("http")!==0){src=_6c5.url+"/"+_6c6+"/images/"+_6c3.url;var _6c9=_6c5._getToken();if(_6c9){src+="?token="+_6c9;}}}var img=_66a.create("img",{src:src,border:0,style:"opacity:"+_6c5.opacity},_6c8);_66a.create("td",{innerHTML:_6c3.label.replace(/[\<]/g,"&lt;").replace(/[\>]/g,"&gt;"),align:(this.alignRight?"right":"left")},_66a.create("tr",{},_66a.create("tbody",{},_66a.create("table",{width:"95%",dir:"ltr"},_6c7))));if(has("ie")<9){img.style.filter="alpha(opacity="+(_6c5.opacity*100)+")";}},_buildLegendItems_Renderer:function(_6ca,_6cb,node){var _6cc=_6cb.parentLayerId;var _6cd=this.map.getScale();var _6ce=false;if(!this._respectCurrentMapScale||this._isLayerInScale(_6ca,_6cb,_6cd)){var _6cf,_6d0;if(_6ca.renderer instanceof _672){if(_6ca.renderer.infos&&_6ca.renderer.infos.length>0){_6ce=true;_6d0=_66a.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},node);_6cf=_66a.create("tbody",{},_6d0);if(_6ca._hoverLabel||_6ca._hoverLabels){this._createHoverAction(_6d0,_6ca,_6cb);}_665.forEach(_6ca.renderer.infos,function(_6d1,_6d2){var _6d3=null;if(_6ca._editable&&_6ca.types){_6d3=this._getTemplateFromTypes(_6ca.types,_6d1.value);}var _6d4=_6d1.label;if(!_6d4||_6d4.length===0){_6d4=_6d1.value;}this._buildRow_Renderer(_6ca,_6d1.symbol,_6d4,_6d3,_6cf);},this);}}else{if(_6ca.renderer instanceof _673){if(_6ca.renderer.infos&&_6ca.renderer.infos.length>0){_6ce=true;_6d0=_66a.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},node);_6cf=_66a.create("tbody",{},_6d0);if(_6ca._hoverLabel||_6ca._hoverLabels){this._createHoverAction(_6d0,_6ca,_6cb);}_665.forEach(_6ca.renderer.infos,function(_6d5,_6d6){var _6d7=_6d5.label;if(!_6d7||_6d7.length===0){_6d7=_6d5.minValue+" - "+_6d5.maxValue;}this._buildRow_Renderer(_6ca,_6d5.symbol,_6d7,null,_6cf);},this);}}else{if(_6ca.renderer instanceof _671){_6ce=true;_6d0=_66a.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},node);_6cf=_66a.create("tbody",{},_6d0);if(_6ca._hoverLabel||_6ca._hoverLabels){this._createHoverAction(_6d0,_6ca,_6cb);}var _6d8=null;if(_6ca._editable&&_6ca.templates&&_6ca.templates.length>0){_6d8=_6ca.templates[0];}this._buildRow_Renderer(_6ca,_6ca.renderer.symbol,_6ca.renderer.label,_6d8,_6cf);}}}if(!_6ca._hideDefaultSymbol&&_6ca.renderer.defaultSymbol){_6ce=true;this._buildRow_Renderer(_6ca,_6ca.renderer.defaultSymbol,_6ca.renderer.defaultLabel?_6ca.renderer.defaultLabel:"others",null,_6cf);}}if(_6ce){_66b.set(dom.byId(this.id+"_"+_6ca.id+"_"+_6cb.id),"display","block");if(_6cc>-1){_66b.set(dom.byId(this.id+"_"+_6ca.id+"_"+_6cc+"_group"),"display","block");this._findParentGroup(_6ca.id,_6cc);}}return _6ce;},_buildRow_Renderer:function(_6d9,_6da,_6db,_6dc,_6dd){var tr=_66a.create("tr",{},_6dd);var _6de;var _6df;if(this.alignRight){_6de=_66a.create("td",{align:"right"},tr);_6df=_66a.create("td",{align:"right",width:35},tr);}else{_6df=_66a.create("td",{width:35},tr);_6de=_66a.create("td",{},tr);}var _6e0=30;var _6e1=30;if(_6da.type=="simplemarkersymbol"){_6e0=Math.min(Math.max(_6e0,_6da.size+12),125);_6e1=Math.min(Math.max(_6e1,_6da.size+12),125);}else{if(_6da.type=="picturemarkersymbol"){_6e0=Math.min(Math.max(_6e0,_6da.width),125);_6e1=Math.min(_6da.height?_6da.height:_6e1,125);}}var div=_66a.create("div",{style:"width:"+_6e0+"px;height:"+_6e1+"px;"},_6df);_66a.create("td",{innerHTML:_6db?_6db.replace(/[\<]/g,"&lt;").replace(/[\>]/g,"&gt;").replace(/^#/,""):"",align:(this.alignRight?"right":"left")},_66a.create("tr",{},_66a.create("tbody",{},_66a.create("table",{width:"95%"},_6de))));var _6e2=this._drawSymbol(div,_6da,_6e0,_6e1,_6dc,_6d9.opacity);this._surfaceItems.push(_6e2);},_drawSymbol:function(node,sym,_6e3,_6e4,_6e5,_6e6){var _6e7=_674.fromJson(sym.toJson()),rgba;if(_6e7.type==="simplelinesymbol"||_6e7.type==="cartographiclinesymbol"||_6e7.type==="textsymbol"){if(!_6e7.color){return;}rgba=_6e7.color.toRgba();rgba[3]=rgba[3]*_6e6;_6e7.color.setColor(rgba);}else{if(_6e7.type==="simplemarkersymbol"||_6e7.type==="simplefillsymbol"){if(!_6e7.color){return;}rgba=_6e7.color.toRgba();rgba[3]=rgba[3]*_6e6;_6e7.color.setColor(rgba);if(_6e7.outline&&_6e7.outline.color){rgba=_6e7.outline.color.toRgba();rgba[3]=rgba[3]*_6e6;_6e7.outline.color.setColor(rgba);}}else{if(_6e7.type==="picturemarkersymbol"){node.style.opacity=_6e6;node.style.filter="alpha(opacity=("+_6e6*100+"))";}}}var _6e8=gfx.createSurface(node,_6e3,_6e4);if(has("ie")){var _6e9=_6e8.getEventSource();_66b.set(_6e9,"position","relative");_66b.set(_6e9.parentNode,"position","relative");}var _6ea=this._getDrawingToolShape(_6e7,_6e5)||_674.getShapeDescriptors(_6e7);var _6eb;try{_6eb=_6e8.createShape(_6ea.defaultShape).setFill(_6ea.fill).setStroke(_6ea.stroke);}catch(e){_6e8.clear();_6e8.destroy();return;}var bbox=_6eb.getBoundingBox(),_6ec=bbox.width,_6ed=bbox.height,_6ee=-(bbox.x+(_6ec/2)),_6ef=-(bbox.y+(_6ed/2)),dim=_6e8.getDimensions(),_6f0={dx:_6ee+dim.width/2,dy:_6ef+dim.height/2};if(_6ec>_6e3||_6ed>_6e4){var _6f1=_6ec>_6ed?_6ec:_6ed;var _6f2=_6e3<_6e4?_6e3:_6e4;var _6f3=(_6f2-5)/_6f1;lang.mixin(_6f0,{xx:_6f3,yy:_6f3});}_6eb.applyTransform(_6f0);return _6e8;},_getDrawingToolShape:function(_6f4,_6f5){var _6f6,_6f7=_6f5?_6f5.drawingTool||null:null;switch(_6f7){case "esriFeatureEditToolArrow":_6f6={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolTriangle":_6f6={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":_6f6={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":_6f6={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":_6f6={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null;}return {defaultShape:_6f6,fill:_6f4.getFill(),stroke:_6f4.getStroke()};},_repaintItems:function(){_665.forEach(this._surfaceItems,function(_6f8){this._repaint(_6f8);},this);},_repaint:function(_6f9){if(!_6f9){return;}if(_6f9.getStroke&&_6f9.setStroke){_6f9.setStroke(_6f9.getStroke());}try{if(_6f9.getFill&&_6f9.setFill){_6f9.setFill(_6f9.getFill());}}catch(e){}if(_6f9.children&&lang.isArray(_6f9.children)){_665.forEach(_6f9.children,this._repaint,this);}},_createHoverAction:function(node,_6fa,_6fb){var _6fc=_6fa._hoverLabel||_6fa._hoverLabels[_6fb.id];if(!_6fc){return;}_6fa.mouseMoveHandler=_6fa.mouseMoveHandler||{};_6fa.mouseMoveHandler[_6fb.id]=dojo.connect(node,"onmousemove",dojo.hitch(this,function(_6fd,evt){this.mouseX=evt.clientX;this.mouseY=evt.clientY;if(this.hoverLabelShowing){this.hoverLabelShowing=false;dojo.style(dojo.byId(this.id+"_hoverLabel"),"display","none");}setTimeout(dojo.hitch(this,function(_6fe,_6ff,_700){if(_6fe==this.mouseX&&_6ff==this.mouseY&&!this.hoverLabelShowing){this.hoverLabelShowing=true;if(dojo.byId(this.id+"_hoverLabel")){var n=dojo.byId(this.id+"_hoverLabel");n.innerHTML="<span>"+_700+"</span>";dojo.style(n,"top",_6ff+"px");dojo.style(n,"left",(_6fe+15)+"px");dojo.style(n,"display","");}else{dojo.create("div",{innerHTML:"<span>"+_700+"</span>",id:this.id+"_hoverLabel","class":"esriLegendHoverLabel",style:{top:_6ff+"px",left:(_6fe+15)+"px"}},document.body);}}},evt.clientX,evt.clientY,_6fd),500);},_6fc));_6fa.mouseOutHandler=_6fa.mouseOutHandler||{};_6fa.mouseOutHandler[_6fb.id]=dojo.connect(node,"onmouseout",dojo.hitch(this,function(evt){this.mouseX=-1;this.mouseY=-1;if(this.hoverLabelShowing){this.hoverLabelShowing=false;dojo.style(dojo.byId(this.id+"_hoverLabel"),"display","none");}}));},_removeHoverHandlers:function(){_665.forEach(this.layers,function(_701){if(_701.mouseMoveHandler){for(key in _701.mouseMoveHandler){_666.disconnect(_701.mouseMoveHandler[key]);}}if(_701.mouseOutHandler){for(key in _701.mouseOutHandler){_666.disconnect(_701.mouseOutHandler[key]);}}});},_createDynamicLayers:function(_702){var _703=[],_704;var _705=_702.dynamicLayerInfos||_702.layerInfos;_665.forEach(_705,function(info){var _706={id:info.id};_706.source=info.source&&info.source.toJson();var _707;if(_702.layerDefinitions&&_702.layerDefinitions[info.id]){_707=_702.layerDefinitions[info.id];}if(_707){_706.definitionExpression=_707;}var _708;if(_702.layerDrawingOptions&&_702.layerDrawingOptions[info.id]){_708=_702.layerDrawingOptions[info.id];}if(_708){_706.drawingInfo=_708.toJson();}_706.minScale=info.minScale||0;_706.maxScale=info.maxScale||0;_703.push(_706);});return _703;},_getTemplateFromTypes:function(_709,_70a){var i;for(i=0;i<_709.length;i++){if(_709[i].id==_70a&&_709[i].templates&&_709[i].templates.length>0){return _709[i].templates[0];}}return null;},_findParentGroup:function(_70b,_70c,_70d){var k;var _70e=_70c.dynamicLayerInfos||_70c.layerInfos;for(k=0;k<_70e.length;k++){if(_70d==_70e[k].id){if(_70e[k].parentLayerId>-1){_66b.set(dom.byId(this.id+"_"+_70b+"_"+_70e[k].parentLayerId+"_group"),"display","block");this._findParentGroup(_70b,_70c,_70e[k].parentLayerId);}break;}}},_addSubLayersToHide:function(_70f){var i;if(!_70f.layer.layerInfos){return;}function _710(id,list){var _711=_70f.layer.dynamicLayerInfos||_70f.layer.layerInfos,i,k;for(i=0;i<_711.length;i++){if(_711[i].id===id&&_711[i].subLayerIds){for(k=0;k<_711[i].subLayerIds.length;k++){var _712=_711[i].subLayerIds[k];if(_665.indexOf(list,_712)===-1){list.push(_712);_710(_712,list);}}}}};_665.forEach(_70f.layer._hideLayersInLegend,function(_713){_710(_713,_70f.layer._hideLayersInLegend);});},_isLayerInScale:function(_714,_715,_716){var i;var _717=true;if(_714.legendResponse&&_714.legendResponse.layers){for(i=0;i<_714.legendResponse.layers.length;i++){var _718=_714.legendResponse.layers[i];if(_715.id==_718.layerId){var _719,_71a;if((!_714.minScale&&_714.minScale!==0)||(!_714.maxScale&&_714.maxScale!==0)){if(_718.minScale==0&&_714.tileInfo){_719=_714.tileInfo.lods[0].scale;}if(_718.maxScale==0&&_714.tileInfo){_71a=_714.tileInfo.lods[_714.tileInfo.lods.length-1].scale;}}else{_719=Math.min(_714.minScale,_718.minScale)||_714.minScale||_718.minScale;_71a=Math.max(_714.maxScale,_718.maxScale);}if((_719>0&&_719<_716)||_71a>_716){_717=false;}break;}}}else{if(_714.minScale||_714.maxScale){if((_714.minScale&&_714.minScale<_716)||_714.maxScale&&_714.maxScale>_716){_717=false;}}}return _717;},_getServiceTitle:function(_71b){var _71c=_71b._titleForLegend;if(!_71c){_71c=_71b.url;if(!_71b.url){_71c="";}else{if(_71b.url.indexOf("/MapServer")>-1){_71c=_71b.url.substring(0,_71b.url.indexOf("/MapServer"));_71c=_71c.substring(_71c.lastIndexOf("/")+1,_71c.length);}else{if(_71b.url.indexOf("/ImageServer")>-1){_71c=_71b.url.substring(0,_71b.url.indexOf("/ImageServer"));_71c=_71c.substring(_71c.lastIndexOf("/")+1,_71c.length);}else{if(_71b.url.indexOf("/FeatureServer")>-1){_71c=_71b.url.substring(0,_71b.url.indexOf("/FeatureServer"));_71c=_71c.substring(_71c.lastIndexOf("/")+1,_71c.length);}}}}if(_71b.name){if(_71c.length>0){_71c+=" - "+_71b.name;}else{_71c=_71b.name;}}}return _66d.encode(_71c);},_isSupportedLayerType:function(_71d){if(_71d&&(_71d.declaredClass==="esri.layers.ArcGISDynamicMapServiceLayer"||(_71d.declaredClass==="esri.layers.ArcGISImageServiceLayer"&&_71d.version>=10.2)||_71d.declaredClass==="esri.layers.ArcGISTiledMapServiceLayer"||_71d.declaredClass==="esri.layers.FeatureLayer"||_71d.declaredClass==="esri.layers.KMLLayer"||_71d.declaredClass==="esri.layers.GeoRSSLayer"||_71d.declaredClass==="esri.layers.WMSLayer")){return true;}return false;}});lang.mixin(_677,{ALIGN_LEFT:0,ALIGN_RIGHT:1});if(has("extend-esri")){lang.setObject("dijit.Legend",_677,_66e);}return _677;});},"dijit/form/_ListMouseMixin":function(){define("dijit/form/_ListMouseMixin",["dojo/_base/declare","dojo/mouse","dojo/on","dojo/touch","./_ListBase"],function(_71e,_71f,on,_720,_721){return _71e("dijit.form._ListMouseMixin",_721,{postCreate:function(){this.inherited(arguments);this.own(on(this.domNode,_720.press,function(evt){evt.preventDefault();}));this._listConnect(_720.press,"_onMouseDown");this._listConnect(_720.release,"_onMouseUp");this._listConnect(_71f.enter,"_onMouseOver");this._listConnect(_71f.leave,"_onMouseOut");},_onMouseDown:function(evt,_722){if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}this._isDragging=true;this._setSelectedAttr(_722);},_onMouseUp:function(evt,_723){this._isDragging=false;var _724=this.selected;var _725=this._hoveredNode;if(_724&&_723==_724){this.onClick(_724);}else{if(_725&&_723==_725){this._setSelectedAttr(_725);this.onClick(_725);}}},_onMouseOut:function(evt,_726){if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}if(this._isDragging){this._cancelDrag=(new Date()).getTime()+1000;}},_onMouseOver:function(evt,_727){if(this._cancelDrag){var time=(new Date()).getTime();if(time>this._cancelDrag){this._isDragging=false;}this._cancelDrag=null;}this._hoveredNode=_727;this.onHover(_727);if(this._isDragging){this._setSelectedAttr(_727);}}});});},"esri/dijit/editing/Update":function(){define("esri/dijit/editing/Update",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/geometry/jsonUtils","esri/OperationBase"],function(_728,lang,has,_729,_72a,_72b){var _72c=_728(_72b,{declaredClass:"esri.dijit.editing.Update",type:"edit",label:"Update Features",constructor:function(_72d){var i;_72d=_72d||{};if(!_72d.featureLayer){console.error("In constructor of 'esri.dijit.editing.Update', featureLayer not provided");return;}this._featureLayer=_72d.featureLayer;if(!_72d.preUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Update', preUpdatedGraphics not provided");return;}this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(i=0;i<_72d.preUpdatedGraphics.length;i++){this._preUpdatedGraphicsGeometries.push(_72d.preUpdatedGraphics[i].geometry.toJson());this._preUpdatedGraphicsAttributes.push(_72d.preUpdatedGraphics[i].attributes);}if(!_72d.postUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Update', postUpdatedGraphics not provided");return;}this._postUpdatedGraphics=_72d.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];for(i=0;i<_72d.postUpdatedGraphics.length;i++){this._postUpdatedGraphicsGeometries.push(_72d.postUpdatedGraphics[i].geometry.toJson());this._postUpdatedGraphicsAttributes.push(lang.clone(_72d.postUpdatedGraphics[i].attributes));}},performUndo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_72a.fromJson(this._preUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._preUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null);},performRedo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_72a.fromJson(this._postUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._postUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null);}});if(has("extend-esri")){lang.setObject("dijit.editing.Update",_72c,_729);}return _72c;});},"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"button presentation\" aria-hidden=\"true\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n","dijit/ProgressBar":function(){require({cache:{"url:dijit/templates/ProgressBar.html":"<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  data-dojo-attach-point=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&#160;</span\n\t></div\n\t><div data-dojo-attach-point=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img data-dojo-attach-point=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n"}});define("dijit/ProgressBar",["require","dojo/_base/declare","dojo/dom-class","dojo/_base/lang","dojo/number","./_Widget","./_TemplatedMixin","dojo/text!./templates/ProgressBar.html"],function(_72e,_72f,_730,lang,_731,_732,_733,_734){return _72f("dijit.ProgressBar",[_732,_733],{progress:"0",value:"",maximum:100,places:0,indeterminate:false,label:"",name:"",templateString:_734,_indeterminateHighContrastImagePath:_72e.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);if(!(this.params&&"value" in this.params)){this.value=this.indeterminate?Infinity:this.progress;}},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update();},update:function(_735){lang.mixin(this,_735||{});var tip=this.internalProgress,ap=this.domNode;var _736=1;if(this.indeterminate){ap.removeAttribute("aria-valuenow");}else{if(String(this.progress).indexOf("%")!=-1){_736=Math.min(parseFloat(this.progress)/100,1);this.progress=_736*this.maximum;}else{this.progress=Math.min(this.progress,this.maximum);_736=this.maximum?this.progress/this.maximum:0;}ap.setAttribute("aria-valuenow",this.progress);}ap.setAttribute("aria-describedby",this.labelNode.id);ap.setAttribute("aria-valuemin",0);ap.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(_736);_730.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);tip.style.width=(_736*100)+"%";this.onChange();},_setValueAttr:function(v){this._set("value",v);if(v==Infinity){this.update({indeterminate:true});}else{this.update({indeterminate:false,progress:v});}},_setLabelAttr:function(_737){this._set("label",_737);this.update();},_setIndeterminateAttr:function(_738){this.indeterminate=_738;this.update();},report:function(_739){return this.label?this.label:(this.indeterminate?"&#160;":_731.format(_739,{type:"percent",places:this.places,locale:this.lang}));},onChange:function(){}});});},"esri/layers/RenderMode":function(){define("esri/layers/RenderMode",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/io/script","esri/kernel"],function(_73a,_73b,lang,_73c,has,_73d,_73e){var _73f=_73b(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(_73a._scopeName||"dojo")+"IoScript";},initialize:function(map){this.map=map;this._init=true;},startup:function(){},propertyChangeHandler:function(type){},destroy:function(){this._init=false;},drawFeature:function(_740){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _741=this._featureMap[oid];if(_741){_741._count++;}},_decRefCount:function(oid){var _742=this._featureMap[oid];if(_742){_742._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_743){var fmap=this._featureMap,_744=fmap[oid],_745=this.featureLayer;if(!_744){fmap[oid]=_743;_745._add(_743);_743._count=0;}return _744||_743;},_removeFeatureIIf:function(oid){var _746=this._featureMap[oid],_747=this.featureLayer;if(_746){if(_746._count){return;}delete this._featureMap[oid];_747._remove(_746);}return _746;},_clearIIf:function(){var i,_748=this.featureLayer,_749=_748.graphics,_74a=_748._selectedFeatures,_74b=_748.objectIdField;for(i=_749.length-1;i>=0;i--){var _74c=_749[i];var oid=_74c.attributes[_74b];if(oid in _74a){_74c._count=1;continue;}_74c._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=_73d[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||_73d[this._prefix+id];if(dfd){try{dfd.cancel();_73d._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){_73d._validCheck(null);},_toggleVisibility:function(show){var _74d=this.featureLayer,_74e=_74d.graphics,_74f=show?"show":"hide",i,len=_74e.length;show=show&&_74d._ager;for(i=0;i<len;i++){var _750=_74e[i];_750[_74f]();if(show){_74d._repaint(_750);}}},_applyTimeFilter:function(_751){var _752=this.featureLayer;if(!_752.timeInfo||_752.suspended){return;}if(!_751){_752._fireUpdateStart();}var _753=_752._trackManager;if(_753){_753.clearTracks();}var defn=_752.getTimeDefinition(),_754=_752._getOffsettedTE(_752._mapTimeExtent);if(_754){_754=_752._getTimeOverlap(defn,_754);if(_754){var _755=_752._filterByTime(_752.graphics,_754.startTime,_754.endTime);if(_753){_753.addFeatures(_755.match);}_73c.forEach(_755.match,function(_756){var _757=_756._shape;if(!_756.visible){_756.show();_757=_756._shape;_757&&_757._moveToFront();}if(_752._ager&&_757){_752._repaint(_756);}});_73c.forEach(_755.noMatch,function(_758){if(_758.visible){_758.hide();}});}else{this._toggleVisibility(false);}}else{if(_753){_753.addFeatures(_752.graphics);}this._toggleVisibility(true);}if(_753){_753.moveLatestToFront();_753.drawTracks();}if(!_751){_752._fireUpdateEnd();}}});if(has("extend-esri")){lang.setObject("layers._RenderMode",_73f,_73e);}return _73f;});},"dojox/gauges/AnalogLineIndicator":function(){define("dojox/gauges/AnalogLineIndicator",["dojo/_base/declare","./AnalogIndicatorBase"],function(_759,_75a){return _759("dojox.gauges.AnalogLineIndicator",[_75a],{_getShapes:function(_75b){var _75c=this.direction;var _75d=this.length;if(_75c=="inside"){_75d=-_75d;}return [_75b.createLine({x1:0,y1:-this.offset,x2:0,y2:-_75d-this.offset}).setStroke({color:this.color,width:this.width})];}});});},"dojox/grid/_ViewManager":function(){define("dojox/grid/_ViewManager",["dojo/_base/declare","dojo/_base/sniff","dojo/dom-class"],function(_75e,has,_75f){return _75e("dojox.grid._ViewManager",null,{constructor:function(_760){this.grid=_760;},defaultWidth:200,views:[],resize:function(){this.onEach("resize");},render:function(){this.onEach("render");},addView:function(_761){_761.idx=this.views.length;this.views.push(_761);},destroyViews:function(){for(var i=0,v;v=this.views[i];i++){v.destroy();}this.views=[];},getContentNodes:function(){var _762=[];for(var i=0,v;v=this.views[i];i++){_762.push(v.contentNode);}return _762;},forEach:function(_763){for(var i=0,v;v=this.views[i];i++){_763(v,i);}},onEach:function(_764,_765){_765=_765||[];for(var i=0,v;v=this.views[i];i++){if(_764 in v){v[_764].apply(v,_765);}}},normalizeHeaderNodeHeight:function(){var _766=[];for(var i=0,v;(v=this.views[i]);i++){if(v.headerContentNode.firstChild){_766.push(v.headerContentNode);}}this.normalizeRowNodeHeights(_766);},normalizeRowNodeHeights:function(_767){var h=0;var _768=[];if(this.grid.rowHeight){h=this.grid.rowHeight;}else{if(_767.length<=1){return;}for(var i=0,n;(n=_767[i]);i++){if(!_75f.contains(n,"dojoxGridNonNormalizedCell")){_768[i]=n.firstChild.offsetHeight;h=Math.max(h,_768[i]);}}h=(h>=0?h:0);if((has("mozilla")||has("ie")>8)&&h){h++;}}for(i=0;(n=_767[i]);i++){if(_768[i]!=h){n.firstChild.style.height=h+"px";}}},resetHeaderNodeHeight:function(){for(var i=0,v,n;(v=this.views[i]);i++){n=v.headerContentNode.firstChild;if(n){n.style.height="";}}},renormalizeRow:function(_769){var _76a=[];for(var i=0,v,n;(v=this.views[i])&&(n=v.getRowNode(_769));i++){n.firstChild.style.height="";_76a.push(n);}this.normalizeRowNodeHeights(_76a);},getViewWidth:function(_76b){return this.views[_76b].getWidth()||this.defaultWidth;},measureHeader:function(){this.resetHeaderNodeHeight();this.forEach(function(_76c){_76c.headerContentNode.style.height="";});var h=0;this.forEach(function(_76d){h=Math.max(_76d.headerNode.offsetHeight,h);});return h;},measureContent:function(){var h=0;this.forEach(function(_76e){h=Math.max(_76e.domNode.offsetHeight,h);});return h;},findClient:function(_76f){var c=this.grid.elasticView||-1;if(c<0){for(var i=1,v;(v=this.views[i]);i++){if(v.viewWidth){for(i=1;(v=this.views[i]);i++){if(!v.viewWidth){c=i;break;}}break;}}}if(c<0){c=Math.floor(this.views.length/2);}return c;},arrange:function(l,w){var i,v,vw,len=this.views.length,self=this;var c=(w<=0?len:this.findClient());var _770=function(v,l){var ds=v.domNode.style;var hs=v.headerNode.style;if(!self.grid.isLeftToRight()){ds.right=l+"px";if(has("ff")<4){hs.right=l+v.getScrollbarWidth()+"px";}else{hs.right=l+"px";}if(!has("webkit")){hs.width=parseInt(hs.width,10)-v.getScrollbarWidth()+"px";}}else{ds.left=l+"px";hs.left=l+"px";}ds.top=0+"px";hs.top=0;};for(i=0;(v=this.views[i])&&(i<c);i++){vw=this.getViewWidth(i);v.setSize(vw,0);_770(v,l);if(v.headerContentNode&&v.headerContentNode.firstChild){vw=v.getColumnsWidth()+v.getScrollbarWidth();}else{vw=v.domNode.offsetWidth;}l+=vw;}i++;var r=w;for(var j=len-1;(v=this.views[j])&&(i<=j);j--){vw=this.getViewWidth(j);v.setSize(vw,0);vw=v.domNode.offsetWidth;r-=vw;_770(v,r);}if(c<len){v=this.views[c];vw=Math.max(1,r-l);v.setSize(vw+"px",0);_770(v,l);}return l;},renderRow:function(_771,_772,_773){var _774=[];for(var i=0,v,n,_775;(v=this.views[i])&&(n=_772[i]);i++){_775=v.renderRow(_771);n.appendChild(_775);_774.push(_775);}if(!_773){this.normalizeRowNodeHeights(_774);}},rowRemoved:function(_776){this.onEach("rowRemoved",[_776]);},updateRow:function(_777,_778){for(var i=0,v;v=this.views[i];i++){v.updateRow(_777);}if(!_778){this.renormalizeRow(_777);}},updateRowStyles:function(_779){this.onEach("updateRowStyles",[_779]);},setScrollTop:function(_77a){var top=_77a;for(var i=0,v;v=this.views[i];i++){top=v.setScrollTop(_77a);if(has("ie")&&v.headerNode&&v.scrollboxNode){v.headerNode.scrollLeft=v.scrollboxNode.scrollLeft;}}return top;},getFirstScrollingView:function(){for(var i=0,v;(v=this.views[i]);i++){if(v.hasHScrollbar()||v.hasVScrollbar()){return v;}}return null;}});});},"esri/dijit/editing/tools/SelectionTools":function(){define("esri/dijit/editing/tools/SelectionTools",["dojo/_base/lang","dojo/has","esri/layers/FeatureLayer","esri/toolbars/draw","esri/kernel"],function(lang,has,_77b,Draw,_77c){var _77d={select:{id:"btnNewSelection",_enabledIcon:"toolbarIcon newSelectionIcon",_disabledIcon:"toolbarIcon newSelectionIcon",_drawType:Draw.EXTENT,_selectMethod:_77b.SELECTION_NEW,_label:"NLS_selectionNewLbl"},selectadd:{id:"btnAddToSelection",_enabledIcon:"toolbarIcon addToSelectionIcon",_disabledIcon:"toolbarIcon addToSelectionIcon",_drawType:Draw.EXTENT,_selectMethod:_77b.SELECTION_ADD,_label:"NLS_selectionAddLbl"},selectremove:{id:"btnSubtractFromSelection",_enabledIcon:"toolbarIcon removeFromSelectionIcon",_disabledIcon:"toolbarIcon removeFromSelectionIcon",_drawType:Draw.EXTENT,_selectMethod:_77b.SELECTION_SUBTRACT,_label:"NLS_selectionRemoveLbl"},selectClear:{id:"btnClearSelection",_enabledIcon:"toolbarIcon clearSelectionIcon",_disabledIcon:"toolbarIcon clearSelectionIcon",_enabled:false,_label:"NLS_selectionClearLbl"}};if(has("extend-esri")){lang.setObject("dijit.editing.tools.SelectionTools",_77d,_77c);}return _77d;});},"dojox/form/RangeSlider":function(){require({cache:{"url:dojox/form/resources/HorizontalRangeSlider.html":"<table class=\"dijit dijitReset dijitSlider dijitSliderH dojoxRangeSlider\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\" role=\"presentation\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"topDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderDecrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper\" dojoAttachEvent=\"onmousedown:_onClkDecBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\n\t\t\t/><div role=\"presentation\" class=\"dojoxRangeSliderBarContainer\" dojoAttachPoint=\"sliderBarContainer\"\n\t\t\t\t><div dojoAttachPoint=\"sliderHandle\" tabIndex=\"${tabIndex}\" class=\"dijitSliderMoveable dijitSliderMoveableH\" dojoAttachEvent=\"onmousedown:_onHandleClick\" role=\"slider\"\n\t\t\t\t\t><div class=\"dijitSliderImageHandle dijitSliderImageHandleH\"></div\n\t\t\t\t></div\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"progressBar,focusNode\" class=\"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"></div\n\t\t\t\t><div dojoAttachPoint=\"sliderHandleMax\" tabIndex=\"${tabIndex}\" class=\"dijitSliderMoveable dijitSliderMoveableH\" dojoAttachEvent=\"onmousedown:_onHandleClickMax\" role=\"slider\"\n\t\t\t\t\t><div class=\"dijitSliderImageHandle dijitSliderImageHandleH\"></div\n\t\t\t\t></div\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH\" dojoAttachEvent=\"onmousedown:_onRemainingBarClick\"></div\n\t\t\t></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper\" dojoAttachEvent=\"onmousedown:_onClkIncBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderIncrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"containerNode,bottomDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n></table>\n","url:dojox/form/resources/VerticalRangeSlider.html":"<table class=\"dijitReset dijitSlider dijitSliderV dojoxRangeSlider\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\"\r\n\trole=\"presentation\"\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\r\n\t\t\t><div class=\"dijitSliderIncrementIconV\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"decrementButton\" dojoAttachEvent=\"onclick: increment\"><span class=\"dijitSliderButtonInner\">+</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper\" dojoAttachEvent=\"onclick:_onClkIncBumper\"></div></center\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td dojoAttachPoint=\"leftDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationL dijitSliderDecorationV\" style=\"text-align:center;height:100%;\"></td\r\n\t\t><td class=\"dijitReset\" style=\"height:100%;\"\r\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\r\n\t\t\t/><center role=\"presentation\" style=\"position:relative;height:100%;\" dojoAttachPoint=\"sliderBarContainer\"\r\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV\" dojoAttachEvent=\"onmousedown:_onRemainingBarClick\"\r\n\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle\" tabIndex=\"${tabIndex}\" class=\"dijitSliderMoveable dijitSliderMoveableV\" dojoAttachEvent=\"onkeypress:_onKeyPress,onmousedown:_onHandleClick\" style=\"vertical-align:top;\" role=\"slider\"\r\n\t\t\t\t\t\t><div class=\"dijitSliderImageHandle dijitSliderImageHandleV\"></div\r\n\t\t\t\t\t></div\r\n\t\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"progressBar,focusNode\" tabIndex=\"${tabIndex}\" class=\"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV\" dojoAttachEvent=\"onkeypress:_onKeyPress,onmousedown:_onBarClick\"\r\n\t\t\t\t\t></div\r\n\t\t\t\t\t><div dojoAttachPoint=\"sliderHandleMax\" tabIndex=\"${tabIndex}\" class=\"dijitSliderMoveable dijitSliderMoveableV\" dojoAttachEvent=\"onkeypress:_onKeyPress,onmousedown:_onHandleClickMax\" style=\"vertical-align:top;\" role=\"slider\"\r\n\t\t\t\t\t\t><div class=\"dijitSliderImageHandle dijitSliderImageHandleV\"></div\r\n\t\t\t\t\t></div\r\n\t\t\t\t></div\r\n\t\t\t></center\r\n\t\t></td\r\n\t\t><td dojoAttachPoint=\"containerNode,rightDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationR dijitSliderDecorationV\" style=\"text-align:center;height:100%;\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper\" dojoAttachEvent=\"onclick:_onClkDecBumper\"></div></center\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\r\n\t\t\t><div class=\"dijitSliderDecrementIconV\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"incrementButton\" dojoAttachEvent=\"onclick: decrement\"><span class=\"dijitSliderButtonInner\">-</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n></table>\r\n"}});define("dojox/form/RangeSlider",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/fx","dojo/_base/event","dojo/_base/sniff","dojo/dom-style","dojo/dom-geometry","dojo/keys","dijit","dojo/dnd/Mover","dojo/dnd/Moveable","dojo/text!./resources/HorizontalRangeSlider.html","dojo/text!./resources/VerticalRangeSlider.html","dijit/form/HorizontalSlider","dijit/form/VerticalSlider","dijit/form/_FormValueWidget","dijit/focus","dojo/fx","dojox/fx"],function(_77e,lang,_77f,fx,_780,has,_781,_782,keys,_783,_784,_785,_786,_787,_788,_789,_78a,_78b,_78c){var _78d=function(a,b){return b-a;},_78e=function(a,b){return a-b;};var _78f=_77e("dojox.form._RangeSliderMixin",null,{value:[0,100],postMixInProperties:function(){this.inherited(arguments);this.value=_77f.map(this.value,function(i){return parseInt(i,10);});},postCreate:function(){this.inherited(arguments);this.value.sort(this._isReversed()?_78d:_78e);var _790=this;var _791=_77e(_792,{constructor:function(){this.widget=_790;}});this._movableMax=new _785(this.sliderHandleMax,{mover:_791});this.sliderHandle.setAttribute("aria-valuemin",this.minimum);this.sliderHandle.setAttribute("aria-valuemax",this.maximum);this.sliderHandleMax.setAttribute("aria-valuemin",this.minimum);this.sliderHandleMax.setAttribute("aria-valuemax",this.maximum);var _793=_77e(_7ca,{constructor:function(){this.widget=_790;}});this._movableBar=new _785(this.progressBar,{mover:_793});this.focusNode.removeAttribute("aria-valuemin");this.focusNode.removeAttribute("aria-valuemax");this.focusNode.removeAttribute("aria-valuenow");},destroy:function(){this.inherited(arguments);this._movableMax.destroy();this._movableBar.destroy();},_onKeyPress:function(e){if(this.disabled||this.readOnly||e.altKey||e.ctrlKey){return;}var _794=e.target===this.sliderHandleMax;var _795=e.target===this.progressBar;var k=lang.delegate(keys,this.isLeftToRight()?{PREV_ARROW:keys.LEFT_ARROW,NEXT_ARROW:keys.RIGHT_ARROW}:{PREV_ARROW:keys.RIGHT_ARROW,NEXT_ARROW:keys.LEFT_ARROW});var _796=0;var down=false;switch(e.keyCode){case k.HOME:this._setValueAttr(this.minimum,true,_794);_780.stop(e);return;case k.END:this._setValueAttr(this.maximum,true,_794);_780.stop(e);return;case k.PREV_ARROW:case k.DOWN_ARROW:down=true;case k.NEXT_ARROW:case k.UP_ARROW:_796=1;break;case k.PAGE_DOWN:down=true;case k.PAGE_UP:_796=this.pageIncrement;break;default:this.inherited(arguments);return;}if(down){_796=-_796;}if(_796){if(_795){this._bumpValue([{change:_796,useMaxValue:false},{change:_796,useMaxValue:true}]);}else{this._bumpValue(_796,_794);}_780.stop(e);}},_onHandleClickMax:function(e){if(this.disabled||this.readOnly){return;}if(!has("ie")){_78b.focus(this.sliderHandleMax);}_780.stop(e);},_onClkIncBumper:function(){this._setValueAttr(this._descending===false?this.minimum:this.maximum,true,true);},_bumpValue:function(_797,_798){var _799=lang.isArray(_797)?[this._getBumpValue(_797[0].change,_797[0].useMaxValue),this._getBumpValue(_797[1].change,_797[1].useMaxValue)]:this._getBumpValue(_797,_798);this._setValueAttr(_799,true,_798);},_getBumpValue:function(_79a,_79b){var idx=_79b?1:0;if(this._isReversed()){idx=1-idx;}var s=_781.getComputedStyle(this.sliderBarContainer),c=_782.getContentBox(this.sliderBarContainer,s),_79c=this.discreteValues,_79d=this.value[idx];if(_79c<=1||_79c==Infinity){_79c=c[this._pixelCount];}_79c--;var _79e=(_79d-this.minimum)*_79c/(this.maximum-this.minimum)+_79a;if(_79e<0){_79e=0;}if(_79e>_79c){_79e=_79c;}return _79e*(this.maximum-this.minimum)/_79c+this.minimum;},_onBarClick:function(e){if(this.disabled||this.readOnly){return;}if(!has("ie")){_78b.focus(this.progressBar);}_780.stop(e);},_onRemainingBarClick:function(e){if(this.disabled||this.readOnly){return;}if(!has("ie")){_78b.focus(this.progressBar);}var _79f=_782.position(this.sliderBarContainer,true),bar=_782.position(this.progressBar,true),_7a0=e[this._mousePixelCoord]-_79f[this._startingPixelCoord],_7a1=bar[this._startingPixelCoord],_7a2=_7a1+bar[this._pixelCount],_7a3=this._isReversed()?_7a0<=_7a1:_7a0>=_7a2,p=this._isReversed()?_79f[this._pixelCount]-_7a0:_7a0;this._setPixelValue(p,_79f[this._pixelCount],true,_7a3);_780.stop(e);},_setPixelValue:function(_7a4,_7a5,_7a6,_7a7){if(this.disabled||this.readOnly){return;}var _7a8=this._getValueByPixelValue(_7a4,_7a5);this._setValueAttr(_7a8,_7a6,_7a7);},_getValueByPixelValue:function(_7a9,_7aa){_7a9=_7a9<0?0:_7aa<_7a9?_7aa:_7a9;var _7ab=this.discreteValues;if(_7ab<=1||_7ab==Infinity){_7ab=_7aa;}_7ab--;var _7ac=_7aa/_7ab;var _7ad=Math.round(_7a9/_7ac);return (this.maximum-this.minimum)*_7ad/_7ab+this.minimum;},_setValueAttr:function(_7ae,_7af,_7b0){var _7b1=this.value;if(!lang.isArray(_7ae)){if(_7b0){if(this._isReversed()){_7b1[0]=_7ae;}else{_7b1[1]=_7ae;}}else{if(this._isReversed()){_7b1[1]=_7ae;}else{_7b1[0]=_7ae;}}}else{_7b1=_7ae;}this._lastValueReported="";this.valueNode.value=this.value=_7ae=_7b1;this.value.sort(this._isReversed()?_78d:_78e);this.sliderHandle.setAttribute("aria-valuenow",_7b1[0]);this.sliderHandleMax.setAttribute("aria-valuenow",_7b1[1]);_78a.prototype._setValueAttr.apply(this,arguments);this._printSliderBar(_7af,_7b0);},_printSliderBar:function(_7b2,_7b3){var _7b4=(this.value[0]-this.minimum)/(this.maximum-this.minimum);var _7b5=(this.value[1]-this.minimum)/(this.maximum-this.minimum);var _7b6=_7b4;if(_7b4>_7b5){_7b4=_7b5;_7b5=_7b6;}var _7b7=this._isReversed()?((1-_7b4)*100):(_7b4*100);var _7b8=this._isReversed()?((1-_7b5)*100):(_7b5*100);var _7b9=this._isReversed()?((1-_7b5)*100):(_7b4*100);if(_7b2&&this.slideDuration>0&&this.progressBar.style[this._progressPixelSize]){var _7ba=_7b3?_7b5:_7b4;var _7bb=this;var _7bc={};var _7bd=parseFloat(this.progressBar.style[this._handleOffsetCoord]);var _7be=this.slideDuration/10;if(_7be===0){return;}if(_7be<0){_7be=0-_7be;}var _7bf={};var _7c0={};var _7c1={};_7bf[this._handleOffsetCoord]={start:this.sliderHandle.style[this._handleOffsetCoord],end:_7b7,units:"%"};_7c0[this._handleOffsetCoord]={start:this.sliderHandleMax.style[this._handleOffsetCoord],end:_7b8,units:"%"};_7c1[this._handleOffsetCoord]={start:this.progressBar.style[this._handleOffsetCoord],end:_7b9,units:"%"};_7c1[this._progressPixelSize]={start:this.progressBar.style[this._progressPixelSize],end:(_7b5-_7b4)*100,units:"%"};var _7c2=fx.animateProperty({node:this.sliderHandle,duration:_7be,properties:_7bf});var _7c3=fx.animateProperty({node:this.sliderHandleMax,duration:_7be,properties:_7c0});var _7c4=fx.animateProperty({node:this.progressBar,duration:_7be,properties:_7c1});var _7c5=_78c.combine([_7c2,_7c3,_7c4]);_7c5.play();}else{this.sliderHandle.style[this._handleOffsetCoord]=_7b7+"%";this.sliderHandleMax.style[this._handleOffsetCoord]=_7b8+"%";this.progressBar.style[this._handleOffsetCoord]=_7b9+"%";this.progressBar.style[this._progressPixelSize]=((_7b5-_7b4)*100)+"%";}}});var _792=_77e("dijit.form._SliderMoverMax",_783.form._SliderMover,{onMouseMove:function(e){var _7c6=this.widget;var _7c7=_7c6._abspos;if(!_7c7){_7c7=_7c6._abspos=_782.position(_7c6.sliderBarContainer,true);_7c6._setPixelValue_=lang.hitch(_7c6,"_setPixelValue");_7c6._isReversed_=_7c6._isReversed();}var _7c8=e[_7c6._mousePixelCoord]-_7c7[_7c6._startingPixelCoord];_7c6._setPixelValue_(_7c6._isReversed_?(_7c7[_7c6._pixelCount]-_7c8):_7c8,_7c7[_7c6._pixelCount],false,true);},destroy:function(e){_784.prototype.destroy.apply(this,arguments);var _7c9=this.widget;_7c9._abspos=null;_7c9._setValueAttr(_7c9.value,true);}});var _7ca=_77e("dijit.form._SliderBarMover",_784,{onMouseMove:function(e){var _7cb=this.widget;if(_7cb.disabled||_7cb.readOnly){return;}var _7cc=_7cb._abspos;var bar=_7cb._bar;var _7cd=_7cb._mouseOffset;if(!_7cc){_7cc=_7cb._abspos=_782.position(_7cb.sliderBarContainer,true);_7cb._setPixelValue_=lang.hitch(_7cb,"_setPixelValue");_7cb._getValueByPixelValue_=lang.hitch(_7cb,"_getValueByPixelValue");_7cb._isReversed_=_7cb._isReversed();}if(!bar){bar=_7cb._bar=_782.position(_7cb.progressBar,true);}if(!_7cd){_7cd=_7cb._mouseOffset=e[_7cb._mousePixelCoord]-bar[_7cb._startingPixelCoord];}var _7ce=e[_7cb._mousePixelCoord]-_7cc[_7cb._startingPixelCoord]-_7cd,_7cf=_7ce+bar[_7cb._pixelCount],_7d0=[_7ce,_7cf];_7d0.sort(_78e);if(_7d0[0]<=0){_7d0[0]=0;_7d0[1]=bar[_7cb._pixelCount];}if(_7d0[1]>=_7cc[_7cb._pixelCount]){_7d0[1]=_7cc[_7cb._pixelCount];_7d0[0]=_7cc[_7cb._pixelCount]-bar[_7cb._pixelCount];}var _7d1=[_7cb._getValueByPixelValue(_7cb._isReversed_?(_7cc[_7cb._pixelCount]-_7d0[0]):_7d0[0],_7cc[_7cb._pixelCount]),_7cb._getValueByPixelValue(_7cb._isReversed_?(_7cc[_7cb._pixelCount]-_7d0[1]):_7d0[1],_7cc[_7cb._pixelCount])];_7cb._setValueAttr(_7d1,false,false);},destroy:function(){_784.prototype.destroy.apply(this,arguments);var _7d2=this.widget;_7d2._abspos=null;_7d2._bar=null;_7d2._mouseOffset=null;_7d2._setValueAttr(_7d2.value,true);}});_77e("dojox.form.HorizontalRangeSlider",[_788,_78f],{templateString:_786});_77e("dojox.form.VerticalRangeSlider",[_789,_78f],{templateString:_787});return _78f;});},"url:dojox/form/resources/VerticalRangeSlider.html":"<table class=\"dijitReset dijitSlider dijitSliderV dojoxRangeSlider\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\"\r\n\trole=\"presentation\"\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\r\n\t\t\t><div class=\"dijitSliderIncrementIconV\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"decrementButton\" dojoAttachEvent=\"onclick: increment\"><span class=\"dijitSliderButtonInner\">+</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper\" dojoAttachEvent=\"onclick:_onClkIncBumper\"></div></center\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td dojoAttachPoint=\"leftDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationL dijitSliderDecorationV\" style=\"text-align:center;height:100%;\"></td\r\n\t\t><td class=\"dijitReset\" style=\"height:100%;\"\r\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\r\n\t\t\t/><center role=\"presentation\" style=\"position:relative;height:100%;\" dojoAttachPoint=\"sliderBarContainer\"\r\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV\" dojoAttachEvent=\"onmousedown:_onRemainingBarClick\"\r\n\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle\" tabIndex=\"${tabIndex}\" class=\"dijitSliderMoveable dijitSliderMoveableV\" dojoAttachEvent=\"onkeypress:_onKeyPress,onmousedown:_onHandleClick\" style=\"vertical-align:top;\" role=\"slider\"\r\n\t\t\t\t\t\t><div class=\"dijitSliderImageHandle dijitSliderImageHandleV\"></div\r\n\t\t\t\t\t></div\r\n\t\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"progressBar,focusNode\" tabIndex=\"${tabIndex}\" class=\"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV\" dojoAttachEvent=\"onkeypress:_onKeyPress,onmousedown:_onBarClick\"\r\n\t\t\t\t\t></div\r\n\t\t\t\t\t><div dojoAttachPoint=\"sliderHandleMax\" tabIndex=\"${tabIndex}\" class=\"dijitSliderMoveable dijitSliderMoveableV\" dojoAttachEvent=\"onkeypress:_onKeyPress,onmousedown:_onHandleClickMax\" style=\"vertical-align:top;\" role=\"slider\"\r\n\t\t\t\t\t\t><div class=\"dijitSliderImageHandle dijitSliderImageHandleV\"></div\r\n\t\t\t\t\t></div\r\n\t\t\t\t></div\r\n\t\t\t></center\r\n\t\t></td\r\n\t\t><td dojoAttachPoint=\"containerNode,rightDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationR dijitSliderDecorationV\" style=\"text-align:center;height:100%;\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper\" dojoAttachEvent=\"onclick:_onClkDecBumper\"></div></center\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\r\n\t\t\t><div class=\"dijitSliderDecrementIconV\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"incrementButton\" dojoAttachEvent=\"onclick: decrement\"><span class=\"dijitSliderButtonInner\">-</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n></table>\r\n","dijit/form/NumberTextBox":function(){define("dijit/form/NumberTextBox",["dojo/_base/declare","dojo/_base/lang","dojo/number","./RangeBoundTextBox"],function(_7d3,lang,_7d4,_7d5){var _7d6=_7d3("dijit.form.NumberTextBoxMixin",null,{pattern:_7d4.regexp,value:NaN,editOptions:{pattern:"#.######"},_formatter:_7d4.format,postMixInProperties:function(){this.inherited(arguments);this._set("type","text");},_setConstraintsAttr:function(_7d7){var _7d8=typeof _7d7.places=="number"?_7d7.places:0;if(_7d8){_7d8++;}if(typeof _7d7.max!="number"){_7d7.max=9*Math.pow(10,15-_7d8);}if(typeof _7d7.min!="number"){_7d7.min=-9*Math.pow(10,15-_7d8);}this.inherited(arguments,[_7d7]);if(this.focusNode&&this.focusNode.value&&!isNaN(this.value)){this.set("value",this.value);}},_onFocus:function(){if(this.disabled){return;}var val=this.get("value");if(typeof val=="number"&&!isNaN(val)){var _7d9=this.format(val,this.constraints);if(_7d9!==undefined){this.textbox.value=_7d9;}}this.inherited(arguments);},format:function(_7da,_7db){var _7dc=String(_7da);if(typeof _7da!="number"){return _7dc;}if(isNaN(_7da)){return "";}if(!("rangeCheck" in this&&this.rangeCheck(_7da,_7db))&&_7db.exponent!==false&&/\de[-+]?\d/i.test(_7dc)){return _7dc;}if(this.editOptions&&this.focused){_7db=lang.mixin({},_7db,this.editOptions);}return this._formatter(_7da,_7db);},_parser:_7d4.parse,parse:function(_7dd,_7de){var v=this._parser(_7dd,lang.mixin({},_7de,(this.editOptions&&this.focused)?this.editOptions:{}));if(this.editOptions&&this.focused&&isNaN(v)){v=this._parser(_7dd,_7de);}return v;},_getDisplayedValueAttr:function(){var v=this.inherited(arguments);return isNaN(v)?this.textbox.value:v;},filter:function(_7df){return (_7df==null||_7df==="")?NaN:this.inherited(arguments);},serialize:function(_7e0,_7e1){return (typeof _7e0!="number"||isNaN(_7e0))?"":this.inherited(arguments);},_setBlurValue:function(){var val=lang.hitch(lang.mixin({},this,{focused:true}),"get")("value");this._setValueAttr(val,true);},_setValueAttr:function(_7e2,_7e3,_7e4){if(_7e2!==undefined&&_7e4===undefined){_7e4=String(_7e2);if(typeof _7e2=="number"){if(isNaN(_7e2)){_7e4="";}else{if(("rangeCheck" in this&&this.rangeCheck(_7e2,this.constraints))||this.constraints.exponent===false||!/\de[-+]?\d/i.test(_7e4)){_7e4=undefined;}}}else{if(!_7e2){_7e4="";_7e2=NaN;}else{_7e2=undefined;}}}this.inherited(arguments,[_7e2,_7e3,_7e4]);},_getValueAttr:function(){var v=this.inherited(arguments);if(isNaN(v)&&this.textbox.value!==""){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+_7d4._realNumberRegexp(lang.mixin({},this.constraints))+"$").test(this.textbox.value))){var n=Number(this.textbox.value);return isNaN(n)?undefined:n;}else{return undefined;}}else{return v;}},isValid:function(_7e5){if(!this.focused||this._isEmpty(this.textbox.value)){return this.inherited(arguments);}else{var v=this.get("value");if(!isNaN(v)&&this.rangeCheck(v,this.constraints)){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)){return true;}else{return this.inherited(arguments);}}else{return false;}}}});var _7e6=_7d3("dijit.form.NumberTextBox",[_7d5,_7d6],{baseClass:"dijitTextBox dijitNumberTextBox"});_7e6.Mixin=_7d6;return _7e6;});},"dojo/promise/all":function(){define(["../_base/array","../Deferred","../when"],function(_7e7,_7e8,when){"use strict";var some=_7e7.some;return function all(_7e9){var _7ea,_7e7;if(_7e9 instanceof Array){_7e7=_7e9;}else{if(_7e9&&typeof _7e9==="object"){_7ea=_7e9;}}var _7eb;var _7ec=[];if(_7ea){_7e7=[];for(var key in _7ea){if(Object.hasOwnProperty.call(_7ea,key)){_7ec.push(key);_7e7.push(_7ea[key]);}}_7eb={};}else{if(_7e7){_7eb=[];}}if(!_7e7||!_7e7.length){return new _7e8().resolve(_7eb);}var _7ed=new _7e8();_7ed.promise.always(function(){_7eb=_7ec=null;});var _7ee=_7e7.length;some(_7e7,function(_7ef,_7f0){if(!_7ea){_7ec.push(_7f0);}when(_7ef,function(_7f1){if(!_7ed.isFulfilled()){_7eb[_7ec[_7f0]]=_7f1;if(--_7ee===0){_7ed.resolve(_7eb);}}},_7ed.reject);return _7ed.isFulfilled();});return _7ed.promise;};});},"esri/toolbars/_GraphicMover":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/json","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/Mover","dojox/gfx/matrix","esri/kernel","esri/geometry/webMercatorUtils","esri/geometry/ScreenPoint"],function(_7f2,lang,_7f3,_7f4,has,_7f5,_7f6,_7f7,_7f8,_7f9,_7fa,_7fb){var GM=_7f2(null,{declaredClass:"esri.toolbars._GraphicMover",constructor:function(_7fc,map,_7fd){this.graphic=_7fc;this.map=map;this.toolbar=_7fd;this._enableGraphicMover();this._moved=false;},refresh:function(_7fe){var _7ff=this.graphic.getDojoShape();if(_7ff&&(_7fe||!_7ff._hostGraphic)){this._disableGraphicMover();this._enableGraphicMover();}},destroy:function(){this._disableGraphicMover();},hasMoved:function(){return this._moved;},_enableGraphicMover:function(){var _800=this.graphic,_801=_800.getDojoShape();if(_801){_801._hostGraphic=_800;this._moveable=new _7f6(_801,{mover:GM.Mover});this._moveStartHandle=_7f3.connect(this._moveable,"onMoveStart",this,this._moveStartHandler);this._firstMoveHandle=_7f3.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_7f3.connect(this._moveable,"onMoving",this,this._movingHandler);this._moveStopHandle=_7f3.connect(this._moveable,"onMoveStop",this,this._moveStopHandler);var node=_801.getEventSource();if(node){_7f5.set(node,"cursor",this.toolbar._cursors.move);}}},_disableGraphicMover:function(){var _802=this._moveable;if(_802){_7f3.disconnect(this._moveStartHandle);_7f3.disconnect(this._firstMoveHandle);_7f3.disconnect(this._movingHandle);_7f3.disconnect(this._moveStopHandle);var _803=_802.shape;if(_803){_803._hostGraphic=null;var node=_803.getEventSource();if(node){_7f5.set(node,"cursor",null);}}_802.destroy();}this._moveable=null;},_moveStartHandler:function(){var _804=this.graphic,map=this.map;this._startTx=_804.getDojoShape().getTransform();if(this.graphic.geometry.type==="point"){if(map.snappingManager){map.snappingManager._setUpSnapping();}}this.toolbar.onGraphicMoveStart(_804);},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic);},_movingHandler:function(_805){this.toolbar.onGraphicMove(this.graphic,_805.shape.getTransform());},_moveStopHandler:function(_806){var _807=this.graphic,_808=this.toolbar,map=this.map,mx=_7f8,_809=_808._geo?_7fa.geographicToWebMercator(_807.geometry):_807.geometry,type=_809.type,_80a=_807.getDojoShape(),tx=_80a.getTransform();if(_7f4.toJson(tx)!==_7f4.toJson(this._startTx)){this._moved=true;switch(type){case "point":var _80b=[tx,mx.invert(this._startTx)],_80c;if(map.snappingManager){_80c=map.snappingManager._snappingPoint;}_809=_80c||map.toMap(mx.multiplyPoint(_80b,map.toScreen(_809,true)));if(map.snappingManager){map.snappingManager._killOffSnapping();}break;case "polyline":_809=this._updatePolyGeometry(_809,_809.paths,tx);break;case "polygon":_809=this._updatePolyGeometry(_809,_809.rings,tx);break;}_80a.setTransform(null);_807.setGeometry(_808._geo?_7fa.webMercatorToGeographic(_809,true):_809);}else{this._moved=false;}_808._endOperation("MOVE");_808.onGraphicMoveStop(_807,tx);if(!this._moved){var e=_806.__e,_80d=this.map.position,pt=new _7fb(e.pageX-_80d.x,e.pageY-_80d.y);_808.onGraphicClick(_807,{screenPoint:pt,mapPoint:this.map.toMap(pt)});}},_updatePolyGeometry:function(_80e,_80f,_810){var map=this.map,_811=_80e.getPoint(0,0),_812=map.toMap(map.toScreen(_811).offset(_810.dx,_810.dy)),_813=_812.x-_811.x,_814=_812.y-_811.y,i,j,seg,_815;for(i=0;i<_80f.length;i++){seg=_80f[i];for(j=0;j<seg.length;j++){_815=_80e.getPoint(i,j);_80e.setPoint(i,j,_815.offset(_813,_814));}}return _80e;}});GM.Mover=_7f2(_7f7,{declaredClass:"esri.toolbars._Mover",constructor:function(_816,e,host){this.__e=e;}});if(has("extend-esri")){lang.setObject("toolbars._GraphicMover",GM,_7f9);lang.setObject("toolbars._Mover",GM.Mover,_7f9);}return GM;});},"dojox/main":function(){define("dojox/main",["dojo/_base/kernel"],function(dojo){return dojo.dojox;});},"esri/dijit/Geocoder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/_base/event","dojo/dom-attr","dojo/dom-class","dojo/dom-style","dojo/dom-construct","dojo/json","dojo/keys","dojo/on","dojo/query","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/templates/Geocoder.html","dojo/uacss","dijit/_OnDijitClickMixin","dijit/_TemplatedMixin","dijit/_WidgetBase","dijit/focus","esri/kernel","esri/SpatialReference","esri/graphic","esri/request","esri/dijit/_EventedWidget","esri/geometry/Point","esri/geometry/Extent","esri/tasks/locator"],function(_817,lang,_818,_819,_81a,_81b,_81c,_81d,JSON,keys,on,_81e,i18n,_81f,has,_820,_821,_822,_823,_824,_825,_826,_827,_828,_829,_82a,_82b){var _82c=_817([_828,_820,_821],{declaredClass:"esri.dijit.Geocoder",templateString:_81f,_eventMap:{"select":["result"],"find-results":["results"],"auto-complete":["results"],"geocoder-select":["geocoder"],"clear":true,"enter-key-select":true,"load":true},constructor:function(_82d,_82e){var _82f=this;_82f._setPublicDefaults();_817.safeMixin(_82f,_82d);_82f._setPrivateDefaults();_82f.watch("value",_82f._updateValue);_82f.watch("theme",_82f._updateTheme);_82f.watch("activeGeocoder",_82f._setActiveGeocoder);_82f.watch("activeGeocoderIndex",_82f._setActiveGeocoderIndex);_82f.watch("geocoder",_82f._updateGeocoder);_82f.watch("arcgisGeocoder",_82f._updateGeocoder);_82f.domNode=_82e;},startup:function(){var _830=this;if(!_830._geocoders.length){console.log("No geocoders defined.");_830.destroy();return;}if(!_830.domNode){console.log("domNode is undefined.");_830.destroy();return;}if(_830.get("value")){_830._checkStatus();}if(_830.map){if(_830.map.loaded){_830._init();}else{on(_830.map,"load",function(){_830._init();});}}else{_830._init();}},postCreate:function(){var _831=this;_831._updateGeocoder();_831._setDelegations();},destroy:function(){var i;var _832=this;if(_832._delegations){for(i=0;i<_832._delegations.length;i++){_832._delegations[i].remove();}}_81d.empty(_832.domNode);_832.inherited(arguments);},clear:function(){var _833=this;_833.onClear();_81a.set(_833.inputNode,"value","");_833.set("value","");_833.results=[];_81b.remove(_833.containerNode,_833._hasValueClass);_81a.set(_833.clearNode,"title","");_833._hideMenus();_833._hideLoading();},show:function(){var _834=this;_81c.set(_834.domNode,"display","block");},hide:function(){var _835=this;_81c.set(_835.domNode,"display","none");},find:function(_836){var _837=this;var def=new _818();if(_836){if(typeof _836==="string"){_837._queryDeferred(_836).then(function(resp){def.resolve(resp);});}else{if(typeof _836==="object"&&_836.hasOwnProperty("geometry")){var _838;switch(_836.geometry.type){case "extent":_838=_836.geometry.getCenter();break;case "multipoint":_838=_836.geometry.getExtent().getCenter();break;case "point":_838=_836.geometry;break;case "polygon":_838=_836.geometry.getExtent().getCenter();break;case "polyline":_838=_836.geometry.getExtent().getCenter();break;}if(_838){_837._reverseGeocodePoint(_838,_836.geometry).then(function(resp){if(resp.results[0]){if(_836.hasOwnProperty("attributes")){resp.results[0].feature.setAttributes(lang.mixin(resp.results[0].feature.attributes,_836.attributes));}if(_836.hasOwnProperty("infoTemplate")){resp.results[0].feature.setInfoTemplate(_836.infoTemplate);}if(_836.hasOwnProperty("symbol")){resp.results[0].feature.setSymbol(_836.symbol);}}def.resolve(resp);},function(_839){def.reject(_839);});}}else{if(typeof _836==="object"&&_836.type==="point"){_837._reverseGeocodePoint(_836).then(function(resp){def.resolve(resp);},function(_83a){def.reject(_83a);});}else{if(_836 instanceof Array&&_836.length===2){var pt=new _829(_836,new _825({wkid:4326}));_837._reverseGeocodePoint(pt).then(function(resp){def.resolve(resp);},function(_83b){def.reject(_83b);});}else{def.reject("Invalid find type");}}}}}else{_837._queryDeferred(_837.get("value")).then(function(resp){def.resolve(resp);});}return def;},focus:function(){var _83c=this;_823.focus(_83c.inputNode);},blur:function(){if(_823.curNode){_823.curNode.blur();}},select:function(e){var _83d=this;_83d.onSelect(e);_83d._hideMenus();_83d._hideLoading();if(_83d.autoNavigate&&e&&e.hasOwnProperty("extent")&&_83d.map){_83d.map.setExtent(e.extent);}},onSelect:function(){},onFindResults:function(){},onAutoComplete:function(){},onGeocoderSelect:function(){},onClear:function(){},onEnterKeySelect:function(){},onLoad:function(){},_init:function(){var _83e=this;_83e.loaded=true;_83e.onLoad();_83e._hideMenus();},_queryDeferred:function(_83f){var _840=this;var def=new _818();_840._query({delay:0,search:_83f}).then(function(_841){_840.onFindResults(_841);def.resolve(_841);},function(_842){_840.onFindResults(_842);def.reject(_842);});return def;},_reverseGeocodePoint:function(pt,_843){var def=new _818();var _844=this;if(pt&&_844.activeGeocoder){var geo=_843||pt;_844._reverseTask=new _82b(_844.activeGeocoder.url);_844._reverseTask.outSpatialReference=_844._defaultSR;if(_844.map){_844._reverseTask.outSpatialReference=_844.map.spatialReference;}var _845=_844.activeGeocoder.distance||1500;_844._reverseTask.locationToAddress(pt,_845,function(_846){var _847=_844._hydrateResult(_846);var obj={"results":[_847],"geometry":geo};_844.onFindResults(obj);def.resolve(obj);},function(_848){def.reject(_848);});}else{def.reject("no point or active geocoder defined");}return def;},_setPublicDefaults:function(){var _849=this;_849.autoComplete=false;_849.arcgisGeocoder=true;_849.set("value","");_849.set("theme","simpleGeocoder");_849.activeGeocoderIndex=0;_849.maxLocations=6;_849.minCharacters=3;_849.searchDelay=350;_849.geocoderMenu=true;_849.autoNavigate=true;_849.showResults=true;},_setPrivateDefaults:function(){var _84a=this;_84a._i18n=i18n;_84a._deferreds=[];_84a.results=[];_84a._defaultSR=new _825(4326);_84a._GeocoderContainerClass="esriGeocoderContainer";_84a._GeocoderClass="esriGeocoder";_84a._GeocoderMultipleClass="esriGeocoderMultiple";_84a._GeocoderIconClass="esriGeocoderIcon";_84a._GeocoderActiveClass="esriGeocoderActive";_84a._loadingClass="esriGeocoderLoading";_84a._resultsContainerClass="esriGeocoderResults";_84a._resultsItemClass="esriGeocoderResult";_84a._resultsItemEvenClass="esriGeocoderResultEven";_84a._resultsItemOddClass="esriGeocoderResultOdd";_84a._resultsItemFirstClass="esriGeocoderResultFirst";_84a._resultsItemLastClass="esriGeocoderResultLast";_84a._resultsPartialMatchClass="esriGeocoderResultPartial";_84a._searchButtonClass="esriGeocoderSearch";_84a._clearButtonClass="esriGeocoderReset";_84a._hasValueClass="esriGeocoderHasValue";_84a._geocoderMenuClass="esriGeocoderMenu";_84a._geocoderMenuHeaderClass="esriGeocoderMenuHeader";_84a._geocoderMenuCloseClass="esriGeocoderMenuClose";_84a._activeMenuClass="esriGeocoderMenuActive";_84a._geocoderMenuArrowClass="esriGeocoderMenuArrow";_84a._geocoderSelectedClass="esriGeocoderSelected";_84a._geocoderSelectedCheckClass="esriGeocoderSelectedCheck";_84a._GeocoderClearClass="esriGeocoderClearFloat";},_setEsriGeocoder:function(){var _84b=this;if(_84b.arcgisGeocoder){if(typeof _84b.arcgisGeocoder==="object"){_84b._arcgisGeocoder=_84b.arcgisGeocoder;}else{_84b._arcgisGeocoder={};}if(!_84b._arcgisGeocoder.url){_84b._arcgisGeocoder.url=location.protocol+"//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer";}if(!_84b._arcgisGeocoder.name){_84b._arcgisGeocoder.name=i18n.widgets.Geocoder.esriGeocoderName;}if(!_84b._arcgisGeocoder.hasOwnProperty("localSearchOptions")){_84b._arcgisGeocoder.localSearchOptions={minScale:150000,distance:12000};}_84b.arcgisGeocoder=_84b._arcgisGeocoder;}else{_84b.arcgisGeocoder=false;}},_setActiveGeocoder:function(){var _84c=this;_84c.activeGeocoder=_84c._geocoders[_84c.activeGeocoderIndex];_84c._updatePlaceholder();},_setGeocoderList:function(){var _84d=this;var _84e=[];if(_84d.arcgisGeocoder){_84e=_84e.concat([_84d._arcgisGeocoder]);}if(_84d.geocoders&&_84d.geocoders.length){_84e=_84e.concat(_84d.geocoders);}_84d._geocoders=_84e;},_updateGeocoder:function(){var _84f=this;_84f.set("activeGeocoderIndex",0);_84f._setEsriGeocoder();_84f._setGeocoderList();_84f._setActiveGeocoder();_84f._insertGeocoderMenuItems();},_updatePlaceholder:function(){var _850=this;_850._placeholder="";if(_850.activeGeocoder&&_850.activeGeocoder.placeholder){_850._placeholder=_850.activeGeocoder.placeholder;}_81a.set(_850.inputNode,"placeholder",_850._placeholder);_81a.set(_850.submitNode,"title",_850._placeholder);},_updateValue:function(attr,_851,_852){var _853=this;if(!_853._ignoreUpdateValue){_81a.set(_853.inputNode,"value",_852);_853._checkStatus();}},_updateTheme:function(attr,_854,_855){var _856=this;_81b.remove(_856.domNode,_854);_81b.add(_856.domNode,_855);},_setActiveGeocoderIndex:function(attr,_857,_858){var _859=this;_859.activeGeocoderIndex=_858;_859._setActiveGeocoder();_859._hideMenus();_859._insertGeocoderMenuItems();var evt={attr:_859.activeGeocoder,oldVal:_857,newVal:_858};_859.onGeocoderSelect(evt);},_query:function(e){var _85a=this;if(!e){e={delay:0};}if(!e.search){e.search=_85a.get("value");}var def=new _818();_85a._deferreds.push(def);_85a._queryTimer=setTimeout(function(){_85a._performQuery(def,e);},e.delay);return def;},_performQuery:function(def,e){var _85b=this;if(e.search){_85b._hideGeolocatorMenu();_85b._showLoading();var _85c;var _85d=_85b.activeGeocoder.outFields||"";var _85e="";if(_85b.activeGeocoder.prefix){_85e+=_85b.activeGeocoder.prefix;}_85e+=e.search;if(_85b.activeGeocoder.suffix){_85e+=_85b.activeGeocoder.suffix;}if(_85b.activeGeocoder===_85b._arcgisGeocoder){var _85f=_85b._defaultSR;if(_85b.map){_85f=_85b.map.spatialReference;}_85c={"text":_85e,"outSR":_85f.wkid||JSON.stringify(_85f.toJson()),"f":"json"};if(_85b.map&&_85b.activeGeocoder.localSearchOptions&&_85b.activeGeocoder.localSearchOptions.hasOwnProperty("distance")&&_85b.activeGeocoder.localSearchOptions.hasOwnProperty("minScale")){var _860=_85b.map.extent.getCenter().normalize();var _861=_85b.map.getScale();if(!_85b.activeGeocoder.localSearchOptions.minScale||(_861&&_861<=parseFloat(_85b.activeGeocoder.localSearchOptions.minScale))){_85c.location=JSON.stringify(_860.toJson());_85c.distance=_85b.activeGeocoder.localSearchOptions.distance;}}if(_85d){_85c.outFields=_85d;}if(_85b.maxLocations){_85c.maxLocations=_85b.maxLocations;}if(_85b.activeGeocoder.sourceCountry){_85c.sourceCountry=_85b.activeGeocoder.sourceCountry;}if(_85b.activeGeocoder.searchExtent){var bbox={"xmin":_85b.activeGeocoder.searchExtent.xmin,"ymin":_85b.activeGeocoder.searchExtent.ymin,"xmax":_85b.activeGeocoder.searchExtent.xmax,"ymax":_85b.activeGeocoder.searchExtent.ymax,"spatialReference":_85b.activeGeocoder.searchExtent.spatialReference.toJson()};_85c.bbox=JSON.stringify(bbox);}_827({url:_85b.activeGeocoder.url+"/find",content:_85c,handleAs:"json",callbackParamName:"callback",load:function(_862){_85b._receivedResults(_862.locations,def);}});}else{_85c={address:{}};if(_85b.activeGeocoder.singleLineFieldName){_85c.address[_85b.activeGeocoder.singleLineFieldName]=_85e;}else{_85c.address["Single Line Input"]=_85e;}if(_85d){_85c.outFields=[_85d];}if(_85b.activeGeocoder.searchExtent){_85c.searchExtent=_85b.activeGeocoder.searchExtent;}_85b._task=new _82b(_85b.activeGeocoder.url);_85b._task.outSpatialReference=_85b._defaultSR;if(_85b.map){_85b._task.outSpatialReference=_85b.map.spatialReference;}_85b._task.addressToLocations(_85c,function(_863){_85b._receivedResults(_863,def);},function(_864){_85b._receivedResults(_864,def);});}}else{_85b._hideLoading();def.reject("no search to perform");}},_showResults:function(){var _865=this;_865._hideGeolocatorMenu();var html="";if(_865.results&&_865.results.length&&_865.resultsNode){var _866=_865.get("value"),i;var _867=new RegExp("("+_866+")","gi");html+="<ul role=\"presentation\">";for(i=0;i<_865.results.length;++i){var _868=_865._resultsItemClass+" ";if(i%2===0){_868+=_865._resultsItemOddClass;}else{_868+=_865._resultsItemEvenClass;}if(i===0){_868+=" "+_865._resultsItemFirstClass;}else{if(i===(_865.results.length-1)){_868+=" "+_865._resultsItemLastClass;}}html+="<li data-text=\""+_865.results[i].name+"\" data-item=\"true\" data-index=\""+i+"\" role=\"menuitem\" tabindex=\"0\" class=\""+_868+"\">"+_865.results[i].name.replace(_867,"<strong class=\""+_865._resultsPartialMatchClass+"\">"+_866+"</strong>")+"</li>";}html+="</ul>";if(_865.resultsNode){_865.resultsNode.innerHTML=html;}_865._showResultsMenu();}},_autocomplete:function(){var _869=this;_869._query({delay:_869.searchDelay,search:_869.get("value")}).then(function(_86a){_869.onAutoComplete(_86a);if(_869.showResults){_869._showResults(_86a);}});},_receivedResults:function(_86b,def){var _86c=this;_86c._hideLoading();var _86d=_86c._hydrateResults(_86b);_86c.results=_86d;var obj={"results":_86d,"value":_86c.get("value")};def.resolve(obj);},_showLoading:function(){var _86e=this;_81b.add(_86e.containerNode,_86e._loadingClass);},_hideLoading:function(){var _86f=this;_81b.remove(_86f.containerNode,_86f._loadingClass);},_showGeolocatorMenu:function(){var _870=this;_81b.add(_870.containerNode,_870._activeMenuClass);_81c.set(_870.geocoderMenuNode,"display","block");_81a.set(_870.geocoderMenuInsertNode,"aria-hidden","false");_81a.set(_870.geocoderMenuArrowNode,"aria-expanded","true");},_hideGeolocatorMenu:function(){var _871=this;_81b.remove(_871.containerNode,_871._activeMenuClass);_81c.set(_871.geocoderMenuNode,"display","none");_81a.set(_871.geocoderMenuInsertNode,"aria-hidden","true");_81a.set(_871.geocoderMenuArrowNode,"aria-expanded","false");},_toggleGeolocatorMenu:function(){var _872=this;_872._hideResultsMenu();var _873=_81c.get(_872.geocoderMenuNode,"display");if(_873==="block"){_872._hideGeolocatorMenu();}else{_872._showGeolocatorMenu();}},_showResultsMenu:function(){var _874=this;_81b.add(_874.containerNode,_874._GeocoderActiveClass);_81c.set(_874.resultsNode,"display","block");_81a.set(_874.resultsNode,"aria-hidden","false");},_hideResultsMenu:function(){var _875=this;_81c.set(_875.resultsNode,"display","none");_81b.remove(_875.containerNode,_875._GeocoderActiveClass);_81a.set(_875.resultsNode,"aria-hidden","true");},_hideMenus:function(){var _876=this;_876._hideGeolocatorMenu();_876._hideResultsMenu();},_insertGeocoderMenuItems:function(){var _877=this;if(_877.geocoderMenu&&_877._geocoders.length>1){var html="";var _878="",i;html+="<ul role=\"presentation\">";for(i=0;i<_877._geocoders.length;i++){_878=_877._resultsItemClass+" ";if(i%2===0){_878+=_877._resultsItemOddClass;}else{_878+=_877._resultsItemEvenClass;}if(i===_877.activeGeocoderIndex){_878+=" "+_877._geocoderSelectedClass;}if(i===0){_878+=" "+_877._resultsItemFirstClass;}else{if(i===(_877._geocoders.length-1)){_878+=" "+_877._resultsItemLastClass;}}var _879=_877._geocoders[i].name||i18n.widgets.Geocoder.main.untitledGeocoder;html+="<li data-index=\""+i+"\" data-item=\"true\" role=\"menuitem\" tabindex=\"0\" class=\""+_878+"\">";html+="<div class=\""+_877._geocoderSelectedCheckClass+"\"></div>";html+=_879;html+="<div class=\""+_877._GeocoderClearClass+"\"></div>";html+="</li>";}html+="</ul>";_877.geocoderMenuInsertNode.innerHTML=html;_81c.set(_877.geocoderMenuNode,"display","none");_81c.set(_877.geocoderMenuArrowNode,"display","block");_81b.add(_877.containerNode,_877._GeocoderMultipleClass);}else{_877.geocoderMenuInsertNode.innerHTML="";_81c.set(_877.geocoderMenuNode,"display","none");_81c.set(_877.geocoderMenuArrowNode,"display","none");_81b.remove(_877.containerNode,_877._GeocoderMultipleClass);}},_checkStatus:function(){var _87a=this;if(_87a.get("value")){_81b.add(_87a.containerNode,_87a._hasValueClass);_81a.set(_87a.clearNode,"title",i18n.widgets.Geocoder.main.clearButtonTitle);}else{_87a.clear();}},_setDelegations:function(){var _87b=this;_87b._delegations=[];var _87c=on(document,"click",function(e){_87b._hideResultsMenu(e);});_87b._delegations.push(_87c);var _87d=on(_87b.inputNode,"keyup",function(e){_87b._inputKeyUp(e);});_87b._delegations.push(_87d);var _87e=on(_87b.inputNode,"keydown",function(e){_87b._inputKeyDown(e);});_87b._delegations.push(_87e);var _87f=on(_87b.geocoderMenuArrowNode,"keydown",_87b._geocoderMenuButtonKeyDown());_87b._delegations.push(_87f);var _880=on(_87b.resultsNode,"[data-item=\"true\"]:click, [data-item=\"true\"]:keydown",function(e){clearTimeout(_87b._queryTimer);var _881=_81e("[data-item=\"true\"]",_87b.resultsNode);var _882=parseInt(_81a.get(this,"data-index"),10);var _883=_81a.get(this,"data-text");var _884;if(e.type==="click"||(e.type==="keydown"&&e.keyCode===keys.ENTER)){_81a.set(_87b.inputNode,"value",_883);_87b.set("value",_883);if(_87b.results&&_87b.results[_882]){_87b.select(_87b.results[_882]);}}else{if(e.type==="keydown"&&e.keyCode===keys.UP_ARROW){_819.stop(e);_884=_882-1;if(_884<0){_87b.inputNode.focus();}else{_881[_884].focus();}}else{if(e.type==="keydown"&&e.keyCode===keys.DOWN_ARROW){_819.stop(e);_884=_882+1;if(_884>=_881.length){_87b.inputNode.focus();}else{_881[_884].focus();}}else{if(e.keyCode===keys.ESCAPE){_87b._hideMenus();}}}}});_87b._delegations.push(_880);var _885=on(_87b.geocoderMenuInsertNode,"[data-item=\"true\"]:click, [data-item=\"true\"]:keydown",function(e){var _886=_81e("[data-item=\"true\"]",_87b.geocoderMenuInsertNode);var _887=parseInt(_81a.get(this,"data-index"),10);var _888;if(e.type==="click"||(e.type==="keydown"&&e.keyCode===keys.ENTER)){_87b._setActiveGeocoderIndex(null,null,_887);_87b._hideGeolocatorMenu();}else{if(e.type==="keydown"&&e.keyCode===keys.UP_ARROW){_819.stop(e);_888=_887-1;if(_888<0){_87b.geocoderMenuArrowNode.focus();}else{_886[_888].focus();}}else{if(e.type==="keydown"&&e.keyCode===keys.DOWN_ARROW){_819.stop(e);_888=_887+1;if(_888>=_886.length){_87b.geocoderMenuArrowNode.focus();}else{_886[_888].focus();}}else{if(e.keyCode===keys.ESCAPE){_87b._hideGeolocatorMenu();}}}}});_87b._delegations.push(_885);},_findThenSelect:function(){var _889=this;_889.find().then(function(_88a){if(_88a.results&&_88a.results.length){_889.select(_88a.results[0]);_889.onEnterKeySelect();}});},_inputKeyUp:function(e){var _88b=this;if(e){clearTimeout(_88b._queryTimer);var _88c=_88b.inputNode.value;_88b._ignoreUpdateValue=true;_88b.set("value",_88c);_88b._ignoreUpdateValue=false;var _88d=0;if(_88c){_88d=_88c.length;}if(e.keyCode===e.copyKey||e.ctrlKey||e.shiftKey||e.metaKey||e.altKey||e.keyCode===e.ALT||e.keyCode===e.CTRL||e.keyCode===e.META||e.keyCode===e.shiftKey||e.keyCode===keys.UP_ARROW||e.keyCode===keys.DOWN_ARROW||e.keyCode===keys.LEFT_ARROW||e.keyCode===keys.RIGHT_ARROW){return;}else{if(e&&e.keyCode===keys.ENTER){_88b._cancelDeferreds();_88b._findThenSelect();}else{if(e&&e.keyCode===keys.ESCAPE){_88b._cancelDeferreds();_88b._hideMenus();}else{if(e&&e.keyCode===keys.TAB){_88b._cancelDeferreds();_88b._hideMenus();}else{if(_88b.autoComplete&&_88d>=_88b.minCharacters){_88b._autocomplete();}else{_88b._hideMenus();}}}}}_88b._checkStatus();}},_cancelDeferreds:function(){var _88e=this;if(_88e._deferreds.length){for(var i=0;i<_88e._deferreds.length;i++){_88e._deferreds[i].cancel("stop query");}_88e._deferreds=[];}},_inputKeyDown:function(e){var _88f=this;var _890=_81e("[data-item=\"true\"]",_88f.resultsNode);if(e&&e.keyCode===keys.TAB){_88f._cancelDeferreds();_88f._hideMenus();return;}else{if(e&&e.keyCode===keys.UP_ARROW){_819.stop(e);_88f._cancelDeferreds();var _891=_890.length;if(_891){_890[_891-1].focus();}}else{if(e&&e.keyCode===keys.DOWN_ARROW){_819.stop(e);_88f._cancelDeferreds();if(_890[0]){_890[0].focus();}}}}},_geocoderMenuButtonKeyDown:function(e){var _892=this;var _893=_81e("[data-item=\"true\"]",_892.geocoderMenuInsertNode);if(e&&e.keyCode===keys.UP_ARROW){_819.stop(e);_892._showGeolocatorMenu();var _894=_893.length;if(_894){_893[_894-1].focus();}}else{if(e&&e.keyCode===keys.DOWN_ARROW){_819.stop(e);_892._showGeolocatorMenu();if(_893[0]){_893[0].focus();}}}},_inputClick:function(){var _895=this;_895._hideGeolocatorMenu();if(!_895.get("value")){_895.clear();_895._hideMenus();}_895._checkStatus();},_hydrateResult:function(e){var _896=this;var sR=_896._defaultSR;if(_896.map){sR=_896.map.spatialReference;}var _897={},_898;if(e.hasOwnProperty("extent")){_897.extent=new _82a(e.extent);_897.extent.setSpatialReference(new _825(sR));if(e.hasOwnProperty("name")){_897.name=e.name;}if(e.hasOwnProperty("feature")){_897.feature=new _826(e.feature);_898=_897.feature.geometry;if(_898){_898.setSpatialReference(sR);}}}else{if(e.hasOwnProperty("location")){var _899=new _829(e.location.x,e.location.y,sR);if(_896.map){_897.extent=_896.map.extent.centerAt(_899);}else{_897.extent=new _82a({"xmin":_899.x-0.25,"ymin":_899.y-0.25,"xmax":_899.x+0.25,"ymax":_899.y+0.25,"spatialReference":{"wkid":4326}});}if(e.hasOwnProperty("address")&&typeof e.address==="string"){_897.name=e.address;}else{if(e.hasOwnProperty("address")&&typeof e.address==="object"){var _89a="";if(e.address.Address){_89a+=e.address.Address+" ";}if(e.address.City){_89a+=e.address.City+" ";}if(e.address.Region){_89a+=e.address.Region+" ";}if(e.address.Postal){_89a+=e.address.Postal+" ";}if(e.address.CountryCode){_89a+=e.address.CountryCode+" ";}_897.name=lang.trim(_89a);}}var _89b={};if(e.hasOwnProperty("attributes")){_89b=e.attributes;}if(e.hasOwnProperty("score")){_89b.score=e.score;}_897.feature=new _826(_899,null,_89b,null);}}return _897;},_hydrateResults:function(e){var _89c=this;var _89d=[];if(e&&e.length){var i=0;for(i;i<e.length&&i<_89c.maxLocations;i++){var _89e=_89c._hydrateResult(e[i]);_89d.push(_89e);}}return _89d;}});if(has("extend-esri")){lang.setObject("dijit.Geocoder",_82c,_824);}return _82c;});},"esri/dijit/Directions":function(){require({cache:{"url:esri/dijit/templates/Directions.html":"<div class=\"${options.theme}\" role=\"presentation\">\r\n    <div data-dojo-attach-point=\"_widgetContainer\" class=\"${_widgetContainerClass}\" role=\"presentation\">\r\n        <div class=\"${_stopsContainerClass}\" data-dojo-attach-point=\"_dndNode\" role=\"presentation\">\r\n            <table class=\"${_stopsClass}\" data-dojo-attach-point=\"_dndNode\"></table>\r\n            <div class=\"${_clearClass}\"></div>\r\n            <div class=\"${_stopsButtonContainerClass}\">\r\n                <div role=\"button\" class=\"${_stopsAddDestinationClass}\" data-dojo-attach-point=\"_addDestinationNode\" data-dojo-attach-event=\"ondijitclick:_addStopButton\">${_i18n.widgets.directions.addDestination}</div>\r\n                <div role=\"button\" class=\"${_stopsOptionsButtonClass}\" data-dojo-attach-point=\"_optionsButtonNode\" data-dojo-attach-event=\"ondijitclick:_toggleOptionsMenu\">${_i18n.widgets.directions.showOptions}</div>\r\n            \t<div class=\"${_clearClass}\"></div>\r\n            </div>\r\n            <div role=\"presentation\" class=\"${_stopsOptionsMenuClass}\" data-dojo-attach-point=\"_optionsMenuNode\">\r\n                <div class=\"${_stopsOptionsCheckboxesClass}\">\r\n                    <ul>\r\n                        <li class=\"${_stopsFindOptimalOrderClass}\" data-dojo-attach-point=\"_findOptimalOrderItemNode\"><input data-dojo-attach-event=\"ondijitclick:_toggleCheckbox\" tabindex=\"0\" data-dojo-attach-point=\"_findOptimalOrderNode\" type=\"checkbox\" id=\"${id}_find_optimal_order\" /><label for=\"${id}_find_optimal_order\">${_i18n.widgets.directions.findOptimalOrder}</label></li>\r\n                        <li class=\"${_stopsReturnToStartClass}\" data-dojo-attach-point=\"_returnToStartItemNode\"><input data-dojo-attach-event=\"ondijitclick:_toggleCheckbox\" tabindex=\"0\" data-dojo-attach-point=\"_returnToStartNode\" type=\"checkbox\" id=\"${id}_stopsReturnToStart\" /><label for=\"${id}_stopsReturnToStart\">${_i18n.widgets.directions.returnToStart}</label></li>\r\n                        <li class=\"${_stopsUseTrafficClass}\" data-dojo-attach-point=\"_useTrafficItemNode\"><input data-dojo-attach-event=\"ondijitclick:_toggleCheckbox\" tabindex=\"0\" data-dojo-attach-point=\"_useTrafficNode\" type=\"checkbox\" id=\"${id}_stopsUseTraffic\" /><label for=\"${id}_stopsUseTraffic\">${_i18n.widgets.directions.useTraffic}</label></li>\r\n                    </ul>\r\n                </div>\r\n                <div class=\"${_stopsOptionsUnitsClass}\">\r\n                    <ul>\r\n                        <li><input data-dojo-attach-event=\"ondijitclick:_toggleUnits\" tabindex=\"0\" id=\"${id}_use_miles\" data-dojo-attach-point=\"_useMilesNode\" name=\"${id}_units\" type=\"radio\"><label for=\"${id}_use_miles\">${_i18n.widgets.directions.units.MILES.name}</label></li>\r\n                        <li><input data-dojo-attach-event=\"ondijitclick:_toggleUnits\" tabindex=\"0\" id=\"${id}_use_kilometers\" data-dojo-attach-point=\"_useKilometersNode\" name=\"${id}_units\" type=\"radio\"><label for=\"${id}_use_kilometers\">${_i18n.widgets.directions.units.KILOMETERS.name}</label></li>\r\n                    </ul>\r\n                </div>\r\n                <div class=\"${_clearClass}\"></div>\r\n            </div>\r\n            <div class=\"${_stopsGetDirectionsContainerClass}\">\r\n                <div tabindex=\"0\" role=\"button\" class=\"${_stopsGetDirectionsClass}\" data-dojo-attach-event=\"ondijitclick:_directionsButton\">${_i18n.widgets.directions.getDirections}</div>\r\n                <div tabindex=\"0\" role=\"button\" class=\"${_stopsClearDirectionsClass}\" data-dojo-attach-event=\"ondijitclick:clearDirections\">${_i18n.widgets.directions.clearDirections}</div>\r\n                <div class=\"${_clearClass}\"></div>\r\n            </div>\r\n    \t</div>\r\n    \t<div class=\"${_clearClass}\"></div>\r\n    \t<div data-dojo-attach-point=\"_errorNode\" role=\"presentation\"></div>\r\n    \t<div class=\"${_resultsContainerClass}\" role=\"presentation\">\r\n        \t<div class=\"${_routesContainerClass}\" data-dojo-attach-point=\"_resultsNode\" role=\"presentation\"></div>\r\n    \t</div>\r\n    </div>\r\n</div>"}});define("esri/dijit/Directions",["require","dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/_base/Color","dijit/_WidgetBase","dijit/_OnDijitClickMixin","dijit/_TemplatedMixin","dojo/keys","dojo/has","dojo/on","dojo/mouse","dojo/dom","dojo/dom-geometry","dojo/dom-style","dojo/dom-class","dojo/dom-attr","dojo/query","dojo/number","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/templates/Directions.html","esri/dijit/Geocoder","dojo/dom-construct","dojo/promise/all","dojo/Deferred","dojo/dnd/Source","esri/kernel","esri/graphic","esri/units","esri/InfoTemplate","esri/SpatialReference","esri/layers/ArcGISDynamicMapServiceLayer","esri/geometry/Point","esri/geometry/Extent","esri/geometry/Polyline","esri/geometry/mathUtils","esri/symbols/PictureMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/TextSymbol","esri/symbols/Font","esri/dijit/_EventedWidget","esri/dijit/Popup","esri/tasks/FeatureSet","esri/tasks/RouteTask","esri/tasks/RouteParameters","esri/toolbars/edit","dojo/uacss"],function(_89f,_8a0,_8a1,lang,_8a2,_8a3,_8a4,_8a5,_8a6,keys,has,on,_8a7,dom,_8a8,_8a9,_8aa,_8ab,_8ac,_8ad,i18n,_8ae,_8af,_8b0,all,_8b1,_8b2,_8b3,_8b4,_8b5,_8b6,_8b7,_8b8,_8b9,_8ba,_8bb,_8bc,_8bd,_8be,_8bf,Font,_8c0,_8c1,_8c2,_8c3,_8c4,Edit){var _8c5=_8a0([_8c0,_8a5,_8a6],{declaredClass:"esri.dijit.Directions",templateString:_8ae,basePath:_89f.toUrl("esri/dijit"),_eventMap:{"load":true,"directions-start":true,"directions-finish":["result"],"directions-clear":true,"segment-select":["graphic"],"segment-highlight":["graphic"]},constructor:function(_8c6,_8c7){var _8c8=this;_8c8._setClasses();_8c8._setTemplates();_8c8._setPublicDefaults();lang.mixin(_8c8.options,_8c6);_8c8._setPrivateDefaults();_8c8._setTrafficDefaults();_8c8._widgetProperties();_8c8.set("geocoders",[]);var _8c9=_8c8.watch("theme",_8c8._updateThemeWatch);_8c8._watchEvents.push(_8c9);var _8ca=_8c8.watch("stops",_8c8._updateStopsWatch);_8c8._watchEvents.push(_8ca);_8c8.domNode=_8c7;},startup:function(){var _8cb=this;_8cb._setOptions();_8cb._setStops();_8cb._dnd=new _8b2(_8cb._dndNode,{skipForm:true,withHandles:true});if(_8cb.options.map){if(_8cb.options.map.loaded){_8cb._init();}else{var _8cc=_8cb.options.map.on("load",lang.hitch(_8cb,_8cb._init));_8cb._onEvents.push(_8cc);}}else{_8cb._init();}},destroy:function(){var _8cd=this;var i;_8cd.clearDirections();_8cd._removeTrafficLayer();if(_8cd._watchEvents){for(i=0;i<_8cd._watchEvents.length;i++){_8cd._watchEvents[i].unwatch();}}if(_8cd._globalGeocoder){_8cd._globalGeocoder.destroy();}if(_8cd._dnd){_8cd._dnd.destroy();}if(_8cd.geocoders.length){for(i=0;i<_8cd.geocoders.length;i++){_8cd.geocoders[i].destroy();}}if(_8cd._onEvents){for(i=0;i<_8cd._onEvents.length;i++){_8cd._onEvents[i].remove();}}if(_8cd._geocoderFindEvents){for(i=0;i<_8cd._geocoderFindEvents.length;i++){_8cd._geocoderFindEvents[i].remove();}}if(_8cd._geocoderWatchEvents){for(i=0;i<_8cd._geocoderWatchEvents.length;i++){_8cd._geocoderWatchEvents[i].unwatch();}}if(_8cd._geocoderSelectEvents){for(i=0;i<_8cd._geocoderSelectEvents.length;i++){_8cd._geocoderSelectEvents[i].remove();}}if(_8cd._connectEvents){for(i=0;i<_8cd._connectEvents.length;i++){_8a1.disconnect(_8cd._connectEvents[i]);}}_8cd._disconnectResults();_8b0.empty(_8cd.domNode);_8cd.inherited(arguments);},clearDirections:function(){var _8ce=this;_8ce._routeParams.stops.features=[];_8ce.set("directions",null);_8ce._clearStopGraphics();_8ce._clearRouteGraphics();_8ce._clearInfoWindow();_8ce._clearResultsHTML();_8ce._clearResultError();_8ce.onDirectionsClear();},reset:function(){var _8cf=this;_8cf.clearDirections();_8cf._removeTrafficLayer();_8cf._setTrafficDefaults();_8cf._configureRouteOptions();_8cf._widgetProperties();_8cf._setOptions();_8cf.updateStops(_8cf.options.stops);},onLoad:function(){},onDirectionsStart:function(){var _8d0=this;_8aa.add(_8d0._widgetContainer,_8d0._resultsLoadingClass);_8d0._solveActive=true;},onDirectionsFinish:function(){var _8d1=this;_8aa.remove(_8d1._widgetContainer,_8d1._resultsLoadingClass);_8d1._solveActive=false;},onDirectionsClear:function(){},onSegmentSelect:function(){},onSegmentHighlight:function(){},onAddStops:function(){},onUpdateStops:function(){},onRemoveStops:function(){},removeStops:function(){var _8d2=this;_8d2._clearResultError();return _8d2._removeStops().then(function(resp){_8d2.onRemoveStops(resp);});},removeStop:function(_8d3){var _8d4=this;_8d4._clearResultError();return _8d4._removeStop(_8d3).then(function(resp,i){_8d4.onRemoveStops(resp,i);});},updateStops:function(_8d5){var _8d6=this;_8d6._clearResultError();return _8d6._updateStops(_8d5).then(function(resp){_8d6.onUpdateStops(resp);});},addStops:function(_8d7,_8d8){var _8d9=this;_8d9._clearResultError();return _8d9._addStops(_8d7,_8d8).then(function(resp,i){_8d9.onAddStops(resp,i);});},addStop:function(stop,_8da){var _8db=this;_8db._clearResultError();return _8db._addStop(stop,_8da).then(function(resp,i){_8db.onAddStops(resp,i);});},updateStop:function(stop,_8dc){var _8dd=this;_8dd._clearResultError();return _8dd._updateStop(stop,_8dc).then(function(resp,i){_8dd.onUpdateStops(resp,i);});},getDirections:function(){var _8de=this;_8de._clearResultError();_8de._directionsDeferred=new _8b1();if(_8de._calculateValidStops()>=_8de.get("minStops")){if(!_8de._solveActive){_8de.onDirectionsStart();_8de.clearDirections();_8de._dnd.sync();_8de._sortGeocoders();_8de._getCandidates(_8de.get("stops")).then(function(_8df){_8de._stops=_8df;_8de._setStops();_8de.onUpdateStops(_8de.get("stops"));var _8e0=_8de._validateStops(_8df);if(_8e0.error){var _8e1=i18n.widgets.directions.error.locator;var _8e2=_8de.geocoders[_8e0.index];if(_8e2){_8e1=i18n.widgets.directions.error.unknownStop.replace("<name>",_8e2.get("value"));}_8de._resultError(_8e1);_8de._directionsDeferred.reject(_8e1);_8de.onDirectionsFinish(new Error([_8e1]));}else{_8de._configureRoute();}},function(){_8de.onDirectionsFinish();});}}else{_8de.clearDirections();_8de._resultError(i18n.widgets.directions.error.notEnoughStops);_8de._directionsDeferred.reject(i18n.widgets.directions.error.notEnoughStops);_8de.onDirectionsFinish(new Error([i18n.widgets.directions.error.notEnoughStops]));}return _8de._directionsDeferred;},unhighlightSegment:function(){var _8e3=this;if(_8e3.options.map&&_8e3.options.map.graphics&&_8e3.options.showSegmentHighlight){_8e3.options.map.graphics.remove(_8e3._segmentGraphic);_8e3._segmentGraphic=null;}},highlightSegment:function(_8e4){var _8e5=this;if(typeof _8e4==="undefined"){_8e4=0;}var _8e6=_8e5.directions.features[_8e4];var _8e7=new _8bb(_8e6.geometry);var _8e8;var _8e9=_8e7.getPoint(0,0);var _8ea=_8e7.getPoint(0,1);var _8eb=_8bc.getLength(_8e9,_8ea);if(!_8eb){_8e7=_8e9;_8e8=_8e9;}else{_8e8=_8e7.getPoint(0,0);}_8e5.unhighlightSegment();_8e5._segmentGraphic=new _8b4(_8e7,_8e5.options.segmentSymbol,_8e6.attributes,_8e5.options.segmentInfoTemplate);if(_8e5._segmentGraphic&&_8e5.options.map&&_8e5.options.map.graphics){if(_8e5.options.showSegmentHighlight){_8e5.options.map.graphics.add(_8e5._segmentGraphic);}}},zoomToSegment:function(_8ec){var _8ed=this;if(typeof _8ec==="undefined"){_8ec=0;}if(_8ed.options.map){var _8ee=_8ed.directions.features[_8ec];var _8ef=_8ee.geometry;var _8f0=new _8bb(_8ef);var _8f1=_8f0.getExtent();var _8f2=_8ed.options.map.setExtent(_8f1,true);_8f2.then(function(){_8ed._showSegmentPopup(_8ee,_8ec);});}},centerAtSegmentStart:function(_8f3){var _8f4=this;if(typeof _8f3==="undefined"){_8f3=0;}if(_8f4.options.map){var _8f5=_8f4.directions.features[_8f3];var _8f6=_8f5.geometry;var _8f7=_8f6.getPoint(0,0);var _8f8=_8f4.options.map.centerAt(_8f7);_8f8.then(function(){_8f4._showSegmentPopup(_8f5,_8f3);});}},zoomToFullRoute:function(){var _8f9=this;if(_8f9.options.map){_8f9._clearInfoWindow();_8f9.unhighlightSegment();_8f9.options.map.setExtent(_8f9.directions.extent,true);}},_updateStops:function(_8fa){var _8fb=this;var _8fc=_8fa.length;if(_8fa&&_8fc){var _8fd=[];var i;if(_8fc===_8fb._stops.length){for(i=0;i<_8fc;i++){_8fd.push(_8fb._updateStop(_8fa[i],i));}}else{if(_8fc>_8fb._stops.length){var _8fe=0;for(i=0;i<_8fb._stops.length;i++){_8fd.push(_8fb._updateStop(_8fa[i],i));_8fe++;}for(i=_8fe;i<_8fc;i++){_8fd.push(_8fb._addStop(_8fa[i],i));}}else{var _8ff=_8fb._stops.length-_8fc;for(i=0;i<_8ff;i++){_8fb._removeStop();}for(i=0;i<_8fc;i++){_8fd.push(_8fb._updateStop(_8fa[i],i));}}}if(_8fd.length){return all(_8fd);}}else{return _8fb._removeStops();}},_removeStops:function(){var _900=this;var _901=lang.clone(_900.get("stops"));var def=new _8b1();if(_900._stops.length){while(_900._stops.length){_900._removeStop();}def.resolve(_900._removeSortIds(_901));}else{def.reject("no stops to remove");}return def;},_removeStop:function(_902){var _903=this;var def=new _8b1();if(_903._stops.length){if(typeof _902==="undefined"){_902=_903._stops.length-1;}var _904=lang.clone(_903._stops);var stop=_904[_902];var _905=_903._dnd.getAllNodes();var node=_905[_902];_903.geocoders[_902].destroy();_903.geocoders.splice(_902,1);_903._stops.splice(_902,1);_903._setStops();_903._geocoderSelectEvents[node.id].remove();_903._geocoderFindEvents[node.id].remove();_903._geocoderWatchEvents[node.id].unwatch();_8b0.destroy(node);_903._dnd.sync();_903._stopsRemovable();_903._optionsMenu();_903._checkMaxStops();_903._fixIcons();_903._sortGeocoders();def.resolve(_903._removeSortId(stop),_902);}else{def.reject("no stop to remove");}return def;},_removeTrafficLayer:function(){var _906=this;if(_906._trafficLayer&&_906.options.map){_906.options.map.removeLayer(_906._trafficLayer);_906._trafficLayer=false;}},_addStops:function(_907,_908){var _909=this;var i;if(typeof _908==="undefined"){_908=_909._stops.length;}var def=new _8b1();if(_907&&_907.length){_909._getCandidates(_907).then(function(e){if(e&&e.length){for(i=0;i<e.length;i++){_909._insertStop(e[i],_908+i);}_909._setStops();def.resolve(_909._removeSortIds(e));}else{_909._resultError(i18n.widgets.directions.error.noAddresses);def.reject(i18n.widgets.directions.error.noAddresses);}});}else{_909._resultError(i18n.widgets.directions.error.noStops);def.reject(i18n.widgets.directions.error.noStops);}return def;},_addStop:function(stop,_90a){var _90b=this;if(typeof _90a==="undefined"){_90a=_90b._stops.length;}var def=new _8b1();_90b._checkMaxStops();if(!_90b.maxStopsReached){_90b._getCandidate(stop,_90a).then(function(_90c){_90b._insertStop(_90c,_90a);_90b._setStops();def.resolve(_90b._removeSortId(_90c),_90a);},function(_90d){def.reject(_90d);});}else{_90b._resultError(i18n.widgets.directions.error.maximumStops);def.reject(i18n.widgets.directions.error.maximumStops);}return def;},_setTrafficDefaults:function(){},_setPublicDefaults:function(){var _90e=this;_90e.options={map:null,autoSolve:true,minStops:2,maxStops:20,theme:"simpleDirections",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",directions:null,showReturnToStartOption:true,showUseOptimalRouteOption:true,returnToStart:false,useOptimalRoute:false,routeTaskUrl:location.protocol+"//route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",routeParams:{},stops:["",""],geocoderOptions:{autoComplete:true,autoNavigate:false},stopsInfoTemplate:new _8b6("Location",_90e._stopTpl),segmentInfoTemplate:new _8b6("Route",_90e._routeTpl),textSymbolFont:new Font("11px",Font.STYLE_NORMAL,Font.VARIANT_NORMAL,Font.WEIGHT_NORMAL,"Arial, Helvetica, sans-serif"),textSymbolColor:new _8a3([255,255,255]),textSymbolOffset:{x:0,y:10.875},fromSymbol:new _8bd({"url":_90e.basePath+"/images/Directions/greenPoint.png","height":21.75,"width":15.75,"imageData":"iVBORw0KGgoAAAANSUhEUgAAABUAAAAdCAYAAABFRCf7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4OTI1MkU2ODE0QzUxMUUyQURFMUNDNThGMTA3MjkzMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4OTI1MkU2OTE0QzUxMUUyQURFMUNDNThGMTA3MjkzMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjg5MjUyRTY2MTRDNTExRTJBREUxQ0M1OEYxMDcyOTMxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjg5MjUyRTY3MTRDNTExRTJBREUxQ0M1OEYxMDcyOTMxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+iVNkdQAABJlJREFUeNp0VltvG0UUnpkdr72261CnCQWEIA9FqOKlqooARUKCtAUhoA+VoBVRhfgFXKSKJ97goRL8ARCIclGgL0VUkBBAoBaVoggEQQVSAhFS06SJje3Y3t25cc7srL3YjddHs3N85pvvfOfMyJRs83n8o+P7POI9yQibooTeBa68ISbSRv+hifpCGHX2s6dnfrrRWjroOPzB0T0+zZ0q8uDRSrniF/MB8X2fADhR8IRRRDphh7Q6rbgtOucU0Sdnj59Z2hb00PtHD+Zp/p2x6uitO4o7iLYP8DMafjVE2wXUboALm50W2ahtXO3q8MTX02fnh0Affu/IkSAXnL55dLzMPU6kURZMIZQhFtRk2VBKcpQTIQVZ21hrdUX4zDcnPv2kBzr59mP3BLnChfGx8YrHPKIAELSzMPhQk+ydzpOvIYwywjFeK7K+vt6IlZw8/+y5RZ4gm9eCUrGCmkUyBkCV0Sd5UlBtTLIhRWQE9ixwsVwe6dY3X4WwJ+j9bx7a7/v5i6O7qlxisFZJAvBF7Rjty56CWlmszilj6BNgXd+syTCO7uNK62nuezyUkWWASTPHDtOjbgOHkJTOsbXAyJhIC+rlODdROM211gcQKBJxoh+EKAs4AGqybHVfBvdICNIU/IDHYbcJiS6le4wwbW1B9UDXJcg9QBxtbglh1BlAJzjoUxIGQZFRwtAypgnjtH0spDG9MWVs34xrN5uBLnEoTKQUgDLgZ6hliLunBaIDhy4LYhyotptZlphGyLUhfyspxxj3AIpaVqikdgyzoGn7p0xNj71rNamweCscWC0qoQ8YRm3K2OgpeFoc+j9FSUYKB+4OgxIK4RcZUJ6RsUgqCrShxWzza9035aw/lzYGY5P4xFSMR5vMcFpm87opL4HjXsr76dLhC2xYhgx3I0BfoS7RCp+3K/e8vn+Ke2zWK+cYofQG9yMlw1eK1aAni9oSWil9eOmFhXkPnbXZ1eXqwVsirfQU9Vynm75lymLbxvpSP4yqI4iR5uWlFxdOI56Xbro5t3qhOrW7ZmL1EOFwp7k6pRXuWaZgBmuwJSIl1fNXXvrxjRTLy2ZTm1v9YeTBXedNbCYZZ1U4pdt+NGiomuKKEvKp5ZM/f5z9zctc1vju1b9cv5q/M/icBd4+KNztlnGWKfYjAMqm+K7zZ/PYP6d+X3TrafbmR8N71QcrOPMLd5RGdj838WFup393orNLWRki6vFv197661i40m6AKwYLneG79BzDPNhNYFWwnfguGyKgPl32bwseoTnKekVpS9n49vorWwv1JsSVwAJHCHcW2Agsk3rBBZXBihhcn11biTfDixpPik1bEZyj34EVXXzJrUccWwrbZo5+B6ztRpvO1kLjjO5qW3YccZ5JeTAecQxqqV0Q6hM5KVIrNL5a/77yQPUyLbK9qiMv49zFhW6MMnPE0dwxlQ48ckXDNHJOq0C2xByreHtxhPk1sK4DEI5dut7+QWCZCyj9MXKLWmD/gl1Xtfhd6F2CI86dv+XiIrdOpeeCDd0VyW7KGbLptn9p/mrgNsIxwzKN0QO3IvlPgAEA3AQhIZtaN54AAAAASUVORK5CYII=","contentType":"image/png","type":"esriPMS"}).setOffset(0,10.875),fromSymbolDrag:new _8bd({"url":_90e.basePath+"/images/Directions/greenPointMove.png","height":21.75,"width":15.75,"imageData":"iVBORw0KGgoAAAANSUhEUgAAABUAAAAdCAYAAABFRCf7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzU5RTBFMjk2QzlCMTFFMkI3NTI4NEEyOTA0NjEyMEYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzU5RTBFMkE2QzlCMTFFMkI3NTI4NEEyOTA0NjEyMEYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3NTlFMEUyNzZDOUIxMUUyQjc1Mjg0QTI5MDQ2MTIwRiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3NTlFMEUyODZDOUIxMUUyQjc1Mjg0QTI5MDQ2MTIwRiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkWg288AAAVnSURBVHjadFVrbBVFFD4zO3fvo7e9baEBIUohQBQRRWwQhJDwLBIRE4yAEmPgh4l/NGrqP0wkIhJ8JYYYfCAqBuGHkBgoIK9QIzVEAiXYQoHGpi2l9NrXvbs7OzOe2Z29vRTYm9OZOXvmm+9858yWwH2e535ZN9MC63kKdDEBMhVdcQXKlUq2SBBHuRIHDq3Ze/5ee8lIx7I9q6fYJLYtxZLLy9JldiqeBNu2AcFB4M9xXcg5ORjIDXhDPPebAFlXv27/lfuCLv1p9ZI4ie+qqhw1rjRVCjL4KZjMJsAUVg0t/nW4wm8EB+iN/bkB6Ont6chL59UT6w8ci3CsaLLox1WrErH43jFVVaNisRg40gVPeDDZngBL0vMhw0phkv0Q9PBeaPc6wVMcbBaDRDJR6jj5F8avnHSp7deWZo1F9Z95362YTsH6PlNenkatYJDnIMfzkPMdeDazECzLKtiK8kXgcJTAywMKAD5KUl5ZUWoRa7fG0Xgs1EBtSZakyrRmru+BRODo2dH1AyRpAjaOWws7O/ZAXjjgYgaKKAClgBILGLUglU5n8tnbH+KWlWzO10tnUcuqZXGKzPKgpAilJhBo1+F2hjohy9b8dTwQe0Bh/aUM/Ao4cIlZ2BQYo8trdi6aRfHlemZbzPFRQ7QnMzPgi+mbwRc++NIHjiPHkTGGPhH4fDxYoH352BaoKX8CmbuBWTHGlFLrmZSyRlfY5R48M7oGNlSvCxjEUBmdJjGsNVN9EPJEthLiKIn2bax+GaRUcKbnLEiC3YJ4TCg5Ec8GIiTMr3o6CAy0fOrjOxuaEPh29mf3vCgLxsyBkzcbAp0RdCLSlSVcaVACJ7obYMaoaUHgpvNbC22sAd9//F30hQcprSuOH8ysC9Ynus4EEmFBdBYlDAvjCkyLUArHO05jNQHefPR1uJi9bG4HKRSqCX0aLgLVvk+adsDRjlNByaQunlQOQzluCN+voszC20Ogvv0kHG0/VWAYgQaF0mwKTBUsr18TzANAHKWPBVSyjSLhJsHDFtH9KaUIq4up6FGnFbfsgFXcihfeBfE413vCvejjQsM3kUc+n72MMnKYpe0CK0KG02548dBdhZm7r9YwBgiFCEd/gIMSqpaSND0mPdEovLD3tC5CDNvmxu13XFO9Lrw38YG5yJKLRo1n3TrYriqWPXADW+oVEqNEmVOjX3P2KnQOdUMmUQZfXdgFB1sPF96FVMPCiRyXKMNrzW80thY+fVO3z6ojMfKRlWRB+iOadHiuonSjNYDI46Xg6r2Wt89tvePTd/tIZ0Pl4rG9yhMLgRGmJVVmszJsolaKABW2jhjkrvDFW1ff+fvTu76n+uk90vlXZsHoM8pT8yijlYTCfR+pO6afXxXcf+la3YV9xe+sov8Aem5lf+/uiFcnD9OkNZMw8mDAuJip7kcE9Pv5H7nW/rX/bmtuMvtJ8b8TYr6rNlrCmJ2YUJIZu2Hiz7EK+2FiDWuKLQM86/3T9c31tU7bUB+6PDTHmJ77lmEYRytHq0Sr0HO/jyeJTa7Z45O1WEAaXU8x5Pt9p29tGjyX7ce4ErSkIaRP5miCFqWeMEFptJQOztbfbPNuO39KfVOCtAXotfYbsJSJLzH7NU5QCl1MYejn0IbMGKQzeK5vv8zLoOx61OuilEfGaxyltZQmSOvjGikiS/Qd7z5bNrfyMknRaSLnX9ZrE+eY0S1aaxzJDFPfgLumaFbw8Q+1SuKdPkLLrGl6xHUXWt4AcMMu2q9N0eF7UXjpmk0DaP+h3RK93m7sXdCjXhv/gIlzzT4R3YuR7a3MacKYZpMfuth/SeFHQ49FLKMYWXxr9fO/AAMAeko3KTmnLXwAAAAASUVORK5CYII=","contentType":"image/png","type":"esriPMS"}).setOffset(0,10.875),stopSymbol:new _8bd({"url":_90e.basePath+"/images/Directions/bluePoint.png","height":21.75,"width":15.75,"imageData":"iVBORw0KGgoAAAANSUhEUgAAABUAAAAdCAYAAABFRCf7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowRDNGRjhFQzNDMDcxMUUyQTlERUFFMkE4NTNDNjgwMiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowRDNGRjhFRDNDMDcxMUUyQTlERUFFMkE4NTNDNjgwMiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjBEM0ZGOEVBM0MwNzExRTJBOURFQUUyQTg1M0M2ODAyIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjBEM0ZGOEVCM0MwNzExRTJBOURFQUUyQTg1M0M2ODAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+G7OGVQAABIpJREFUeNqEVE1oXUUUPvPz7vvPHy9FIi4KWiS6KSW4UHBToUXwb1ewCILLrhTEiLizi+JKd25iFaUiBYWCmGy6abUIukitVBGLkIZE4stLXt79mZnjOTNzk9vXFO/jvJk795xvvnO+MyPm37sO/CRSgRICQApoaFoQ8rgGfFFKOCnAHaOVOjrInBC3jRXLxsE3AO4XgwLy3AIKBAfosTTc/zxGdqGt8fRkt5W0mnWoJzUQ9KNQyLJidriXPj0YjhZ3UrhCvm+T/V4FGAd9rqXtUm96aq7baQESiwIR8hQILrAAUYNmJ4Fmu5s0d4cv/7PVfyoH8Rp9WTkM9KVGIj/r9XqdWqJhN6d0CNC5ABYhaaMwSipTrd6C3mwyZza2Lo8K8yotf1sFfVIp/HRyZrrDNcoyC5bAqIZUKyIXgXjuLL0IT5mAAWqkw/TMdDff2LxIIc/Qh1VtqOI1Kc63Wt0JEgBGNjAUFMC6oQljyZLxnZ+zLATMzAi93elOUik+MIgvMNMTSqlTMqnDsHAhXSYjuREEN8N+7h7QcUlo5A1dAFY0V0kDtFKnjTEntEU8K+sNnZrozCy5ZsxChHn1cRHcUkahEg64ZJLmqtnQONg9qxFxwaGEjMqADBhzlRTBYvCrGBPKs42sPXvyVbyOiuruFpjpUSMU0HahY4gdp+w4dYdw2ONKYAxz3tJa3l3x+lFNq+3CMUMXWFEqXnER2PiNZGTpDkB9JzBTUQpIP+v4W5uYOsqc1UavJEF6MAYPzLmAByx9n3qRgh+6uAmGrqGuSDVK8Zd1ZlbSSWFZ/PGPWguAe4QqG98zi+0VrNyADrIUdzTttOpssYBC+5QZhOspKmjlFMc2YHZY2YxwuINWJal1yRWpPzZhR06D+/XAbLTqu/cJlQyxrIFJWZtL0jV7K7YoblhTgKucGKr5A81Fn1J9Nh9POIwnfbyAd1226xAqP3lgEG1/beznM0h3HOMwXmwWWHE2XzR729RvNtxOhxhW5taW5aDLJx2QSMVief3ty3HkzRU+7Ofo74JsTtS5kf/3QSIwGmQE/Bax+3jjw5P3CLsv9My5K89KXftEtiYfFSp5IJ4zOeBo+w9nije2Pnr+arU5VKVreK5GN75Y0w/Pf0dsj9PV8wjI+xkjA+5tXcv//vlMf+n11Rgvqi0o4mXNtBrREj33xOTEK+e/VFMPPQ5SVymC7a//Nrj8zhmzdnObVnKyNBrPjYoM62RTZDNk0zx3O5tN0PU/5ZFjp6DWkKHJSaBh36Q/ffV+/uvygJbaZM1IiMkVpfpl6o3o1CFrsfPo2tIdt732A9osHEYa+Z3XI1gr+rdjvCrvH4xXBtPfIxvG0aeT31r+GrOhP7888nsl5XF/xkEZDwc7cX02yO6Srcf51uj65z+6dPsWi8Mjv/N6/L4e/TdiPOM4HZmaCJ5F0TiNWqxVE0f977EzO89jBBpFgCKyK+NdyRQqJTARmIN2yPpkm/bfuxe5njzye1zfiX5ZjLNlr8rxFizvk2jMZlTcvnoTCwM8VliWPm7sVoT/BBgAPp8JxKgcaMoAAAAASUVORK5CYII=","contentType":"image/png","type":"esriPMS"}).setOffset(0,10.875),stopSymbolDrag:new _8bd({"url":_90e.basePath+"/images/Directions/bluePointMove.png","height":21.75,"width":15.75,"imageData":"iVBORw0KGgoAAAANSUhEUgAAABUAAAAdCAYAAABFRCf7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkQ5MDM5MjY2QzlCMTFFMkI0NTE5QUY4QjQzREJFODIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkQ5MDM5Mjc2QzlCMTFFMkI0NTE5QUY4QjQzREJFODIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2RDkwMzkyNDZDOUIxMUUyQjQ1MTlBRjhCNDNEQkU4MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2RDkwMzkyNTZDOUIxMUUyQjQ1MTlBRjhCNDNEQkU4MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmssHYwAAAUwSURBVHjahFZtiFRVGH7PuR8zc3dmv9odzazc0C0sEBEriohiKzcjy1AQ8k/QT8lK0goJ+pGWGET9CPpjFoYigomypoj+0VrCPlhTVw0t2JVdWWd3dubOnXs+et9zz6zX2aK7+95z3nPf85zn/Tq7bPHWM0CPzx1wGAPgDLIuLjC+1AW9inPoY6B6cSWjFUSKsWEh2TGh4CCA+lVoBvW6BM00KNAGy4XZzyKUHS2u7m8rBH6Qy0DG94DhD26FKIq7K9Xa41OV8L1yDQ6j7WaUS2kA3gT4TODKk8WOwqq5c4t+NihADB7cG9Sgf95NWIAj6bl8K8wpFv1iZ+Fln4mTuK8vDZJm+lLW5990dXXlPd+F6Tq6ozUsuSOCFxZUjUFPexXQUzg77gPHMHmZALq6/XlibOJAGItX0eT7NNOHHEd/3dbZkacYTUcSKri7iuOaRRE4jjMja3sjCGP8jt/KaCPRvqOzo+Aw2E04hqnAiHucbQuCQismAEKZMGR4HOVt+2AOAk/DW8sF7Bx0oSqYYas1pYUZVi5msyVfaLsxUfpIaP0iub8MGazgfgYqsQKlMIMaDChH1L/KdDYzLC/cZOa7ETxQqwQYWYLjZ8F1nH4hxDIutV7PM1m3JjTUUR6bD7BntQPoAIqGWCbiui4IHNEEqwDMfO8rLjxxD0CEi7TfyWVddHI9vvRypTl+UPB0jwNvPOLZuhVQk0kI8NcwFVqg22CY5ryE/cZHHdRjOHFVYNgcrFe13EWmPYI5QBT67vOMIT171wa31RpD9IPr/q2sAZ7F1hi4ItCIDtA9LsK3xHgyYwqOXolh2fyMMdx4pGwYJoAAn/YX4M0jJsCGLSYdPnu+YPSBSyFywvhKzImGFmSqIood4xoOD0cGYetTrXB2JJ4BBOv+2dHYANJpGDaz9uGJKTh0MTI6VQ1WRc3VnF2VSnRz5plMHrqIvTdcSwCtmNrDREmtbzFFefjLsWQO1PdUDdjInF3jyHpIyRgkspVYIhJdoMyS3sh+1k2SksXkCKWtrTa2Zo/SCVPEQXWI3bnpxHPM8QacoP1WUlIML7yzcFZi7v/kcsI4tUZzWS3hK17BVa7ruIzjQSlisHVvXEESRrYcGb+tTUlX1obsG2L2Iw7huWY/g/dZNH2UB+28+f7aP1Qy3bVmSTvs+61k9DQ7M1KH1cqKcNBUsjlbfwdVvYHuqs3gZLbzbB5Bbr8RWZObDaDGiqpNI1S0RQP/mAddt+yLbx+nZt+Arx0815qhQv7fR0tQ4VSklNyENL4Y29k3i4TROzccfpK73lc8aFvIHP8/8ZSogw4nLysRvz7x+cpT6bw5KQ9p7oSDe0bcuxYPINulePXcDXw2Y02A1YnT9b9/WVfa9dpQU8HMKJQwopW14rvzHmxrXb3tO6d97gPA3TRFkKXrF6YOvLtOjJybxJU6Ss0KzYVjGVLDU6F2onTQXJXHc+Bm/uTF3hXgZbmGpDVlpSRqP+/7oP7HsSlcakHJWUJEjnpb8pTrWWuUR6ErKhee3nVNTY78qGVkQkYj6bRuwQJr32L3O5Dc70kzWPr0F65iR+NO/fyx/TqqaHOJ4Eh6yuVme8LR3DYHGVF8xlBGUa7b+UR45tufVG3yPCWHRtJp3X6/bu3H7H7CUa5lKix4ZJNGbng2Vjkdln7Q+e7FNFqg0ALEll1jv2owhVQIhAWmTXQjU0+Oy5ujuymeNJJu18vWLrL7ZKNWm/9DmblPrBCbMB4+dU7HAmhMsWzYqKYLC/4RYACkZdX+YS9hNAAAAABJRU5ErkJggg==","contentType":"image/png","type":"esriPMS"}).setOffset(0,10.875),toSymbol:new _8bd({"url":_90e.basePath+"/images/Directions/redPoint.png","height":21.75,"width":15.75,"imageData":"iVBORw0KGgoAAAANSUhEUgAAABUAAAAdCAYAAABFRCf7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyNEZDQTg5MTE0QzYxMUUyQURFMUNDNThGMTA3MjkzMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyNEZDQTg5MjE0QzYxMUUyQURFMUNDNThGMTA3MjkzMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjg5MjUyRTZBMTRDNTExRTJBREUxQ0M1OEYxMDcyOTMxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI0RkNBODkwMTRDNjExRTJBREUxQ0M1OEYxMDcyOTMxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+pmgrrgAABHNJREFUeNqEVU2IHEUUflVd3fO/P3FWRPAQ0EVWL2FZFBS8REgQXD0GDILg0Zsgbg7ezCFXb15iFCUigkJAzF5y0RgQPUyIRBFz2SxusszO7uxMd1e953vV1TM9m6gF31S96qqvvvdTNerH9RWQFtUSUCYCRWwkddAAJ8iYdVD6JIJa5tkaAKUK8bZCexWc/QYJflXO8jADcsRAz2XgwfYU4wI1Wqebnfmk1mhCnNSYWwFZB3meLo0Phy+M9gcbcLh/hde+x/i9SnCU9GWXNC8udLuPN9sdYBo+PQcYsxIivyDmLmk2oNNsJMNB4/X+/XvPKZu9yZ82H0b6mo7rn3aXum1jYqDDAyBEJitcgkDKA/+rlIZmLYaEBezu2K/taPQGT39bJX2WVPTJ4tx828coTZnQFQRCptSE2B9STjGxYgGLC4udnSy7BA5f5NmeQSZRcXy+02rOKbJAo5FXyDsKqFlSD/6O3CsZRxp0ZKDTas33x/c+JGtfFaWrURSdqvFHPBwWhJ5DsRDt1UzaRCmDM83BAZULcQR1HUFkzGlr7aoh587WtTaUjv3igrQgJNRTlWXzXkgCOTwcIpTD2Vs5nInNAdFZw1ldY42AWeozrLzLvI1JJRmeVFAmqlSLQYDYIEJYqfA4WhOlxyPLsdQhL56ECWWTJ62onBQAToiLsZzrIPJn4HHDdovyHFCrEMciOQV5KKcJM01DMFFMRTjYxiKJLYPWpSRKhcTHUQiwIC8KcjamvgKguAyEwUZvyzVFpLFRSH9Z65Zizr4vESjJS8KH+F+WFk1VinrHqpnvDpcU9XKHawZKlzkEhLNk1TqtHEAz5AC58zHuac7W5bHF4EVwwbtRAZePx4yNfq3fE/YKD5K6rLsRbubO3citmyTA9+j+A/gAZH+OeEP4pJAcB+PcAc/4U0u4CsIlmtqzEPX71gf1nPCVd3Azc7ixl/Fjwq5R6dpRhPAUISrC4RiDjFU62iifv0k2Np9/VMrzHa6kC3NG1yIF/9tYNAwsps7hu/ywfHTy+t8zVT3J85XVYy/FWn88H+snE/3vzOwZ7Fn6g6P29is/716r3De+rtMrI+Po87ujrZWW+Y7VnkgUPBGV5VlBxhJ3c/rhl73szFu9fm/6Tk7JVHisE0Y9IHmmbebPL8998VgSPW0qgi2Tbmfut/dvD87cPLB7IpoxDpCxjYJC/qeEBcYxxqKMdzJs1BT8udzQp+r8Dhd3naCfO/vl9viDq/ezAa9rMRpBkBydl9kvXa+HRW1GUxZf3Brd2UrxeuqKApdebJkPZM2wvhX2RxCedfK1Wsg/ZAxD791hRV8NnX80QXqxKy4fXe//2Ix/kopFEp80hKJE/bPt0U/rjyS32lqt7GV4S+ywbhz6tGILD5qg1AbyNCRN3IhDrBp9S98vIa1Iz/Y2YxQI8qCu3O//a3TlTSs/pmHTPqPP2LmbuUsST+nFDvP7YV0a9rmyVvWRmqZwmgsQNaNr/fwmP+MgfUVluQarhS/tHwEGAEyHOx7EoDsBAAAAAElFTkSuQmCC","contentType":"image/png","type":"esriPMS"}).setOffset(0,10.875),toSymbolDrag:new _8bd({"url":_90e.basePath+"/images/Directions/redPointMove.png","height":21.75,"width":15.75,"imageData":"iVBORw0KGgoAAAANSUhEUgAAABUAAAAdCAYAAABFRCf7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0RDNTQyNTU2QzlCMTFFMkExREZEMUE4OEI2QURDNjEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0RDNTQyNTY2QzlCMTFFMkExREZEMUE4OEI2QURDNjEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3REM1NDI1MzZDOUIxMUUyQTFERkQxQTg4QjZBREM2MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3REM1NDI1NDZDOUIxMUUyQTFERkQxQTg4QjZBREM2MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PubpLUYAAAU3SURBVHjahFVbiFZVFF57n33Of5+LOWZFkOAMMQUh49jFyofGUIosIlBLgqCgB4NIEvNBItAHA6N6qhfTSkwxykZEfTFJLckixgsqli8zw4zaP//9nLMvrbXP/i+ORZtZs89eZ+1vf+tb69+HnVo1CDS8VABMeMAMLoI0cIBFRohVwPiIBjaA3hSACZnWl5iWR0HJ77SB35mS+BiBUQZNWywBt49+tO0mk1uZLXQHqUwW/CCF2AyMVBDHYV+jVl1aL5feg1p5FGM3ol3uBJgNulwF2Z09c+fenc0XAGHw9BiggUyMsQE+TkE2A4VsJqiWMi8Ub1x/mMnoVXx1rAnCOwCf5376wLw+BPR9MLUK6EoZNM71+f3w99KXoH5XP+h6BVRlBky1DNmUD/OQgBekD+D+52YzfdAw74veru681SgMwWiFbgPxwGKoP/GiDarfsxBAxiAungHG0ME41sGH3p7ewnQU7QKlH0fvGNcIYjjbVshlu5jBZ2SiwyqYGIHjGKKn1oLneS2LRl5B4Ah0hO8bNYwvA0eJCrlct9Zyq4oalukQBq9IeRxTRTCNFSQW+I9xDumvtoJJZUGt3gDenu2obxWICLICjZmwGEXGw9IcDxVipZRySBil1qU5FyZsYLbagSaARqPkE3/aM4glu3YegN7bAqI8KJGmw+kQlAKBRcWYdRyrOowcbToqioA99CSID/aBlihF0xBACNF61k3f1m9tvI4jUCiVRzjKDBPTBR4FISkxvBz81W/bokiRwlavOykSpjFutAMzglQm0XntOxBhu6kzR8BDtzF6gUBFclQQjc0tljxtA2lkt+2/pYEZSpLfcQj+dTy6AqonD4GmXtY6J7RUoU0LN8lThyE9uNjGlT5c34Sz/7s2fIy+t6ye9g+t+91Pklb7adRJgulr0xBMm7+kVH0+Vj888YOF6HpjC8Tnz4Jrxnb6F8669BNU8pU+ex8aJ0ZtARVeBoh3DVvKjMVKDwuqKILUjn8P9R8PtsBc7q1CtYeByZeHWgfQiOlCMZqa3+xtSJ2808lNo20abQPsU6t1Opf4qAMwhmLtHreXcLRhe9kfy+70rks42eN7S3wsVpJym+jCg5dvq8uVZ/vbMrhBLItS/zJXwGN0oSgUY3MlRonp1KapxKZ2bLzlZ0rrW+LQiH1ZWlE3E5735n15qClzVRoI0T/iE1nTLkbjynmQU+PgF3pgevdHUDy8z/oN/fpwpjYqxxoiDZtw6+6sYO1qHHtkHoGtRwW2dwme8hj878BEoCR1qJTGi4F/OnJ6qlO5dp1Hh+Ys8zn/vNvnCwP+38gRajgjzRVU7fVnfr15PGlg9+vr6HB69r6eqI8P5sRhZLsoYHCvBy68wyKkeDM2J3+bida8NlYcc/tbDJoLugIDtLSz4IG86N420LVnfuDdLzoIo/YwGamLmy6V1pyryBkijdZwRs/ScwzxSwk9aHPQeul5OtKZFIOrAxm+Is3xs2OLY6AYK/nNZGPL0RtRCeNyaBlHiI6mG0fxjtTTLihP9wkF7xyvXxsP9elQJQ1OM63J78CyLj7n9nvJRyZRSjn6NbSqm206yGh/VRFNfIEzrTtSnh1vP2ykpXZBpE/opGha+svJ+s+r7ggu5DkbnIn0BVq7uIabw4414WjhmEoHHrqiURq+0ypTlOZInzaDNON6km47BxA7ds399lvDW1dO+2XoNpXRimjTE5HaRXrSTGvnL7u40O1TzV7ls3rauNOUM2JTP16Mz+EVDDR3sGzG6M7Gp/GPAAMAKMYdXbFXj3QAAAAASUVORK5CYII=","contentType":"image/png","type":"esriPMS"}).setOffset(0,10.875),routeSymbol:new _8be().setColor(new _8a3([0,69,117,1])).setWidth(4),segmentSymbol:new _8be().setColor(new _8a3([0,122,194,1])).setWidth(8),printPage:"",showPrintPage:true,showSegmentPopup:true,showSegmentHighlight:true,centerAtSegmentStart:true,showReverseStopsButton:true,focusOnNewStop:true,dragging:true,canModifyStops:true};},_removeEmptyStops:function(){var _90f=this;var i;if(_90f._stops.length>_90f.get("minStops")){for(i=(_90f._stops.length-1);_90f._stops.length>_90f.get("minStops")&&i>-1;i--){var stop=_90f._stops[i];if(!stop||!stop.name){_90f.removeStop(i);}}}},_setReverseGeocode:function(_910){var _911=this;if(_910.name&&_910.feature.geometry){var _912={address:_910.name};if(_911._stopGraphics[_911._dragGraphic._index]){_911._stopGraphics[_911._dragGraphic._index].setAttributes(_912);_911._stopGraphics[_911._dragGraphic._index].setGeometry(_910.feature.geometry);}if(_911._textGraphics[_911._dragGraphic._index]){_911._textGraphics[_911._dragGraphic._index].setAttributes(_912);_911._textGraphics[_911._dragGraphic._index].setGeometry(_910.feature.geometry);}if(!_911._moveInProgress){_911._unsetDraggableObject(_911._dragGraphic);}if(_911.geocoders[_911._dragGraphic._index]){_911.geocoders[_911._dragGraphic._index].set("value",_910.name);}_911._stops[_911._dragGraphic._index]=_910;_911._setStops();_911.onUpdateStops(_911.get("stops")[_911._dragGraphic._index],_911._dragGraphic._index);if(_911.get("autoSolve")){_911._directionsDeferred=new _8b1();_911.set("directions",null);_911._configureRouteOptions();_911._routeTask.solve(_911._routeParams,function(_913){_911._showRoute(_913);},function(_914){_911._routeTaskError(_914);});}}},_insertStop:function(_915,_916){var _917=this;var _918=_917._dnd.getAllNodes();var _919=false,_91a=false;var _91b=_918.length;if(!_918[_916]){_91a=false;_919=false;}else{_91a=_918[_916];_919=true;}var tr=_8b0.create("tr",{className:_917._stopClass});var _91c=_8b0.create("td",{className:_917._stopIconColumnClass},tr);_8b0.create("div",{className:_917._stopIconClass+" dojoDndHandle",innerHTML:_917._getLetter(_91b)},_91c);var _91d=_8b0.create("td",{className:_917._esriStopGeocoderColumnClass},tr);var _91e=_8b0.create("div",{},_91d);if(_917.options.canModifyStops){var _91f=_8b0.create("td",{className:_917._stopIconRemoveColumnClass},tr);_8b0.create("div",{className:_917._stopIconRemoveClass,role:"button","data-remove":"true"},_91f);}_917._dnd.insertNodes(false,[tr],_919,_91a);_917._stops.splice(_916,0,_915);var _920=lang.mixin(_917.options.geocoderOptions,{value:_915.name});var _921=new _8af(_920,_91e);_921[_917._sortId]=tr.id;_917.geocoders.splice(_916,0,_921);_921.startup();var _922=_921.on("select",function(evt){if(evt.result){var _923=_917._dnd.getAllNodes();var _924=_8a2.indexOf(_923,tr);_917._stops[_924]=evt.result;_917._setStops();_917.onUpdateStops(_917.get("stops")[_924],_924);if(_917.get("autoSolve")){_917.getDirections().then(function(){_917.zoomToFullRoute();});}}});_917._geocoderSelectEvents[tr.id]=_922;var _925=_921.on("enter-key-select",function(evt){if(evt.result){var _926=_917._dnd.getAllNodes();var _927=_8a2.indexOf(_926,tr);_917._stops[_927]=evt.result;_917._setStops();_917.onUpdateStops(_917.get("stops")[_927],_927);if(_917.get("autoSolve")){_917.getDirections().then(function(){_917.zoomToFullRoute();});}}});_917._geocoderFindEvents[tr.id]=_925;var _928=_921.watch("value",function(name,_929,_92a){var _92b=_917._dnd.getAllNodes();var _92c=_8a2.indexOf(_92b,tr);if(_917._stops[_92c]&&_92a!==_917._stops[_92c].name){_917._stops[_92c]={name:_92a};_917._setStops();_917.onUpdateStops(_917.get("stops")[_92c],_92c);}});_917._geocoderWatchEvents[tr.id]=_928;_917._checkMaxStops();_917._fixIcons();if(_917._focusOnNewStop){_921.focus();}_917._stopsRemovable();_917._optionsMenu();_917._sortGeocoders();},_validateStops:function(_92d){var i;if(_92d){for(i=0;i<_92d.length;i++){if(!_92d[i]||!_92d[i].feature||!_92d[i].extent){return {error:true,index:i};}}}return {error:false};},_sortStops:function(){var _92e=this;if(_92e._stops.length){_92e._stops.sort(function(a,b){var _92f,_930;for(var i=0;i<_92e.geocoders.length;i++){var gId=_92e.geocoders[i][_92e._sortId];if(a[_92e._sortId]===gId){_92f=i;}else{if(b[_92e._sortId]===gId){_930=i;}}}if(_92f>_930){return 1;}else{if(_930>_92f){return -1;}else{return 0;}}});_92e._setStops();}},_getCandidate:function(stop,_931){var _932=this;var def=new _8b1();var _933=typeof stop;var _934={name:""};if(!stop){def.resolve(_934);}else{if(_933==="object"&&stop.hasOwnProperty("feature")&&stop.hasOwnProperty("name")){def.resolve(stop);}else{if(_933==="object"&&stop.hasOwnProperty("address")&&stop.hasOwnProperty("location")){var _935=_932._globalGeocoder._hydrateResult(stop);def.resolve(_935);}else{if(_933==="object"&&stop.hasOwnProperty("name")){stop=stop.name;}if(_932.geocoders[_931]){_934.name=_932.geocoders[_931].get("value");}_932._globalGeocoder.find(stop).then(function(_936){if(_936.results&&_936.results.length){def.resolve(_936.results[0]);}else{var _937=i18n.widgets.directions.error.locator;_932._resultError(_937);def.reject(_937);}},function(){var _938=i18n.widgets.directions.error.locator;_932._resultError(_938);def.reject(_938);});}}}return def;},_updateStop:function(e,_939){var _93a=this;var def=new _8b1();if(_93a._stops.length){if(typeof _939==="undefined"){_939=_93a._stops.length-1;}_93a._getCandidate(e,_939).then(function(_93b){if(_93a.geocoders[_939]){_93a.geocoders[_939].set("value",_93b.name);_93a._stops[_939]=_93b;_93a._setStops();}def.resolve(_93a._removeSortId(_93b));},function(_93c){def.reject(_93c);});}else{def.reject("could not update stop");}return def;},_showRoute:function(_93d){var _93e=this;_93e._clearInfoWindow();_93e._clearResultError();_93e.set("directions",_93d.routeResults[0].directions);var _93f=_93d.routeResults[0].stops;if(_93f&&_93f.length){var _940=[];var i;_93e._clearStopGraphics();var _941=_93f.length;if(_93e._startReturn){_941--;}for(i=0;i<_941;i++){var _942=_93f[i];var _943={extent:new _8ba({"xmin":_942.geometry.x-0.25,"ymin":_942.geometry.y-0.25,"xmax":_942.geometry.x+0.25,"ymax":_942.geometry.y+0.25,"spatialReference":_942.geometry.spatialReference}),feature:_942,name:_942.attributes.Name};_940.push(_943);}_93e._stops=_940;for(i=0;i<_93e._stops.length;i++){_93e._updateStop(_93e._stops[i],i);}_93e._setStops();_93e.onUpdateStops(_93e.get("stops"));_93e._setRouteSymbols();}_93e._clearRouteGraphics();_93e.set("mergedRouteGraphic",new _8b4(_93e.directions.mergedGeometry,_93e.options.routeSymbol));if(_93e.options.map&&_93e.options.map.graphics){_93e.options.map.graphics.add(_93e.get("mergedRouteGraphic"));var _944=_93e.get("mergedRouteGraphic").getDojoShape();if(_944){_944.moveToBack();}}_93e._addRouteSymbols();var html="";if(_93e._resultsNode){html+="<div class=\""+_93e._resultsRouteNameClass+"\">";html+=_93e.directions.routeName;html+="</div>";html+="<div class=\""+_93e._clearClass+"\"></div>";if(_93e.directions.totalLength||_93e.directions.totalTime){var _945=_93e._formatDistance(_93e.directions.totalLength,i18n.widgets.directions.units[_93e._getUnits(_93e.get("directionsLengthUnits"))].name);var _946=_93e._formatTime(_93e.directions.totalTime);html+="<div class=\""+_93e._resultsSummaryClass+"\">";if(_945){html+=_945;}if(_945&&_946){html+=" &middot; ";}if(_946){html+=_946;}html+="</div>";}html+="<div class=\""+_93e._clearClass+"\"></div>";html+="<div class=\""+_93e._resultsRouteButtonContainerClass+"\">";html+="<div tabindex=\"0\" role=\"button\" class=\""+_93e._resultsViewFullRouteClass+"\" data-full-route=\"true\">"+i18n.widgets.directions.viewFullRoute+"</div>";if(_93e.options.showPrintPage){html+="<div tabindex=\"0\" role=\"button\" title=\""+i18n.widgets.directions.print+"\" class=\""+_93e._resultsPrintClass+"\" data-print-directions=\"true\"></div>";}html+="<div class=\""+_93e._clearClass+"\"></div>";html+="</div>";html+="<div class=\""+_93e._routesClass+"\">";html+="<table summary=\""+_93e.directions.routeName+"\">";html+="<tbody role=\"menu\">";var _947=0;_8a2.forEach(_93e.directions.features,function(_948,i){var _949=_93e._routeClass;if(_948.attributes){_948.attributes.step=(i+1);}if(_948.attributes.maneuverType){_949+=" "+_948.attributes.maneuverType;}if(i===0||_93e._startReturn&&(i+1)===_93e.directions.features.length){_949+=" "+_93e._routeOriginClass;}else{if(i===(_93e.directions.features.length-1)||((_93e.stops.length-1)===_947&&(_948.attributes.maneuverType==="esriDMTStop"||_948.attributes.maneuverType==="esriDMTDepart"))){_949+=" "+_93e._routeDestinationClass;}}if(_93e.directions.features.length===(i+1)){_949+=" "+_93e._routeLastClass;}html+="<tr tabindex=\"0\" role=\"menuitem\" class=\""+_949+" "+_93e._routeZoomClass+"\" data-segment=\""+i+"\">";html+="<td class=\""+_93e._routeIconColumnClass+"\">";html+="<div class=\""+_93e._routeIconClass+"\">";if(i===0){html+=_93e._getLetter(_947);_947++;}else{if(_948.attributes.maneuverType==="esriDMTStop"){if(_93e._startReturn&&(i+1)===_93e.directions.features.length){html+=_93e._getLetter(0);}else{html+=_93e._getLetter(_947);}}else{if(_948.attributes.maneuverType==="esriDMTDepart"){html+=_93e._getLetter(_947);_947++;}}}html+="</div>";html+="</td>";html+="<td class=\""+_93e._routeTextColumnClass+"\">";html+="<div class=\""+_93e._routeInfoClass+"\">";html+="<div class=\""+_93e._routeTextClass+"\">";var _94a=_93e.directions.strings[i],j;if(_94a){var _94b=_948.attributes.text;for(j=0;j<_94a.length;j++){_94b=_93e._boldText(_94b,_94a[j].string);}_948.attributes.formattedText=_94b;}else{_948.attributes.formattedText=_948.attributes.text;}html+="<strong>"+_8ad.format(_948.attributes.step)+".</strong> "+_948.attributes.formattedText;html+="</div>";var _94c=_93e._formatDistance(_948.attributes.length,i18n.widgets.directions.units[_93e._getUnits(_93e.get("directionsLengthUnits"))].abbr);var time=_93e._formatTime(_948.attributes.time);if(_94c){html+="<div class=\""+_93e._routeLengthClass+"\">";html+=_94c;if(time){html+=" "+time;}html+="</div>";}html+="</div>";html+="</td>";html+="</tr>";});html+="</tbody>";html+="</table>";html+="</div>";if(_93e._resultsNode){_93e._resultsNode.innerHTML=html;}_93e._disconnectResults();var _94d=_8ac("[data-segment]",_93e._resultsNode);if(_94d&&_94d.length){_94d.forEach(function(node){var _94e=on(node,_8a7.enter,function(){var i=parseInt(_8ab.get(this,"data-segment"),10);_93e.highlightSegment(i);_93e.onSegmentHighlight(_93e.directions.features[i]);});_93e._resultEvents.push(_94e);var _94f=on(node,"focusin",function(){var i=parseInt(_8ab.get(this,"data-segment"),10);_93e.highlightSegment(i);_93e.onSegmentHighlight(_93e.directions.features[i]);});_93e._resultEvents.push(_94f);var _950=on(node,"focusout",function(){_93e.unhighlightSegment();});_93e._resultEvents.push(_950);var _951=on(node,_8a7.leave,function(){_93e.unhighlightSegment();});_93e._resultEvents.push(_951);if(_93e.options.centerAtSegmentStart){var _952=on(node,"click, keydown",function(e){if(e.type==="click"||(e.type==="keydown"&&e.keyCode===keys.ENTER)){var i=parseInt(_8ab.get(this,"data-segment"),10);_93e.centerAtSegmentStart(i);_93e.onSegmentSelect(_93e.directions.features[i]);}});_93e._resultEvents.push(_952);}});}}_93e.onDirectionsFinish(_93d);_93e._directionsDeferred.resolve(_93d);},_removeSortId:function(stop){var _953=this;var copy=lang.clone(stop);if(copy&&copy.hasOwnProperty(_953._sortId)){delete copy[_953._sortId];}return copy;},_removeSortIds:function(_954){var _955=this;var _956=[];if(_954&&_954.length){_956=lang.clone(_954);for(var i=0;i<_956.length;i++){_956[i]=_955._removeSortId(_956[i]);}}return _956;},_setStops:function(){var _957=this;var _958=[];var i;_957._ignoreStopsWatch=true;if(_957._stops&&_957._stops.length){for(i=0;i<_957._stops.length;i++){if(_957._stops[i]){_957._stops[i][_957._sortId]=_957.geocoders[i][_957._sortId];}}_958=_957._removeSortIds(_957._stops);}_957.set("stops",_958);_957._ignoreStopsWatch=false;},_getCandidates:function(_959){var _95a=this;var _95b=[];var i;if(_959&&_959.length){for(i=0;i<_959.length;i++){_95b.push(_95a._getCandidate(_959[i],i));}return all(_95b);}},_clearResultsHTML:function(){var _95c=this;if(_95c._resultsNode){_95c._resultsNode.innerHTML="";}},_showSegmentPopup:function(_95d){var _95e=this;if(_95d&&_95e.options.showSegmentPopup&&_95e.options.map&&_95e.options.map.infoWindow){var _95f=_95d.geometry;var _960=_95f.getPoint(0,0);var _961=new _8b4(_960,null,_95d.attributes,_95e.options.segmentInfoTemplate);_95e.options.map.infoWindow.setFeatures([_961]);_95e.options.map.infoWindow.show(_960);}},_removeStopButton:function(_962){var _963=this;if(_963._stops.length>_963.get("minStops")){_963.removeStop(_962);}},_updateStopsWatch:function(attr,_964,_965){var _966=this;if(_966.loaded&&!_966._ignoreStopsWatch){_966.updateStops(_965);}},_addStopButton:function(){var _967=this;_967.addStop();},_sortGeocoders:function(){var _968=this;var _969=_968._dnd.getAllNodes();_968.geocoders.sort(function(a,b){return _968._sortGeocodersToNodes(a,b,_969,_968._sortId);});_968._sortStops();},_disconnectResults:function(){var _96a=this,i;if(_96a._resultEvents.length){for(i=0;i<_96a._resultEvents.length;i++){_96a._resultEvents[i].remove();}}},_formatTime:function(time){var hr,min,str="";var _96b=Math.round(time);hr=Math.floor(_96b/60);min=Math.floor(_96b%60);if(hr){str+=hr+" ";if(hr>1){str+=i18n.widgets.directions.time.hours;}else{str+=i18n.widgets.directions.time.hour;}}if(hr&&min){str+=" ";}if(min){str+=min+" ";if(min>1){str+=i18n.widgets.directions.time.minutes;}else{str+=i18n.widgets.directions.time.minute;}}return str;},_formatDistance:function(dist,_96c){var d=Math.round(dist*100)/100;if(d===0){return "";}return _8ad.format(d)+" "+_96c;},_setMoveSymbol:function(_96d){var _96e=this;_96e._moveSymbolSet=true;var _96f=_96e._setStopSymbol(_96d._index,_96e._stopGraphics.length,true);_96d.setSymbol(_96f);},_unsetMoveSymbol:function(_970){var _971=this;var _972=_971._setStopSymbol(_970._index,_971._stopGraphics.length);_970.setSymbol(_972);_971._moveSymbolSet=false;},_removeTextGraphic:function(_973){var _974=this;var _975=_974._textGraphics[_973];_974.options.map.graphics.remove(_975);},_setDraggableObject:function(_976){var _977=this;if(_976._drag&&_977.options.map&&_977.options.map.graphics){_977._removeTextGraphic(_976._index);_977._dragGraphic=_976;_977._dragGeometry=_976.geometry;_977._edit.activate(Edit.MOVE,_976);}},_setTextGraphic:function(_978){var _979=this;if(_978._drag&&_979.options.map&&_979.options.map.graphics){var _97a=_979._textGraphics[_978._index];_97a.setGeometry(_978.geometry);_979.options.map.graphics.add(_97a);var _97b=_97a.getDojoShape();if(_97b){_97b.moveToFront();}}},_unsetDraggableObject:function(_97c){var _97d=this;if(_97c._drag){if(_97d._moveSymbolSet){_97d._unsetMoveSymbol(_97c);}_97d._setTextGraphic(_97c);_97d._edit.deactivate();}},_editToolbar:function(){var _97e=this;if(_97e.options.map){_97e._edit=new Edit(_97e.options.map);}},_createGlobalGeocoder:function(){var _97f=this;var def=new _8b1();if(_97f.options.map){_97f.options.geocoderOptions.map=_97f.options.map;}if(!_97f.options.geocoderOptions.theme){_97f.options.geocoderOptions.theme=_97f.get("theme");}if(!_97f.options.geocoderOptions.autoComplete){_97f.options.geocoderOptions.maxLocations=1;}_97f._globalGeocoder=new _8af(_97f.options.geocoderOptions,_8b0.create("div"));var _980=_97f._globalGeocoder.on("load",function(){def.resolve();});_97f._onEvents.push(_980);_97f._globalGeocoder.startup();return def;},_init:function(){var _981=this;_981._createGlobalGeocoder().then(function(){_981._createRouteTask();_981._editToolbar();_981._setEvents();if(!_981.options.canModifyStops){_8b0.destroy(_981._addDestinationNode);}_981._focusOnNewStop=_981.options.focusOnNewStop;if(_981.options.stops){_981.addStops(_981.options.stops).then(function(){if(_981._focusOnNewStop){_981.geocoders[0].focus();}});}_981.loaded=true;_981.onLoad();});},_calculateValidStops:function(){var _982=this,_983=0,i;var _984=_982._stops;for(i=0;i<_984.length;i++){if(_984[i]&&_984[i].name){_983++;}}return _983;},_setStopSymbol:function(i,_985,move){var _986=this;if(i===0){if(move&&_986.options.fromSymbolDrag){return _986.options.fromSymbolDrag;}return _986.options.fromSymbol;}else{if(i===(_985-1)){if(move&&_986.options.toSymbolDrag){return _986.options.toSymbolDrag;}return _986.options.toSymbol;}else{if(move&&_986.options.stopSymbolDrag){return _986.options.stopSymbolDrag;}return _986.options.stopSymbol;}}},_setRouteSymbols:function(){var _987=this,i;for(i=0;i<_987.stops.length;i++){var stop=_987.stops[i];if(stop&&stop.feature){var _988=_987._setStopSymbol(i,_987.stops.length);var _989=_987._defaultSR;if(_987.options.map){_989=_987.options.map.spatialReference;}var _98a=new _8b9(stop.feature.geometry.x,stop.feature.geometry.y,_989);var _98b=_987._getLetter(i);var _98c=new _8bf(_98b,_987.options.textSymbolFont,_987.options.textSymbolColor);if(_987.options.textSymbolOffset){_98c.setOffset(_987.options.textSymbolOffset.x,_987.options.textSymbolOffset.y);}var _98d=new _8b4(_98a,_98c);_98d._textGraphic=true;_98d._index=i;var _98e=new _8b4(_98a,_988,{address:stop.name},_987.options.stopsInfoTemplate);_98e._drag=true;_98e._index=i;_987._stopGraphics[i]=_98e;_987._textGraphics[i]=_98d;}}},_addRouteSymbols:function(){var _98f=this;var i;if(_98f._stopGraphics.length&&_98f.options.map&&_98f.options.map.graphics){for(i=0;i<_98f._stopGraphics.length;i++){_98f.options.map.graphics.add(_98f._stopGraphics[i]);var _990=_98f._stopGraphics[i].getDojoShape();if(_990){_990.moveToFront();}_98f.options.map.graphics.add(_98f._textGraphics[i]);var _991=_98f._textGraphics[i].getDojoShape();if(_991){_991.moveToFront();}}}},_showTrafficLayer:function(){var _992=this;if(_992.options.map&&!_992._trafficLayer&&_992.options.trafficLayer){_992._trafficLayer=_992.options.map.addLayer(_992.options.trafficLayer);}if(_992._trafficLayer){_992._trafficLayer.show();}},_hideTrafficLayer:function(){var _993=this;if(_993._trafficLayer){_993._trafficLayer.hide();}},_toggleUnits:function(e){var _994=this;if(e.target===_994._useMilesNode){_994.set("directionsLengthUnits",_8b5.MILES);}else{if(e.target===_994._useKilometersNode){_994.set("directionsLengthUnits",_8b5.KILOMETERS);}}},_toggleCheckbox:function(e){var _995=this;var _996=_8ab.get(e.target,"checked");if(e.target===_995._findOptimalOrderNode){_995.set("useOptimalRoute",_996);}else{if(e.target===_995._useTrafficNode){_995.set("traffic",_996);}else{if(e.target===_995._returnToStartNode){_995.set("returnToStart",_996);}}}},_configureRouteOptions:function(){var _997=this;_997._routeParams.directionsLengthUnits=_997.get("directionsLengthUnits");_997._routeParams.findBestSequence=_997.get("useOptimalRoute");if(_997._routeParams.findBestSequence){_997._routeParams.returnStops=true;}else{_997._routeParams.returnStops=false;}if(_997.get("traffic")){var now=new Date();var utc=new Date(now.getTime()-(now.getTimezoneOffset()*60*1000));_997._routeParams.startTime=utc;_997._showTrafficLayer();}else{_997._routeParams.startTime=null;_997._hideTrafficLayer();}if(_997.get("returnToStart")&&_997._stopGraphics.length){var _998=new _8b4(_997._stopGraphics[0].geometry,null,_997._stopGraphics[0].attributes);var _999=_997._stopGraphics.slice(0);_997._startReturn=_998;_999.push(_998);_997._routeParams.stops.features=_999;}else{_997._startReturn=null;_997._routeParams.stops.features=_997._stopGraphics;}},_configureRoute:function(){var _99a=this;_99a._setRouteSymbols();_99a._configureRouteOptions();_99a.set("directions",null);_99a._routeTask.solve(_99a._routeParams,function(_99b){_99a._showRoute(_99b);},function(_99c){_99a._routeTaskError(_99c);});},_boldText:function(_99d,_99e){return _99d.replace(new RegExp("(^|\\s)("+_99e+")(\\s|$)","ig"),"$1<strong>$2</strong>$3");},_clearStopGraphics:function(){var _99f=this;var i;if(_99f._stopGraphics.length&&_99f.options.map&&_99f.options.map.graphics){for(i=0;i<_99f._stopGraphics.length;i++){_99f.options.map.graphics.remove(_99f._stopGraphics[i]);_99f.options.map.graphics.remove(_99f._textGraphics[i]);}}_99f._stopGraphics=[];_99f._textGraphics=[];},_clearRouteGraphics:function(){var _9a0=this;if(_9a0.get("mergedRouteGraphic")&&_9a0.options.map&&_9a0.options.map.graphics){_9a0.options.map.graphics.remove(_9a0.get("mergedRouteGraphic"));_9a0.set("mergedRouteGraphic",null);}_9a0.unhighlightSegment();},_clearInfoWindow:function(){var _9a1=this;if(_9a1.options.map&&_9a1.options.map.infoWindow){_9a1.options.map.infoWindow.hide();if(_9a1.options.map.infoWindow.features){_9a1.options.map.infoWindow.clearFeatures();}}},_getLetter:function(i){var _9a2=this.options.alphabet;var _9a3="";if(_9a2&&_9a2.length){if(!i){i=0;}if(i>=_9a2.length){i=_9a2.length-1;}if(typeof _9a2==="string"){_9a3=_9a2.substr(i,1);}else{if(_9a2 instanceof Array){_9a3=_9a2[i];}}}return _9a3;},_directionsButton:function(){var _9a4=this;_9a4._removeEmptyStops();_9a4.getDirections().then(function(){_9a4.zoomToFullRoute();});},_fixIcons:function(){var _9a5=this,i,_9a6=_9a5._dnd.getAllNodes();for(i=0;i<_9a6.length;i++){var icon=_8ac("."+_9a5._stopIconClass,_9a6[i])[0];if(icon){icon.innerHTML=_9a5._getLetter(i);}_8aa.remove(_9a6[i],_9a5._stopOriginClass+" "+_9a5._stopDestinationClass);if(i===0){_8aa.add(_9a6[i],_9a5._stopOriginClass);}else{if(i===(_9a6.length-1)){_8aa.add(_9a6[i],_9a5._stopDestinationClass);}}}if(_9a5.options.showReverseStopsButton){var _9a7=_8ac("[data-reverse-td]",_9a5._dndNode)[0];_8b0.destroy(_9a7);_8b0.create("td",{"data-reverse-td":"true",rowspan:_9a6.length,className:_9a5._esriStopReverseColumnClass,innerHTML:"<div role=\"button\" class=\""+_9a5._reverseStopsClass+"\" data-reverse-stops=\"true\" title=\""+i18n.widgets.directions.reverseDirections+"\"></div>"},_9a6[0]);}},_setEvents:function(){var _9a8=this;var _9a9=on(_9a8._dndNode,"[data-reverse-stops]:click, [data-reverse-stops]:keydown",function(e){if(e.type==="click"||(e.type==="keydown"&&e.keyCode===keys.ENTER)){_9a8._reverseStops();}});_9a8._onEvents.push(_9a9);var _9aa=on(_9a8._resultsNode,"[data-print-directions]:click, [data-print-directions]:keydown",function(e){if(e.type==="click"||(e.type==="keydown"&&e.keyCode===keys.ENTER)){_9a8._printDirections();}});_9a8._onEvents.push(_9aa);var _9ab=on(_9a8._resultsNode,"[data-full-route]:click, [data-full-route]:keydown",function(e){if(e.type==="click"||(e.type==="keydown"&&e.keyCode===keys.ENTER)){_9a8.zoomToFullRoute();}});_9a8._onEvents.push(_9ab);var _9ac=on(_9a8._dndNode,"[data-remove]:click, [data-remove]:keydown",function(e){if(e.type==="click"||(e.type==="keydown"&&e.keyCode===keys.ENTER)){var _9ad=_8ac("[data-remove]",_9a8._dndNode);var _9ae=_8a2.indexOf(_9ad,this);_9a8._removeStopButton(_9ae);}});_9a8._onEvents.push(_9ac);var _9af=on(_9a8._dnd,"Drop",function(){_9a8._dnd.sync();_9a8._sortGeocoders();_9a8._fixIcons();_9a8.onUpdateStops(_9a8.get("stops"));if(_9a8._calculateValidStops()===_9a8.geocoders.length&&_9a8._routeParams.stops.features.length){if(_9a8.get("autoSolve")){_9a8.getDirections().then(function(){_9a8.zoomToFullRoute();});}}});_9a8._onEvents.push(_9af);var _9b0=on(_9a8._dnd,"DndStart",function(){var body=_8ac("body")[0];_8aa.add(body,_9a8._dndDragBodyClass);});_9a8._onEvents.push(_9b0);var _9b1=on(_9a8._dnd,"DndDrop, DndCancel",function(){var body=_8ac("body")[0];_8aa.remove(body,_9a8._dndDragBodyClass);});_9a8._onEvents.push(_9b1);if(_9a8.options.map&&_9a8.options.map.graphics){if(_9a8.options.dragging){var _9b2=_9a8.options.map.graphics.on("mouse-over",function(e){var _9b3;if(e.graphic._drag){_9b3=_9a8._edit.getCurrentState();if(!_9b3.graphic){_9a8._setDraggableObject(e.graphic);}if(!_9a8._moveSymbolSet){_9a8._setMoveSymbol(e.graphic);}}else{if(e.graphic._textGraphic){_9b3=_9a8._edit.getCurrentState();if(_9a8._stopGraphics[e.graphic._index]){if(!_9b3.graphic){_9a8._setDraggableObject(_9a8._stopGraphics[e.graphic._index]);}if(!_9a8._moveSymbolSet){_9a8._setMoveSymbol(_9a8._stopGraphics[e.graphic._index]);}}}}});_9a8._onEvents.push(_9b2);var _9b4=_9a8.options.map.graphics.on("mouse-out",function(e){if(!_9a8._moveInProgress&&e.graphic._drag){_9a8._unsetDraggableObject(e.graphic);}});_9a8._onEvents.push(_9b4);}var _9b5=_8a1.connect(_9a8._edit,"onGraphicClick",function(e){if(_9a8.options.map&&_9a8.options.map.infoWindow){_9a8.options.map.infoWindow.setFeatures([e]);_9a8.options.map.infoWindow.show(e.geometry);}});_9a8._connectEvents.push(_9b5);var _9b6=_8a1.connect(_9a8._edit,"onGraphicFirstMove",function(){_9a8._moveInProgress=true;});_9a8._connectEvents.push(_9b6);var _9b7=_8a1.connect(_9a8._edit,"onGraphicMoveStop",function(_9b8){_9a8._moveInProgress=false;_9a8._unsetDraggableObject(_9b8);if(_9a8._dragGeometry!==_9b8.geometry){_9a8._currentEditableGraphic=_9b8;if(_9a8.get("autoSolve")){_9a8.onDirectionsStart();_9a8._clearInfoWindow();_9a8._clearResultsHTML();}_9a8._globalGeocoder.find(_9b8.geometry).then(function(_9b9){if(_9b9&&_9b9.results.length){_9a8._setReverseGeocode(_9b9.results[0]);}else{_9a8._reverseGeocodeError(new Error(i18n.widgets.directions.error.locator));}},function(_9ba){_9a8._reverseGeocodeError(_9ba);});}});_9a8._connectEvents.push(_9b7);}},_reverseGeocodeError:function(_9bb){var _9bc=this;_9bc.onDirectionsFinish(_9bb);var _9bd=i18n.widgets.directions.error.locator;_9bc._resultError(_9bd);_9bc._clearRouteGraphics();_9bc._currentEditableGraphic.setAttributes({error:_9bd});var _9be=_9bc._currentEditableGraphic._index;_9bc._updateStop({name:""},_9be).then(function(resp,i){_9bc.onUpdateStops(resp,i);});},_routeTaskError:function(_9bf){var _9c0=this;var _9c1=i18n.widgets.directions.error.routeTask;_9c0._resultError(_9c1);_9c0._directionsDeferred.reject(_9bf);_9c0.onDirectionsFinish(_9bf);},_clearResultError:function(){var _9c2=this;_9c2._errors=[];if(_9c2._errorNode){_9c2._errorNode.innerHTML="";}},_resultError:function(_9c3){var _9c4=this;var html="";_9c4._errors.push(_9c3);html+="<div class=\""+_9c4._routesErrorClass+"\">";if(_9c4._errors.length){html+="<ul>";for(var i=0;i<_9c4._errors.length;i++){html+="<li>"+_9c4._errors[i]+"</li>";}html+="</ul>";}html+="</div>";if(_9c4._errorNode){_9c4._errorNode.innerHTML=html;}},_getUnits:function(unit){switch(unit){case _8b5.KILOMETERS:return "KILOMETERS";case _8b5.METERS:return "METERS";case _8b5.NAUTICAL_MILES:return "NAUTICAL_MILES";default:return "MILES";}},_createRouteTask:function(){var _9c5=this;_9c5._routeTask=new _8c3(_9c5.options.routeTaskUrl);_9c5._routeParams=new _8c4();var _9c6={returnRoutes:false};var _9c7={directionsOutputType:"complete",stops:new _8c2(),returnDirections:true,doNotLocateOnRestrictedElements:true};if(_9c5.options.map){_9c7.outSpatialReference=_9c5.options.map.spatialReference;}else{_9c7.outSpatialReference=_9c5._defaultSR;}if(_9c5.options.routeParams){lang.mixin(_9c5._routeParams,_9c6,_9c5.options.routeParams,_9c7);}_9c5._configureRouteOptions();},_reverseStops:function(){var _9c8=this;var _9c9=_9c8._dnd.getAllNodes();if(_9c9.length){_9c9.reverse();_9c8._dnd.clearItems();_9c8._dnd.insertNodes(false,_9c9);_9c8._dnd.sync();_9c8._stopsRemovable();_9c8._optionsMenu();_9c8._checkMaxStops();_9c8._fixIcons();_9c8._sortGeocoders();_9c8.onUpdateStops(_9c8.get("stops"));if(_9c8.get("autoSolve")){_9c8.getDirections().then(function(){_9c8.zoomToFullRoute();});}}},_setTemplates:function(){var _9ca=this;_9ca._routeTpl="";_9ca._routeTpl+="<div class=\"${maneuverType}\">";_9ca._routeTpl+="<div class=\""+_9ca._routeIconClass+" "+_9ca._infoWindowRouteClass+"\">";_9ca._routeTpl+="<strong>${step}.</strong> ${formattedText}";_9ca._routeTpl+="</div>";_9ca._routeTpl+="</div>";_9ca._stopTpl="${address}${error}";},_setClasses:function(){var _9cb=this;_9cb._widgetContainerClass="esriDirectionsContainer";_9cb._stopsContainerClass="esriStopsContainer";_9cb._reverseStopsClass="esriStopsReverse";_9cb._addStopsClass="esriStopsAdd";_9cb._stopsClass="esriStops";_9cb._stopsRemovableClass="esriStopsRemovable";_9cb._stopsButtonContainerClass="esriStopsButtons";_9cb._stopsOptionsButtonClass="esriStopsOptionsButton";_9cb._stopsAddDestinationClass="esriStopsAddDestination";_9cb._stopsGetDirectionsContainerClass="esriStopsGetDirectionsContainer";_9cb._stopsGetDirectionsClass="esriStopsGetDirections";_9cb._stopsClearDirectionsClass="esriStopsClearDirections";_9cb._stopsOptionsOptionsEnabledClass="esriStopsOptionsEnabled";_9cb._stopsOptionsMenuClass="esriStopsOptionsMenu";_9cb._stopsFindOptimalOrderClass="esriFindOptimalOrderOption";_9cb._stopsUseTrafficClass="esriUseTrafficOption";_9cb._stopsReturnToStartClass="esriReturnToStartOption";_9cb._stopsOptionsCheckboxesClass="esriOptionsCheckboxes";_9cb._stopsOptionsUnitsClass="esriOptionsUnits";_9cb._stopClass="esriStop";_9cb._stopOriginClass="esriStopOrigin";_9cb._stopDestinationClass="esriStopDestination";_9cb._esriStopGeocoderColumnClass="esriStopGeocoderColumn";_9cb._esriStopReverseColumnClass="esriStopReverseColumn";_9cb._stopIconColumnClass="esriStopIconColumn";_9cb._stopIconClass="esriStopIcon";_9cb._stopIconRemoveColumnClass="esriStopIconRemoveColumn";_9cb._stopIconRemoveClass="esriStopIconRemove";_9cb._resultsContainerClass="esriResultsContainer";_9cb._resultsLoadingClass="esriResultsLoading";_9cb._resultsPrintClass="esriResultsPrint";_9cb._resultsSummaryClass="esriResultsSummary";_9cb._resultsViewFullRouteClass="esriResultsViewFullRoute";_9cb._resultsRouteNameClass="esriResultsRouteName";_9cb._resultsRouteButtonContainerClass="esriResultsButtonsContainer";_9cb._routesContainerClass="esriRoutesContainer";_9cb._routesClass="esriRoutes";_9cb._routesErrorClass="esriRoutesError";_9cb._routeClass="esriRoute";_9cb._routeTextColumnClass="esriRouteTextColumn";_9cb._routeTextClass="esriRouteText";_9cb._routeLengthClass="esriRouteLength";_9cb._routeOriginClass="esriDMTStopOrigin";_9cb._routeDestinationClass="esriDMTStopDestination";_9cb._routeLastClass="esriDMTStopLast";_9cb._routeInfoClass="esriRouteInfo";_9cb._routeIconColumnClass="esriRouteIconColumn";_9cb._routeIconClass="esriRouteIcon";_9cb._infoWindowRouteClass="esriInfoWindowRoute";_9cb._routeZoomClass="esriRouteZoom";_9cb._esriPrintPageClass="esriPrintPage";_9cb._esriPrintBarClass="esriPrintBar";_9cb._esriPrintButtonClass="esriPrintButton";_9cb._esriCloseButtonClass="esriCloseButton";_9cb._esriPrintMainClass="esriPrintMain";_9cb._esriPrintHeaderClass="esriPrintHeader";_9cb._esriPrintLogoClass="esriPrintLogo";_9cb._esriPrintNameClass="esriPrintName";_9cb._esriPrintNotesClass="esriPrintNotes";_9cb._esriPrintLengthClass="esriPrintLength";_9cb._esriPrintDirectionsClass="esriPrintDirections";_9cb._esriPrintFooterClass="esriPrintFooter";_9cb._esriPrintStopLabelClass="esriPrintStopLabel";_9cb._clearClass="esriClear";_9cb._dndDragBodyClass="esriDndDragDirection";},_setPrivateDefaults:function(){var _9cc=this;_9cc._sortId="_dndId";_9cc._stops=[];_9cc._i18n=i18n;_9cc._onEvents=[];_9cc._connectEvents=[];_9cc._watchEvents=[];_9cc._geocoderSelectEvents=[];_9cc._geocoderFindEvents=[];_9cc._geocoderWatchEvents=[];_9cc._resultEvents=[];_9cc._stopGraphics=[];_9cc._textGraphics=[];_9cc._errors=[];_9cc._defaultSR=new _8b7(4326);},_sortGeocodersToNodes:function(a,b,_9cd,id){var aId=a[id];var bId=b[id];var aDnd=dom.byId(aId);var bDnd=dom.byId(bId);var _9ce=_8a2.indexOf(_9cd,aDnd);var _9cf=_8a2.indexOf(_9cd,bDnd);var i;for(i=0;i<_9cd.length;i++){if(i===_9ce){return -1;}else{if(i===_9cf){return 1;}}}},_setOptions:function(){var _9d0=this;var _9d1=_9d0.get("optimalRoute")||false;if(_9d0._findOptimalOrderNode){_8ab.set(_9d0._findOptimalOrderNode,"checked",_9d1);}var _9d2=_9d0.get("returnToStart")||false;if(_9d0._returnToStartNode){_8ab.set(_9d0._returnToStartNode,"checked",_9d2);}var _9d3=_9d0.get("traffic")||false;if(_9d0._useTrafficNode){_8ab.set(_9d0._useTrafficNode,"checked",_9d3);}var _9d4=_9d0.get("directionsLengthUnits");switch(_9d4){case _8b5.KILOMETERS:_8ab.set(_9d0._useKilometersNode,"checked",true);_8ab.set(_9d0._useMilesNode,"checked",false);break;case _8b5.MILES:_8ab.set(_9d0._useKilometersNode,"checked",false);_8ab.set(_9d0._useMilesNode,"checked",true);break;}},_widgetProperties:function(){var _9d5=this;_9d5.set("theme",_9d5.options.theme);_9d5.set("showTrafficOption",_9d5.options.showTrafficOption);_9d5.set("showReturnToStartOption",_9d5.options.showReturnToStartOption);_9d5.set("showUseOptimalRouteOption",_9d5.options.showUseOptimalRouteOption);_9d5.set("optimalRoute",_9d5.options.useOptimalRoute);_9d5.set("returnToStart",_9d5.options.returnToStart);_9d5.set("traffic",_9d5.options.traffic);_9d5.set("minStops",_9d5.options.minStops);_9d5.set("maxStops",_9d5.options.maxStops);_9d5.set("printPage",_9d5.options.printPage);_9d5.set("autoSolve",_9d5.options.autoSolve);var _9d6=_8b5.KILOMETERS;if(_9d5.options.routeParams.directionsLengthUnits){_9d6=_9d5.options.routeParams.directionsLengthUnits;}else{if(_9d5.options.routeParams.directionsLanguage){_9d6=_9d5.options.routeParams.directionsLanguage==="en"?_8b5.MILES:_8b5.KILOMETERS;}}_9d5.set("directionsLengthUnits",_9d6);},_optionsMenu:function(){var _9d7=this;if(_9d7._useTrafficItemNode){if(_9d7.get("showTrafficOption")){_8a9.set(_9d7._useTrafficItemNode,"display","block");}else{_8a9.set(_9d7._useTrafficItemNode,"display","none");}}if(_9d7._returnToStartItemNode){if(_9d7.get("showReturnToStartOption")){_8a9.set(_9d7._returnToStartItemNode,"display","block");}else{_8a9.set(_9d7._returnToStartItemNode,"display","none");}}if(_9d7._findOptimalOrderItemNode){if(_9d7.get("showUseOptimalRouteOption")&&_9d7._stops.length>=4){_8a9.set(_9d7._findOptimalOrderItemNode,"display","block");}else{_8a9.set(_9d7._findOptimalOrderItemNode,"display","none");}}if(_9d7._stops.length>=_9d7.get("minStops")){_8aa.add(_9d7._widgetContainer,_9d7._stopsOptionsOptionsEnabledClass);}else{_8aa.remove(_9d7._widgetContainer,_9d7._stopsOptionsOptionsEnabledClass);if(_9d7._optionsMenuNode){var _9d8=_8a9.get(_9d7._optionsMenuNode,"display");if(_9d8==="block"){_9d7._toggleOptionsMenu();}}if(_9d7.loaded){_9d7._configureRouteOptions();}}},_stopsRemovable:function(){var _9d9=this;if(_9d9.geocoders.length>_9d9.get("minStops")){_8aa.add(_9d9._widgetContainer,_9d9._stopsRemovableClass);}else{_8aa.remove(_9d9._widgetContainer,_9d9._stopsRemovableClass);}},_checkMaxStops:function(){var _9da=this;if(_9da._stops.length<_9da.get("maxStops")){_9da._showAddDestination();_9da.set("maxStopsReached",false);}else{_9da._hideAddDestination();_9da.set("maxStopsReached",true);}},_updateThemeWatch:function(attr,_9db,_9dc){var _9dd=this;if(_9dd.loaded){_8aa.remove(_9dd.domNode,_9db);_8aa.add(_9dd.domNode,_9dc);}},_toggleOptionsMenu:function(){var _9de=this;if(_9de._optionsMenuNode){var _9df=_8a9.get(_9de._optionsMenuNode,"display");if(_9df==="block"){_8a9.set(_9de._optionsMenuNode,"display","none");_9de._optionsButtonNode.innerHTML=i18n.widgets.directions.showOptions;}else{_8a9.set(_9de._optionsMenuNode,"display","block");_9de._optionsButtonNode.innerHTML=i18n.widgets.directions.hideOptions;}}},_hideAddDestination:function(){var _9e0=this;_8aa.remove(_9e0._widgetContainer,_9e0._addStopsClass);},_showAddDestination:function(){var _9e1=this;_8aa.add(_9e1._widgetContainer,_9e1._addStopsClass);},_getAbsoluteUrl:function(){var url=_89f.toUrl("esri/dijit");if(/^https?\:/i.test(url)){return url;}else{if(/^\/\//i.test(url)){return window.location.protocol+url;}else{if(/^\//i.test(url)){return window.location.protocol+"//"+window.location.host+url;}}}},_getManeuverImage:function(_9e2){var _9e3=this;if(_9e2){var _9e4=_9e3._getAbsoluteUrl()+"/images/Directions/maneuvers/";var _9e5=".png";if(_9e2==="esriDMTStop"||_9e2==="esriDMTDepart"){return "";}return _9e4+_9e2+_9e5;}return "";},_loadPrintDirections:function(){var _9e6=this;var _9e7=_9e6._getAbsoluteUrl()+"/css/Directions.css";var _9e8=_9e6._getAbsoluteUrl()+"/css/DirectionsPrint.css";var dir;if(_8a8.isBodyLtr()){dir="ltr";}else{dir="rtl";}var _9e9="";_9e9+="<!DOCTYPE HTML>";_9e9+="<html lang=\"en\" class=\""+_9e6.get("theme")+"\" dir=\""+dir+"\">";_9e9+="<head>";_9e9+="<meta charset=\"utf-8\">";_9e9+="<meta http-equiv=\"X-UA-Compatible\" content=\"IE=Edge,chrome=1\">";_9e9+="<title>"+_9e6.directions.routeName+"</title>";_9e9+="<link rel=\"stylesheet\" media=\"screen\" type=\"text/css\" href=\""+_9e7+"\" />";_9e9+="<link rel=\"stylesheet\" media=\"print\" type=\"text/css\" href=\""+_9e8+"\" />";_9e9+="</head>";_9e9+="<body class=\""+_9e6._esriPrintPageClass+"\">";_9e9+="<div class=\""+_9e6._esriPrintBarClass+"\">";_9e9+="<div class=\""+_9e6._esriCloseButtonClass+"\" title=\""+i18n.common.close+"\" onclick=\"window.close();\">"+i18n.common.close+"</div>";_9e9+="<div id=\"printButton\" class=\""+_9e6._esriPrintButtonClass+"\" title=\""+i18n.widgets.directions.print+"\" onclick=\"window.print();\">"+i18n.widgets.directions.print+"</div>";_9e9+="</div>";_9e9+="<div class=\""+_9e6._esriPrintMainClass+"\">";_9e9+="<div class=\""+_9e6._esriPrintHeaderClass+"\">";_9e9+="<img class=\""+_9e6._esriPrintLogoClass+"\" src=\"https://www.arcgis.com/about/graphics/logo-esri.png\" />";_9e9+="<div class=\""+_9e6._esriPrintNameClass+"\">"+_9e6.directions.routeName+"</div>";_9e9+="<div class=\""+_9e6._esriPrintLengthClass+"\">"+_9e6._formatDistance(_9e6.directions.totalLength,i18n.widgets.directions.units[_9e6._getUnits(_9e6.get("directionsLengthUnits"))].name)+". "+_9e6._formatTime(_9e6.directions.totalTime)+"</div>";_9e9+="<div id=\"print_helper\"></div>";_9e9+="<textarea onkeyup=\"document.getElementById('print_helper').innerHTML=this.value;\" id=\"print_area\" class=\""+_9e6._esriPrintNotesClass+"\" placeholder=\""+i18n.widgets.directions.printNotes+"\"></textarea>";_9e9+="<div class=\""+_9e6._clearClass+"\"></div>";_9e9+="</div>";_9e9+="<div class=\""+_9e6._esriPrintDirectionsClass+"\">";_9e9+="<table>";_9e9+="<tbody>";var _9ea=0;_8a2.forEach(_9e6.directions.features,function(_9eb,i){var _9ec=_9e6.directions.strings[i],j;if(_9ec){var _9ed=_9eb.attributes.text;for(j=0;j<_9ec.length;j++){_9ed=_9e6._boldText(_9ed,_9ec[j].string);}_9eb.attributes.formattedText=_9ed;}else{_9eb.attributes.formattedText=_9eb.attributes.text;}var _9ee="";if(_9e6.directions.features.length===(i+1)){_9ee=_9e6._routeLastClass;}if(_9eb.attributes){_9eb.attributes.step=(i+1);}_9e9+="<tr class=\""+_9ee+"\">";_9e9+="<td class=\""+_9e6._routeIconColumnClass+"\">";var _9ef=_9e6._getManeuverImage(_9eb.attributes.maneuverType);var _9f0;if(i===0){_9f0=_9e6._getLetter(_9ea);_9ea++;}else{if(_9eb.attributes.maneuverType==="esriDMTStop"){_9f0=_9e6._getLetter(_9ea);}else{if(_9eb.attributes.maneuverType==="esriDMTDepart"){_9f0=_9e6._getLetter(_9ea);_9ea++;}}}if(_9ef){_9e9+="<img src=\""+_9ef+"\" />";}else{if(_9f0){_9e9+="<div class=\""+_9e6._esriPrintStopLabelClass+"\">";_9e9+=_9f0;_9e9+="</div>";}}_9e9+="</td>";_9e9+="<td class=\""+_9e6._routeTextColumnClass+"\">";_9e9+="<div><strong>"+_8ad.format(_9eb.attributes.step)+".</strong> "+_9eb.attributes.formattedText+"</div>";_9e9+="</td>";_9e9+="<td class=\""+_9e6._routeTextColumnClass+"\">";_9e9+="<div class=\""+_9e6._routeLengthClass+"\">"+_9e6._formatDistance(_9eb.attributes.length,i18n.widgets.directions.units[_9e6._getUnits(_9e6.get("directionsLengthUnits"))].abbr)+"</div>";_9e9+="</td>";_9e9+="</tr>";});_9e9+="</tbody>";_9e9+="</table>";_9e9+="</div>";_9e9+="<div class=\""+_9e6._esriPrintFooterClass+"\">";_9e9+="<p>"+i18n.widgets.directions.printDisclaimer+"</p>";_9e9+="</div>";_9e9+="</div>";_9e9+="</body>";_9e9+="</html>";_9e6._printWindow.document.open("text/html","replace");_9e6._printWindow.document.write(_9e9);_9e6._printWindow.document.close();},_printDirections:function(){var _9f1=this;var w=screen.width/2;var h=screen.height/1.5;var left=(screen.width/2)-(w/2);var top=(screen.height/2)-(h/2);var _9f2="toolbar=no, location=no, directories=no, status=yes, menubar=no, scrollbars=yes, resizable=yes, width="+w+", height="+h+", top="+top+", left="+left;if(_9f1.printPage){window.directions=_9f1.directions;window.open(_9f1.printPage,"directions_widget_print",_9f2,true);}else{_9f1._printWindow=window.open("","directions_widget_print",_9f2,true);_9f1._loadPrintDirections();}}});if(has("extend-esri")){lang.setObject("dijit.Directions",_8c5,_8b3);}return _8c5;});},"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n","esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel"],function(lang,_9f3,has,_9f4){var util={};util={findFeatures:function(ids,_9f5,_9f6){var _9f7=_9f5.objectIdField;var _9f8=_9f5.graphics;var _9f9=_9f3.filter(_9f8,function(_9fa){return _9f3.some(ids,function(id){return _9fa.attributes[_9f7]===id.objectId;});});if(_9f6){_9f6(_9f9);}else{return _9f9;}},getSelection:function(_9fb){var _9fc=[];_9f3.forEach(_9fb,function(_9fd){var _9fe=_9fd.getSelectedFeatures();_9f3.forEach(_9fe,function(_9ff){_9fc.push(_9ff);});});return _9fc;}};if(has("extend-esri")){lang.setObject("dijit.editing.Util.LayerHelper",util,_9f4);}return util;});},"esri/dijit/Gallery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/kernel","dojo/has","dojo/query","dojo/dom","dojo/dom-construct","dojo/dom-class","dojo/dom-geometry","esri/kernel","esri/dijit/_TouchBase","esri/Evented"],function(_a00,lang,_a01,_a02,_a03,has,_a04,dom,_a05,_a06,_a07,_a08,_a09,_a0a){var GAL=_a00(_a0a,{declaredClass:"esri.dijit.Gallery",container:null,_items:[],_currentIndex:0,_left:0,_offset:10,_slideDiv:null,_thumbnailStyle:"default",_focusedIndex:null,_selectedIndex:-1,_slideStep:1,_showTitle:true,_eventMap:{"select":["item"],"focus":["item"]},constructor:function(_a0b,_a0c){var i;this.container=dom.byId(_a0c);this._touchBase=_a09(this.container,null);this._slideDiv=_a05.create("div",{"class":"slideContainer"},this.container,"first");this.events=[_a01.connect(this._touchBase,"onTouchStart",this,this._onTouchStartHandler),_a01.connect(this._touchBase,"onTouchMove",this,this._onTouchMoveHandler),_a01.connect(this._touchBase,"onTouchEnd",this,this._onTouchEndHandler),_a01.connect(this._touchBase,"onclick",this,this._onClickHandler)];this._resizeHandle=_a01.connect(window,"onorientationchange",lang.hitch(this,this._onResizeHandler));this._items=_a0b.items;if(_a0b.thumbnailStyle&&_a0b.thumbnailStyle=="small"){this._thumbnailStyle="small";this._offset=4;this._slideStep=3;this._thumbnailWidth=100;}else{this._thumbnailStyle="default";this._offset=10;this._slideStep=1;this._thumbnailWidth=200;}if(_a0b.showTitle==false){this._showTitle=false;}this.container.setAttribute((document.all?"className":"class"),"esriMobileGallery");var _a0d,_a0e;for(i=0;i<this._items.length;i++){var div,_a0f,_a10,img;div=_a05.create("div",{"class":"thumbnailcontainer"},this._slideDiv);img=_a05.create("img",{"class":"thumbnail",src:this._items[i].thumbnailUrl},div);img._index=i;img._item=this._items[i];_a0f=_a05.create("div",{"class":"title","innerHTML":this._items[i].title},div);_a10=_a05.create("div",{"class":"title"},div);if(this._thumbnailStyle=="small"){_a06.add(div,"small");_a06.add(img,"small");_a06.add(_a0f,"small");_a06.add(_a10,"small");_a06.add(this._slideDiv,"small");}if(!this._showTitle){_a0f.style.display="none";}_a0e=_a07.getContentBox(div).h;if(!_a0d){_a0d=_a0e;}if(_a0e>_a0d){_a0d=_a0e;}}for(i=0;i<this._slideDiv.childNodes.length;i++){_a07.getContentBox(this._slideDiv.childNodes[i],{h:_a0d});}this._thumbnailWidth=_a07.getContentBox(this._slideDiv.childNodes[0]).w;this._slideDiv.style.width=this._items.length*(this._thumbnailWidth+this._offset)+"px";if(window.orientation){if(window.orientation==90||window.orientation==-90){_a06.add(this.container,"galleryLandscape");}}this._calculateSlideStep();},startup:function(){this._focusedIndex=0;this.onFocus(this._items[this._focusedIndex]);},destroy:function(){_a02.forEach(this.events,_a01.disconnect);_a01.disconnect(this._resizeHandle);this._touchBase=null;_a03.query("img",this.container).forEach(function(node){node._index=null;node._item=null;_a05.destroy(node);node=null;});this._items=null;_a05.destroy(this._slideDiv);_a05.destroy(this.container);this.container=this._slideDiv=null;},setFocus:function(item){var i,il;if(!item){return;}for(i=0,il=this._items.length;i<il;i++){if(this._items[i]==item){this._setFocus(i);this.onFocus(this._items[this._focusedIndex]);}}},select:function(item){var i,il;if(!item){return;}for(i=0,il=this._items.length;i<il;i++){if(this._items[i]==item){if(this._selectedIndex!=-1){this.onUnSelect(this._items[this._selectedIndex]);}this._select(i);this.onSelect(this._items[this._selectedIndex]);break;}}},getFocusedItem:function(){return this._items[this._focusedIndex];},getSelectedItem:function(){return this._items[this._selectedIndex];},next:function(){this._next();this._startTransition();this.onFocus(this._items[this._currentIndex]);},previous:function(){this._previous();this._startTransition();this.onFocus(this._items[this._currentIndex]);},getTitleNode:function(item){var i,il;if(!item){return;}for(i=0,il=this._items.length;i<il;i++){if(this._items[i]==item){return this._slideDiv.childNodes[i].childNodes[1];break;}}},getInfoNode:function(item){var i,il;if(!item){return;}for(i=0,il=this._items.length;i<il;i++){if(this._items[i]==item){return this._slideDiv.childNodes[i].childNodes[2];break;}}},showTitle:function(item){var i,il;if(!item){return;}for(i=0,il=this._items.length;i<il;i++){if(this._items[i]==item){this._slideDiv.childNodes[i].childNodes[1].style.display="block";break;}}},hideTitle:function(item){var i,il;if(!item){return;}for(i=0,il=this._items.length;i<il;i++){if(this._items[i]==item){this._slideDiv.childNodes[i].childNodes[1].style.display="none";break;}}},onFocus:function(item){},onSelect:function(item){},onUnSelect:function(item){},_onClickHandler:function(e){if(e.target instanceof HTMLImageElement){var _a11=e.target._index;if(this._selectedIndex!=-1){this.onUnSelect(this._items[this._selectedIndex]);}this._select(_a11);this.onSelect(this._items[this._selectedIndex]);}},_onTouchStartHandler:function(e){this._moveDirection=null;this._left=this._currentIndex*(-(this._thumbnailWidth)-this._offset);this._slideDiv.style.WebkitTransitionDuration="0s";},_onTouchMoveHandler:function(e){if(!this._moveDirection){if(Math.abs(e.curY)>Math.abs(e.curX)){this._moveDirection="vertical";}else{this._moveDirection="horizontal";}}if(this._moveDirection=="vertical"){if(!this._touchBase._preventDefault==false){this._touchBase._preventDefault=false;}return;}else{if(this._moveDirection=="horizontal"){if(!this._touchBase._preventDefault){this._touchBase._preventDefault=true;}var _a12=this._left+e.curX;this._slideDiv.style.webkitTransform="translate3d("+_a12+"px, 0, 0)";}}},_onTouchEndHandler:function(e){var _a13=this._currentIndex;this._slideDiv.style.WebkitTransitionDuration="0.5s";if(e.swipeDirection=="left"){this._next();}else{if(e.swipeDirection=="right"){this._previous();}}this._left=this._currentIndex*(-(this._thumbnailWidth)-this._offset);this._slideDiv.style.webkitTransform="translate3d("+this._left+"px, 0, 0)";if(_a13!=this._currentIndex){this.onFocus(this._items[this._currentIndex]);}},_onResizeHandler:function(e){var _a14=window.orientation;switch(_a14){case 0:_a06.remove(this.container,"galleryLandscape");break;case 90:case -90:_a06.add(this.container,"galleryLandscape");break;}this._calculateSlideStep();},_startTransition:function(){this._slideDiv.style.WebkitTransitionDuration="0.5s";this._left=this._currentIndex*(-(this._thumbnailWidth)-this._offset);this._slideDiv.style.webkitTransform="translate3d("+this._left+"px, 0, 0)";},_markUnSelected:function(_a15){_a06.remove(_a15,"selected");_a06.remove(_a15.parentNode,"selected");_a06.remove(_a15.parentNode.childNodes[1],"selected");_a06.remove(_a15.parentNode.childNodes[2],"selected");},_markSelected:function(_a16){_a06.add(_a16,"selected");_a06.add(_a16.parentNode,"selected");_a06.add(_a16.parentNode.childNodes[1],"selected");_a06.add(_a16.parentNode.childNodes[2],"selected");},_next:function(){if(this._currentIndex+this._slideStep<this._items.length){this._currentIndex+=this._slideStep;this._focusedIndex=this._currentIndex;}},_previous:function(){if(this._currentIndex-this._slideStep>=0){this._currentIndex-=this._slideStep;}this._focusedIndex=this._currentIndex;},_setFocus:function(_a17){this._focusedIndex=_a17;this._currentIndex=Math.floor(_a17/this._slideStep)*this._slideStep;this._startTransition();},_select:function(_a18){if(this._selectedIndex!=-1){this._markUnSelected(this._slideDiv.childNodes[this._selectedIndex].childNodes[0]);}this._selectedIndex=_a18;this._markSelected(this._slideDiv.childNodes[this._selectedIndex].childNodes[0]);},_calculateSlideStep:function(){var _a19=_a07.getContentBox(this.container);var step=Math.floor((_a19.w+this._offset)/(this._thumbnailWidth+this._offset));if(step>=1){var _a1a=_a19.w-(this._thumbnailWidth+this._offset)*step;if(_a1a>0){this._slideDiv.style.marginLeft=Math.floor(_a1a/2)+"px";}else{this._slideDiv.style.marginLeft="0px";}this._slideStep=step;}else{this._slideStep=1;}if(this._selectedIndex!=-1){this._setFocus(this._selectedIndex);}else{this._setFocus(this._focusedIndex);}}});if(has("extend-esri")){lang.setObject("dijit.Gallery",GAL,_a08);}return GAL;});},"esri/dijit/editing/TemplatePickerItem":function(){define("esri/dijit/editing/TemplatePickerItem",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/sniff","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojox/gfx","esri/symbols/jsonUtils","esri/kernel"],function(_a1b,lang,_a1c,has,_a1d,_a1e,_a1f,_a20,gfx,_a21,_a22){var TPI=_a1b([_a1f,_a20],{declaredClass:"esri.dijit.editing.TemplatePickerItem",templateString:"<div class='item' style='text-align: center;'>"+"<div class='itemSymbol' dojoAttachPoint='_surfaceNode'></div>"+"<div class='itemLabel'>${label}</div>"+"</div>",startup:function(){if(this._started){return;}this.inherited(arguments);this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);},_draw:function(node,_a23,_a24,_a25,_a26){if(!_a23){return;}var _a27=gfx.createSurface(node,_a24,_a25);if(has("ie")<9){var _a28=_a27.getEventSource();_a1e.set(_a28,"position","relative");_a1e.set(_a28.parentNode,"position","relative");}var _a29=(!this.legendOverride&&this._getDrawingToolShape(_a23,_a26))||_a21.getShapeDescriptors(_a23);var _a2a;try{_a2a=_a27.createShape(_a29.defaultShape).setFill(_a29.fill).setStroke(_a29.stroke);}catch(e){_a27.clear();_a27.destroy();return;}var bbox=_a2a.getBoundingBox(),_a2b=bbox.width,_a2c=bbox.height,_a2d=-(bbox.x+(_a2b/2)),_a2e=-(bbox.y+(_a2c/2)),dim=_a27.getDimensions(),_a2f={dx:_a2d+dim.width/2,dy:_a2e+dim.height/2};if(_a2b>_a24||_a2c>_a25){var _a30=_a2b>_a2c?_a2b:_a2c;var _a31=_a24<_a25?_a24:_a25;var _a32=(_a31-5)/_a30;lang.mixin(_a2f,{xx:_a32,yy:_a32});}_a2a.applyTransform(_a2f);return _a27;},_getDrawingToolShape:function(_a33,_a34){var _a35,_a36=_a34?_a34.drawingTool||null:null;switch(_a36){case "esriFeatureEditToolArrow":_a35={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":_a35={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":_a35={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":_a35={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};break;case "esriFeatureEditToolDownArrow":_a35={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":_a35={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":_a35={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":_a35={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":_a35={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":if(_a33.type==="simplelinesymbol"||_a33.type==="cartographiclinesymbol"){_a35={type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"};}else{_a35={type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};}break;default:return null;}return {defaultShape:_a35,fill:_a33.getFill(),stroke:_a33.getStroke()};},_repaint:function(_a37){if(!_a37){this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);return;}if(_a37.getStroke&&_a37.setStroke){_a37.setStroke(_a37.getStroke());}if(_a37.getFill&&_a37.setFill){_a37.setFill(_a37.getFill());}if(_a37.children&&lang.isArray(_a37.children)){_a1c.forEach(_a37.children,this._repaint,this);}},destroy:function(){if(this._surface){this._surface.destroy();delete this._surface;}this.inherited(arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.TemplatePickerItem",TPI,_a22);}return TPI;});},"url:dijit/form/templates/VerticalSlider.html":"<table class=\"dijit dijitReset dijitSlider dijitSliderV\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" data-dojo-attach-event=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\"\r\n\trole=\"presentation\"\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\r\n\t\t\t><div class=\"dijitSliderIncrementIconV\" style=\"display:none\" data-dojo-attach-point=\"decrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper\" data-dojo-attach-event=\"press:_onClkIncBumper\"></div></center\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td data-dojo-attach-point=\"leftDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationL dijitSliderDecorationV\"></td\r\n\t\t><td class=\"dijitReset dijitSliderDecorationC\" style=\"height:100%;\"\r\n\t\t\t><input data-dojo-attach-point=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\r\n\t\t\t/><center class=\"dijitReset dijitSliderBarContainerV\" role=\"presentation\" data-dojo-attach-point=\"sliderBarContainer\"\r\n\t\t\t\t><div role=\"presentation\" data-dojo-attach-point=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV\" data-dojo-attach-event=\"press:_onBarClick\"><!--#5629--></div\r\n\t\t\t\t><div role=\"presentation\" data-dojo-attach-point=\"progressBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV\" data-dojo-attach-event=\"press:_onBarClick\"\r\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableV\" style=\"vertical-align:top;\"\r\n\t\t\t\t\t\t><div data-dojo-attach-point=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleV\" data-dojo-attach-event=\"press:_onHandleClick\" role=\"slider\"></div\r\n\t\t\t\t\t></div\r\n\t\t\t\t></div\r\n\t\t\t></center\r\n\t\t></td\r\n\t\t><td data-dojo-attach-point=\"containerNode,rightDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationR dijitSliderDecorationV\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper\" data-dojo-attach-event=\"press:_onClkDecBumper\"></div></center\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\r\n\t\t\t><div class=\"dijitSliderDecrementIconV\" style=\"display:none\" data-dojo-attach-point=\"incrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n></table>\r\n","esri/dijit/editing/Add":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/OperationBase"],function(_a38,lang,has,_a39,_a3a){var Add=_a38(_a3a,{declaredClass:"esri.dijit.editing.Add",type:"edit",label:"Add Features",constructor:function(_a3b){_a3b=_a3b||{};if(!_a3b.featureLayer){console.error("In constructor of 'esri.dijit.editing.Add', featureLayer is not provided");return;}this._featureLayer=_a3b.featureLayer;if(!_a3b.addedGraphics){console.error("In constructor of 'esri.dijit.editing.Add', no graphics provided");return;}this._addedGraphics=_a3b.addedGraphics;},performUndo:function(){this._featureLayer.applyEdits(null,null,this._addedGraphics);},performRedo:function(){this._featureLayer.applyEdits(this._addedGraphics,null,null);}});if(has("extend-esri")){lang.setObject("dijit.editing.Add",Add,_a39);}return Add;});},"url:esri/dijit/templates/Directions.html":"<div class=\"${options.theme}\" role=\"presentation\">\r\n    <div data-dojo-attach-point=\"_widgetContainer\" class=\"${_widgetContainerClass}\" role=\"presentation\">\r\n        <div class=\"${_stopsContainerClass}\" data-dojo-attach-point=\"_dndNode\" role=\"presentation\">\r\n            <table class=\"${_stopsClass}\" data-dojo-attach-point=\"_dndNode\"></table>\r\n            <div class=\"${_clearClass}\"></div>\r\n            <div class=\"${_stopsButtonContainerClass}\">\r\n                <div role=\"button\" class=\"${_stopsAddDestinationClass}\" data-dojo-attach-point=\"_addDestinationNode\" data-dojo-attach-event=\"ondijitclick:_addStopButton\">${_i18n.widgets.directions.addDestination}</div>\r\n                <div role=\"button\" class=\"${_stopsOptionsButtonClass}\" data-dojo-attach-point=\"_optionsButtonNode\" data-dojo-attach-event=\"ondijitclick:_toggleOptionsMenu\">${_i18n.widgets.directions.showOptions}</div>\r\n            \t<div class=\"${_clearClass}\"></div>\r\n            </div>\r\n            <div role=\"presentation\" class=\"${_stopsOptionsMenuClass}\" data-dojo-attach-point=\"_optionsMenuNode\">\r\n                <div class=\"${_stopsOptionsCheckboxesClass}\">\r\n                    <ul>\r\n                        <li class=\"${_stopsFindOptimalOrderClass}\" data-dojo-attach-point=\"_findOptimalOrderItemNode\"><input data-dojo-attach-event=\"ondijitclick:_toggleCheckbox\" tabindex=\"0\" data-dojo-attach-point=\"_findOptimalOrderNode\" type=\"checkbox\" id=\"${id}_find_optimal_order\" /><label for=\"${id}_find_optimal_order\">${_i18n.widgets.directions.findOptimalOrder}</label></li>\r\n                        <li class=\"${_stopsReturnToStartClass}\" data-dojo-attach-point=\"_returnToStartItemNode\"><input data-dojo-attach-event=\"ondijitclick:_toggleCheckbox\" tabindex=\"0\" data-dojo-attach-point=\"_returnToStartNode\" type=\"checkbox\" id=\"${id}_stopsReturnToStart\" /><label for=\"${id}_stopsReturnToStart\">${_i18n.widgets.directions.returnToStart}</label></li>\r\n                        <li class=\"${_stopsUseTrafficClass}\" data-dojo-attach-point=\"_useTrafficItemNode\"><input data-dojo-attach-event=\"ondijitclick:_toggleCheckbox\" tabindex=\"0\" data-dojo-attach-point=\"_useTrafficNode\" type=\"checkbox\" id=\"${id}_stopsUseTraffic\" /><label for=\"${id}_stopsUseTraffic\">${_i18n.widgets.directions.useTraffic}</label></li>\r\n                    </ul>\r\n                </div>\r\n                <div class=\"${_stopsOptionsUnitsClass}\">\r\n                    <ul>\r\n                        <li><input data-dojo-attach-event=\"ondijitclick:_toggleUnits\" tabindex=\"0\" id=\"${id}_use_miles\" data-dojo-attach-point=\"_useMilesNode\" name=\"${id}_units\" type=\"radio\"><label for=\"${id}_use_miles\">${_i18n.widgets.directions.units.MILES.name}</label></li>\r\n                        <li><input data-dojo-attach-event=\"ondijitclick:_toggleUnits\" tabindex=\"0\" id=\"${id}_use_kilometers\" data-dojo-attach-point=\"_useKilometersNode\" name=\"${id}_units\" type=\"radio\"><label for=\"${id}_use_kilometers\">${_i18n.widgets.directions.units.KILOMETERS.name}</label></li>\r\n                    </ul>\r\n                </div>\r\n                <div class=\"${_clearClass}\"></div>\r\n            </div>\r\n            <div class=\"${_stopsGetDirectionsContainerClass}\">\r\n                <div tabindex=\"0\" role=\"button\" class=\"${_stopsGetDirectionsClass}\" data-dojo-attach-event=\"ondijitclick:_directionsButton\">${_i18n.widgets.directions.getDirections}</div>\r\n                <div tabindex=\"0\" role=\"button\" class=\"${_stopsClearDirectionsClass}\" data-dojo-attach-event=\"ondijitclick:clearDirections\">${_i18n.widgets.directions.clearDirections}</div>\r\n                <div class=\"${_clearClass}\"></div>\r\n            </div>\r\n    \t</div>\r\n    \t<div class=\"${_clearClass}\"></div>\r\n    \t<div data-dojo-attach-point=\"_errorNode\" role=\"presentation\"></div>\r\n    \t<div class=\"${_resultsContainerClass}\" role=\"presentation\">\r\n        \t<div class=\"${_routesContainerClass}\" data-dojo-attach-point=\"_resultsNode\" role=\"presentation\"></div>\r\n    \t</div>\r\n    </div>\r\n</div>","dijit/form/VerticalSlider":function(){require({cache:{"url:dijit/form/templates/VerticalSlider.html":"<table class=\"dijit dijitReset dijitSlider dijitSliderV\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" data-dojo-attach-event=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\"\r\n\trole=\"presentation\"\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\r\n\t\t\t><div class=\"dijitSliderIncrementIconV\" style=\"display:none\" data-dojo-attach-point=\"decrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper\" data-dojo-attach-event=\"press:_onClkIncBumper\"></div></center\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td data-dojo-attach-point=\"leftDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationL dijitSliderDecorationV\"></td\r\n\t\t><td class=\"dijitReset dijitSliderDecorationC\" style=\"height:100%;\"\r\n\t\t\t><input data-dojo-attach-point=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\r\n\t\t\t/><center class=\"dijitReset dijitSliderBarContainerV\" role=\"presentation\" data-dojo-attach-point=\"sliderBarContainer\"\r\n\t\t\t\t><div role=\"presentation\" data-dojo-attach-point=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV\" data-dojo-attach-event=\"press:_onBarClick\"><!--#5629--></div\r\n\t\t\t\t><div role=\"presentation\" data-dojo-attach-point=\"progressBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV\" data-dojo-attach-event=\"press:_onBarClick\"\r\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableV\" style=\"vertical-align:top;\"\r\n\t\t\t\t\t\t><div data-dojo-attach-point=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleV\" data-dojo-attach-event=\"press:_onHandleClick\" role=\"slider\"></div\r\n\t\t\t\t\t></div\r\n\t\t\t\t></div\r\n\t\t\t></center\r\n\t\t></td\r\n\t\t><td data-dojo-attach-point=\"containerNode,rightDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationR dijitSliderDecorationV\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset\"\r\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper\" data-dojo-attach-event=\"press:_onClkDecBumper\"></div></center\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n\t><tr class=\"dijitReset\"\r\n\t\t><td class=\"dijitReset\"></td\r\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\r\n\t\t\t><div class=\"dijitSliderDecrementIconV\" style=\"display:none\" data-dojo-attach-point=\"incrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\r\n\t\t></td\r\n\t\t><td class=\"dijitReset\"></td\r\n\t></tr\r\n></table>\r\n"}});define("dijit/form/VerticalSlider",["dojo/_base/declare","./HorizontalSlider","dojo/text!./templates/VerticalSlider.html"],function(_a3c,_a3d,_a3e){return _a3c("dijit.form.VerticalSlider",_a3d,{templateString:_a3e,_mousePixelCoord:"pageY",_pixelCount:"h",_startingPixelCoord:"y",_handleOffsetCoord:"top",_progressPixelSize:"height",_descending:true,_isReversed:function(){return this._descending;}});});},"esri/dijit/InfoWindow":function(){require({cache:{"url:esri/dijit/templates/InfoWindow.html":"<div id=\"${id}.infowindow\" class=\"infowindow\" dojoAttachPoint=\"_infowindow\"\r\n  ><div style=\"position:relative;\"\r\n    ><div class=\"window\" dojoAttachPoint=\"_window\"\r\n      ><div class=\"top\"\r\n        ><div class=\"left\" dojoAttachPoint=\"_topleft\"><div class=\"sprite\"></div></div\r\n    \t\t><div class=\"right\" dojoAttachPoint=\"_topright\"\r\n    \t\t\t><div class=\"sprite\"></div\r\n    \t\t\t><div class=\"user\" dojoAttachPoint=\"_user\"\r\n    \t\t\t  ><div class=\"titlebar\" dojoAttachPoint=\"_titlebar\"\r\n    \t\t\t    ><a class=\"hide\" dojoAttachPoint=\"_hide\" dojoAttachEvent=\"onclick:hide\"><div class=\"sprite\"></div></a\r\n              ><div class=\"title\" dojoAttachPoint=\"_title\">${title}</div\r\n    \t\t\t  ></div\r\n            ><div class=\"border\" dojoAttachPoint=\"_border\"></div\r\n    \t\t\t  ><div class=\"layout content\" dojoAttachPoint=\"_content, containerNode\"\r\n    \t\t\t  ></div\r\n    \t\t\t></div\r\n    \t\t></div\r\n        ><div class=\"bottom\"\r\n          ><div class=\"left\" dojoAttachPoint=\"_bottomleft\"><div class=\"sprite\"></div></div\r\n\t\t      ><div class=\"right\" dojoAttachPoint=\"_bottomright\"><div class=\"sprite\"></div></div\r\n        ></div\r\n      ></div\r\n    ></div\r\n    ><div class=\"pointer\" dojoAttachPoint=\"_pointer\"><div dojoAttachPoint=\"_sprite\" class=\"sprite\"></div></div\r\n  ></div\r\n></div>"}});define("esri/dijit/InfoWindow",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/kernel","dojo/has","dojo/query","dojo/sniff","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dijit/_Widget","dijit/_Templated","dijit/_Container","esri/kernel","esri/domUtils","esri/InfoWindowBase","esri/dijit/_EventedWidget","dojo/text!esri/dijit/templates/InfoWindow.html"],function(_a3f,lang,_a40,win,_a41,has,_a42,_a43,_a44,_a45,_a46,_a47,_a48,_a49,_a4a,_a4b,_a4c,_a4d,_a4e){var IW=_a3f([_a4d,_a47,_a48,_a49,_a4c],{declaredClass:"esri.dijit.InfoWindow",isContainer:true,templateString:_a4e,anchor:"upperright",fixedAnchor:null,coords:null,isShowing:true,isContentShowing:true,isTitleBarShowing:true,width:250,height:150,title:"Info Window",setMap:function(map){this.inherited(arguments);_a45.place(this.domNode,map.root);},startup:function(){if(this._started){return;}this.inherited(arguments);this._ANCHORS=[IW.ANCHOR_UPPERRIGHT,IW.ANCHOR_LOWERRIGHT,IW.ANCHOR_LOWERLEFT,IW.ANCHOR_UPPERLEFT];if(has("ie")<7){var url=_a46.getComputedStyle(this._sprite).backgroundImage.replace(/url\(\"/i,"").replace(/\"\)/,""),_a4f="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', sizingMethod='crop', src='"+url+"')";var s=_a45.create("div",null,win.body());_a46.set(s,{width:"1px",height:"1px",display:"none",backgroundImage:"none",filter:_a4f});var t=setTimeout(function(){_a45.destroy(s);clearTimeout(t);t=s=null;},100);_a41.query(".sprite",this.domNode).forEach(function(n){n.style.backgroundImage="none";n.style.filter=_a4f;});}this.resize(this.width,this.height);this.hide();},destroy:function(){if(this._destroyed){return;}this.__unregisterMapListeners();this.destroyDijits(this._title);this.destroyDijits(this._content);this._title.innerHTML=this._content.innerHTML="";this.inherited(arguments);},resize:function(_a50,_a51){if(!_a50||!_a51){return;}var _a52=_a46.set;_a52(this._topleft,{height:_a51+"px",marginLeft:_a50+"px"});_a52(this._topright,{width:_a50+"px",height:_a51+"px"});_a52(this._user,"width",(_a50-8)+"px");_a52(this._hide,"marginLeft",(_a50-22)+"px");_a52(this._title,"width",(_a50-25)+"px");_a52(this._content,"height",(_a51-37)+"px");_a52(this._bottomleft,{marginLeft:_a50+"px",marginTop:_a51+"px"});_a52(this._bottomright,{width:(_a50-5)+"px",marginTop:_a51+"px"});this.width=_a50;this.height=_a51;if(this.coords){this._adjustPosition(this.coords,this.anchor);}this.onResize(_a50,_a51);},_adjustPosition:function(_a53,_a54){var _a55=_a46.set;_a55(this._infowindow,{left:Math.round(_a53.x)+"px",top:Math.round(_a53.y)+"px"});if(_a54===IW.ANCHOR_UPPERLEFT){_a55(this._window,{left:null,right:(this.width+18)+"px",top:null,bottom:(this.height+50)+"px"});}else{if(_a54===IW.ANCHOR_UPPERRIGHT){_a55(this._window,{left:"6px",right:null,top:null,bottom:(this.height+50)+"px"});}else{if(_a54===IW.ANCHOR_LOWERRIGHT){_a55(this._window,{left:"6px",right:null,top:"43px",bottom:null});}else{if(_a54===IW.ANCHOR_LOWERLEFT){_a55(this._window,{left:null,right:(this.width+18)+"px",top:"43px",bottom:null});}}}}},_getAnchor:function(pt){var map=this.map;return (map&&pt)?(((pt.y<(map.height/2))?"lower":"upper")+((pt.x<(map.width/2))?"right":"left")):"upperright";},show:function(_a56,_a57){if(!_a56){return;}if(_a56.spatialReference){this.mapCoords=_a56;_a56=this.coords=this.map.toScreen(_a56,true);}else{this.mapCoords=null;this.coords=_a56;}var _a58=this.map._getFrameWidth();if(_a58!==-1){_a56.x=_a56.x%_a58;if(_a56.x<0){_a56.x+=_a58;}if(this.map.width>_a58){var _a59=(this.map.width-_a58)/2;while(_a56.x<_a59){_a56.x+=_a58;}}}if(!_a57||_a40.indexOf(this._ANCHORS,_a57)===-1){_a57=this._getAnchor(_a56);}_a44.remove(this._pointer,this.anchor);_a57=(this.anchor=this.fixedAnchor||_a57);this._adjustPosition(_a56,_a57);_a44.add(this._pointer,_a57);_a4b.show(this.domNode);this.isShowing=true;if(!arguments[2]){this.onShow();}},hide:function(evt){_a4b.hide(this.domNode);this.isShowing=false;if(!arguments[1]){this.onHide();}},showTitleBar:function(){_a4b.show(this._titlebar);_a4b.show(this._border);this.isTitleBarShowing=true;},hideTitleBar:function(){_a4b.hide(this._titlebar);_a4b.hide(this._border);this.isTitleBarShowing=false;},showContent:function(){_a4b.show(this._content);_a4b.show(this._border);this.isContentShowing=true;},hideContent:function(){_a4b.hide(this._content);_a4b.hide(this._border);this.isContentShowing=false;},move:function(_a5a,_a5b){if(_a5b){_a5a=this.coords.offset(_a5a.x,_a5a.y);}else{this.coords=_a5a;if(this.mapCoords){this.mapCoords=this.map.toMap(_a5a);}}_a46.set(this._infowindow,{left:Math.round(_a5a.x)+"px",top:Math.round(_a5a.y)+"px"});},setFixedAnchor:function(_a5c){if(_a5c&&_a40.indexOf(this._ANCHORS,_a5c)===-1){return;}this.fixedAnchor=_a5c;if(this.isShowing){this.show(this.mapCoords||this.coords,_a5c);}this.onAnchorChange(_a5c);},setTitle:function(_a5d){this.destroyDijits(this._title);this.__setValue("_title",_a5d);return this;},setContent:function(_a5e){this.destroyDijits(this._content);this.__setValue("_content",_a5e);return this;},onShow:function(){this.__registerMapListeners();this.startupDijits(this._title);this.startupDijits(this._content);},onHide:function(){this.__unregisterMapListeners();},onResize:function(){},onAnchorChange:function(){}});lang.mixin(IW,{ANCHOR_UPPERRIGHT:"upperright",ANCHOR_LOWERRIGHT:"lowerright",ANCHOR_LOWERLEFT:"lowerleft",ANCHOR_UPPERLEFT:"upperleft"});if(has("extend-esri")){lang.setObject("dijit.InfoWindow",IW,_a4a);}return IW;});},"dojox/date/islamic/locale":function(){define("dojox/date/islamic/locale",["../..","dojo/_base/lang","dojo/_base/array","dojo/date","dojo/i18n","dojo/regexp","dojo/string","./Date","dojo/i18n!dojo/cldr/nls/islamic"],function(_a5f,lang,arr,dd,i18n,_a60,_a61,_a62,_a63){var _a64=lang.getObject("date.islamic.locale",true,_a5f);function _a65(_a66,_a67,_a68,_a69,_a6a){return _a6a.replace(/([a-z])\1*/ig,function(_a6b){var s,pad;var c=_a6b.charAt(0);var l=_a6b.length;var _a6c=["abbr","wide","narrow"];switch(c){case "G":s=_a67["eraAbbr"][0];break;case "y":s=String(_a66.getFullYear());break;case "M":var m=_a66.getMonth();if(l<3){s=m+1;pad=true;}else{var _a6d=["months","format",_a6c[l-3]].join("-");s=_a67[_a6d][m];}break;case "d":s=_a66.getDate(true);pad=true;break;case "E":var d=_a66.getDay();if(l<3){s=d+1;pad=true;}else{var _a6e=["days","format",_a6c[l-3]].join("-");s=_a67[_a6e][d];}break;case "a":var _a6f=(_a66.getHours()<12)?"am":"pm";s=_a67["dayPeriods-format-wide-"+_a6f];break;case "h":case "H":case "K":case "k":var h=_a66.getHours();switch(c){case "h":s=(h%12)||12;break;case "H":s=h;break;case "K":s=(h%12);break;case "k":s=h||24;break;}pad=true;break;case "m":s=_a66.getMinutes();pad=true;break;case "s":s=_a66.getSeconds();pad=true;break;case "S":s=Math.round(_a66.getMilliseconds()*Math.pow(10,l-3));pad=true;break;case "z":s=dd.getTimezoneName(_a66.toGregorian());if(s){break;}l=4;case "Z":var _a70=_a66.toGregorian().getTimezoneOffset();var tz=[(_a70<=0?"+":"-"),_a61.pad(Math.floor(Math.abs(_a70)/60),2),_a61.pad(Math.abs(_a70)%60,2)];if(l==4){tz.splice(0,0,"GMT");tz.splice(3,0,":");}s=tz.join("");break;default:throw new Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+_a6a);}if(pad){s=_a61.pad(s,l);}return s;});};_a64.format=function(_a71,_a72){_a72=_a72||{};var _a73=i18n.normalizeLocale(_a72.locale);var _a74=_a72.formatLength||"short";var _a75=_a64._getIslamicBundle(_a73);var str=[];var _a76=lang.hitch(this,_a65,_a71,_a75,_a73,_a72.fullYear);if(_a72.selector=="year"){var year=_a71.getFullYear();return year;}if(_a72.selector!="time"){var _a77=_a72.datePattern||_a75["dateFormat-"+_a74];if(_a77){str.push(_a78(_a77,_a76));}}if(_a72.selector!="date"){var _a79=_a72.timePattern||_a75["timeFormat-"+_a74];if(_a79){str.push(_a78(_a79,_a76));}}var _a7a=str.join(" ");return _a7a;};_a64.regexp=function(_a7b){return _a64._parseInfo(_a7b).regexp;};_a64._parseInfo=function(_a7c){_a7c=_a7c||{};var _a7d=i18n.normalizeLocale(_a7c.locale);var _a7e=_a64._getIslamicBundle(_a7d);var _a7f=_a7c.formatLength||"short";var _a80=_a7c.datePattern||_a7e["dateFormat-"+_a7f];var _a81=_a7c.timePattern||_a7e["timeFormat-"+_a7f];var _a82;if(_a7c.selector=="date"){_a82=_a80;}else{if(_a7c.selector=="time"){_a82=_a81;}else{_a82=(typeof (_a81)=="undefined")?_a80:_a80+" "+_a81;}}var _a83=[];var re=_a78(_a82,lang.hitch(this,_a84,_a83,_a7e,_a7c));return {regexp:re,tokens:_a83,bundle:_a7e};};_a64.parse=function(_a85,_a86){_a85=_a85.replace(/[\u200E\u200F\u202A\u202E]/g,"");if(!_a86){_a86={};}var info=_a64._parseInfo(_a86);var _a87=info.tokens,_a63=info.bundle;var _a88=info.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,"");var re=new RegExp("^"+_a88+"$");var _a89=re.exec(_a85);var _a8a=i18n.normalizeLocale(_a86.locale);if(!_a89){return null;}var date,_a8b;var _a8c=[1389,0,1,0,0,0,0];var amPm="";var _a8d=0;var _a8e=["abbr","wide","narrow"];var _a8f=arr.every(_a89,function(v,i){if(!i){return true;}var _a90=_a87[i-1];var l=_a90.length;switch(_a90.charAt(0)){case "y":_a8c[0]=Number(v);break;case "M":if(l>2){var _a91=_a63["months-format-"+_a8e[l-3]].concat();if(!_a86.strict){v=v.replace(".","").toLowerCase();_a91=arr.map(_a91,function(s){return s?s.replace(".","").toLowerCase():s;});}v=arr.indexOf(_a91,v);if(v==-1){return false;}_a8d=l;}else{v--;}_a8c[1]=Number(v);break;case "D":_a8c[1]=0;case "d":_a8c[2]=Number(v);break;case "a":var am=_a86.am||_a63["dayPeriods-format-wide-am"],pm=_a86.pm||_a63["dayPeriods-format-wide-pm"];if(!_a86.strict){var _a92=/\./g;v=v.replace(_a92,"").toLowerCase();am=am.replace(_a92,"").toLowerCase();pm=pm.replace(_a92,"").toLowerCase();}if(_a86.strict&&v!=am&&v!=pm){return false;}amPm=(v==pm)?"p":(v==am)?"a":"";break;case "K":if(v==24){v=0;}case "h":case "H":case "k":_a8c[3]=Number(v);break;case "m":_a8c[4]=Number(v);break;case "s":_a8c[5]=Number(v);break;case "S":_a8c[6]=Number(v);}return true;});var _a93=+_a8c[3];if(amPm==="p"&&_a93<12){_a8c[3]=_a93+12;}else{if(amPm==="a"&&_a93==12){_a8c[3]=0;}}var _a94=new _a62(_a8c[0],_a8c[1],_a8c[2],_a8c[3],_a8c[4],_a8c[5],_a8c[6]);return _a94;};function _a78(_a95,_a96,_a97,_a98){var _a99=function(x){return x;};_a96=_a96||_a99;_a97=_a97||_a99;_a98=_a98||_a99;var _a9a=_a95.match(/(''|[^'])+/g);var _a9b=_a95.charAt(0)=="'";arr.forEach(_a9a,function(_a9c,i){if(!_a9c){_a9a[i]="";}else{_a9a[i]=(_a9b?_a97:_a96)(_a9c);_a9b=!_a9b;}});return _a98(_a9a.join(""));};function _a84(_a9d,_a9e,_a9f,_aa0){_aa0=_a60.escapeString(_aa0);var _aa1=i18n.normalizeLocale(_a9f.locale);return _aa0.replace(/([a-z])\1*/ig,function(_aa2){var s;var c=_aa2.charAt(0);var l=_aa2.length;var p2="",p3="";if(_a9f.strict){if(l>1){p2="0"+"{"+(l-1)+"}";}if(l>2){p3="0"+"{"+(l-2)+"}";}}else{p2="0?";p3="0{0,2}";}switch(c){case "y":s="\\d+";break;case "M":s=(l>2)?"\\S+ ?\\S+":p2+"[1-9]|1[0-2]";break;case "d":s="[12]\\d|"+p2+"[1-9]|3[01]";break;case "E":s="\\S+";break;case "h":s=p2+"[1-9]|1[0-2]";break;case "k":s=p2+"\\d|1[01]";break;case "H":s=p2+"\\d|1\\d|2[0-3]";break;case "K":s=p2+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":s=p2+"\\d|[0-5]\\d";break;case "S":s="\\d{"+l+"}";break;case "a":var am=_a9f.am||_a9e["dayPeriods-format-wide-am"],pm=_a9f.pm||_a9e["dayPeriods-format-wide-pm"];if(_a9f.strict){s=am+"|"+pm;}else{s=am+"|"+pm;if(am!=am.toLowerCase()){s+="|"+am.toLowerCase();}if(pm!=pm.toLowerCase()){s+="|"+pm.toLowerCase();}}break;default:s=".*";}if(_a9d){_a9d.push(_aa2);}return "("+s+")";}).replace(/[\xa0 ]/g,"[\\s\\xa0]");};var _aa3=[];_a64.addCustomFormats=function(_aa4,_aa5){_aa3.push({pkg:_aa4,name:_aa5});};_a64._getIslamicBundle=function(_aa6){var _aa7={};arr.forEach(_aa3,function(desc){var _aa8=i18n.getLocalization(desc.pkg,desc.name,_aa6);_aa7=lang.mixin(_aa7,_aa8);},this);return _aa7;};_a64.addCustomFormats("dojo.cldr","islamic");_a64.getNames=function(item,type,_aa9,_aaa,date){var _aab;var _aac=_a64._getIslamicBundle(_aaa);var _aad=[item,_aa9,type];if(_aa9=="standAlone"){var key=_aad.join("-");_aab=_aac[key];if(_aab[0]==1){_aab=undefined;}}_aad[1]="format";return (_aab||_aac[_aad.join("-")]).concat();};_a64.weekDays=_a64.getNames("days","wide","format");_a64.months=_a64.getNames("months","wide","format");return _a64;});},"url:dijit/templates/ProgressBar.html":"<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  data-dojo-attach-point=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&#160;</span\n\t></div\n\t><div data-dojo-attach-point=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img data-dojo-attach-point=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n","dojox/grid/cells":function(){define("dojox/grid/cells",["../main","./cells/_base"],function(_aae){return _aae.grid.cells;});},"esri/dijit/editing/Union":function(){define("esri/dijit/editing/Union",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/OperationBase","esri/dijit/editing/Cut"],function(_aaf,lang,has,_ab0,_ab1,Cut){var _ab2=_aaf(_ab1,{declaredClass:"esri.dijit.editing.Union",type:"edit",label:"Union Features",constructor:function(_ab3){_ab3=_ab3||{};this._cut=new Cut({featureLayer:_ab3.featureLayer,addedGraphics:_ab3.deletedGraphics,preUpdatedGraphics:_ab3.preUpdatedGraphics,postUpdatedGraphics:_ab3.postUpdatedGraphics});},performUndo:function(){this._cut.performRedo();},performRedo:function(){this._cut.performUndo();}});if(has("extend-esri")){lang.setObject("dijit.editing.Union",_ab2,_ab0);}return _ab2;});},"esri/dijit/Basemap":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/has","esri/kernel","esri/request","esri/dijit/BasemapLayer"],function(_ab4,_ab5,lang,has,_ab6,_ab7,_ab8){var BM=_ab4(null,{declaredClass:"esri.dijit.Basemap",id:null,title:"",thumbnailUrl:null,layers:null,itemId:null,basemapGallery:null,constructor:function(_ab9,_aba){_ab9=_ab9||{};if(!_ab9.layers&&!_ab9.itemId){console.error("esri.dijit.Basemap: unable to find the 'layers' property in parameters");}this.id=_ab9.id;this.itemId=_ab9.itemId;this.layers=_ab9.layers;this.title=_ab9.title||"";this.thumbnailUrl=_ab9.thumbnailUrl;this.basemapGallery=_aba;},getLayers:function(){if(this.layers){return this.layers;}else{if(this.itemId){var url=_ab6.dijit._arcgisUrl+"/content/items/"+this.itemId+"/data";var _abb={};_abb.f="json";var _abc=_ab7({url:url,content:_abb,callbackParamName:"callback",error:lang.hitch(this,function(_abd,args){var msg="esri.dijit.Basemap: could not access basemap item.";if(this.basemapGallery){this.basemapGallery.onError(msg);}else{console.error(msg);}})});_abc.addCallback(lang.hitch(this,function(_abe,args){if(_abe.baseMap){this.layers=[];_ab5.forEach(_abe.baseMap.baseMapLayers,function(_abf){var _ac0={};if(_abf.url){_ac0.url=_abf.url;}if(_abf.type){_ac0.type=_abf.type;}if(_abf.isReference){_ac0.isReference=_abf.isReference;}if(_abf.displayLevels){_ac0.displayLevels=_abf.displayLevels;}if(_abf.visibleLayers){_ac0.visibleLayers=_abf.visibleLayers;}if(_abf.bandIds){_ac0.bandIds=_abf.bandIds;}this.layers.push(new _ab8(_ac0));},this);return this.layers;}else{var msg="esri.dijit.Basemap: could not access basemap item.";if(this.basemapGallery){this.basemapGallery.onError(msg);}else{console.error(msg);}return [];}}));return _abc;}}}});if(has("extend-esri")){lang.setObject("dijit.Basemap",BM,_ab6);}return BM;});},"dojox/grid/_Layout":function(){define("dojox/grid/_Layout",["dojo/_base/kernel","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-geometry","./cells","./_RowSelector"],function(dojo,_ac1,_ac2,_ac3,lang,_ac4){return _ac2("dojox.grid._Layout",null,{constructor:function(_ac5){this.grid=_ac5;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_ac6,_ac7,_ac8,_ac9,_aca){var _acb=this.structure[_ac6].cells[0];var _acc=this.structure[_ac7].cells[0];var cell=null;var _acd=0;var _ace=0;for(var i=0,c;c=_acb[i];i++){if(c.index==_ac8){_acd=i;break;}}cell=_acb.splice(_acd,1)[0];cell.view=this.grid.views.views[_ac7];for(i=0,c=null;c=_acc[i];i++){if(c.index==_ac9){_ace=i;break;}}if(!_aca){_ace+=1;}_acc.splice(_ace,0,cell);var _acf=this.grid.getCell(this.grid.getSortIndex());if(_acf){_acf._currentlySorted=this.grid.getSortAsc();}this.cells=[];_ac8=0;var v;for(i=0;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0;c=cs[k];k++){c.index=_ac8;this.cells.push(c);if("_currentlySorted" in c){var si=_ac8+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_ac8++;}}}_ac3.forEach(this.cells,function(c){var _ad0=c.markup[2].split(" ");var _ad1=parseInt(_ad0[1].substring(5));if(_ad1!=c.index){_ad0[1]="idx=\""+c.index+"\"";c.markup[2]=_ad0.join(" ");}});this.grid.setupHeaderMenu();},setColumnVisibility:function(_ad2,_ad3){var cell=this.cells[_ad2];if(cell.hidden==_ad3){cell.hidden=!_ad3;var v=cell.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_ac4.getMarginBox(cell.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_ad4,_ad5,_ad6){var self=this;var _ad7=function(_ad8){var w=0;if(_ad8.colSpan>1){w=0;}else{w=_ad8.width||self._defaultCellProps.width||self.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _ad9={grid:this.grid,subrow:_ad4,layoutIndex:_ad5,index:this.cells.length};if(_ad6&&_ad6 instanceof _ac1.grid.cells._Base){var _ada=lang.clone(_ad6);_ad9.unitWidth=_ad7(_ada._props);_ada=lang.mixin(_ada,this._defaultCellProps,_ad6._props,_ad9);return _ada;}var _adb=_ad6.type||_ad6.cellType||this._defaultCellProps.type||this._defaultCellProps.cellType||_ac1.grid.cells.Cell;if(lang.isString(_adb)){_adb=lang.getObject(_adb);}_ad9.unitWidth=_ad7(_ad6);return new _adb(lang.mixin({},this._defaultCellProps,_ad6,_ad9));},addRowDef:function(_adc,_add){var _ade=[];var _adf=0,_ae0=0,_ae1=true;for(var i=0,def,cell;(def=_add[i]);i++){cell=this.addCellDef(_adc,i,def);_ade.push(cell);this.cells.push(cell);if(_ae1&&cell.relWidth){_adf+=cell.relWidth;}else{if(cell.width){var w=cell.width;if(typeof w=="string"&&w.slice(-1)=="%"){_ae0+=window.parseInt(w,10);}else{if(w=="auto"){_ae1=false;}}}}}if(_adf&&_ae1){_ac3.forEach(_ade,function(cell){if(cell.relWidth){cell.width=cell.unitWidth=((cell.relWidth/_adf)*(100-_ae0))+"%";}});}return _ade;},addRowsDef:function(_ae2){var _ae3=[];if(lang.isArray(_ae2)){if(lang.isArray(_ae2[0])){for(var i=0,row;_ae2&&(row=_ae2[i]);i++){_ae3.push(this.addRowDef(i,row));}}else{_ae3.push(this.addRowDef(0,_ae2));}}return _ae3;},addViewDef:function(_ae4){this._defaultCellProps=_ae4.defaultCell||{};if(_ae4.width&&_ae4.width=="auto"){delete _ae4.width;}return lang.mixin({},_ae4,{cells:this.addRowsDef(_ae4.rows||_ae4.cells)});},setStructure:function(_ae5){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_ac1._scopeName+".grid._RowSelector"};if(lang.isString(this.grid.rowSelector)){var _ae6=this.grid.rowSelector;if(_ae6=="false"){sel=null;}else{if(_ae6!="true"){sel["width"]=_ae6;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _ae7=function(def){return ("name" in def||"field" in def||"get" in def);};var _ae8=function(def){if(lang.isArray(def)){if(lang.isArray(def[0])||_ae7(def[0])){return true;}}return false;};var _ae9=function(def){return (def!==null&&lang.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_ae7(def))));};if(lang.isArray(_ae5)){var _aea=false;for(var i=0,st;(st=_ae5[i]);i++){if(_ae9(st)){_aea=true;break;}}if(!_aea){s.push(this.addViewDef({cells:_ae5}));}else{for(i=0;(st=_ae5[i]);i++){if(_ae8(st)){s.push(this.addViewDef({cells:st}));}else{if(_ae9(st)){s.push(this.addViewDef(st));}}}}}else{if(_ae9(_ae5)){s.push(this.addViewDef(_ae5));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});});},"dojox/gauges/AnalogIndicatorBase":function(){define("dojox/gauges/AnalogIndicatorBase",["dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/fx","dojox/gfx","./_Indicator"],function(lang,_aeb,_aec,fx,gfx,_aed){return _aeb("dojox.gauges.AnalogIndicatorBase",[_aed],{draw:function(_aee,_aef){if(this.shape){this._move(_aef);}else{if(this.text){this.text.parent.remove(this.text);this.text=null;}var a=this._gauge._getAngle(Math.min(Math.max(this.value,this._gauge.min),this._gauge.max));this.color=this.color||"#000000";this.length=this.length||this._gauge.radius;this.width=this.width||1;this.offset=this.offset||0;this.highlight=this.highlight||"#D0D0D0";var _af0=this._getShapes(_aee,this._gauge,this);if(_af0){if(_af0.length>1){this.shape=_aee.createGroup();for(var s=0;s<_af0.length;s++){this.shape.add(_af0[s]);}}else{this.shape=_af0[0];}this.shape.setTransform([{dx:this._gauge.cx,dy:this._gauge.cy},gfx.matrix.rotateg(a)]);this.shape.connect("onmouseover",this,this.handleMouseOver);this.shape.connect("onmouseout",this,this.handleMouseOut);this.shape.connect("onmousedown",this,this.handleMouseDown);this.shape.connect("touchstart",this,this.handleTouchStart);}if(this.label){var _af1=this.direction;if(!_af1){_af1="outside";}var len;if(_af1=="inside"){len=-this.length+this.offset-5;}else{len=this.length+this.offset+5;}var rad=this._gauge._getRadians(90-a);this._layoutLabel(_aee,this.label+"",this._gauge.cx,this._gauge.cy,len,rad,_af1);}this.currentValue=this.value;}},_layoutLabel:function(_af2,txt,ox,oy,lrad,_af3,_af4){var font=this.font?this.font:gfx.defaultFont;var box=gfx._base._getTextBox(txt,{font:gfx.makeFontString(gfx.makeParameters(gfx.defaultFont,font))});var tw=box.w;var fz=font.size;var th=gfx.normalizedLength(fz);var tfx=ox+Math.cos(_af3)*lrad-tw/2;var tfy=oy-Math.sin(_af3)*lrad-th/2;var side;var _af5=[];side=tfx;var ipx=side;var ipy=-Math.tan(_af3)*side+oy+Math.tan(_af3)*ox;if(ipy>=tfy&&ipy<=tfy+th){_af5.push({x:ipx,y:ipy});}side=tfx+tw;ipx=side;ipy=-Math.tan(_af3)*side+oy+Math.tan(_af3)*ox;if(ipy>=tfy&&ipy<=tfy+th){_af5.push({x:ipx,y:ipy});}side=tfy;ipx=-1/Math.tan(_af3)*side+ox+1/Math.tan(_af3)*oy;ipy=side;if(ipx>=tfx&&ipx<=tfx+tw){_af5.push({x:ipx,y:ipy});}side=tfy+th;ipx=-1/Math.tan(_af3)*side+ox+1/Math.tan(_af3)*oy;ipy=side;if(ipx>=tfx&&ipx<=tfx+tw){_af5.push({x:ipx,y:ipy});}var dif;if(_af4=="inside"){for(var it=0;it<_af5.length;it++){var ip=_af5[it];dif=this._distance(ip.x,ip.y,ox,oy)-lrad;if(dif>=0){tfx=ox+Math.cos(_af3)*(lrad-dif)-tw/2;tfy=oy-Math.sin(_af3)*(lrad-dif)-th/2;break;}}}else{for(it=0;it<_af5.length;it++){ip=_af5[it];dif=this._distance(ip.x,ip.y,ox,oy)-lrad;if(dif<=0){tfx=ox+Math.cos(_af3)*(lrad-dif)-tw/2;tfy=oy-Math.sin(_af3)*(lrad-dif)-th/2;break;}}}this.text=this._gauge.drawText(_af2,txt,tfx+tw/2,tfy+th,"middle",this.color,this.font);},_distance:function(x1,y1,x2,y2){return Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));},_move:function(_af6){var v=Math.min(Math.max(this.value,this._gauge.min),this._gauge.max),c=this.currentValue;if(_af6){var _af7=this._gauge._getAngle(v);this.shape.setTransform([{dx:this._gauge.cx,dy:this._gauge.cy},gfx.matrix.rotateg(_af7)]);this.currentValue=v;}else{if(c!=v){var anim=new fx.Animation({curve:[c,v],duration:this.duration,easing:this.easing});_aec.connect(anim,"onAnimate",lang.hitch(this,function(step){this.shape.setTransform([{dx:this._gauge.cx,dy:this._gauge.cy},gfx.matrix.rotateg(this._gauge._getAngle(step))]);this.currentValue=step;}));anim.play();}}}});});},"dijit/form/RangeBoundTextBox":function(){define("dijit/form/RangeBoundTextBox",["dojo/_base/declare","dojo/i18n","./MappedTextBox"],function(_af8,i18n,_af9){var _afa=_af8("dijit.form.RangeBoundTextBox",_af9,{rangeMessage:"",rangeCheck:function(_afb,_afc){return ("min" in _afc?(this.compare(_afb,_afc.min)>=0):true)&&("max" in _afc?(this.compare(_afb,_afc.max)<=0):true);},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints);},_isDefinitelyOutOfRange:function(){var val=this.get("value");if(val==null){return false;}var _afd=false;if("min" in this.constraints){var min=this.constraints.min;_afd=this.compare(val,((typeof min=="number")&&min>=0&&val!=0)?0:min)<0;}if(!_afd&&("max" in this.constraints)){var max=this.constraints.max;_afd=this.compare(val,((typeof max!="number")||max>0)?max:0)>0;}return _afd;},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange();},isValid:function(_afe){return this.inherited(arguments)&&((this._isEmpty(this.textbox.value)&&!this.required)||this.isInRange(_afe));},getErrorMessage:function(_aff){var v=this.get("value");if(v!=null&&v!==""&&(typeof v!="number"||!isNaN(v))&&!this.isInRange(_aff)){return this.rangeMessage;}return this.inherited(arguments);},postMixInProperties:function(){this.inherited(arguments);if(!this.rangeMessage){this.messages=i18n.getLocalization("dijit.form","validate",this.lang);this.rangeMessage=this.messages.rangeMessage;}},applyTextDir:function(){}});return _afa;});},"dijit/_editor/RichText":function(){define("dijit/_editor/RichText",["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/query","dojo/ready","dojo/sniff","dojo/topic","dojo/_base/unload","dojo/_base/url","dojo/_base/window","../_Widget","../_CssStateMixin","./selection","./range","./html","../focus","../main"],function(_b00,_b01,_b02,_b03,dom,_b04,_b05,_b06,_b07,_b08,_b09,_b0a,keys,lang,on,_b0b,_b0c,has,_b0d,_b0e,_b0f,win,_b10,_b11,_b12,_b13,_b14,_b15,_b16){var _b17=_b02("dijit._editor.RichText",[_b10,_b11],{constructor:function(_b18){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};if(_b18&&lang.isString(_b18.value)){this.value=_b18.value;}this.onLoadDeferred=new _b03();},baseClass:"dijitEditor",inheritWidth:false,focusOnLoad:false,name:"",styleSheets:"",height:"300px",minHeight:"1em",isClosed:true,isLoaded:false,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:false,disableSpellCheck:false,postCreate:function(){if("textarea"===this.domNode.tagName.toLowerCase()){console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");}this.contentPreFilters=[lang.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);if(has("mozilla")){this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters);this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters);}if(has("webkit")){this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters);this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters);}if(has("ie")){this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters);this.contentDomPostFilters=[lang.hitch(this,this._stripBreakerNodes)].concat(this.contentDomPostFilters);}this.inherited(arguments);_b0d.publish(_b16._scopeName+"._editor.RichText::init",this);this.open();this.setupDefaultShortcuts();},setupDefaultShortcuts:function(){var exec=lang.hitch(this,function(cmd,arg){return function(){return !this.execCommand(cmd,arg);};});var _b19={b:exec("bold"),i:exec("italic"),u:exec("underline"),a:exec("selectall"),s:function(){this.save(true);},m:function(){this.isTabIndent=!this.isTabIndent;},"1":exec("formatblock","h1"),"2":exec("formatblock","h2"),"3":exec("formatblock","h3"),"4":exec("formatblock","h4"),"\\":exec("insertunorderedlist")};if(!has("ie")){_b19.Z=exec("redo");}var key;for(key in _b19){this.addKeyHandler(key,true,false,_b19[key]);}},events:["onKeyPress","onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:false,_localizeEditorCommands:function(){if(_b17._editorCommandsLocalized){this._local2NativeFormatNames=_b17._local2NativeFormatNames;this._native2LocalFormatNames=_b17._native2LocalFormatNames;return;}_b17._editorCommandsLocalized=true;_b17._local2NativeFormatNames={};_b17._native2LocalFormatNames={};this._local2NativeFormatNames=_b17._local2NativeFormatNames;this._native2LocalFormatNames=_b17._native2LocalFormatNames;var _b1a=["div","p","pre","h1","h2","h3","h4","h5","h6","ol","ul","address"];var _b1b="",_b1c,i=0;while((_b1c=_b1a[i++])){if(_b1c.charAt(1)!=="l"){_b1b+="<"+_b1c+"><span>content</span></"+_b1c+"><br/>";}else{_b1b+="<"+_b1c+"><li>content</li></"+_b1c+"><br/>";}}var _b1d={position:"absolute",top:"0px",zIndex:10,opacity:0.01};var div=_b06.create("div",{style:_b1d,innerHTML:_b1b});this.ownerDocumentBody.appendChild(div);var _b1e=lang.hitch(this,function(){var node=div.firstChild;while(node){try{this._sCall("selectElement",[node.firstChild]);var _b1f=node.tagName.toLowerCase();this._local2NativeFormatNames[_b1f]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[_b1f]]=_b1f;node=node.nextSibling.nextSibling;}catch(e){}}_b06.destroy(div);});this.defer(_b1e);},open:function(_b20){if(!this.onLoadDeferred||this.onLoadDeferred.fired>=0){this.onLoadDeferred=new _b03();}if(!this.isClosed){this.close();}_b0d.publish(_b16._scopeName+"._editor.RichText::open",this);if(arguments.length===1&&_b20.nodeName){this.domNode=_b20;}var dn=this.domNode;var html;if(lang.isString(this.value)){html=this.value;delete this.value;dn.innerHTML="";}else{if(dn.nodeName&&dn.nodeName.toLowerCase()=="textarea"){var ta=(this.textarea=dn);this.name=ta.name;html=ta.value;dn=this.domNode=this.ownerDocument.createElement("div");dn.setAttribute("widgetId",this.id);ta.removeAttribute("widgetId");dn.cssText=ta.cssText;dn.className+=" "+ta.className;_b06.place(dn,ta,"before");var _b21=lang.hitch(this,function(){_b08.set(ta,{display:"block",position:"absolute",top:"-1000px"});if(has("ie")){var s=ta.style;this.__overflow=s.overflow;s.overflow="hidden";}});if(has("ie")){this.defer(_b21,10);}else{_b21();}if(ta.form){var _b22=ta.value;this.reset=function(){var _b23=this.getValue();if(_b23!==_b22){this.replaceValue(_b22);}};on(ta.form,"submit",lang.hitch(this,function(){_b04.set(ta,"disabled",this.disabled);ta.value=this.getValue();}));}}else{html=_b14.getChildrenHtml(dn);dn.innerHTML="";}}this.value=html;if(dn.nodeName&&dn.nodeName==="LI"){dn.innerHTML=" <br>";}this.header=dn.ownerDocument.createElement("div");dn.appendChild(this.header);this.editingArea=dn.ownerDocument.createElement("div");dn.appendChild(this.editingArea);this.footer=dn.ownerDocument.createElement("div");dn.appendChild(this.footer);if(!this.name){this.name=this.id+"_AUTOGEN";}if(this.name!==""&&(!_b01["useXDomain"]||_b01["allowXdRichTextSave"])){var _b24=dom.byId(_b16._scopeName+"._editor.RichText.value");if(_b24&&_b24.value!==""){var _b25=_b24.value.split(this._SEPARATOR),i=0,dat;while((dat=_b25[i++])){var data=dat.split(this._NAME_CONTENT_SEP);if(data[0]===this.name){html=data[1];_b25=_b25.splice(i,1);_b24.value=_b25.join(this._SEPARATOR);break;}}}if(!_b17._globalSaveHandler){_b17._globalSaveHandler={};_b0e.addOnUnload(function(){var id;for(id in _b17._globalSaveHandler){var f=_b17._globalSaveHandler[id];if(lang.isFunction(f)){f();}}});}_b17._globalSaveHandler[this.id]=lang.hitch(this,"_saveContent");}this.isClosed=false;var ifr=(this.editorObject=this.iframe=this.ownerDocument.createElement("iframe"));ifr.id=this.id+"_iframe";ifr.style.border="none";ifr.style.width="100%";if(this._layoutMode){ifr.style.height="100%";}else{if(has("ie")>=7){if(this.height){ifr.style.height=this.height;}if(this.minHeight){ifr.style.minHeight=this.minHeight;}}else{ifr.style.height=this.height?this.height:this.minHeight;}}ifr.frameBorder=0;ifr._loadFunc=lang.hitch(this,function(w){this.window=w;this.document=this.window.document;if(has("ie")){this._localizeEditorCommands();}this.onLoad(html);});var src=this._getIframeDocTxt(),s="javascript: '"+src.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'";ifr.setAttribute("src",s);this.editingArea.appendChild(ifr);if(has("safari")<=4){src=ifr.getAttribute("src");if(!src||src.indexOf("javascript")===-1){this.defer(function(){ifr.setAttribute("src",s);});}}if(dn.nodeName==="LI"){dn.lastChild.style.marginTop="-1.2em";}_b05.add(this.domNode,this.baseClass);},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var _b26=_b08.getComputedStyle(this.domNode);var html="";var _b27=true;if(has("ie")||has("webkit")||(!this.height&&!has("mozilla"))){html="<div id='dijitEditorBody'></div>";_b27=false;}else{if(has("mozilla")){this._cursorToStart=true;html="&#160;";}}var font=[_b26.fontWeight,_b26.fontSize,_b26.fontFamily].join(" ");var _b28=_b26.lineHeight;if(_b28.indexOf("px")>=0){_b28=parseFloat(_b28)/parseFloat(_b26.fontSize);}else{if(_b28.indexOf("em")>=0){_b28=parseFloat(_b28);}else{_b28="normal";}}var _b29="";var self=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(_b2a){_b2a=_b2a.replace(/^;/ig,"")+";";var s=_b2a.split(":")[0];if(s){s=lang.trim(s);s=s.toLowerCase();var i;var sC="";for(i=0;i<s.length;i++){var c=s.charAt(i);switch(c){case "-":i++;c=s.charAt(i).toUpperCase();default:sC+=c;}}_b08.set(self.domNode,sC,"");}_b29+=_b2a+";";});var _b2b=_b0b("label[for=\""+this.id+"\"]");return [this.isLeftToRight()?"<html>\n<head>\n":"<html dir='rtl'>\n<head>\n",(has("mozilla")&&_b2b.length?"<title>"+_b2b[0].innerHTML+"</title>\n":""),"<meta http-equiv='Content-Type' content='text/html'>\n","<style>\n","\tbody,html {\n","\t\tbackground:transparent;\n","\t\tpadding: 1px 0 0 0;\n","\t\tmargin: -1px 0 0 0;\n",((has("webkit"))?"\t\twidth: 100%;\n":""),((has("webkit"))?"\t\theight: 100%;\n":""),"\t}\n","\tbody{\n","\t\ttop:0px;\n","\t\tleft:0px;\n","\t\tright:0px;\n","\t\tfont:",font,";\n",((this.height||has("opera"))?"":"\t\tposition: fixed;\n"),"\t\tmin-height:",this.minHeight,";\n","\t\tline-height:",_b28,";\n","\t}\n","\tp{ margin: 1em 0; }\n",(!_b27&&!this.height?"\tbody,html {overflow-y: hidden;}\n":""),"\t#dijitEditorBody{overflow-x: auto; overflow-y:"+(this.height?"auto;":"hidden;")+" outline: 0px;}\n","\tli > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; }\n",(!has("ie")?"\tli{ min-height:1.2em; }\n":""),"</style>\n",this._applyEditingAreaStyleSheets(),"\n","</head>\n<body ",(_b27?"id='dijitEditorBody' ":""),"onload='frameElement && frameElement._loadFunc(window,document)' ","style='"+_b29+"'>",html,"</body>\n</html>"].join("");},_applyEditingAreaStyleSheets:function(){var _b2c=[];if(this.styleSheets){_b2c=this.styleSheets.split(";");this.styleSheets="";}_b2c=_b2c.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];var text="",i=0,url;while((url=_b2c[i++])){var _b2d=(new _b0f(win.global.location,url)).toString();this.editingAreaStyleSheets.push(_b2d);text+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_b2d+"\"/>";}return text;},addStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){url=(new _b0f(win.global.location,url)).toString();}if(_b00.indexOf(this.editingAreaStyleSheets,url)>-1){return;}this.editingAreaStyleSheets.push(url);this.onLoadDeferred.then(lang.hitch(this,function(){if(this.document.createStyleSheet){this.document.createStyleSheet(url);}else{var head=this.document.getElementsByTagName("head")[0];var _b2e=this.document.createElement("link");_b2e.rel="stylesheet";_b2e.type="text/css";_b2e.href=url;head.appendChild(_b2e);}}));},removeStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){url=(new _b0f(win.global.location,url)).toString();}var _b2f=_b00.indexOf(this.editingAreaStyleSheets,url);if(_b2f===-1){return;}delete this.editingAreaStyleSheets[_b2f];_b0b("link:[href=\""+url+"\"]",this.window.document).orphan();},disabled:false,_mozSettingProps:{"styleWithCSS":false},_setDisabledAttr:function(_b30){_b30=!!_b30;this._set("disabled",_b30);if(!this.isLoaded){return;}if(has("ie")||has("webkit")||has("opera")){var _b31=has("ie")&&(this.isLoaded||!this.focusOnLoad);if(_b31){this.editNode.unselectable="on";}this.editNode.contentEditable=!_b30;if(_b31){this.defer(function(){if(this.editNode){this.editNode.unselectable="off";}});}}else{try{this.document.designMode=(_b30?"off":"on");}catch(e){return;}if(!_b30&&this._mozSettingProps){var ps=this._mozSettingProps;var n;for(n in ps){if(ps.hasOwnProperty(n)){try{this.document.execCommand(n,false,ps[n]);}catch(e2){}}}}}this._disabledOK=true;},onLoad:function(html){if(!this.window.__registeredWindow){this.window.__registeredWindow=true;this._iframeRegHandle=_b15.registerIframe(this.iframe);}if(!has("ie")&&!has("webkit")&&(this.height||has("mozilla"))){this.editNode=this.document.body;}else{this.editNode=this.document.body.firstChild;var _b32=this;if(has("ie")){this.tabStop=_b06.create("div",{tabIndex:-1},this.editingArea);this.iframe.onfocus=function(){_b32.editNode.setActive();};}}this.focusNode=this.editNode;var _b33=this.events.concat(this.captureEvents);var ap=this.iframe?this.document:this.editNode;_b00.forEach(_b33,function(item){this.connect(ap,item.toLowerCase(),item);},this);this.connect(ap,"onmouseup","onClick");if(has("ie")){this.connect(this.document,"onmousedown","_onIEMouseDown");this.editNode.style.zoom=1;}else{this.connect(this.document,"onmousedown",function(){delete this._cursorToStart;});}if(has("webkit")){this._webkitListener=this.connect(this.document,"onmouseup","onDisplayChanged");this.connect(this.document,"onmousedown",function(e){var t=e.target;if(t&&(t===this.document.body||t===this.document)){this.defer("placeCursorAtEnd");}});}if(has("ie")){try{this.document.execCommand("RespectVisibilityInDesign",true,null);}catch(e){}}this.isLoaded=true;this.set("disabled",this.disabled);var _b34=lang.hitch(this,function(){this.setValue(html);if(this.onLoadDeferred){this.onLoadDeferred.resolve(true);}this.onDisplayChanged();if(this.focusOnLoad){_b0c(lang.hitch(this,"defer","focus",this.updateInterval));}this.value=this.getValue(true);});if(this.setValueDeferred){this.setValueDeferred.then(_b34);}else{_b34();}},onKeyDown:function(e){if(e.keyCode===keys.TAB&&this.isTabIndent){_b09.stop(e);if(this.queryCommandEnabled((e.shiftKey?"outdent":"indent"))){this.execCommand((e.shiftKey?"outdent":"indent"));}}if(has("ie")){if(e.keyCode==keys.TAB&&!this.isTabIndent){if(e.shiftKey&&!e.ctrlKey&&!e.altKey){this.iframe.focus();}else{if(!e.shiftKey&&!e.ctrlKey&&!e.altKey){this.tabStop.focus();}}}else{if(e.keyCode===keys.BACKSPACE&&this.document.selection.type==="Control"){_b09.stop(e);this.execCommand("delete");}else{if((65<=e.keyCode&&e.keyCode<=90)||(e.keyCode>=37&&e.keyCode<=40)){e.charCode=e.keyCode;this.onKeyPress(e);}}}}if(has("ff")){if(e.keyCode===keys.PAGE_UP||e.keyCode===keys.PAGE_DOWN){if(this.editNode.clientHeight>=this.editNode.scrollHeight){e.preventDefault();}}}return true;},onKeyUp:function(){},setDisabled:function(_b35){_b0a.deprecated("dijit.Editor::setDisabled is deprecated","use dijit.Editor::attr(\"disabled\",boolean) instead",2);this.set("disabled",_b35);},_setValueAttr:function(_b36){this.setValue(_b36);},_setDisableSpellCheckAttr:function(_b37){if(this.document){_b04.set(this.document.body,"spellcheck",!_b37);}else{this.onLoadDeferred.then(lang.hitch(this,function(){_b04.set(this.document.body,"spellcheck",!_b37);}));}this._set("disableSpellCheck",_b37);},onKeyPress:function(e){var c=(e.keyChar&&e.keyChar.toLowerCase())||e.keyCode,_b38=this._keyHandlers[c],args=arguments;if(_b38&&!e.altKey){_b00.some(_b38,function(h){if(!(h.shift^e.shiftKey)&&!(h.ctrl^(e.ctrlKey||e.metaKey))){if(!h.handler.apply(this,args)){e.preventDefault();}return true;}},this);}if(!this._onKeyHitch){this._onKeyHitch=lang.hitch(this,"onKeyPressed");}this.defer("_onKeyHitch",1);return true;},addKeyHandler:function(key,ctrl,_b39,_b3a){if(!lang.isArray(this._keyHandlers[key])){this._keyHandlers[key]=[];}this._keyHandlers[key].push({shift:_b39||false,ctrl:ctrl||false,handler:_b3a});},onKeyPressed:function(){this.onDisplayChanged();},onClick:function(e){this.onDisplayChanged(e);},_onIEMouseDown:function(){if(!this.focused&&!this.disabled){this.focus();}},_onBlur:function(e){this.inherited(arguments);var _b3b=this.getValue(true);if(_b3b!==this.value){this.onChange(_b3b);}this._set("value",_b3b);},_onFocus:function(e){if(!this.disabled){if(!this._disabledOK){this.set("disabled",false);}this.inherited(arguments);}},blur:function(){if(!has("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus){this.window.document.documentElement.focus();}else{if(this.ownerDocumentBody.focus){this.ownerDocumentBody.focus();}}},focus:function(){if(!this.isLoaded){this.focusOnLoad=true;return;}if(this._cursorToStart){delete this._cursorToStart;if(this.editNode.childNodes){this.placeCursorAtStart();return;}}if(!has("ie")){_b15.focus(this.iframe);}else{if(this.editNode&&this.editNode.focus){this.iframe.fireEvent("onfocus",document.createEventObject());}}},updateInterval:200,_updateTimer:null,onDisplayChanged:function(){if(this._updateTimer){this._updateTimer.remove();}this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval);},onNormalizedDisplayChanged:function(){delete this._updateTimer;},onChange:function(){},_normalizeCommand:function(cmd,_b3c){var _b3d=cmd.toLowerCase();if(_b3d==="formatblock"){if(has("safari")&&_b3c===undefined){_b3d="heading";}}else{if(_b3d==="hilitecolor"&&!has("mozilla")){_b3d="backcolor";}}return _b3d;},_qcaCache:{},queryCommandAvailable:function(_b3e){var ca=this._qcaCache[_b3e];if(ca!==undefined){return ca;}return (this._qcaCache[_b3e]=this._queryCommandAvailable(_b3e));},_queryCommandAvailable:function(_b3f){var ie=1;var _b40=1<<1;var _b41=1<<2;var _b42=1<<3;function _b43(_b44){return {ie:Boolean(_b44&ie),mozilla:Boolean(_b44&_b40),webkit:Boolean(_b44&_b41),opera:Boolean(_b44&_b42)};};var _b45=null;switch(_b3f.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":_b45=_b43(_b40|ie|_b41|_b42);break;case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":_b45=_b43(_b40|ie|_b42|_b41);break;case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":_b45=_b43(ie);break;case "cut":case "copy":case "paste":_b45=_b43(ie|_b40|_b41|_b42);break;case "inserttable":_b45=_b43(_b40|ie);break;case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":_b45=_b43(ie|_b40);break;default:return false;}return (has("ie")&&_b45.ie)||(has("mozilla")&&_b45.mozilla)||(has("webkit")&&_b45.webkit)||(has("opera")&&_b45.opera);},execCommand:function(_b46,_b47){var _b48;this.focus();_b46=this._normalizeCommand(_b46,_b47);if(_b47!==undefined){if(_b46==="heading"){throw new Error("unimplemented");}else{if((_b46==="formatblock")&&has("ie")){_b47="<"+_b47+">";}}}var _b49="_"+_b46+"Impl";if(this[_b49]){_b48=this[_b49](_b47);}else{_b47=arguments.length>1?_b47:null;if(_b47||_b46!=="createlink"){_b48=this.document.execCommand(_b46,false,_b47);}}this.onDisplayChanged();return _b48;},queryCommandEnabled:function(_b4a){if(this.disabled||!this._disabledOK){return false;}_b4a=this._normalizeCommand(_b4a);var _b4b="_"+_b4a+"EnabledImpl";if(this[_b4b]){return this[_b4b](_b4a);}else{return this._browserQueryCommandEnabled(_b4a);}},queryCommandState:function(_b4c){if(this.disabled||!this._disabledOK){return false;}_b4c=this._normalizeCommand(_b4c);try{return this.document.queryCommandState(_b4c);}catch(e){return false;}},queryCommandValue:function(_b4d){if(this.disabled||!this._disabledOK){return false;}var r;_b4d=this._normalizeCommand(_b4d);if(has("ie")&&_b4d==="formatblock"){r=this._native2LocalFormatNames[this.document.queryCommandValue(_b4d)];}else{if(has("mozilla")&&_b4d==="hilitecolor"){var _b4e;try{_b4e=this.document.queryCommandValue("styleWithCSS");}catch(e){_b4e=false;}this.document.execCommand("styleWithCSS",false,true);r=this.document.queryCommandValue(_b4d);this.document.execCommand("styleWithCSS",false,_b4e);}else{r=this.document.queryCommandValue(_b4d);}}return r;},_sCall:function(name,args){return win.withGlobal(this.window,name,_b12,args);},placeCursorAtStart:function(){this.focus();var _b4f=false;if(has("mozilla")){var _b50=this.editNode.firstChild;while(_b50){if(_b50.nodeType===3){if(_b50.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_b4f=true;this._sCall("selectElement",[_b50]);break;}}else{if(_b50.nodeType===1){_b4f=true;var tg=_b50.tagName?_b50.tagName.toLowerCase():"";if(/br|input|img|base|meta|area|basefont|hr|link/.test(tg)){this._sCall("selectElement",[_b50]);}else{this._sCall("selectElementChildren",[_b50]);}break;}}_b50=_b50.nextSibling;}}else{_b4f=true;this._sCall("selectElementChildren",[this.editNode]);}if(_b4f){this._sCall("collapse",[true]);}},placeCursorAtEnd:function(){this.focus();var _b51=false;if(has("mozilla")){var last=this.editNode.lastChild;while(last){if(last.nodeType===3){if(last.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_b51=true;this._sCall("selectElement",[last]);break;}}else{if(last.nodeType===1){_b51=true;this._sCall("selectElement",[last.lastChild||last]);break;}}last=last.previousSibling;}}else{_b51=true;this._sCall("selectElementChildren",[this.editNode]);}if(_b51){this._sCall("collapse",[false]);}},getValue:function(_b52){if(this.textarea){if(this.isClosed||!this.isLoaded){return this.textarea.value;}}return this._postFilterContent(null,_b52);},_getValueAttr:function(){return this.getValue(true);},setValue:function(html){if(!this.isLoaded){this.onLoadDeferred.then(lang.hitch(this,function(){this.setValue(html);}));return;}this._cursorToStart=true;if(this.textarea&&(this.isClosed||!this.isLoaded)){this.textarea.value=html;}else{html=this._preFilterContent(html);var node=this.isClosed?this.domNode:this.editNode;if(html&&has("mozilla")&&html.toLowerCase()==="<p></p>"){html="<p>&#160;</p>";}if(!html&&has("webkit")){html="&#160;";}node.innerHTML=html;this._preDomFilterContent(node);}this.onDisplayChanged();this._set("value",this.getValue(true));},replaceValue:function(html){if(this.isClosed){this.setValue(html);}else{if(this.window&&this.window.getSelection&&!has("mozilla")){this.setValue(html);}else{if(this.window&&this.window.getSelection){html=this._preFilterContent(html);this.execCommand("selectall");if(!html){this._cursorToStart=true;html="&#160;";}this.execCommand("inserthtml",html);this._preDomFilterContent(this.editNode);}else{if(this.document&&this.document.selection){this.setValue(html);}}}}this._set("value",this.getValue(true));},_preFilterContent:function(html){var ec=html;_b00.forEach(this.contentPreFilters,function(ef){if(ef){ec=ef(ec);}});return ec;},_preDomFilterContent:function(dom){dom=dom||this.editNode;_b00.forEach(this.contentDomPreFilters,function(ef){if(ef&&lang.isFunction(ef)){ef(dom);}},this);},_postFilterContent:function(dom,_b53){var ec;if(!lang.isString(dom)){dom=dom||this.editNode;if(this.contentDomPostFilters.length){if(_b53){dom=lang.clone(dom);}_b00.forEach(this.contentDomPostFilters,function(ef){dom=ef(dom);});}ec=_b14.getChildrenHtml(dom);}else{ec=dom;}if(!lang.trim(ec.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length){ec="";}_b00.forEach(this.contentPostFilters,function(ef){ec=ef(ec);});return ec;},_saveContent:function(){var _b54=dom.byId(_b16._scopeName+"._editor.RichText.value");if(_b54){if(_b54.value){_b54.value+=this._SEPARATOR;}_b54.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(true);}},escapeXml:function(str,_b55){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_b55){str=str.replace(/'/gm,"&#39;");}return str;},getNodeHtml:function(node){_b0a.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",2);return _b14.getNodeHtml(node);},getNodeChildrenHtml:function(dom){_b0a.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return _b14.getChildrenHtml(dom);},close:function(save){if(this.isClosed){return;}if(!arguments.length){save=true;}if(save){this._set("value",this.getValue(true));}if(this.interval){clearInterval(this.interval);}if(this._webkitListener){this.disconnect(this._webkitListener);delete this._webkitListener;}if(has("ie")){this.iframe.onfocus=null;}this.iframe._loadFunc=null;if(this._iframeRegHandle){this._iframeRegHandle.remove();delete this._iframeRegHandle;}if(this.textarea){var s=this.textarea.style;s.position="";s.left=s.top="";if(has("ie")){s.overflow=this.__overflow;this.__overflow=null;}this.textarea.value=this.value;_b06.destroy(this.domNode);this.domNode=this.textarea;}else{this.domNode.innerHTML=this.value;}delete this.iframe;_b05.remove(this.domNode,this.baseClass);this.isClosed=true;this.isLoaded=false;delete this.editNode;delete this.focusNode;if(this.window&&this.window._frameElement){this.window._frameElement=null;}this.window=null;this.document=null;this.editingArea=null;this.editorObject=null;},destroy:function(){if(!this.isClosed){this.close(false);}if(this._updateTimer){this._updateTimer.remove();}this.inherited(arguments);if(_b17._globalSaveHandler){delete _b17._globalSaveHandler[this.id];}},_removeMozBogus:function(html){return html.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"");},_removeWebkitBogus:function(html){html=html.replace(/\sclass="webkit-block-placeholder"/gi,"");html=html.replace(/\sclass="apple-style-span"/gi,"");html=html.replace(/<meta charset=\"utf-8\" \/>/gi,"");return html;},_normalizeFontStyle:function(html){return html.replace(/<(\/)?strong([ \>])/gi,"<$1b$2").replace(/<(\/)?em([ \>])/gi,"<$1i$2");},_preFixUrlAttributes:function(html){return html.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2");},_browserQueryCommandEnabled:function(_b56){if(!_b56){return false;}var elem=has("ie")?this.document.selection.createRange():this.document;try{return elem.queryCommandEnabled(_b56);}catch(e){return false;}},_createlinkEnabledImpl:function(){var _b57=true;if(has("opera")){var sel=this.window.getSelection();if(sel.isCollapsed){_b57=true;}else{_b57=this.document.queryCommandEnabled("createlink");}}else{_b57=this._browserQueryCommandEnabled("createlink");}return _b57;},_unlinkEnabledImpl:function(){var _b58=true;if(has("mozilla")||has("webkit")){_b58=this._sCall("hasAncestorElement",["a"]);}else{_b58=this._browserQueryCommandEnabled("unlink");}return _b58;},_inserttableEnabledImpl:function(){var _b59=true;if(has("mozilla")||has("webkit")){_b59=true;}else{_b59=this._browserQueryCommandEnabled("inserttable");}return _b59;},_cutEnabledImpl:function(){var _b5a=true;if(has("webkit")){var sel=this.window.getSelection();if(sel){sel=sel.toString();}_b5a=!!sel;}else{_b5a=this._browserQueryCommandEnabled("cut");}return _b5a;},_copyEnabledImpl:function(){var _b5b=true;if(has("webkit")){var sel=this.window.getSelection();if(sel){sel=sel.toString();}_b5b=!!sel;}else{_b5b=this._browserQueryCommandEnabled("copy");}return _b5b;},_pasteEnabledImpl:function(){var _b5c=true;if(has("webkit")){return true;}else{_b5c=this._browserQueryCommandEnabled("paste");}return _b5c;},_inserthorizontalruleImpl:function(_b5d){if(has("ie")){return this._inserthtmlImpl("<hr>");}return this.document.execCommand("inserthorizontalrule",false,_b5d);},_unlinkImpl:function(_b5e){if((this.queryCommandEnabled("unlink"))&&(has("mozilla")||has("webkit"))){var a=this._sCall("getAncestorElement",["a"]);this._sCall("selectElement",[a]);return this.document.execCommand("unlink",false,null);}return this.document.execCommand("unlink",false,_b5e);},_hilitecolorImpl:function(_b5f){var _b60;var _b61=this._handleTextColorOrProperties("hilitecolor",_b5f);if(!_b61){if(has("mozilla")){this.document.execCommand("styleWithCSS",false,true);console.log("Executing color command.");_b60=this.document.execCommand("hilitecolor",false,_b5f);this.document.execCommand("styleWithCSS",false,false);}else{_b60=this.document.execCommand("hilitecolor",false,_b5f);}}return _b60;},_backcolorImpl:function(_b62){if(has("ie")){_b62=_b62?_b62:null;}var _b63=this._handleTextColorOrProperties("backcolor",_b62);if(!_b63){_b63=this.document.execCommand("backcolor",false,_b62);}return _b63;},_forecolorImpl:function(_b64){if(has("ie")){_b64=_b64?_b64:null;}var _b65=false;_b65=this._handleTextColorOrProperties("forecolor",_b64);if(!_b65){_b65=this.document.execCommand("forecolor",false,_b64);}return _b65;},_inserthtmlImpl:function(_b66){_b66=this._preFilterContent(_b66);var rv=true;if(has("ie")){var _b67=this.document.selection.createRange();if(this.document.selection.type.toUpperCase()==="CONTROL"){var n=_b67.item(0);while(_b67.length){_b67.remove(_b67.item(0));}n.outerHTML=_b66;}else{_b67.pasteHTML(_b66);}_b67.select();}else{if(has("mozilla")&&!_b66.length){this._sCall("remove");}else{rv=this.document.execCommand("inserthtml",false,_b66);}}return rv;},_boldImpl:function(_b68){var _b69=false;if(has("ie")){this._adaptIESelection();_b69=this._adaptIEFormatAreaAndExec("bold");}if(!_b69){_b69=this.document.execCommand("bold",false,_b68);}return _b69;},_italicImpl:function(_b6a){var _b6b=false;if(has("ie")){this._adaptIESelection();_b6b=this._adaptIEFormatAreaAndExec("italic");}if(!_b6b){_b6b=this.document.execCommand("italic",false,_b6a);}return _b6b;},_underlineImpl:function(_b6c){var _b6d=false;if(has("ie")){this._adaptIESelection();_b6d=this._adaptIEFormatAreaAndExec("underline");}if(!_b6d){_b6d=this.document.execCommand("underline",false,_b6c);}return _b6d;},_strikethroughImpl:function(_b6e){var _b6f=false;if(has("ie")){this._adaptIESelection();_b6f=this._adaptIEFormatAreaAndExec("strikethrough");}if(!_b6f){_b6f=this.document.execCommand("strikethrough",false,_b6e);}return _b6f;},_superscriptImpl:function(_b70){var _b71=false;if(has("ie")){this._adaptIESelection();_b71=this._adaptIEFormatAreaAndExec("superscript");}if(!_b71){_b71=this.document.execCommand("superscript",false,_b70);}return _b71;},_subscriptImpl:function(_b72){var _b73=false;if(has("ie")){this._adaptIESelection();_b73=this._adaptIEFormatAreaAndExec("subscript");}if(!_b73){_b73=this.document.execCommand("subscript",false,_b72);}return _b73;},_fontnameImpl:function(_b74){var _b75;if(has("ie")){_b75=this._handleTextColorOrProperties("fontname",_b74);}if(!_b75){_b75=this.document.execCommand("fontname",false,_b74);}return _b75;},_fontsizeImpl:function(_b76){var _b77;if(has("ie")){_b77=this._handleTextColorOrProperties("fontsize",_b76);}if(!_b77){_b77=this.document.execCommand("fontsize",false,_b76);}return _b77;},_insertorderedlistImpl:function(_b78){var _b79=false;if(has("ie")){_b79=this._adaptIEList("insertorderedlist",_b78);}if(!_b79){_b79=this.document.execCommand("insertorderedlist",false,_b78);}return _b79;},_insertunorderedlistImpl:function(_b7a){var _b7b=false;if(has("ie")){_b7b=this._adaptIEList("insertunorderedlist",_b7a);}if(!_b7b){_b7b=this.document.execCommand("insertunorderedlist",false,_b7a);}return _b7b;},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header);},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer);},_getNodeChildrenHeight:function(node){var h=0;if(node&&node.childNodes){var i;for(i=0;i<node.childNodes.length;i++){var size=_b07.position(node.childNodes[i]);h+=size.h;}}return h;},_isNodeEmpty:function(node,_b7c){if(node.nodeType===1){if(node.childNodes.length>0){return this._isNodeEmpty(node.childNodes[0],_b7c);}return true;}else{if(node.nodeType===3){return (node.nodeValue.substring(_b7c)==="");}}return false;},_removeStartingRangeFromRange:function(node,_b7d){if(node.nextSibling){_b7d.setStart(node.nextSibling,0);}else{var _b7e=node.parentNode;while(_b7e&&_b7e.nextSibling==null){_b7e=_b7e.parentNode;}if(_b7e){_b7d.setStart(_b7e.nextSibling,0);}}return _b7d;},_adaptIESelection:function(){var _b7f=_b13.getSelection(this.window);if(_b7f&&_b7f.rangeCount&&!_b7f.isCollapsed){var _b80=_b7f.getRangeAt(0);var _b81=_b80.startContainer;var _b82=_b80.startOffset;while(_b81.nodeType===3&&_b82>=_b81.length&&_b81.nextSibling){_b82=_b82-_b81.length;_b81=_b81.nextSibling;}var _b83=null;while(this._isNodeEmpty(_b81,_b82)&&_b81!==_b83){_b83=_b81;_b80=this._removeStartingRangeFromRange(_b81,_b80);_b81=_b80.startContainer;_b82=0;}_b7f.removeAllRanges();_b7f.addRange(_b80);}},_adaptIEFormatAreaAndExec:function(_b84){var _b85=_b13.getSelection(this.window);var doc=this.document;var rs,ret,_b86,txt,_b87,_b88,_b89,_b8a;if(_b84&&_b85&&_b85.isCollapsed){var _b8b=this.queryCommandValue(_b84);if(_b8b){var _b8c=this._tagNamesForCommand(_b84);_b86=_b85.getRangeAt(0);var fs=_b86.startContainer;if(fs.nodeType===3){var _b8d=_b86.endOffset;if(fs.length<_b8d){ret=this._adjustNodeAndOffset(rs,_b8d);fs=ret.node;_b8d=ret.offset;}}var _b8e;while(fs&&fs!==this.editNode){var _b8f=fs.tagName?fs.tagName.toLowerCase():"";if(_b00.indexOf(_b8c,_b8f)>-1){_b8e=fs;break;}fs=fs.parentNode;}if(_b8e){rs=_b86.startContainer;var _b90=doc.createElement(_b8e.tagName);_b06.place(_b90,_b8e,"after");if(rs&&rs.nodeType===3){var _b91,_b92;var _b93=_b86.endOffset;if(rs.length<_b93){ret=this._adjustNodeAndOffset(rs,_b93);rs=ret.node;_b93=ret.offset;}txt=rs.nodeValue;_b87=doc.createTextNode(txt.substring(0,_b93));var _b94=txt.substring(_b93,txt.length);if(_b94){_b88=doc.createTextNode(_b94);}_b06.place(_b87,rs,"before");if(_b88){_b89=doc.createElement("span");_b89.className="ieFormatBreakerSpan";_b06.place(_b89,rs,"after");_b06.place(_b88,_b89,"after");_b88=_b89;}_b06.destroy(rs);var _b95=_b87.parentNode;var _b96=[];var _b97;while(_b95!==_b8e){var tg=_b95.tagName;_b97={tagName:tg};_b96.push(_b97);var _b98=doc.createElement(tg);if(_b95.style){if(_b98.style){if(_b95.style.cssText){_b98.style.cssText=_b95.style.cssText;_b97.cssText=_b95.style.cssText;}}}if(_b95.tagName==="FONT"){if(_b95.color){_b98.color=_b95.color;_b97.color=_b95.color;}if(_b95.face){_b98.face=_b95.face;_b97.face=_b95.face;}if(_b95.size){_b98.size=_b95.size;_b97.size=_b95.size;}}if(_b95.className){_b98.className=_b95.className;_b97.className=_b95.className;}if(_b88){_b91=_b88;while(_b91){_b92=_b91.nextSibling;_b98.appendChild(_b91);_b91=_b92;}}if(_b98.tagName==_b95.tagName){_b89=doc.createElement("span");_b89.className="ieFormatBreakerSpan";_b06.place(_b89,_b95,"after");_b06.place(_b98,_b89,"after");}else{_b06.place(_b98,_b95,"after");}_b87=_b95;_b88=_b98;_b95=_b95.parentNode;}if(_b88){_b91=_b88;if(_b91.nodeType===1||(_b91.nodeType===3&&_b91.nodeValue)){_b90.innerHTML="";}while(_b91){_b92=_b91.nextSibling;_b90.appendChild(_b91);_b91=_b92;}}var _b99;if(_b96.length){_b97=_b96.pop();var _b9a=doc.createElement(_b97.tagName);if(_b97.cssText&&_b9a.style){_b9a.style.cssText=_b97.cssText;}if(_b97.className){_b9a.className=_b97.className;}if(_b97.tagName==="FONT"){if(_b97.color){_b9a.color=_b97.color;}if(_b97.face){_b9a.face=_b97.face;}if(_b97.size){_b9a.size=_b97.size;}}_b06.place(_b9a,_b90,"before");while(_b96.length){_b97=_b96.pop();var _b9b=doc.createElement(_b97.tagName);if(_b97.cssText&&_b9b.style){_b9b.style.cssText=_b97.cssText;}if(_b97.className){_b9b.className=_b97.className;}if(_b97.tagName==="FONT"){if(_b97.color){_b9b.color=_b97.color;}if(_b97.face){_b9b.face=_b97.face;}if(_b97.size){_b9b.size=_b97.size;}}_b9a.appendChild(_b9b);_b9a=_b9b;}_b8a=doc.createTextNode(".");_b89.appendChild(_b8a);_b9a.appendChild(_b8a);_b99=_b13.create(this.window);_b99.setStart(_b8a,0);_b99.setEnd(_b8a,_b8a.length);_b85.removeAllRanges();_b85.addRange(_b99);this._sCall("collapse",[false]);_b8a.parentNode.innerHTML="";}else{_b89=doc.createElement("span");_b89.className="ieFormatBreakerSpan";_b8a=doc.createTextNode(".");_b89.appendChild(_b8a);_b06.place(_b89,_b90,"before");_b99=_b13.create(this.window);_b99.setStart(_b8a,0);_b99.setEnd(_b8a,_b8a.length);_b85.removeAllRanges();_b85.addRange(_b99);this._sCall("collapse",[false]);_b8a.parentNode.innerHTML="";}if(!_b90.firstChild){_b06.destroy(_b90);}return true;}}return false;}else{_b86=_b85.getRangeAt(0);rs=_b86.startContainer;if(rs&&rs.nodeType===3){var _b8d=_b86.startOffset;if(rs.length<_b8d){ret=this._adjustNodeAndOffset(rs,_b8d);rs=ret.node;_b8d=ret.offset;}txt=rs.nodeValue;_b87=doc.createTextNode(txt.substring(0,_b8d));var _b94=txt.substring(_b8d);if(_b94!==""){_b88=doc.createTextNode(txt.substring(_b8d));}_b89=doc.createElement("span");_b8a=doc.createTextNode(".");_b89.appendChild(_b8a);if(_b87.length){_b06.place(_b87,rs,"after");}else{_b87=rs;}_b06.place(_b89,_b87,"after");if(_b88){_b06.place(_b88,_b89,"after");}_b06.destroy(rs);var _b99=_b13.create(this.window);_b99.setStart(_b8a,0);_b99.setEnd(_b8a,_b8a.length);_b85.removeAllRanges();_b85.addRange(_b99);doc.execCommand(_b84);_b06.place(_b89.firstChild,_b89,"before");_b06.destroy(_b89);_b99.setStart(_b8a,0);_b99.setEnd(_b8a,_b8a.length);_b85.removeAllRanges();_b85.addRange(_b99);this._sCall("collapse",[false]);_b8a.parentNode.innerHTML="";return true;}}}else{return false;}},_adaptIEList:function(_b9c){var _b9d=_b13.getSelection(this.window);if(_b9d.isCollapsed){if(_b9d.rangeCount&&!this.queryCommandValue(_b9c)){var _b9e=_b9d.getRangeAt(0);var sc=_b9e.startContainer;if(sc&&sc.nodeType==3){if(!_b9e.startOffset){var _b9f="ul";if(_b9c==="insertorderedlist"){_b9f="ol";}var list=this.document.createElement(_b9f);var li=_b06.create("li",null,list);_b06.place(list,sc,"before");li.appendChild(sc);_b06.create("br",null,list,"after");var _ba0=_b13.create(this.window);_ba0.setStart(sc,0);_ba0.setEnd(sc,sc.length);_b9d.removeAllRanges();_b9d.addRange(_ba0);this._sCall("collapse",[true]);return true;}}}}return false;},_handleTextColorOrProperties:function(_ba1,_ba2){var _ba3=_b13.getSelection(this.window);var doc=this.document;var rs,ret,_ba4,txt,_ba5,_ba6,_ba7,_ba8;_ba2=_ba2||null;if(_ba1&&_ba3&&_ba3.isCollapsed){if(_ba3.rangeCount){_ba4=_ba3.getRangeAt(0);rs=_ba4.startContainer;if(rs&&rs.nodeType===3){var _ba9=_ba4.startOffset;if(rs.length<_ba9){ret=this._adjustNodeAndOffset(rs,_ba9);rs=ret.node;_ba9=ret.offset;}txt=rs.nodeValue;_ba5=doc.createTextNode(txt.substring(0,_ba9));var _baa=txt.substring(_ba9);if(_baa!==""){_ba6=doc.createTextNode(txt.substring(_ba9));}_ba7=doc.createElement("span");_ba8=doc.createTextNode(".");_ba7.appendChild(_ba8);var _bab=doc.createElement("span");_ba7.appendChild(_bab);if(_ba5.length){_b06.place(_ba5,rs,"after");}else{_ba5=rs;}_b06.place(_ba7,_ba5,"after");if(_ba6){_b06.place(_ba6,_ba7,"after");}_b06.destroy(rs);var _bac=_b13.create(this.window);_bac.setStart(_ba8,0);_bac.setEnd(_ba8,_ba8.length);_ba3.removeAllRanges();_ba3.addRange(_bac);if(has("webkit")){var _bad="color";if(_ba1==="hilitecolor"||_ba1==="backcolor"){_bad="backgroundColor";}_b08.set(_ba7,_bad,_ba2);this._sCall("remove",[]);_b06.destroy(_bab);_ba7.innerHTML="&#160;";this._sCall("selectElement",[_ba7]);this.focus();}else{this.execCommand(_ba1,_ba2);_b06.place(_ba7.firstChild,_ba7,"before");_b06.destroy(_ba7);_bac.setStart(_ba8,0);_bac.setEnd(_ba8,_ba8.length);_ba3.removeAllRanges();_ba3.addRange(_bac);this._sCall("collapse",[false]);_ba8.parentNode.removeChild(_ba8);}return true;}}}return false;},_adjustNodeAndOffset:function(node,_bae){while(node.length<_bae&&node.nextSibling&&node.nextSibling.nodeType===3){_bae=_bae-node.length;node=node.nextSibling;}return {"node":node,"offset":_bae};},_tagNamesForCommand:function(_baf){if(_baf==="bold"){return ["b","strong"];}else{if(_baf==="italic"){return ["i","em"];}else{if(_baf==="strikethrough"){return ["s","strike"];}else{if(_baf==="superscript"){return ["sup"];}else{if(_baf==="subscript"){return ["sub"];}else{if(_baf==="underline"){return ["u"];}}}}}}return [];},_stripBreakerNodes:function(node){if(!this.isLoaded){return;}_b0b(".ieFormatBreakerSpan",node).forEach(function(b){while(b.firstChild){_b06.place(b.firstChild,b,"before");}_b06.destroy(b);});return node;}});return _b17;});},"url:dojox/form/resources/HorizontalRangeSlider.html":"<table class=\"dijit dijitReset dijitSlider dijitSliderH dojoxRangeSlider\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\" role=\"presentation\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"topDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderDecrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper\" dojoAttachEvent=\"onmousedown:_onClkDecBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\n\t\t\t/><div role=\"presentation\" class=\"dojoxRangeSliderBarContainer\" dojoAttachPoint=\"sliderBarContainer\"\n\t\t\t\t><div dojoAttachPoint=\"sliderHandle\" tabIndex=\"${tabIndex}\" class=\"dijitSliderMoveable dijitSliderMoveableH\" dojoAttachEvent=\"onmousedown:_onHandleClick\" role=\"slider\"\n\t\t\t\t\t><div class=\"dijitSliderImageHandle dijitSliderImageHandleH\"></div\n\t\t\t\t></div\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"progressBar,focusNode\" class=\"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"></div\n\t\t\t\t><div dojoAttachPoint=\"sliderHandleMax\" tabIndex=\"${tabIndex}\" class=\"dijitSliderMoveable dijitSliderMoveableH\" dojoAttachEvent=\"onmousedown:_onHandleClickMax\" role=\"slider\"\n\t\t\t\t\t><div class=\"dijitSliderImageHandle dijitSliderImageHandleH\"></div\n\t\t\t\t></div\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH\" dojoAttachEvent=\"onmousedown:_onRemainingBarClick\"></div\n\t\t\t></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper\" dojoAttachEvent=\"onmousedown:_onClkIncBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderIncrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"containerNode,bottomDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n></table>\n","dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(_bb0){return function(_bb1,_bb2){switch(typeof _bb1){default:throw new Error("Can not query with a "+typeof _bb1);case "object":case "undefined":var _bb3=_bb1;_bb1=function(_bb4){for(var key in _bb3){var _bb5=_bb3[key];if(_bb5&&_bb5.test){if(!_bb5.test(_bb4[key],_bb4)){return false;}}else{if(_bb5!=_bb4[key]){return false;}}}return true;};break;case "string":if(!this[_bb1]){throw new Error("No filter function "+_bb1+" was found in store");}_bb1=this[_bb1];case "function":}function _bb6(_bb7){var _bb8=_bb0.filter(_bb7,_bb1);var _bb9=_bb2&&_bb2.sort;if(_bb9){_bb8.sort(typeof _bb9=="function"?_bb9:function(a,b){for(var sort,i=0;sort=_bb9[i];i++){var _bba=a[sort.attribute];var _bbb=b[sort.attribute];if(_bba!=_bbb){return !!sort.descending==(_bba==null||_bba>_bbb)?-1:1;}}return 0;});}if(_bb2&&(_bb2.start||_bb2.count)){var _bbc=_bb8.length;_bb8=_bb8.slice(_bb2.start||0,(_bb2.start||0)+(_bb2.count||Infinity));_bb8.total=_bbc;}return _bb8;};_bb6.matches=_bb1;return _bb6;};});},"esri/dijit/BasemapLayer":function(){define("esri/dijit/BasemapLayer",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_bbd,lang,has,_bbe){var BML=_bbd(null,{declaredClass:"esri.dijit.BasemapLayer",constructor:function(_bbf){_bbf=_bbf||{};if(!_bbf.url&&!_bbf.type){console.error("esri.dijit.BasemapLayer: unable to find the 'url' or 'type' property in parameters");}this.url=_bbf.url;this.type=_bbf.type;this.isReference=(_bbf.isReference===true)?true:false;this.displayLevels=_bbf.displayLevels;this.visibleLayers=_bbf.visibleLayers;this.bandIds=_bbf.bandIds;this.opacity=_bbf.opacity;}});if(has("extend-esri")){lang.setObject("dijit.BasemapLayer",BML,_bbe);}return BML;});},"dojox/grid/_View":function(){require({cache:{"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n"}});define("dojox/grid/_View",["dojo","dijit/registry","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/sniff","dojo/query","dojo/_base/window","dojo/text!./resources/View.html","dojo/dnd/Source","dijit/_Widget","dijit/_TemplatedMixin","dojox/html/metrics","./util","dojo/_base/html","./_Builder","dojo/dnd/Avatar","dojo/dnd/Manager"],function(dojo,_bc0,_bc1,_bc2,_bc3,lang,_bc4,has,_bc5,win,_bc6,_bc7,_bc8,_bc9,_bca,util,html,_bcb,_bcc,_bcd){var _bce=function(_bcf,_bd0){return _bcf.style.cssText==undefined?_bcf.getAttribute("style"):_bcf.style.cssText;};var _bd1=_bc2("dojox.grid._View",[_bc8,_bc9],{defaultWidth:"18em",viewWidth:"",templateString:_bc6,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:_bcb._HeaderBuilder,_contentBuilderClass:_bcb._ContentBuilder,postMixInProperties:function(){this.rowNodes={};},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");util.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);util.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);if(!this.grid.isLeftToRight()){this.headerNodeContainer.style.width="";}},destroy:function(){html.destroy(this.headerNode);delete this.headerNode;for(var i in this.rowNodes){this._cleanupRowWidgets(this.rowNodes[i]);html.destroy(this.rowNodes[i]);}this.rowNodes={};if(this.source){this.source.destroy();}this.inherited(arguments);},focus:function(){if(has("ie")||has("webkit")||has("opera")){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_bd2){var vs=(this.structure=_bd2);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||(vs.noscroll?"auto":this.viewWidth);}this._onBeforeRow=vs.onBeforeRow||function(){};this._onAfterRow=vs.onAfterRow||function(){};this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.simpleStructure=Boolean(vs.cells.length==1);this.testFlexCells();this.updateStructure();},_cleanupRowWidgets:function(_bd3){if(_bd3){_bc3.forEach(_bc5("[widgetId]",_bd3).map(_bc0.byNode),function(w){if(w._destroyOnRemove){w.destroy();delete w;}else{if(w.domNode&&w.domNode.parentNode){w.domNode.parentNode.removeChild(w.domNode);}}});}},onBeforeRow:function(_bd4,_bd5){this._onBeforeRow(_bd4,_bd5);if(_bd4>=0){this._cleanupRowWidgets(this.getRowNode(_bd4));}},onAfterRow:function(_bd6,_bd7,_bd8){this._onAfterRow(_bd6,_bd7,_bd8);var g=this.grid;_bc3.forEach(_bc5(".dojoxGridStubNode",_bd8),function(n){if(n&&n.parentNode){var lw=n.getAttribute("linkWidget");var _bd9=window.parseInt(html.attr(n,"cellIdx"),10);var _bda=g.getCell(_bd9);var w=_bc0.byId(lw);if(w){n.parentNode.replaceChild(w.domNode,n);if(!w._started){w.startup();}dojo.destroy(n);}else{n.innerHTML="";}}},this);},testFlexCells:function(){this.flexCells=false;for(var j=0,row;(row=this.structure.cells[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.view=this;this.flexCells=this.flexCells||cell.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){var _bdb=this.hasVScrollbar();var _bdc=html.style(this.scrollboxNode,"overflow");if(this.noscroll||!_bdc||_bdc=="hidden"){_bdb=false;}else{if(_bdc=="scroll"){_bdb=true;}}return (_bdb?_bca.getScrollbar().w:0);},getColumnsWidth:function(){var h=this.headerContentNode;return h&&h.firstChild?(h.firstChild.offsetWidth||html.style(h.firstChild,"width")):0;},setColumnsWidth:function(_bdd){this.headerContentNode.firstChild.style.width=_bdd+"px";if(this.viewWidth){this.viewWidth=_bdd+"px";}},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,html._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();if(this._togglingColumn>=0){this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn);this._togglingColumn=-1;}var _bde=this.grid.layout.cells;var _bdf=lang.hitch(this,function(node,_be0){!this.grid.isLeftToRight()&&(_be0=!_be0);var inc=_be0?-1:1;var idx=this.header.getCellNodeIndex(node)+inc;var cell=_bde[idx];while(cell&&cell.getHeaderNode()&&cell.getHeaderNode().style.display=="none"){idx+=inc;cell=_bde[idx];}if(cell){return cell.getHeaderNode();}return null;});if(this.grid.columnReordering&&this.simpleStructure){if(this.source){this.source.destroy();}var _be1="dojoxGrid_bottomMarker";var _be2="dojoxGrid_topMarker";if(this.bottomMarker){html.destroy(this.bottomMarker);}this.bottomMarker=html.byId(_be1);if(this.topMarker){html.destroy(this.topMarker);}this.topMarker=html.byId(_be2);if(!this.bottomMarker){this.bottomMarker=html.create("div",{"id":_be1,"class":"dojoxGridColPlaceBottom"},win.body());this._hide(this.bottomMarker);this.topMarker=html.create("div",{"id":_be2,"class":"dojoxGridColPlaceTop"},win.body());this._hide(this.topMarker);}this.arrowDim=html.contentBox(this.bottomMarker);var _be3=html.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new _bc7(this.headerContentNode.firstChild.rows[0],{horizontal:true,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:false,onMouseDown:lang.hitch(this,function(e){this.header.decorateEvent(e);if((this.header.overRightResizeArea(e)||this.header.overLeftResizeArea(e))&&this.header.canResize(e)&&!this.header.moveable){this.header.beginColumnResize(e);}else{if(this.grid.headerMenu){this.grid.headerMenu.onCancel(true);}if(e.button===(has("ie")<9?1:0)){_bc7.prototype.onMouseDown.call(this.source,e);}}}),onMouseOver:lang.hitch(this,function(e){var src=this.source;if(src._getChildByEvent(e)){_bc7.prototype.onMouseOver.apply(src,arguments);}}),_markTargetAnchor:lang.hitch(this,function(_be4){var src=this.source;if(src.current==src.targetAnchor&&src.before==_be4){return;}if(src.targetAnchor&&_bdf(src.targetAnchor,src.before)){src._removeItemClass(_bdf(src.targetAnchor,src.before),src.before?"After":"Before");}_bc7.prototype._markTargetAnchor.call(src,_be4);var _be5=_be4?src.targetAnchor:_bdf(src.targetAnchor,src.before);var _be6=0;if(!_be5){_be5=src.targetAnchor;_be6=html.contentBox(_be5).w+this.arrowDim.w/2+2;}var pos=html.position(_be5,true);var left=Math.floor(pos.x-this.arrowDim.w/2+_be6);html.style(this.bottomMarker,"visibility","visible");html.style(this.topMarker,"visibility","visible");html.style(this.bottomMarker,{"left":left+"px","top":(_be3+pos.y)+"px"});html.style(this.topMarker,{"left":left+"px","top":(pos.y-this.arrowDim.h)+"px"});if(src.targetAnchor&&_bdf(src.targetAnchor,src.before)){src._addItemClass(_bdf(src.targetAnchor,src.before),src.before?"After":"Before");}}),_unmarkTargetAnchor:lang.hitch(this,function(){var src=this.source;if(!src.targetAnchor){return;}if(src.targetAnchor&&_bdf(src.targetAnchor,src.before)){src._removeItemClass(_bdf(src.targetAnchor,src.before),src.before?"After":"Before");}this._hide(this.bottomMarker);this._hide(this.topMarker);_bc7.prototype._unmarkTargetAnchor.call(src);}),destroy:lang.hitch(this,function(){_bc4.disconnect(this._source_conn);_bc4.unsubscribe(this._source_sub);_bc7.prototype.destroy.call(this.source);if(this.bottomMarker){html.destroy(this.bottomMarker);delete this.bottomMarker;}if(this.topMarker){html.destroy(this.topMarker);delete this.topMarker;}}),onDndCancel:lang.hitch(this,function(){_bc7.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker);})});this._source_conn=_bc4.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=_bc4.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup();}},_hide:function(node){html.style(node,{top:"-10000px","visibility":"hidden"});},_onDndDropBefore:function(_be7,_be8,copy){if(_bcd.manager().target!==this.source){return;}this.source._targetNode=this.source.targetAnchor;this.source._beforeTarget=this.source.before;var _be9=this.grid.views.views;var _bea=_be9[_be7.viewIndex];var _beb=_be9[this.index];if(_beb!=_bea){_bea.convertColPctToFixed();_beb.convertColPctToFixed();}},_onDndDrop:function(_bec,_bed,copy){if(_bcd.manager().target!==this.source){if(_bcd.manager().source===this.source){this._removingColumn=true;}return;}this._hide(this.bottomMarker);this._hide(this.topMarker);var _bee=function(n){return n?html.attr(n,"idx"):null;};var w=html.marginBox(_bed[0]).w;if(_bec.viewIndex!==this.index){var _bef=this.grid.views.views;var _bf0=_bef[_bec.viewIndex];var _bf1=_bef[this.index];if(_bf0.viewWidth&&_bf0.viewWidth!="auto"){_bf0.setColumnsWidth(_bf0.getColumnsWidth()-w);}if(_bf1.viewWidth&&_bf1.viewWidth!="auto"){_bf1.setColumnsWidth(_bf1.getColumnsWidth());}}var stn=this.source._targetNode;var stb=this.source._beforeTarget;!this.grid.isLeftToRight()&&(stb=!stb);var _bf2=this.grid.layout;var idx=this.index;delete this.source._targetNode;delete this.source._beforeTarget;_bf2.moveColumn(_bec.viewIndex,idx,_bee(_bed[0]),_bee(stn),stb);},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}util.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode]);},_getHeaderContent:function(_bf3){var n=_bf3.name||_bf3.grid.getCellName(_bf3);if(/^\s+$/.test(n)){n="&nbsp;";}var ret=["<div class=\"dojoxGridSortNode"];if(_bf3.index!=_bf3.grid.getSortIndex()){ret.push("\">");}else{ret=ret.concat([" ",_bf3.grid.sortInfo>0?"dojoxGridSortUp":"dojoxGridSortDown","\"><div class=\"dojoxGridArrowButtonChar\">",_bf3.grid.sortInfo>0?"&#9650;":"&#9660;","</div><div class=\"dojoxGridArrowButtonNode\" role=\"presentation\"></div>","<div class=\"dojoxGridColCaption\">"]);}ret=ret.concat([n,"</div></div>"]);return ret.join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasHScrollbar:function(_bf4){var _bf5=this._hasHScroll||false;if(this._hasHScroll==undefined||_bf4){if(this.noscroll){this._hasHScroll=false;}else{var _bf6=html.style(this.scrollboxNode,"overflow");if(_bf6=="hidden"){this._hasHScroll=false;}else{if(_bf6=="scroll"){this._hasHScroll=true;}else{this._hasHScroll=(this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);}}}}if(_bf5!==this._hasHScroll){this.grid.update();}return this._hasHScroll;},hasVScrollbar:function(_bf7){var _bf8=this._hasVScroll||false;if(this._hasVScroll==undefined||_bf7){if(this.noscroll){this._hasVScroll=false;}else{var _bf9=html.style(this.scrollboxNode,"overflow");if(_bf9=="hidden"){this._hasVScroll=false;}else{if(_bf9=="scroll"){this._hasVScroll=true;}else{this._hasVScroll=(this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);}}}}if(_bf8!==this._hasVScroll){this.grid.update();}return this._hasVScroll;},convertColPctToFixed:function(){var _bfa=false;this.grid.initialWidth="";var _bfb=_bc5("th",this.headerContentNode);var _bfc=_bc3.map(_bfb,function(c,vIdx){var w=c.style.width;html.attr(c,"vIdx",vIdx);if(w&&w.slice(-1)=="%"){_bfa=true;}else{if(w&&w.slice(-2)=="px"){return window.parseInt(w,10);}}return html.contentBox(c).w;});if(_bfa){_bc3.forEach(this.grid.layout.cells,function(cell,idx){if(cell.view==this){var _bfd=cell.view.getHeaderCellNode(cell.index);if(_bfd&&html.hasAttr(_bfd,"vIdx")){var vIdx=window.parseInt(html.attr(_bfd,"vIdx"));this.setColWidth(idx,_bfc[vIdx]);html.removeAttr(_bfd,"vIdx");}}},this);return true;}return false;},adaptHeight:function(_bfe){if(!this.grid._autoHeight){var h=(this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10))||this.domNode.clientHeight;var self=this;var _bff=function(){var v;for(var i in self.grid.views.views){v=self.grid.views.views[i];if(v!==self&&v.hasHScrollbar()){return true;}}return false;};if(_bfe||(this.noscroll&&_bff())){h-=_bca.getScrollbar().h;}util.setStyleHeightPx(this.scrollboxNode,h);}this.hasVScrollbar(true);},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();if(!this._removingColumn){w=Math.max(w,this.getColumnsWidth())+"px";}else{w=Math.min(w,this.getColumnsWidth())+"px";this._removingColumn=false;}var cn=this.contentNode;cn.style.width=w;this.hasHScrollbar(true);},setSize:function(w,h){var ds=this.domNode.style;var hs=this.headerNode.style;if(w){ds.width=w;hs.width=w;}ds.height=(h>=0?h+"px":"");},renderRow:function(_c00){var _c01=this.createRowNode(_c00);this.buildRow(_c00,_c01);return _c01;},createRowNode:function(_c02){var node=document.createElement("div");node.className=this.classTag+"Row";if(this instanceof _bc1.grid._RowSelector){html.attr(node,"role","presentation");}else{html.attr(node,"role","row");if(this.grid.selectionMode!="none"){node.setAttribute("aria-selected","false");}}node[util.gridViewTag]=this.id;node[util.rowIndexTag]=_c02;this.rowNodes[_c02]=node;return node;},buildRow:function(_c03,_c04){this.buildRowContent(_c03,_c04);this.styleRow(_c03,_c04);},buildRowContent:function(_c05,_c06){_c06.innerHTML=this.content.generateHtml(_c05,_c05);if(this.flexCells&&this.contentWidth){_c06.firstChild.style.width=this.contentWidth;}util.fire(this,"onAfterRow",[_c05,this.structure.cells,_c06]);},rowRemoved:function(_c07){if(_c07>=0){this._cleanupRowWidgets(this.getRowNode(_c07));}this.grid.edit.save(this,_c07);delete this.rowNodes[_c07];},getRowNode:function(_c08){return this.rowNodes[_c08];},getCellNode:function(_c09,_c0a){var row=this.getRowNode(_c09);if(row){return this.content.getCellNode(row,_c0a);}},getHeaderCellNode:function(_c0b){if(this.headerContentNode){return this.header.getCellNode(this.headerContentNode,_c0b);}},styleRow:function(_c0c,_c0d){_c0d._style=_bce(_c0d);this.styleRowNode(_c0c,_c0d);},styleRowNode:function(_c0e,_c0f){if(_c0f){this.doStyleRowNode(_c0e,_c0f);}},doStyleRowNode:function(_c10,_c11){this.grid.styleRowNode(_c10,_c11);},updateRow:function(_c12){var _c13=this.getRowNode(_c12);if(_c13){_c13.style.height="";this.buildRow(_c12,_c13);}return _c13;},updateRowStyles:function(_c14){this.styleRowNode(_c14,this.getRowNode(_c14));},lastTop:0,firstScroll:0,_nativeScroll:false,doscroll:function(_c15){if(has("ff")>=13){this._nativeScroll=true;}var _c16=this.grid.isLeftToRight();if(this.firstScroll<2){if((!_c16&&this.firstScroll==1)||(_c16&&this.firstScroll===0)){var s=html.marginBox(this.headerNodeContainer);if(has("ie")){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(has("mozilla")){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";this.scrollboxNode.scrollLeft=_c16?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!==this.lastTop){this.grid.scrollTo(top);}this._nativeScroll=false;},setScrollTop:function(_c17){this.lastTop=_c17;if(!this._nativeScroll){this.scrollboxNode.scrollTop=_c17;}return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_c18,_c19){this.grid.setCellWidth(_c18,_c19+"px");},update:function(){if(!this.domNode){return;}this.content.update();this.grid.update();var left=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=left;this.headerNode.scrollLeft=left;}});var _c1a=_bc2("dojox.grid._GridAvatar",_bcc,{construct:function(){var dd=win.doc;var a=dd.createElement("table");a.cellPadding=a.cellSpacing="0";a.className="dojoxGridDndAvatar";a.style.position="absolute";a.style.zIndex=1999;a.style.margin="0px";var b=dd.createElement("tbody");var tr=dd.createElement("tr");var td=dd.createElement("td");var img=dd.createElement("td");tr.className="dojoxGridDndAvatarItem";img.className="dojoxGridDndAvatarItemImage";img.style.width="16px";var _c1b=this.manager.source,node;if(_c1b.creator){node=_c1b._normalizedCreator(_c1b.getItem(this.manager.nodes[0].id).data,"avatar").node;}else{node=this.manager.nodes[0].cloneNode(true);var _c1c,_c1d;if(node.tagName.toLowerCase()=="tr"){_c1c=dd.createElement("table");_c1d=dd.createElement("tbody");_c1d.appendChild(node);_c1c.appendChild(_c1d);node=_c1c;}else{if(node.tagName.toLowerCase()=="th"){_c1c=dd.createElement("table");_c1d=dd.createElement("tbody");var r=dd.createElement("tr");_c1c.cellPadding=_c1c.cellSpacing="0";r.appendChild(node);_c1d.appendChild(r);_c1c.appendChild(_c1d);node=_c1c;}}}node.id="";td.appendChild(node);tr.appendChild(img);tr.appendChild(td);html.style(tr,"opacity",0.9);b.appendChild(tr);a.appendChild(b);this.node=a;var m=_bcd.manager();this.oldOffsetY=m.OFFSET_Y;m.OFFSET_Y=1;},destroy:function(){_bcd.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments);}});var _c1e=_bcd.manager().makeAvatar;_bcd.manager().makeAvatar=function(){var src=this.source;if(src.viewIndex!==undefined&&!html.hasClass(win.body(),"dijit_a11y")){return new _c1a(this);}return _c1e.call(_bcd.manager());};return _bd1;});},"dijit/MenuItem":function(){require({cache:{"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"}});define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/sniff","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_c1f,dom,_c20,_c21,_c22,has,_c23,_c24,_c25,_c26,_c27){return _c1f("dijit.MenuItem",[_c23,_c24,_c25,_c26],{templateString:_c27,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(val){this.containerNode.innerHTML=val;this._set("label",val);if(this.textDir==="auto"){this.applyTextDir(this.focusNode,this.label);}},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_c28){if(_c28&&!("label" in this.params)){this.set("label",_c28.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _c29=this.id+"_text";_c20.set(this.containerNode,"id",_c29);if(this.accelKeyNode){_c20.set(this.accelKeyNode,"id",this.id+"_accel");_c29+=" "+this.id+"_accel";}this.domNode.setAttribute("aria-labelledby",_c29);dom.setSelectable(this.domNode,false);},onClick:function(){},focus:function(){try{if(has("ie")==8){this.containerNode.focus();}this.focusNode.focus();}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_c2a){_c21.toggle(this.domNode,"dijitMenuItemSelected",_c2a);},setLabel:function(_c2b){_c22.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_c2b);},setDisabled:function(_c2c){_c22.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_c2c);},_setDisabledAttr:function(_c2d){this.focusNode.setAttribute("aria-disabled",_c2d?"true":"false");this._set("disabled",_c2d);},_setAccelKeyAttr:function(_c2e){this.accelKeyNode.style.display=_c2e?"":"none";this.accelKeyNode.innerHTML=_c2e;_c20.set(this.containerNode,"colSpan",_c2e?"1":"2");this._set("accelKey",_c2e);},_setTextDirAttr:function(_c2f){if(!this._created||this.textDir!=_c2f){this._set("textDir",_c2f);this.applyTextDir(this.focusNode,this.label);}}});});},"esri/dijit/Measurement":function(){require({cache:{"url:esri/dijit/templates/Measurement.html":"<div class=\"esriMeasurement\">\r\n  <div dojoType='dijit.form.ToggleButton' baseClass='esriButton' dojoAttachPoint='area' checked='false' iconClass='areaIcon' showLabel='false' dojoAttachEvent='onClick:areaToggleButton'></div>\r\n  <div dojoType='dijit.form.ToggleButton' baseClass='esriButton' dojoAttachPoint='distance' iconClass='distanceIcon' showLabel='false' dojoAttachEvent='onClick:distanceToggleButton'></div>\r\n  <div dojoType='dijit.form.ToggleButton' baseClass='esriButton' dojoAttachPoint='location' iconClass='locationIcon' showLabel='false' dojoAttachEvent='onClick:locationToggleButton'></div>\r\n  <div style=\"display:inline;margin-left:2px;margin-right:2px;padding-top:2px;\">|</div>\r\n  <button dojoType='dijit.form.DropDownButton' baseClass='esriToggleButton' dojoAttachPoint='unit' label='unit' value='unit' style='visibility:hidden;'></button>\r\n  <div dojoType='dijit.layout.ContentPane' dojoAttachPoint='resultLabel' class='resultLabel'></div>\r\n  <div dojoType='dijit.layout.ContentPane' dojoAttachPoint='resultValue' align='left' class='result'></div>\r\n</div>"}});define("esri/dijit/Measurement",["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/Color","dojo/has","dojo/number","dojo/dom-style","dijit/_Widget","dijit/_Templated","dijit/registry","dijit/Menu","dijit/MenuItem","esri/SpatialReference","esri/symbols/PictureMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/geometry/geodesicUtils","esri/geometry/webMercatorUtils","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon","esri/graphic","esri/tasks/AreasAndLengthsParameters","esri/tasks/LengthsParameters","esri/tasks/GeometryService","esri/kernel","esri/config","esri/domUtils","esri/lang","esri/units","esri/WKIDUnitConversion","esri/dijit/_EventedWidget","dojo/text!esri/dijit/templates/Measurement.html","dojo/i18n!esri/nls/jsapi","dijit/form/ToggleButton","dijit/form/DropDownButton","dijit/layout/ContentPane"],function(_c30,_c31,lang,_c32,_c33,_c34,has,_c35,_c36,_c37,_c38,_c39,Menu,_c3a,_c3b,_c3c,_c3d,_c3e,_c3f,_c40,_c41,_c42,_c43,_c44,_c45,_c46,_c47,_c48,_c49,_c4a,_c4b,_c4c,_c4d,_c4e,_c4f){var _c50=_c31([_c4d,_c37,_c38],{declaredClass:"esri.dijit.Measurement",widgetsInTemplate:true,templateString:_c4e,unitDictionary:[],result:null,inputPoints:[],measureGraphics:[],numberPattern:"#,###,###,##0.0",_eventMap:{"measure-end":["toolName","geometry"]},constructor:function(_c51,_c52){_c51=_c51||{};if(!_c51.map){console.log("dijit.MeasureTool: unable to find the 'map' property in parameters");return;}this._map=_c51.map;if(this._map.loaded){this._map.cs=this._checkCS(this._map.spatialReference);}else{var _c53=_c33.connect(this._map,"onLoad",this,function(){_c33.disconnect(_c53);_c53=null;this._map.cs=this._checkCS(this._map.spatialReference);});}this._geometryService=_c48.defaults.geometryService;if(_c51.pointSymbol){this._pointSymbol=_c51.pointSymbol;}else{var url=_c30.toUrl("esri/dijit/images/flag.png");this._pointSymbol=new _c3c(url,24,24);this._pointSymbol.setOffset(9,11);}if(_c51.lineSymbol){this._lineSymbol=_c51.lineSymbol;}else{this._lineSymbol=new _c3d(_c3d.STYLE_SOLID,new _c34([0,128,255]),3);}if(_c51.defaultLengthUnit){this._defaultLengthUnit=_c51.defaultLengthUnit;}else{this._defaultLengthUnit=_c4b.MILES;}if(_c51.defaultAreaUnit){this._defaultAreaUnit=_c51.defaultAreaUnit;}else{this._defaultAreaUnit=_c4b.ACRES;}if(_c51.defaultLocationUnit){this._defaultLocationUnit=_c51.defaultLocationUnit;}else{this._defaultLocationUnit=_c4b.DECIMAL_DEGREES;}this._snappingCallback=lang.hitch(this,this._snappingCallback);},startup:function(){var _c54=_c4f.widgets.measurement;this.unitDictionary[_c54.NLS_length_miles]=1;this.unitDictionary[_c54.NLS_length_kilometers]=1.609344;this.unitDictionary[_c54.NLS_length_feet]=5280;this.unitDictionary[_c54.NLS_length_meters]=1609.34;this.unitDictionary[_c54.NLS_length_yards]=1760;this.unitDictionary["Nautical Miles"]=0.869;this.unitDictionary[_c54.NLS_area_acres]=1;this.unitDictionary[_c54.NLS_area_sq_kilometers]=0.004047;this.unitDictionary[_c54.NLS_area_sq_miles]=0.0015625;this.unitDictionary[_c54.NLS_area_sq_feet]=43560;this.unitDictionary[_c54.NLS_area_sq_meters]=4046.87;this.unitDictionary[_c54.NLS_area_hectares]=0.4047;this.unitDictionary[_c54.NLS_area_sq_yards]=4840;this.units={"esriMiles":_c54.NLS_length_miles,"esriKilometers":_c54.NLS_length_kilometers,"esriFeet":_c54.NLS_length_feet,"esriMeters":_c54.NLS_length_meters,"esriYards":_c54.NLS_length_yards,"esriAcres":_c54.NLS_area_acres,"esriSquareKilometers":_c54.NLS_area_sq_kilometers,"esriSquareMiles":_c54.NLS_area_sq_miles,"esriSquareFeet":_c54.NLS_area_sq_feet,"esriSquareMeters":_c54.NLS_area_sq_meters,"esriHectares":_c54.NLS_area_hectares,"esriSquareYards":_c54.NLS_area_sq_yards,"esriDecimalDegrees":_c54.NLS_decimal_degrees,"esriDegreeMinuteSeconds":_c54.NLS_deg_min_sec};_c39.byNode(this.distance.domNode).setLabel(_c4f.widgets.measurement.NLS_distance);_c39.byNode(this.area.domNode).setLabel(_c4f.widgets.measurement.NLS_area);_c39.byNode(this.location.domNode).setLabel(_c4f.widgets.measurement.NLS_location);_c39.byNode(this.resultLabel.domNode).setContent(_c4f.widgets.measurement.NLS_resultLabel);},measureArea:function(){this._map.navigationManager.setImmediateClick(true);this._createAreaUnitList();this.inputPoints=[];this.tempGraphic=new _c43();this.tempGraphic.setSymbol(this._lineSymbol);this.tempGraphic.setGeometry(new _c41(this._map.spatialReference));this._map.graphics.add(this.tempGraphic);if(this._map.cs==="PCS"){this._geometryAreaHandler=_c33.connect(this._geometryService,"onAreasAndLengthsComplete",this,"_outputArea");}this.mouseClickMapHandler=_c33.connect(this._map,"onClick",this,"_measureAreaMouseClickHandler");this.doubleClickMapHandler=_c33.connect(this._map,"onDblClick",this,"_measureAreaDblClickHandler");},measureDistance:function(){this._map.navigationManager.setImmediateClick(true);if(this._map.cs==="PCS"){this._projectMapExtent(this._map.extent);this._mapExtentChangeHandler=_c33.connect(this._map,"onExtentChange",this,"_projectMapExtent");}this.inputPoints=[];this._createLengthUnitList();this.mouseClickMapHandler=_c33.connect(this._map,"onClick",this,"_measureDistanceMouseClickHandler");this.doubleClickMapHandler=_c33.connect(this._map,"onDblClick",this,"_measureDistanceDblClickHandler");},measureLocation:function(){this._map.navigationManager.setImmediateClick(true);this.measureGraphics=[];this._createLocationUnitList();this._map.graphics.remove(this.locationGraphic);if(this._map.cs==="PCS"){this._projectMapExtent(this._map.extent);this._mapExtentChangeHandler=_c33.connect(this._map,"onExtentChange",lang.hitch(this,this._projectMapExtent));}this._clickMapHandler=_c33.connect(this._map,"onClick",this,"_measureLocationClickHandler");this.mouseMoveMapHandler=_c33.connect(this._map,"onMouseMove",this,"_showCoordinates");this.mouseDragMapHandler=_c33.connect(this._map,"onMouseDrag",lang.hitch(this,function(){_c39.byNode(this.resultValue.domNode).setAttribute("disabled",true);}));},setTool:function(_c55,_c56){this.closeTool();var _c57=_c39.byNode(this[_c55].domNode).checked;_c36.set(this.unit.domNode,"visibility","visible");_c39.byNode(this.area.domNode).setAttribute("checked",false);_c39.byNode(this.distance.domNode).setAttribute("checked",false);_c39.byNode(this.location.domNode).setAttribute("checked",false);if(_c56===true||_c56===false){_c57=_c56;}_c39.byNode(this[_c55].domNode).setAttribute("checked",_c57);if(_c57){this.activeTool=_c55;if(this.map.isDoubleClickZoom){this._map.disableDoubleClickZoom();}if(_c55==="area"){this.measureArea();}else{if(_c55==="distance"){this.measureDistance();}else{if(_c55==="location"){this.measureLocation();}}}if(this._map.snappingManager){this._map.snappingManager._startSelectionLayerQuery();this._map.snappingManager._setUpSnapping();}}},areaToggleButton:function(){this.clearResult();this.setTool("area");},distanceToggleButton:function(){this.clearResult();this.setTool("distance");},locationToggleButton:function(){this.clearResult();this.setTool("location");},closeTool:function(){var map=this._map;map.navigationManager.setImmediateClick(false);if(!map.isDoubleClickZoom){map.enableDoubleClickZoom();}this.inputPoints=[];if(map.snappingManager&&map.snappingManager._snappingGraphic){map.graphics.remove(map.snappingManager._snappingGraphic);}_c33.disconnect(this.mouseClickMapHandler);_c33.disconnect(this.mouseMoveMapHandler);_c33.disconnect(this.doubleClickMapHandler);_c33.disconnect(this.mouseDragMapHandler);_c33.disconnect(this._clickMapHandler);_c33.disconnect(this._mapExtentChangeHandler);_c33.disconnect(this._geometryAreaHandler);this.mouseClickMapHandler=this.mouseMoveMapHandler=this.doubleClickMapHandler=this.mouseDragMapHandler=this._clickMapHandler=this._mapExtentChangeHandler=this._geometryAreaHandler=null;if(this._map.snappingManager){this._map.snappingManager._stopSelectionLayerQuery();this._map.snappingManager._killOffSnapping();}},clearResult:function(){var map=this._map;this.result=0;_c39.byNode(this.resultValue.domNode).setAttribute("content","");var i;for(i=0;i<this.measureGraphics.length;i++){map.graphics.remove(this.measureGraphics[i]);}this.measureGraphics=[];map.graphics.remove(this.tempGraphic);},show:function(){_c49.show(this.domNode);},hide:function(){_c49.hide(this.domNode);},showTool:function(_c58){var tool=this[_c58].domNode;tool.style.display="inline";},hideTool:function(_c59){var tool=this[_c59].domNode;tool.style.display="none";},destroy:function(){this.closeTool();this.clearResult();this.inherited(arguments);this._map=this._geometryService=this.measureGraphic=this.measureGraphic=this.tempGraphic=null;},onMeasureEnd:function(){},_densifyGeometry:function(geom){if(this._map.cs==="Web Mercator"){geom=_c3f.webMercatorToGeographic(geom);}var _c5a;if(this._map.cs==="PCS"){_c5a=geom;}else{_c5a=_c3e.geodesicDensify(geom,500000);}if(this._map.cs==="Web Mercator"){_c5a=_c3f.geographicToWebMercator(_c5a);}return _c5a;},_measureAreaMouseClickHandler:function(evt){var _c5b;if(this._map.snappingManager){_c5b=this._map.snappingManager._snappingPoint;}var _c5c=_c5b||evt.mapPoint;this.inputPoints.push(_c5c);this._currentStartPt=_c5c;if(this.inputPoints.length===1){this.tempGraphic.setGeometry(new _c41(this._map.spatialReference));var i;for(i=0;i<this.measureGraphics.length;i++){this._map.graphics.remove(this.measureGraphics[i]);}this.measureGraphics=[];this.result=0;this._outputResult(this.result,_c4f.widgets.measurement.NLS_area_acres);this.mouseMoveMapHandler=_c33.connect(this._map,"onMouseMove",this,"_measureAreaMouseMoveHandler");}this.measureGraphic=new _c43();this.measureGraphic.setSymbol(this._lineSymbol);this.measureGraphics.push(this.measureGraphic);if(this.inputPoints.length>1){var line=new _c41(this._map.spatialReference);line.addPath([this.inputPoints[this.inputPoints.length-2],_c5c]);var _c5d=new _c41(this._map.spatialReference);_c5d.addPath([this.inputPoints[0],_c5c]);var _c5e=this._densifyGeometry(line);var _c5f=this._densifyGeometry(_c5d);this.tempGraphic.setGeometry(_c5f);this.measureGraphic.setGeometry(_c5e);this._map.graphics.add(this.measureGraphic);}},_measureAreaMouseMoveHandler:function(evt){var _c60;if(this.inputPoints.length>0){var line=new _c41(this._map.spatialReference);var _c61;if(this._map.snappingManager){_c61=this._map.snappingManager._snappingPoint;}_c60=_c61||evt.mapPoint;line.addPath([this._currentStartPt,_c60]);var _c62=this._densifyGeometry(line);this.tempGraphic.setGeometry(_c62);}if(this.inputPoints.length>1){var _c63=new _c41(this._map.spatialReference);_c63.addPath([_c60,this.inputPoints[0]]);var _c64=this._densifyGeometry(_c63);this.tempGraphic.setGeometry(this.tempGraphic.geometry.addPath(_c64.paths[0]));}},_measureAreaDblClickHandler:function(evt){_c33.disconnect(this.mouseMoveMapHandler);this.mouseMoveMapHandler=null;var _c65=new _c42(this._map.spatialReference);var ring=[];var i;for(i=0;i<this.inputPoints.length;i++){ring.push([this.inputPoints[i].x,this.inputPoints[i].y]);}ring.push([this.inputPoints[0].x,this.inputPoints[0].y]);_c65.addRing(ring);this.inputPoints=[];this.measurementGeometry=this._densifyGeometry(_c65);this._getArea(_c65);},_getArea:function(_c66){var _c67=[];var _c68=new _c44();_c68.areaUnit=_c46.UNIT_ACRES;_c68.calculationType="geodesic";if(_c42.prototype.isSelfIntersecting(_c66)){this._geometryService.simplify([_c66],lang.hitch(this,function(_c69){_c32.forEach(_c69,lang.hitch(this,function(_c6a,idx){if(this._map.cs==="PCS"){_c68.polygons=_c69;this._geometryService.areasAndLengths(_c68);return;}else{if(this._map.cs==="Web Mercator"){_c6a=_c3f.webMercatorToGeographic(_c6a);}}_c67.push(_c6a);}));var _c6b=_c3e.geodesicAreas(_c67,_c4b.ACRES);this._showArea(_c6b[0]);}));}else{if(this._map.cs==="Web Mercator"){_c66=_c3f.webMercatorToGeographic(_c66);}_c67.push(_c66);if(this._map.cs==="PCS"){_c68.polygons=_c67;this._geometryService.areasAndLengths(_c68);return;}var _c6c=_c3e.geodesicAreas(_c67,_c4b.ACRES);this._showArea(Math.abs(_c6c[0]));}},_outputArea:function(_c6d){this._showArea(Math.abs(_c6d.areas[0]));},_showArea:function(area){if(area){this.result=area;var unit=_c39.byNode(this.unit.domNode).label;this._outputResult(this.result,unit);}this.onMeasureEnd(this.activeTool,this.measurementGeometry);},_measureDistanceDblClickHandler:function(evt){_c33.disconnect(this.mouseMoveMapHandler);this.mouseMoveMapHandler=null;var _c6e=new _c41(this._map.spatialReference);_c6e.addPath(this.inputPoints);_c6e=this._densifyGeometry(_c6e);if(this._map.cs==="PCS"){var _c6f=new _c45();_c6f.polylines=[_c6e];_c6f.lengthUnit=9093;_c6f.calculationType="geodesic";this._geometryService.lengths(_c6f,lang.hitch(this,function(_c70){this.result=_c70.lengths[0];this._showDistance(this.result);}));}this.inputPoints=[];this.onMeasureEnd(this.activeTool,_c6e);},_measureDistanceMouseClickHandler:function(evt){var _c71;if(this._map.snappingManager){_c71=this._map.snappingManager._snappingPoint;}var _c72=_c71||evt.mapPoint;this.inputPoints.push(_c72);this._currentStartPt=_c72;if(this.inputPoints.length===1){var i;for(i=0;i<this.measureGraphics.length;i++){this._map.graphics.remove(this.measureGraphics[i]);}this._map.graphics.remove(this.tempGraphic);this.measureGraphics=[];this.result=0;this._outputResult(this.result,_c4f.widgets.measurement.NLS_length_miles);this.tempGraphic=new _c43();this.tempGraphic.setSymbol(this._lineSymbol);this._map.graphics.add(this.tempGraphic);this.mouseMoveMapHandler=_c33.connect(this._map,"onMouseMove",this,"_measureDistanceMouseMoveHandler");}this.tempGraphic.setGeometry(new _c41(this._map.spatialReference));this.flagGraphic=new _c43();this.flagGraphic.setSymbol(this._pointSymbol);this.flagGraphic.setGeometry(_c72);this.measureGraphics.push(this.flagGraphic);this._map.graphics.add(this.flagGraphic);if(this.inputPoints.length>1){this.measureGraphic=new _c43();this.measureGraphic.setSymbol(this._lineSymbol);this.measureGraphics.push(this.measureGraphic);var line=new _c41(this._map.spatialReference);line.addPath([this.inputPoints[this.inputPoints.length-2],_c72]);var _c73=this._densifyGeometry(line);this.measureGraphic.setGeometry(_c73);this._map.graphics.add(this.measureGraphic);this.result+=this._geodesicDistance(this.inputPoints[this.inputPoints.length-2],_c72);this._showDistance(this.result);}},_measureDistanceMouseMoveHandler:function(evt){if(this.inputPoints.length>0){var line=new _c41(this._map.spatialReference);var _c74;if(this._map.snappingManager){_c74=this._map.snappingManager._snappingPoint;}var _c75=_c74||evt.mapPoint;line.addPath([this._currentStartPt,_c75]);var _c76=this._densifyGeometry(line);this.tempGraphic.setGeometry(_c76);var _c77=this._geodesicDistance(this._currentStartPt,_c75);this._showDistance(_c77+this.result);}},_geodesicDistance:function(pt1,pt2){var _c78=new _c41(this._map.spatialReference);if(this._map.cs==="PCS"){pt1=this._getGCSLocation(pt1);pt2=this._getGCSLocation(pt2);}_c78.addPath([pt1,pt2]);if(this._map.cs==="Web Mercator"){_c78=_c3f.webMercatorToGeographic(_c78);}return _c3e.geodesicLengths([_c78],_c4b.MILES)[0];},_showDistance:function(_c79){if(_c79){this._outputResult(_c79,_c39.byNode(this.unit.domNode).label);}},_measureLocationClickHandler:function(evt){_c39.byNode(this.location.domNode).setAttribute("checked",false);var _c7a;if(this._map.snappingManager){_c7a=this._map.snappingManager._snappingPoint;}var _c7b=_c7a||evt.mapPoint;this.locationToggleButton();this.locationGraphic=new _c43();this.locationGraphic.setGeometry(_c7b);this.locationGraphic.setSymbol(this._pointSymbol);this._map.graphics.add(this.locationGraphic);this.measureGraphics.push(this.locationGraphic);var _c7c={mapPoint:_c7b};if(this._map.cs==="PCS"){this._showCoordinates(_c7c,true);}else{this._showCoordinates(_c7c);}this.onMeasureEnd(this.activeTool,_c7b);},_getGCSLocation:function(pt){var _c7d=pt;if(this._map.cs==="Web Mercator"){_c7d=_c3f.webMercatorToGeographic(_c7d);}else{if(this._map.cs==="PCS"){if(this._map._newExtent){var _c7e=Math.abs((this._map._newExtent.xmax-this._map._newExtent.xmin)/(this._map.extent.xmax-this._map.extent.xmin));var _c7f=Math.abs((this._map._newExtent.ymax-this._map._newExtent.ymin)/(this._map.extent.ymax-this._map.extent.ymin));var newX=(_c7d.x-this._map.extent.xmin)*_c7e+this._map._newExtent.xmin;var newY=(_c7d.y-this._map.extent.ymin)*_c7f+this._map._newExtent.ymin;_c7d=new _c40(newX,newY,this._map.spatialReference);}}}return _c7d;},_projectMapExtent:function(_c80){var _c81=new _c43(_c80);var _c82=new _c3b({wkid:4326});this._geometryService.project([_c81.geometry],_c82,lang.hitch(this,function(_c83){if(!this.mouseMoveMapHandler&&this.activeTool==="location"){this.mouseMoveMapHandler=_c33.connect(this._map,"onMouseMove",lang.hitch(this,this._showCoordinates));this.mouseDragMapHandler=_c33.connect(this._map,"onMouseDrag",lang.hitch(this,function(){_c39.byNode(this.resultValue.domNode).setAttribute("disabled",true);}));}this._map._newExtent=_c83[0];}));},_showCoordinates:function(evt,_c84){var _c85;if(this._map.snappingManager){_c85=this._map.snappingManager._snappingPoint;}var _c86=_c85||evt.mapPoint;var _c87;if(!_c84){_c87=this._getGCSLocation(_c86);this.locationX=_c87.x;this.locationY=_c87.y;this._outputLocationResult(_c87.x,_c87.y,_c39.byNode(this.unit.domNode).label);}else{var _c88=new _c3b({wkid:4326});this._geometryService.project([_c86],_c88,lang.hitch(this,function(_c89){_c87=_c89[0];this.locationX=_c87.x;this.locationY=_c87.y;this._outputLocationResult(_c87.x,_c87.y,_c39.byNode(this.unit.domNode).label);}));}},_checkCS:function(_c8a){if(_c8a.wkid){if(_c8a.wkid===3857||_c8a.wkid===102100||_c8a.wkid===102113){return "Web Mercator";}if(_c4a.isDefined(_c4c[_c8a.wkid])){return "PCS";}return "GCS";}if(_c8a.wkt){if(_c8a.wkt.indexOf("WGS_1984_Web_Mercator")!==-1){return "Web Mercator";}if(_c8a.wkt.indexOf("PROJCS")===0){return "PCS";}return "GCS";}},_switchUnit:function(unit){_c39.byNode(this.unit.domNode).setAttribute("label",unit);if(this.result===null){return;}this._outputResult(this.result,unit);},_outputResult:function(_c8b,unit){var _c8c=_c8b*this.unitDictionary[unit];if(_c8c===0){_c39.byNode(this.resultValue.domNode).setAttribute("content","");}else{if(_c8c>1000000){_c39.byNode(this.resultValue.domNode).setAttribute("content",_c35.format(_c8c.toPrecision(9),{pattern:this.numberPattern})+" "+unit);}else{_c39.byNode(this.resultValue.domNode).setAttribute("content",_c35.format(_c8c.toFixed(2),{pattern:this.numberPattern})+" "+unit);}}},_switchLocationUnit:function(unit){_c39.byNode(this.unit.domNode).setAttribute("label",unit);if(this.result===null||this.resultValue.domNode.innerHTML===""){return;}this._outputLocationResult(this.locationX,this.locationY,unit);},_outputLocationResult:function(x,y,unit){var lon,lat;var _c8d=_c4f.widgets.measurement;if(unit===_c8d.NLS_decimal_degrees){lon=x.toFixed(6);lat=y.toFixed(6);}else{if(unit===_c8d.NLS_deg_min_sec){var _c8e=false;var _c8f=false;if(x<0){_c8e=true;x=Math.abs(x);}if(y<0){_c8f=true;y=Math.abs(y);}lon=Math.floor(x)+""+Math.floor((x-Math.floor(x))*60)+"'"+Math.floor(((x-Math.floor(x))*60-Math.floor((x-Math.floor(x))*60))*60)+"\"";lat=Math.floor(y)+""+Math.floor((y-Math.floor(y))*60)+"'"+Math.floor(((y-Math.floor(y))*60-Math.floor((y-Math.floor(y))*60))*60)+"\"";if(_c8e){lon="-"+lon;}if(_c8f){lat="-"+lat;}}}_c39.byNode(this.resultValue.domNode).setAttribute("content",_c4f.widgets.measurement.NLS_longitude+": "+lon+"<br/>"+_c4f.widgets.measurement.NLS_latitude+": "+lat);},_createLengthUnitList:function(){var menu=new Menu({style:"display: none;"});var _c90=_c4f.widgets.measurement;var _c91=[_c90.NLS_length_miles,_c90.NLS_length_kilometers,_c90.NLS_length_feet,_c90.NLS_length_meters,_c90.NLS_length_yards];_c32.forEach(_c91,lang.hitch(this,function(_c92,idx){var _c93=new _c3a({label:_c92,onClick:lang.hitch(this,function(){this._switchUnit(_c92);})});_c93.setAttribute("class","unitDropDown");menu.addChild(_c93);}));_c39.byNode(this.unit.domNode).setAttribute("dropDown",menu);var _c94=this.units[this._defaultLengthUnit];_c39.byNode(this.unit.domNode).setAttribute("label",_c94);},_createAreaUnitList:function(){var menu=new Menu({style:"display: none;"});var _c95=_c4f.widgets.measurement;var _c96=[_c95.NLS_area_acres,_c95.NLS_area_sq_miles,_c95.NLS_area_sq_kilometers,_c95.NLS_area_hectares,_c95.NLS_area_sq_yards,_c95.NLS_area_sq_feet,_c95.NLS_area_sq_meters];_c32.forEach(_c96,lang.hitch(this,function(_c97,idx){var _c98=new _c3a({label:_c97,onClick:lang.hitch(this,function(){this._switchUnit(_c97);})});_c98.setAttribute("class","unitDropDown");menu.addChild(_c98);}));_c39.byNode(this.unit.domNode).setAttribute("dropDown",menu);var _c99=this.units[this._defaultAreaUnit];_c39.byNode(this.unit.domNode).setAttribute("label",_c99);},_createLocationUnitList:function(){var menu=new Menu({style:"display: none;"});var _c9a=_c4f.widgets.measurement;var _c9b=[_c9a.NLS_decimal_degrees,_c9a.NLS_deg_min_sec];_c32.forEach(_c9b,lang.hitch(this,function(_c9c,idx){var _c9d=new _c3a({label:_c9c,onClick:lang.hitch(this,function(){this._switchLocationUnit(_c9c);})});_c9d.setAttribute("class","unitDropDown");menu.addChild(_c9d);}));_c39.byNode(this.unit.domNode).setAttribute("dropDown",menu);var _c9e=this.units[this._defaultLocationUnit];_c39.byNode(this.unit.domNode).setAttribute("label",_c9e);}});if(has("extend-esri")){lang.setObject("dijit.Measurement",_c50,_c47);}return _c50;});},"esri/dijit/editing/AttachmentEditor":function(){define(["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/kernel","dojo/has","dojo/query","dojo/io-query","dojo/dom-attr","dijit/_Widget","dijit/_Templated","esri/kernel","esri/lang","esri/domUtils","dojo/text!esri/dijit/editing/templates/AttachmentEditor.html","dojo/i18n!esri/nls/jsapi","dojo/NodeList-dom"],function(_c9f,_ca0,lang,_ca1,_ca2,_ca3,has,_ca4,_ca5,_ca6,_ca7,_ca8,_ca9,_caa,_cab,_cac,_cad){var AE=_ca0([_ca7,_ca8],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:true,templateString:_cac,basePath:_c9f.toUrl("esri/dijit/editing")+"/",_listHtml:"<span id='node_${oid}_${attid}'><a href='${href}' target='_blank'>${name}</a>",_deleteBtnHtml:"(<span style='cursor:pointer;color:red;font-weight:bold;' class='deleteAttachment' id='${attid}');'>X</span>)",_endHtml:"<br/></span>",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},constructor:function(_cae,_caf){lang.mixin(this,_cad.widgets.attachmentEditor);},startup:function(){this.inherited(arguments);this._uploadField_connect=_ca1.connect(this._uploadField,"onchange",this,"_addAttachment");this._uploadFieldFocus_connect=_ca1.connect(this._uploadField,"onfocus",lang.hitch(this,function(e){_cab.hide(this._attachmentError);}));},destroy:function(){_ca2.forEach(this._aeConnects,_ca1.disconnect);_ca1.disconnect(this._uploadField_connect);_ca1.disconnect(this._uploadFieldFocus_connect);this.inherited(arguments);},showAttachments:function(_cb0,_cb1){var list=this._attachmentList;list.innerHTML=this.NLS_none;this._uploadField.value="";_ca2.forEach(this.domNode.children,function(_cb2,idx){_cab.show(_cb2);});_cab.hide(this._attachmentError);if(!_cb0){return;}this._featureLayer=_cb0.getLayer()||_cb1;if(!this._featureLayer){return;}if(this._featureLayer.declaredClass!=="esri.layers.FeatureLayer"||!this._featureLayer.getEditCapabilities){_cab.hide(this._uploadForm);_ca2.forEach(this.domNode.children,function(_cb3,idx){_cab.hide(_cb3);});return;}this._currentLayerId=this._featureLayer.id;if(!this._layerEditingCapChecked[this._currentLayerId]){this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities();this._layerEditingCapChecked[this._currentLayerId]=true;}this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:_cb0}).canUpdate;this._oid=_cb0.attributes[this._featureLayer.objectIdField];this._getAttachments(_cb0);},_getAttachments:function(_cb4){if(!this._featureLayer||!this._featureLayer.queryAttachmentInfos){return;}this._featureLayer.queryAttachmentInfos(this._oid,lang.hitch(this,"_onQueryAttachmentInfosComplete"));},_addAttachment:function(){_cab.hide(this._attachmentError);if(!this._featureLayer||!this._featureLayer.addAttachment){return;}this._featureLayer.addAttachment(this._oid,this._uploadForm,lang.hitch(this,"_onAddAttachmentComplete"),lang.hitch(this,"_onAddAttachmentError"));},_deleteAttachment:function(oid,_cb5){this._featureLayer.deleteAttachments(oid,[_cb5],lang.hitch(this,"_onDeleteAttachmentComplete"));},_onQueryAttachmentInfosComplete:function(_cb6){var _cb7=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";if((!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate)||(!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate)){_cb7=this._listHtml+this._endHtml;this._uploadForm.style.display="none";}else{if(this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate){_cb7=this._listHtml+this._endHtml;}}var list=this._attachmentList,_cb8=_ca2.map(_cb6,lang.hitch(this,function(info){return _caa.substitute({href:info.url,name:info.name,oid:info.objectId,attid:info.id},_cb7);}));list.innerHTML=_cb8.join("")||this.NLS_none;this._updateConnects();},_onAddAttachmentComplete:function(_cb9){var _cba=this._uploadField;var _cbb=_cba.value;var pos=_cbb.lastIndexOf("\\");if(pos>-1){_cbb=_cbb.substring(pos+1,_cbb.length);}_cbb=_cbb.replace(/\ /g,"_");var list=this._attachmentList,_cbc=_ca5.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()});var _cbd=this._listHtml+this._deleteBtnHtml+this._endHtml;if(this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate){_cbd=this._listHtml+this._endHtml;}var link=_caa.substitute({href:this._featureLayer._url.path+"/"+_cb9.objectId+"/attachments/"+_cb9.attachmentId+(_cbc?("?"+_cbc):""),name:_cbb,oid:_cb9.objectId,attid:_cb9.attachmentId},_cbd);list.innerHTML=list.innerHTML==this.NLS_none?link:(list.innerHTML+link);this._updateConnects();_cba.value="";},_onAddAttachmentError:function(_cbe){if(_cbe&&_caa.isDefined(_cbe.code)){var _cbf,_cc0=this._attachmentError;if(_cbe.code===400){_cbf=this.NLS_fileNotSupported;}else{_cbf=_cbe.message||(_cbe.details&&_cbe.details.length&&_cbe.details[0]);}_ca6.set(_cc0,"innerHTML",(_cbf||this.NLS_error));_cab.show(_cc0);}},_onDeleteAttachmentComplete:function(_cc1){var _cc2=_ca2.every(_cc1,function(_cc3){return _cc3.success;}),list=this._attachmentList;if(_cc2){_ca3.query("#node_"+_cc1[0].objectId+"_"+_cc1[0].attachmentId).orphan();if(!list.children||!list.children.length){list.innerHTML=this.NLS_none;}}},_updateConnects:function(){_ca2.forEach(this._aeConnects,_ca1.disconnect);_ca3.query(".deleteAttachment").forEach(function(item){this._aeConnects.push(_ca1.connect(item,"onclick",lang.hitch(this,"_deleteAttachment",this._oid,item.id)));},this);}});if(has("extend-esri")){lang.setObject("dijit.editing.AttachmentEditor",AE,_ca9);}return AE;});},"url:esri/dijit/templates/BasemapGallery.html":"<div class=\"esriBasemapGallery\">\r\n  <div dojoAttachPoint=\"flowContainer\">\r\n  </div>\r\n</div>","dijit/ToolbarSeparator":function(){define("dijit/ToolbarSeparator",["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(_cc4,dom,_cc5,_cc6){return _cc4("dijit.ToolbarSeparator",[_cc5,_cc6],{templateString:"<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>",buildRendering:function(){this.inherited(arguments);dom.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});});},"dijit/layout/_LayoutWidget":function(){define("dijit/layout/_LayoutWidget",["dojo/_base/lang","../_Widget","../_Container","../_Contained","../Viewport","dojo/_base/declare","dojo/dom-class","dojo/dom-geometry","dojo/dom-style"],function(lang,_cc7,_cc8,_cc9,_cca,_ccb,_ccc,_ccd,_cce){return _ccb("dijit.layout._LayoutWidget",[_cc7,_cc8,_cc9],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,buildRendering:function(){this.inherited(arguments);_ccc.add(this.domNode,"dijitContainer");},startup:function(){if(this._started){return;}this.inherited(arguments);var _ccf=this.getParent&&this.getParent();if(!(_ccf&&_ccf.isLayoutContainer)){this.resize();this.own(_cca.on("resize",lang.hitch(this,"resize")));}},resize:function(_cd0,_cd1){var node=this.domNode;if(_cd0){_ccd.setMarginBox(node,_cd0);}var mb=_cd1||{};lang.mixin(mb,_cd0||{});if(!("h" in mb)||!("w" in mb)){mb=lang.mixin(_ccd.getMarginBox(node),mb);}var cs=_cce.getComputedStyle(node);var me=_ccd.getMarginExtents(node,cs);var be=_ccd.getBorderExtents(node,cs);var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});var pe=_ccd.getPadExtents(node,cs);this._contentBox={l:_cce.toPixelValue(node,cs.paddingLeft),t:_cce.toPixelValue(node,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};this.layout();},layout:function(){},_setupChild:function(_cd2){var cls=this.baseClass+"-child "+(_cd2.baseClass?this.baseClass+"-"+_cd2.baseClass:"");_ccc.add(_cd2.domNode,cls);},addChild:function(_cd3,_cd4){this.inherited(arguments);if(this._started){this._setupChild(_cd3);}},removeChild:function(_cd5){var cls=this.baseClass+"-child"+(_cd5.baseClass?" "+this.baseClass+"-"+_cd5.baseClass:"");_ccc.remove(_cd5.domNode,cls);this.inherited(arguments);}});});},"dojox/grid/_RowManager":function(){define("dojox/grid/_RowManager",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class"],function(_cd6,lang,_cd7){var _cd8=function(_cd9,_cda){if(_cd9.style.cssText==undefined){_cd9.setAttribute("style",_cda);}else{_cd9.style.cssText=_cda;}};return _cd6("dojox.grid._RowManager",null,{constructor:function(_cdb){this.grid=_cdb;},linesToEms:2,overRow:-2,prepareStylingRow:function(_cdc,_cdd){return {index:_cdc,node:_cdd,odd:Boolean(_cdc&1),selected:!!this.grid.selection.isSelected(_cdc),over:this.isOver(_cdc),customStyles:"",customClasses:"dojoxGridRow"};},styleRowNode:function(_cde,_cdf){var row=this.prepareStylingRow(_cde,_cdf);this.grid.onStyleRow(row);this.applyStyles(row);},applyStyles:function(_ce0){var i=_ce0;i.node.className=i.customClasses;var h=i.node.style.height;_cd8(i.node,i.customStyles+";"+(i.node._style||""));i.node.style.height=h;},updateStyles:function(_ce1){this.grid.updateRowStyles(_ce1);},setOverRow:function(_ce2){var last=this.overRow;this.overRow=_ce2;if((last!=this.overRow)&&(lang.isString(last)||last>=0)){this.updateStyles(last);}this.updateStyles(this.overRow);},isOver:function(_ce3){return (this.overRow==_ce3&&!_cd7.contains(this.grid.domNode,"dojoxGridColumnResizing"));}});});},"dojox/gauges/_Gauge":function(){define("dojox/gauges/_Gauge",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dojo/_base/event","dojo/_base/connect","dojo/dom-construct","dijit/_Widget","dojox/gfx","./Range","dojo/fx/easing"],function(_ce4,_ce5,lang,html,arr,_ce6,_ce7,dom,_ce8,gfx,_ce9){_ce4.deprecated("dojox.gauges","Use the new extensible dojox.dgauges framework instead","2.0");var _cea=0;var _ceb=0;return _ce5("dojox.gauges._Gauge",[_ce8],{width:0,height:0,background:null,image:null,useRangeStyles:0,useTooltip:true,majorTicks:null,minorTicks:null,_defaultIndicator:null,defaultColors:[[0,84,170,1],[68,119,187,1],[102,153,204,1],[153,187,238,1],[153,204,255,1],[204,238,255,1],[221,238,255,1]],min:null,max:null,surface:null,hideValues:false,gaugeContent:undefined,_backgroundDefault:{color:"#E0E0E0"},_rangeData:null,_indicatorData:null,_drag:null,_img:null,_overOverlay:false,_lastHover:"",startup:function(){if(this.image===null){this.image={};}this.connect(this.gaugeContent,"onmousedown",this.handleMouseDown);this.connect(this.gaugeContent,"onmousemove",this.handleMouseMove);this.connect(this.gaugeContent,"onmouseover",this.handleMouseOver);this.connect(this.gaugeContent,"onmouseout",this.handleMouseOut);this.connect(this.gaugeContent,"touchstart",this.handleTouchStart);this.connect(this.gaugeContent,"touchend",this.handleTouchEnd);this.connect(this.gaugeContent,"touchmove",this.handleTouchMove);if(!lang.isArray(this.ranges)){this.ranges=[];}if(!lang.isArray(this.indicators)){this.indicators=[];}var _cec=[],_ced=[];var i;if(this.hasChildren()){var _cee=this.getChildren();for(i=0;i<_cee.length;i++){if(/.*Indicator/.test(_cee[i].declaredClass)){_ced.push(_cee[i]);continue;}switch(_cee[i].declaredClass){case _ce9.prototype.declaredClass:_cec.push(_cee[i]);break;}}this.ranges=this.ranges.concat(_cec);this.indicators=this.indicators.concat(_ced);}if(!this.background){this.background=this._backgroundDefault;}this.background=this.background.color||this.background;if(!this.surface){this.createSurface();}this.addRanges(this.ranges);if(this.minorTicks&&this.minorTicks.interval){this.setMinorTicks(this.minorTicks);}if(this.majorTicks&&this.majorTicks.interval){this.setMajorTicks(this.majorTicks);}for(i=0;i<this.indicators.length;i++){this.addIndicator(this.indicators[i]);}this.inherited(arguments);},hasChildren:function(){return this.getChildren().length>0;},buildRendering:function(){var n=this.domNode=this.srcNodeRef?this.srcNodeRef:dom.create("div");this.gaugeContent=dom.create("div",{className:"dojoxGaugeContent"});this.containerNode=dom.create("div");this.mouseNode=dom.create("div");while(n.hasChildNodes()){this.containerNode.appendChild(n.firstChild);}dom.place(this.gaugeContent,n);dom.place(this.containerNode,n);dom.place(this.mouseNode,n);},_setTicks:function(_cef,_cf0,_cf1){var i;if(_cef&&lang.isArray(_cef._ticks)){for(i=0;i<_cef._ticks.length;i++){this._removeScaleTick(_cef._ticks[i]);}}var t={length:_cf0.length,offset:_cf0.offset,noChange:true};if(_cf0.color){t.color=_cf0.color;}if(_cf0.font){t.font=_cf0.font;}if(_cf0.labelPlacement){t.direction=_cf0.labelPlacement;}_cf0._ticks=[];for(i=this.min;i<=this.max;i+=_cf0.interval){if(i==this.max&&this._isScaleCircular()){continue;}t.value=i;if(_cf1){var _cf2=this._getNumberModule();if(_cf2){t.label=(_cf0.fixedPrecision&&_cf0.precision)?_cf2.format(i,{places:_cf0.precision}):_cf2.format(i);}else{t.label=(_cf0.fixedPrecision&&_cf0.precision)?i.toFixed(_cf0.precision):i.toString();}}_cf0._ticks.push(this._addScaleTick(t,_cf1));}return _cf0;},_isScaleCircular:function(){return false;},setMinorTicks:function(_cf3){this.minorTicks=this._setTicks(this.minorTicks,_cf3,false);},setMajorTicks:function(_cf4){this.majorTicks=this._setTicks(this.majorTicks,_cf4,true);},postCreate:function(){if(this.hideValues){html.style(this.containerNode,"display","none");}html.style(this.mouseNode,"width","0");html.style(this.mouseNode,"height","0");html.style(this.mouseNode,"position","absolute");html.style(this.mouseNode,"z-index","100");if(this.useTooltip){require(["dijit/Tooltip"],dojo.hitch(this,function(_cf5){_cf5.show("test",this.mouseNode,!this.isLeftToRight());_cf5.hide(this.mouseNode);}));}},_getNumberModule:function(){if(_ceb==0){try{_ceb=require("dojo/number");}catch(e){_ceb=null;}}return _ceb;},createSurface:function(){this.gaugeContent.style.width=this.width+"px";this.gaugeContent.style.height=this.height+"px";this.surface=gfx.createSurface(this.gaugeContent,this.width,this.height);this._backgroundGroup=this.surface.createGroup();this._rangeGroup=this.surface.createGroup();this._minorTicksGroup=this.surface.createGroup();this._majorTicksGroup=this.surface.createGroup();this._overlayGroup=this.surface.createGroup();this._indicatorsGroup=this.surface.createGroup();this._foregroundGroup=this.surface.createGroup();this._background=this._backgroundGroup.createRect({x:0,y:0,width:this.width,height:this.height});this._background.setFill(this.background);if(this.image.url){var _cf6=this._backgroundGroup;if(this.image.overlay){_cf6=this._overlayGroup;}this._img=_cf6.createImage({width:this.image.width||this.width,height:this.image.height||this.height,src:this.image.url});if(this.image.x||this.image.y){this._img.setTransform({dx:this.image.x||0,dy:this.image.y||0});}}},draw:function(){var i;if(!this.surface){return;}this.drawBackground(this._backgroundGroup);if(this._rangeData){for(i=0;i<this._rangeData.length;i++){this.drawRange(this._rangeGroup,this._rangeData[i]);}}if(this._minorTicksData){for(i=0;i<this._minorTicksData.length;i++){this._minorTicksData[i].draw(this._minorTicksGroup);}}if(this._majorTicksData){for(i=0;i<this._majorTicksData.length;i++){this._majorTicksData[i].draw(this._majorTicksGroup);}}if(this._indicatorData){for(i=0;i<this._indicatorData.length;i++){this._indicatorData[i].draw(this._indicatorsGroup);}}this.drawForeground(this._foregroundGroup);},drawBackground:function(_cf7){},drawForeground:function(_cf8){},setBackground:function(_cf9){if(!_cf9){_cf9=this._backgroundDefault;}this.background=_cf9.color||_cf9;this._background.setFill(this.background);},addRange:function(_cfa){this.addRanges([_cfa]);},addRanges:function(_cfb){if(!this._rangeData){this._rangeData=[];}var _cfc;for(var i=0;i<_cfb.length;i++){_cfc=_cfb[i];if((this.min===null)||(_cfc.low<this.min)){this.min=_cfc.low;}if((this.max===null)||(_cfc.high>this.max)){this.max=_cfc.high;}if(!_cfc.color){var _cfd=this._rangeData.length%this.defaultColors.length;if(gfx.svg&&this.useRangeStyles>0){_cfd=(this._rangeData.length%this.useRangeStyles)+1;_cfc.color={style:"dojoxGaugeRange"+_cfd};}else{_cfd=this._rangeData.length%this.defaultColors.length;_cfc.color=this.defaultColors[_cfd];}}this._rangeData[this._rangeData.length]=_cfc;}this.draw();},_addScaleTick:function(_cfe,_cff){if(!_cfe.declaredClass){_cfe=new this._defaultIndicator(_cfe);}_cfe._gauge=this;if(_cff){if(!this._majorTicksData){this._majorTicksData=[];}this._majorTicksData[this._majorTicksData.length]=_cfe;_cfe.draw(this._majorTicksGroup);}else{if(!this._minorTicksData){this._minorTicksData=[];}this._minorTicksData[this._minorTicksData.length]=_cfe;_cfe.draw(this._minorTicksGroup);}return _cfe;},_removeScaleTick:function(_d00){var i;if(this._majorTicksData){for(i=0;i<this._majorTicksData.length;i++){if(this._majorTicksData[i]===_d00){this._majorTicksData.splice(i,1);_d00.remove();return;}}}if(this._minorTicksData){for(i=0;i<this._minorTicksData.length;i++){if(this._minorTicksData[i]===_d00){this._minorTicksData.splice(i,1);_d00.remove();return;}}}},addIndicator:function(_d01){if(!_d01.declaredClass){_d01=new this._defaultIndicator(_d01);}_d01._gauge=this;if(!_d01.hideValue){this.containerNode.appendChild(_d01.domNode);}if(!this._indicatorData){this._indicatorData=[];}this._indicatorData[this._indicatorData.length]=_d01;_d01.draw(this._indicatorsGroup);return _d01;},removeIndicator:function(_d02){for(var i=0;i<this._indicatorData.length;i++){if(this._indicatorData[i]===_d02){this._indicatorData.splice(i,1);_d02.remove();break;}}},moveIndicatorToFront:function(_d03){if(_d03.shape){_d03.shape.moveToFront();}},drawText:function(_d04,txt,x,y,_d05,_d06,font){var t=_d04.createText({x:x,y:y,text:txt,align:_d05});t.setFill(_d06?_d06:"black");if(font){t.setFont(font);}return t;},removeText:function(t){if(t.parent){t.parent.remove(t);}},updateTooltip:function(txt,e){if(this.useTooltip){require(["dijit/Tooltip"],dojo.hitch(this,function(_d07){if(this._lastHover!=txt){if(txt!==""){_d07.hide(this.mouseNode);_d07.show(txt,this.mouseNode,!this.isLeftToRight());}else{_d07.hide(this.mouseNode);}this._lastHover=txt;}}));}},handleMouseOver:function(e){if(this.image&&this.image.overlay){if(e.target==this._img.getEventSource()){var _d08;this._overOverlay=true;var r=this.getRangeUnderMouse(e);if(r&&r.hover){_d08=r.hover;}if(this.useTooltip&&!this._drag){if(_d08){this.updateTooltip(_d08,e);}else{this.updateTooltip("",e);}}}}},handleMouseOut:function(e){this._overOverlay=false;this._hideTooltip();},handleMouseMove:function(e){if(this.useTooltip){if(e){html.style(this.mouseNode,"left",e.pageX+1+"px");html.style(this.mouseNode,"top",e.pageY+1+"px");}if(this._overOverlay){var r=this.getRangeUnderMouse(e);if(r&&r.hover){this.updateTooltip(r.hover,e);}else{this.updateTooltip("",e);}}}},handleMouseDown:function(e){var _d09=this._getInteractiveIndicator();if(_d09){this._handleMouseDownIndicator(_d09,e);}},_handleDragInteractionMouseMove:function(e){if(this._drag){this._dragIndicator(this,e);_ce6.stop(e);}},_handleDragInteractionMouseUp:function(e){this._drag=null;for(var i=0;i<this._mouseListeners.length;i++){_ce7.disconnect(this._mouseListeners[i]);}this._mouseListeners=[];_ce6.stop(e);},_handleMouseDownIndicator:function(_d0a,e){if(!_d0a.noChange){if(!this._mouseListeners){this._mouseListeners=[];}this._drag=_d0a;this._mouseListeners.push(_ce7.connect(document,"onmouseup",this,this._handleDragInteractionMouseUp));this._mouseListeners.push(_ce7.connect(document,"onmousemove",this,this._handleDragInteractionMouseMove));this._mouseListeners.push(_ce7.connect(document,"ondragstart",this,_ce6.stop));this._mouseListeners.push(_ce7.connect(document,"onselectstart",this,_ce6.stop));this._dragIndicator(this,e);_ce6.stop(e);}},_handleMouseOverIndicator:function(_d0b,e){if(this.useTooltip&&!this._drag){if(_d0b.hover){require(["dijit/Tooltip"],dojo.hitch(this,function(_d0c){html.style(this.mouseNode,"left",e.pageX+1+"px");html.style(this.mouseNode,"top",e.pageY+1+"px");_d0c.show(_d0b.hover,this.mouseNode,!this.isLeftToRight());}));}else{this.updateTooltip("",e);}}if(_d0b.onDragMove&&!_d0b.noChange){this.gaugeContent.style.cursor="pointer";}},_handleMouseOutIndicator:function(_d0d,e){this._hideTooltip();this.gaugeContent.style.cursor="pointer";},_hideTooltip:function(){if(this.useTooltip&&this.mouseNode){require(["dijit/Tooltip"],dojo.hitch(this,function(_d0e){_d0e.hide(this.mouseNode);}));}},_handleMouseOutRange:function(_d0f,e){this._hideTooltip();},_handleMouseOverRange:function(_d10,e){if(this.useTooltip&&!this._drag){if(_d10.hover){html.style(this.mouseNode,"left",e.pageX+1+"px");html.style(this.mouseNode,"top",e.pageY+1+"px");require(["dijit/Tooltip"],dojo.hitch(this,function(_d11){_d11.show(_d10.hover,this.mouseNode,!this.isLeftToRight());}));}else{this.updateTooltip("",e);}}},handleTouchStartIndicator:function(_d12,e){if(!_d12.noChange){this._drag=_d12;_ce6.stop(e);}},handleTouchStart:function(e){this._drag=this._getInteractiveIndicator();this.handleTouchMove(e);},handleTouchEnd:function(e){if(this._drag){this._drag=null;_ce6.stop(e);}},handleTouchMove:function(e){if(this._drag&&!this._drag.noChange){var _d13=e.touches;var _d14=_d13[0];this._dragIndicatorAt(this,_d14.pageX,_d14.pageY);_ce6.stop(e);}},_getInteractiveIndicator:function(){for(var i=0;i<this._indicatorData.length;i++){var _d15=this._indicatorData[i];if(_d15.interactionMode=="gauge"&&!_d15.noChange){return _d15;}}return null;}});});},"dojox/gauges/Range":function(){define("dojox/gauges/Range",["dojo/_base/declare","dijit/_Widget"],function(_d16,_d17){return _d16("dojox.gauges.Range",[_d17],{low:0,high:0,hover:"",color:null,size:0,startup:function(){this.color=this.color?(this.color.color||this.color):"black";}});});},"dijit/form/HorizontalRule":function(){define("dijit/form/HorizontalRule",["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(_d18,_d19,_d1a){return _d18("dijit.form.HorizontalRule",[_d19,_d1a],{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerH\"></div>",count:3,container:"containerNode",ruleStyle:"",_positionPrefix:"<div class=\"dijitRuleMark dijitRuleMarkH\" style=\"left:",_positionSuffix:"%;",_suffix:"\"></div>",_genHTML:function(pos){return this._positionPrefix+pos+this._positionSuffix+this.ruleStyle+this._suffix;},_isHorizontal:true,buildRendering:function(){this.inherited(arguments);var _d1b;if(this.count==1){_d1b=this._genHTML(50,0);}else{var i;var _d1c=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){_d1b=this._genHTML(0,0);for(i=1;i<this.count-1;i++){_d1b+=this._genHTML(_d1c*i,i);}_d1b+=this._genHTML(100,this.count-1);}else{_d1b=this._genHTML(100,0);for(i=1;i<this.count-1;i++){_d1b+=this._genHTML(100-_d1c*i,i);}_d1b+=this._genHTML(0,this.count-1);}}this.domNode.innerHTML=_d1b;}});});},"dojox/gauges/_Indicator":function(){define("dojox/gauges/_Indicator",["dojo/_base/lang","dojo/_base/declare","dojo/_base/fx","dojo/_base/html","dojo/_base/connect","dijit/_Widget","dojo/dom-construct","dojo/dom-class"],function(lang,_d1d,fx,html,_d1e,_d1f,dom,_d20){return _d1d("dojox.gauges._Indicator",[_d1f],{value:0,type:"",color:"black",strokeColor:"",label:"",font:{family:"sans-serif",size:"12px"},length:0,width:0,offset:0,hover:"",front:false,easing:fx._defaultEasing,duration:1000,hideValue:false,noChange:false,interactionMode:"indicator",_gauge:null,title:"",startup:function(){if(this.onDragMove){this.onDragMove=lang.hitch(this.onDragMove);}if(this.strokeColor===""){this.strokeColor=undefined;}},postCreate:function(){if(this.title===""){html.style(this.domNode,"display","none");}if(lang.isString(this.easing)){this.easing=lang.getObject(this.easing);}},buildRendering:function(){var n=this.domNode=this.srcNodeRef?this.srcNodeRef:dom.create("div");_d20.add(n,"dojoxGaugeIndicatorDiv");var _d21=dom.create("label");if(this.title){_d21.innerHTML=this.title+":";}dom.place(_d21,n);this.valueNode=dom.create("input",{className:"dojoxGaugeIndicatorInput",size:5,value:this.value});dom.place(this.valueNode,n);_d1e.connect(this.valueNode,"onchange",this,this._update);},_update:function(){this._updateValue(true);},_updateValue:function(_d22){var _d23=this.valueNode.value;if(_d23===""){this.value=null;}else{this.value=Number(_d23);this.hover=this.title+": "+_d23;}if(this._gauge){this.draw(this._gauge._indicatorsGroup,_d22||_d22==undefined?false:true);this.valueNode.value=this.value;if((this.title=="Target"||this.front)&&this._gauge.moveIndicator){this._gauge.moveIndicatorToFront(this);}this.valueChanged();}},valueChanged:function(){},update:function(_d24,_d25){if(!this.noChange){this.valueNode.value=_d24;this._updateValue(_d25);}},handleMouseOver:function(e){this._gauge._handleMouseOverIndicator(this,e);},handleMouseOut:function(e){this._gauge._handleMouseOutIndicator(this,e);this._gauge.gaugeContent.style.cursor="";},handleMouseDown:function(e){this._gauge._handleMouseDownIndicator(this,e);},handleTouchStart:function(e){this._gauge.handleTouchStartIndicator(this,e);},onDragMove:function(){this.value=Math.floor(this.value);this.valueNode.value=this.value;this.hover=this.title+": "+this.value;},draw:function(_d26){},remove:function(){if(this.shape){this.shape.parent.remove(this.shape);}this.shape=null;if(this.text){this.text.parent.remove(this.text);}this.text=null;}});});},"esri/dijit/OverviewMap":function(){require({cache:{"url:esri/dijit/templates/OverviewMap.html":"<div class=\"esriOverviewMap\">\r\n  <div class=\"ovwContainer\" dojoattachpoint=\"_body\" style=\"width: ${width}px; height: ${height}px;\">\r\n    <div id=\"${id}-map\" style=\"width: 100%; height: 100%;\">\r\n      <div class=\"ovwHighlight\" dojoattachpoint=\"_focusDiv\" title=\"${NLS_drag}\" style=\"border: 1px solid ${color}; background-color: ${color};\"></div>\r\n    </div>\r\n  </div>\r\n  <div class=\"ovwButton ovwController\" title=\"${NLS_show}\" dojoattachpoint=\"_controllerDiv\" dojoattachevent=\"onclick: _visibilityHandler\">\r\n  </div>\r\n  <div class=\"ovwButton ovwMaximizer\" title=\"${NLS_maximize}\" dojoattachpoint=\"_maximizerDiv\" dojoattachevent=\"onclick: _maximizeHandler\">\r\n  </div>\r\n</div>\r\n"}});define("esri/dijit/OverviewMap",["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/html","dojo/has","dojo/sniff","dojo/dom-class","dojo/dom-style","dojo/dnd/Moveable","dijit/_Widget","dijit/_Templated","esri/map","esri/geometry/Point","esri/geometry/ScreenPoint","esri/layers/TiledMapServiceLayer","esri/layers/DynamicMapServiceLayer","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ArcGISImageServiceLayer","esri/layers/OpenStreetMapLayer","esri/virtualearth/VETiledLayer","esri/kernel","esri/config","esri/domUtils","dojo/text!esri/dijit/templates/OverviewMap.html","dojo/i18n!esri/nls/jsapi"],function(_d27,_d28,lang,_d29,html,has,_d2a,_d2b,_d2c,_d2d,_d2e,_d2f,Map,_d30,_d31,_d32,_d33,_d34,_d35,_d36,_d37,_d38,_d39,_d3a,_d3b,_d3c,_d3d){var OM=_d28([_d2e,_d2f],{declaredClass:"esri.dijit.OverviewMap",widgetsInTemplate:true,templateString:_d3c,basePath:_d27.toUrl("esri/dijit")+"/",constructor:function(_d3e,_d3f){lang.mixin(this,_d3d.widgets.overviewMap);_d3e=_d3e||{};if(!_d3e.map){console.error("esri.dijit.OverviewMap: "+this.NLS_noMap);return;}var _d40={};if(_d3f){this._detached=true;_d40=html.coords(_d3f,true);}this.map=_d3e.map;this.baseLayer=_d3e.baseLayer;this.width=_d3e.width||_d40.w||this.map.width/4;this.height=_d3e.height||_d40.h||this.map.height/4;this.attachTo=_d3e.attachTo||"top-right";this.expandFactor=_d3e.expandFactor||2;this.color=_d3e.color||"#000000";this.opacity=_d3e.opacity||0.5;this.maximizeButton=!!_d3e.maximizeButton;this.visible=!!_d3e.visible;if(this.map.loaded){this._initialSetup();}else{var _d41=_d29.connect(this.map,"onLoad",this,function(){_d29.disconnect(_d41);_d41=null;this._initialSetup();});}if(this._detached){this.visible=true;}this._maximized=false;},startup:function(){this.inherited(arguments);if(has("ie")){if(!this.domNode.parentElement){this.map.container.appendChild(this.domNode);}}else{if(!this.domNode.parentNode){this.map.container.appendChild(this.domNode);}}if(this._detached){_d2c.set(this._body,"display","block");_d2c.set(this._controllerDiv,"display","none");_d2c.set(this._maximizerDiv,"display","none");if(this.map.loaded){this._initialize();}else{_d29.connect(this.map,"onLoad",this,this._initialize);}}else{if(this.attachTo.split("-")[0]==="bottom"){this.domNode.insertBefore(this._maximizerDiv,this._controllerDiv);}if(!this.maximizeButton){_d2b.add(this._maximizerDiv,"ovwDisabledButton");}if(this.visible&&this.map.loaded){this.visible=false;this.show();}_d2b.add(this.domNode,{"top-left":"ovwTL","top-right":"ovwTR","bottom-left":"ovwBL","bottom-right":"ovwBR"}[this.attachTo]);_d2b.add(this._controllerDiv,"ovwShow");_d2b.add(this._maximizerDiv,"ovwMaximize");}_d2c.set(this._focusDiv,"opacity",this.opacity);},destroy:function(){this._deactivate();if(this.overviewMap){this.overviewMap.destroy();}this.overviewMap=this.baseLayer=null;this.inherited(arguments);},resize:function(size){if(!size||size.w<=0||size.h<=0){return;}this._resize(size.w,size.h);},show:function(){if(!this.visible){var div=this._controllerDiv;div.title=this.NLS_hide;_d2b.remove(div,"ovwShow");_d2b.add(div,"ovwHide");_d3b.show(this._body);_d3b.show(this._maximizerDiv);this._initialize();this.visible=true;}},hide:function(){if(this.visible){var div=this._controllerDiv;div.title=this.NLS_show;_d2b.remove(div,"ovwHide");_d2b.add(div,"ovwShow");if(this._maximized){this._maximizeHandler();}_d3b.hide(this._body);_d3b.hide(this._maximizerDiv);this._deactivate();this.visible=false;}},_initialSetup:function(){this._mainMapLayer=this.map.getLayer(this.map.layerIds[0]);if(!this._mainMapLayer){console.error("esri.dijit.OverviewMap: "+this.NLS_noLayer);return;}var _d42=this.baseLayer||this._mainMapLayer;var _d43=this.map.spatialReference,_d44=_d42.spatialReference;if((_d44.wkid!==_d43.wkid)&&(_d44.wkt!==_d43.wkt)){console.error("esri.dijit.OverviewMap: "+this.NLS_invalidSR);return;}var _d45=_d42.declaredClass;if(_d42 instanceof _d32){if(_d45.indexOf("VETiledLayer")!==-1){this.baseLayer=new _d38({resourceInfo:_d42.getResourceInfo(),culture:_d42.culture,mapStyle:_d42.mapStyle,bingMapsKey:_d42.bingMapsKey});}else{if(_d45.indexOf("OpenStreetMapLayer")!==-1){this.baseLayer=new _d37({tileServers:_d42.tileServers});}else{if(_d45.indexOf("WebTiledLayer")!==-1){var _d46=_d42.initialExtent,_d47=_d42.fullExtent,_d48=_d42.tileInfo;this.baseLayer=new _d42.constructor(_d42.urlTemplate,{initialExtent:_d46&&new _d46.constructor(_d46.toJson()),fullExtent:_d47&&new _d47.constructor(_d47.toJson()),tileInfo:_d48&&new _d48.constructor(_d48.toJson()),tileServers:_d42.tileServers&&_d42.tileServers.slice(0)});}else{this.baseLayer=new _d34(_d42.url,{resourceInfo:_d42.getResourceInfo()});}}}}else{if(_d42 instanceof _d33){if(_d45.indexOf("ArcGISImageServiceLayer")!==-1){this.baseLayer=new _d36(_d42.url);}else{this.baseLayer=new _d35(_d42.url);this.baseLayer.setImageFormat("png24");}}else{console.error("esri.dijit.OverviewMap: "+this.NLS_invalidType);return;}}if(!this._detached&&this.visible&&this._controllerDiv){var _d49=function(){this.visible=false;this.show();};if(this.baseLayer.loaded){_d49.call(this);}else{_d29.connect(this.baseLayer,"onLoad",this,_d49);}}},_visibilityHandler:function(){if(this.visible){this.hide();}else{this.show();}},_maximizeHandler:function(){var div=this._maximizerDiv;if(this._maximized){div.title=this.NLS_maximize;_d2b.remove(div,"ovwRestore");_d2b.add(div,"ovwMaximize");this._resize(this.width,this.height);}else{div.title=this.NLS_restore;_d2b.remove(div,"ovwMaximize");_d2b.add(div,"ovwRestore");this._resize(this.map.width,this.map.height);}this._maximized=!this._maximized;},_resize:function(_d4a,_d4b){_d2c.set(this._body,{width:_d4a+"px",height:_d4b+"px"});var _d4c=_d3a.defaults.map.panDuration,_d4d=this.overviewMap;_d3a.defaults.map.panDuration=0;_d4d.resize(true);_d4d.centerAt(this._focusExtent.getCenter());_d3a.defaults.map.panDuration=_d4c;},_initialize:function(){if(!this.overviewMap){var _d4e;_d4e=(this.overviewMap=new Map(this.id+"-map",{slider:false,showAttribution:false,logo:false,lods:this._overviewLods,wrapAround180:this.map.wrapAround180}));_d29.connect(_d4e,"onLoad",this,function(){this._map_resize_override=lang.hitch(_d4e,this._map_resize_override);_d4e.disableMapNavigation();this._activate();});_d4e.addLayer(this.baseLayer);}else{this._activate();}},_activate:function(){var map=this.map,_d4f=this.overviewMap;this._moveableHandle=new _d2d(this._focusDiv);this._soeConnect=_d29.connect(map,"onExtentChange",this,this._syncOverviewMap);this._ufoConnect=_d29.connect(map,"onPan",this,this._updateFocus);this._oecConnect=_d29.connect(_d4f,"onExtentChange",this,this._ovwExtentChangeHandler);this._opaConnect=_d29.connect(_d4f,"onPan",this,this._ovwPanHandler);this._ozsConnect=_d29.connect(_d4f,"onZoomStart",this,function(){_d3b.hide(this._focusDiv);});this._ozeConnect=_d29.connect(_d4f,"onZoomEnd",this,function(){_d3b.show(this._focusDiv);});this._omsConnect=_d29.connect(this._moveableHandle,"onMoveStop",this,this._moveStopHandler);this._syncOverviewMap(map.extent,null,null,null);},_deactivate:function(){_d29.disconnect(this._soeConnect);_d29.disconnect(this._ufoConnect);_d29.disconnect(this._oecConnect);_d29.disconnect(this._opaConnect);_d29.disconnect(this._ozsConnect);_d29.disconnect(this._ozeConnect);_d29.disconnect(this._omsConnect);if(this._moveableHandle){this._moveableHandle.destroy();}},_syncOverviewMap:function(ext,_d50,_d51,lod){if(this._suspendPanHandling){this._suspendPanHandling=false;return;}this._focusExtent=ext;this.overviewMap.setExtent(ext.expand(this.expandFactor),true);},_updateFocus:function(ext){if(this._suspendPanHandling){return;}this._focusExtent=ext;this._drawFocusDiv(ext);},_drawFocusDiv:function(ext,_d52){var _d53=this.overviewMap;var tl=_d53.toScreen(new _d30(ext.xmin,ext.ymax,_d53.spatialReference));var br=_d53.toScreen(new _d30(ext.xmax,ext.ymin,_d53.spatialReference));var _d54=br.x-tl.x,_d55=br.y-tl.y,_d56=true;if((_d54>this.overviewMap.width)&&(_d55>this.overviewMap.height)){_d56=false;}_d2c.set(this._focusDiv,{left:tl.x+(_d52?_d52.x:0)+"px",top:tl.y+(_d52?_d52.y:0)+"px",width:_d54+"px",height:_d55+"px",display:_d56?"block":"none"});},_moveStopHandler:function(evt){var _d57=this._moveableHandle.node.style;var ext=this._focusExtent;var _d58=this.overviewMap;var _d59=_d58.toMap(new _d31(parseInt(_d57.left,10),parseInt(_d57.top,10)));var prev=new _d30(ext.xmin,ext.ymax,_d58.spatialReference);this._focusExtent=ext.offset(_d59.x-prev.x,_d59.y-prev.y);if(this._maximized){this._maximizeHandler();}else{_d58.centerAt(this._focusExtent.getCenter());}this._suspendPanHandling=true;this.map.setExtent(this._focusExtent);},_ovwExtentChangeHandler:function(){this._drawFocusDiv(this._focusExtent);},_ovwPanHandler:function(ext,_d5a){this._drawFocusDiv(this._focusExtent,_d5a);}});if(has("extend-esri")){lang.setObject("dijit.OverviewMap",OM,_d39);}return OM;});},"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n","dojo/dnd/Avatar":function(){define(["../_base/declare","../_base/window","../dom","../dom-attr","../dom-class","../dom-construct","../hccss","../query"],function(_d5b,win,dom,_d5c,_d5d,_d5e,has,_d5f){return _d5b("dojo.dnd.Avatar",null,{constructor:function(_d60){this.manager=_d60;this.construct();},construct:function(){var a=_d5e.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_d61=this.manager.source,node,b=_d5e.create("tbody",null,a),tr=_d5e.create("tr",null,b),td=_d5e.create("td",null,tr),k=Math.min(5,this.manager.nodes.length),i=0;if(has("highcontrast")){_d5e.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td);}_d5e.create("span",{innerHTML:_d61.generateText?this._generateText():""},td);_d5c.set(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_d61.creator){node=_d61._normalizedCreator(_d61.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _d62=_d5e.create("table"),_d63=_d5e.create("tbody",null,_d62);_d63.appendChild(node);node=_d62;}}node.id="";tr=_d5e.create("tr",null,b);td=_d5e.create("td",null,tr);td.appendChild(node);_d5c.set(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){_d5e.destroy(this.node);this.node=false;},update:function(){_d5d.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(has("highcontrast")){var icon=dom.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}_d5f(("tr.dojoDndAvatarHeader td span"+(has("highcontrast")?" span":"")),this.node).forEach(function(node){node.innerHTML=this.manager.source.generateText?this._generateText():"";},this);},_generateText:function(){return this.manager.nodes.length.toString();}});});},"dijit/form/_Spinner":function(){require({cache:{"url:dijit/form/templates/Spinner.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitButtonNode dijitSpinnerButtonContainer\"\n\t\t><input class=\"dijitReset dijitInputField dijitSpinnerButtonInner\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t/><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\n\t\t\tdata-dojo-attach-point=\"upArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9650; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\tdata-dojo-attach-point=\"downArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' data-dojo-attach-point=\"textbox,focusNode\" type=\"${type}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\"\n\t\t\trole=\"spinbutton\" autocomplete=\"off\" ${!nameAttrSetting}\n\t/></div\n></div>\n"}});define("dijit/form/_Spinner",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/mouse","../typematic","./RangeBoundTextBox","dojo/text!./templates/Spinner.html","./_TextBoxMixin"],function(_d64,_d65,keys,lang,has,_d66,_d67,_d68,_d69,_d6a){return _d64("dijit.form._Spinner",_d68,{defaultTimeout:500,minimumTimeout:10,timeoutChangeRate:0.9,smallDelta:1,largeDelta:10,templateString:_d69,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{"upArrowNode":"dijitUpArrowButton","downArrowNode":"dijitDownArrowButton"},adjust:function(val){return val;},_arrowPressed:function(_d6b,_d6c,_d6d){if(this.disabled||this.readOnly){return;}this._setValueAttr(this.adjust(this.get("value"),_d6c*_d6d),false);_d6a.selectInputText(this.textbox,this.textbox.value.length);},_arrowReleased:function(){this._wheelTimer=null;},_typematicCallback:function(_d6e,node,evt){var inc=this.smallDelta;if(node==this.textbox){var key=evt.charOrCode;inc=(key==keys.PAGE_UP||key==keys.PAGE_DOWN)?this.largeDelta:this.smallDelta;node=(key==keys.UP_ARROW||key==keys.PAGE_UP)?this.upArrowNode:this.downArrowNode;}if(_d6e==-1){this._arrowReleased(node);}else{this._arrowPressed(node,(node==this.upArrowNode)?1:-1,inc);}},_wheelTimer:null,_mouseWheeled:function(evt){_d65.stop(evt);var _d6f=evt.wheelDelta/120;if(Math.floor(_d6f)!=_d6f){_d6f=evt.wheelDelta>0?1:-1;}var _d70=evt.detail?(evt.detail*-1):_d6f;if(_d70!==0){var node=this[(_d70>0?"upArrowNode":"downArrowNode")];this._arrowPressed(node,_d70,this.smallDelta);if(this._wheelTimer){this._wheelTimer.remove();}this._wheelTimer=this.defer(function(){this._arrowReleased(node);},50);}},_setConstraintsAttr:function(_d71){this.inherited(arguments);if(this.focusNode){if(this.constraints.min!==undefined){this.focusNode.setAttribute("aria-valuemin",this.constraints.min);}else{this.focusNode.removeAttribute("aria-valuemin");}if(this.constraints.max!==undefined){this.focusNode.setAttribute("aria-valuemax",this.constraints.max);}else{this.focusNode.removeAttribute("aria-valuemax");}}},_setValueAttr:function(_d72,_d73){this.focusNode.setAttribute("aria-valuenow",_d72);this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,_d66.wheel,"_mouseWheeled");this.own(_d67.addListener(this.upArrowNode,this.textbox,{charOrCode:keys.UP_ARROW,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_d67.addListener(this.downArrowNode,this.textbox,{charOrCode:keys.DOWN_ARROW,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_d67.addListener(this.upArrowNode,this.textbox,{charOrCode:keys.PAGE_UP,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_d67.addListener(this.downArrowNode,this.textbox,{charOrCode:keys.PAGE_DOWN,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout));}});});},"dojox/gfx/Moveable":function(){define("dojox/gfx/Moveable",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/topic","dojo/touch","dojo/dom-class","dojo/_base/window","./Mover","dojo/mouse"],function(lang,_d74,arr,_d75,_d76,_d77,_d78,win,_d79,_d7a){return _d74("dojox.gfx.Moveable",null,{constructor:function(_d7b,_d7c){this.shape=_d7b;this.delay=(_d7c&&_d7c.delay>0)?_d7c.delay:0;this.mover=(_d7c&&_d7c.mover)?_d7c.mover:_d79;this.leftButtonOnly=_d7c&&_d7c.leftButtonOnly;this.events=[this.shape.connect(_d77.press,lang.hitch(this,"onMouseDown"))];},destroy:function(){arr.forEach(this.events,function(_d7d){_d7d.remove();});this.events=this.shape=null;},onMouseDown:function(e){if(this.delay){this.events.push(this.shape.connect(_d77.move,lang.hitch(this,"onMouseMove")),this.shape.connect(_d77.release,lang.hitch(this,"onMouseUp")));this._lastX=e.clientX;this._lastY=e.clientY;}else{if(!this.leftButtonOnly||_d7a.isLeft(e)){new this.mover(this.shape,e,this);}}_d75.stop(e);},onMouseMove:function(e){var _d7e=e.clientX,_d7f=e.clientY;if(Math.abs(_d7e-this._lastX)>this.delay||Math.abs(_d7f-this._lastY)>this.delay){this.onMouseUp(e);new this.mover(this.shape,e,this);}_d75.stop(e);},onMouseUp:function(e){this.events.pop().remove();},onMoveStart:function(_d80){_d76.publish("/gfx/move/start",_d80);_d78.add(win.body(),"dojoMove");},onMoveStop:function(_d81){_d76.publish("/gfx/move/stop",_d81);_d78.remove(win.body(),"dojoMove");},onFirstMove:function(_d82){},onMove:function(_d83,_d84){this.onMoving(_d83,_d84);this.shape.applyLeftTransform(_d84);this.onMoved(_d83,_d84);},onMoving:function(_d85,_d86){},onMoved:function(_d87,_d88){}});});},"dojo/dnd/move":function(){define(["../_base/declare","../dom-geometry","../dom-style","./common","./Mover","./Moveable"],function(_d89,_d8a,_d8b,dnd,_d8c,_d8d){var _d8e=_d89("dojo.dnd.move.constrainedMoveable",_d8d,{constraints:function(){},within:false,constructor:function(node,_d8f){if(!_d8f){_d8f={};}this.constraints=_d8f.constraints;this.within=_d8f.within;},onFirstMove:function(_d90){var c=this.constraintBox=this.constraints.call(this,_d90);c.r=c.l+c.w;c.b=c.t+c.h;if(this.within){var mb=_d8a.getMarginSize(_d90.node);c.r-=mb.w;c.b-=mb.h;}},onMove:function(_d91,_d92){var c=this.constraintBox,s=_d91.node.style;this.onMoving(_d91,_d92);_d92.l=_d92.l<c.l?c.l:c.r<_d92.l?c.r:_d92.l;_d92.t=_d92.t<c.t?c.t:c.b<_d92.t?c.b:_d92.t;s.left=_d92.l+"px";s.top=_d92.t+"px";this.onMoved(_d91,_d92);}});var _d93=_d89("dojo.dnd.move.boxConstrainedMoveable",_d8e,{box:{},constructor:function(node,_d94){var box=_d94&&_d94.box;this.constraints=function(){return box;};}});var _d95=_d89("dojo.dnd.move.parentConstrainedMoveable",_d8e,{area:"content",constructor:function(node,_d96){var area=_d96&&_d96.area;this.constraints=function(){var n=this.node.parentNode,s=_d8b.getComputedStyle(n),mb=_d8a.getMarginBox(n,s);if(area=="margin"){return mb;}var t=_d8a.getMarginExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="border"){return mb;}t=_d8a.getBorderExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="padding"){return mb;}t=_d8a.getPadExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;return mb;};}});return {constrainedMoveable:_d8e,boxConstrainedMoveable:_d93,parentConstrainedMoveable:_d95};});},"esri/layers/TrackManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/graphic","esri/geometry/Polyline","esri/layers/GraphicsLayer"],function(_d97,lang,_d98,has,_d99,_d9a,_d9b,_d9c){var _d9d=_d97(null,{declaredClass:"esri.layers._TrackManager",constructor:function(_d9e){this.layer=_d9e;this.trackMap={};},initialize:function(map){this.map=map;var _d9f=this.layer,_da0=_d9f.renderer.trackRenderer;if(_da0&&(_d9f.geometryType==="esriGeometryPoint")){var _da1=(this.container=new _d9c._GraphicsLayer({id:_d9f.id+"_tracks",_child:true}));_da1.loaded=true;_da1.onLoad(_da1);_da1._setMap(map,_d9f._div);_da1.setRenderer(_da0);}},addFeatures:function(_da2){var tkid,_da3=this.trackMap,_da4=this.layer,_da5=_da4._trackIdField;_d98.forEach(_da2,function(_da6){var _da7=_da6.attributes;tkid=_da7[_da5];var ary=(_da3[tkid]=(_da3[tkid]||[]));ary.push(_da6);});var _da8=_da4._startTimeField,_da9=_da4.objectIdField;var _daa=function(a,b){var _dab=a.attributes[_da8],_dac=b.attributes[_da8];if(_dab===_dac){return (a.attributes[_da9]<b.attributes[_da9])?-1:1;}else{return (_dab<_dac)?-1:1;}};for(tkid in _da3){_da3[tkid].sort(_daa);}},drawTracks:function(){var _dad=this.container;if(!_dad){return;}var _dae=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_daf,_db0=this.layer._trackIdField,_db1;for(tkid in _dae){ary=_dae[tkid];path=[];for(i=ary.length-1;i>=0;i--){_daf=ary[i].geometry;if(_daf){path.push([_daf.x,_daf.y]);}}_db1={};_db1[_db0]=tkid;if(path.length>0){_dad.add(new _d9a(new _d9b({paths:[path],spatialReference:sr}),null,_db1));}}},moveLatestToFront:function(){_d98.forEach(this.getLatestObservations(),function(_db2){var _db3=_db2._shape;_db3&&_db3._moveToFront();this._repaint(_db2,null,true);},this.layer);},getLatestObservations:function(){var _db4=[];if(!this.layer.renderer.latestObservationRenderer){return _db4;}var _db5=this.trackMap,tkid;for(tkid in _db5){var ary=_db5[tkid];_db4.push(ary[ary.length-1]);}return _db4;},clearTracks:function(){var _db6=this.getLatestObservations();this.trackMap={};var _db7=this.container;if(_db7){_db7.clear();}_d98.forEach(_db6,function(_db8){this._repaint(_db8,null,true);},this.layer);},isLatestObservation:function(_db9){var _dba=this.layer._trackIdField;var _dbb=this.trackMap[_db9.attributes[_dba]];if(_dbb){return (_dbb[_dbb.length-1]===_db9);}return false;},destroy:function(){var _dbc=this.container;if(_dbc){_dbc.clear();_dbc._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});if(has("extend-esri")){lang.setObject("layers._TrackManager",_d9d,_d99);}return _d9d;});},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(_dbd,_dbe,_dbf){var base=null;return _dbd("dojo.store.Memory",base,{constructor:function(_dc0){for(var i in _dc0){this[i]=_dc0[i];}this.setData(this.data||[]);},data:null,idProperty:"id",index:null,queryEngine:_dbf,get:function(id){return this.data[this.index[id]];},getIdentity:function(_dc1){return _dc1[this.idProperty];},put:function(_dc2,_dc3){var data=this.data,_dc4=this.index,_dc5=this.idProperty;var id=_dc2[_dc5]=(_dc3&&"id" in _dc3)?_dc3.id:_dc5 in _dc2?_dc2[_dc5]:Math.random();if(id in _dc4){if(_dc3&&_dc3.overwrite===false){throw new Error("Object already exists");}data[_dc4[id]]=_dc2;}else{_dc4[id]=data.push(_dc2)-1;}return id;},add:function(_dc6,_dc7){(_dc7=_dc7||{}).overwrite=false;return this.put(_dc6,_dc7);},remove:function(id){var _dc8=this.index;var data=this.data;if(id in _dc8){data.splice(_dc8[id],1);this.setData(data);return true;}},query:function(_dc9,_dca){return _dbe(this.queryEngine(_dc9,_dca)(this.data));},setData:function(data){if(data.items){this.idProperty=data.identifier;data=this.data=data.items;}else{this.data=data;}this.index={};for(var i=0,l=data.length;i<l;i++){this.index[data[i][this.idProperty]]=i;}}});});},"dojox/grid/_Grid":function(){require({cache:{"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n"}});define("dojox/grid/_Grid",["dojo/_base/kernel","../main","dojo/_base/declare","./_Events","./_Scroller","./_Layout","./_View","./_ViewManager","./_RowManager","./_FocusManager","./_EditManager","./Selection","./_RowSelector","./util","dijit/_Widget","dijit/_TemplatedMixin","dijit/CheckedMenuItem","dojo/text!./resources/_Grid.html","dojo/string","dojo/_base/array","dojo/_base/lang","dojo/_base/sniff","dojox/html/metrics","dojo/_base/html","dojo/query","dojo/dnd/common","dojo/i18n!dijit/nls/loading"],function(dojo,_dcb,_dcc,_dcd,_dce,_dcf,_dd0,_dd1,_dd2,_dd3,_dd4,_dd5,_dd6,util,_dd7,_dd8,_dd9,_dda,_ddb,_ddc,lang,has,_ddd,html,_dde){if(!dojo.isCopyKey){dojo.isCopyKey=dojo.dnd.getCopyKeyState;}var _ddf=_dcc("dojox.grid._Grid",[_dd7,_dd8,_dcd],{templateString:_dda,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,summary:"",_setSummaryAttr:"domNode",sortInfo:0,_placeholders:null,_layoutClass:_dcf,buildRendering:function(){this.inherited(arguments);if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_ddd.initOnFontResize();this.connect(_ddd,"onFontResize","textSizeChanged");util.funnelEvents(this.domNode,this,"doKeyEvent",util.keyEvents);if(this.selectionMode!="none"){this.domNode.setAttribute("aria-multiselectable",this.selectionMode=="single"?"false":"true");}html.addClass(this.domNode,this.classTag);if(!this.isLeftToRight()){html.addClass(this.domNode,this.classTag+"Rtl");}if(this.rowHeight>0){html.addClass(this.viewsNode,this.classTag+"FixedRowHeight");}},postMixInProperties:function(){this.inherited(arguments);var _de0=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_ddb.substitute(this.loadingMessage,_de0);this.errorMessage=_ddb.substitute(this.errorMessage,_de0);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){html.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;if(this.scroller){this.scroller.destroy();delete this.scroller;}this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_ddc.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_de1){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.get("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_de1){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _dd2(this);this.focus=new _dd3(this);this.edit=new _dd4(this);},createSelection:function(){this.selection=new _dd5(this);},createScroller:function(){this.scroller=new _dce();this.scroller.grid=this;this.scroller.renderRow=lang.hitch(this,"renderRow");this.scroller.removeRow=lang.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.update();},onResizeColumn:function(_de2){},createViews:function(){this.views=new _dd1(this);this.views.createView=lang.hitch(this,"createView");},createView:function(_de3,idx){var c=lang.getObject(_de3);var view=new c({grid:this,index:idx});this.viewsNode.appendChild(view.domNode);this.viewsHeaderNode.appendChild(view.headerNode);this.views.addView(view);html.attr(this.domNode,"align",this.isLeftToRight()?"left":"right");return view;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_dcb._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_de4){var s=_de4;if(s&&lang.isString(s)){dojo.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0");s=lang.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();this.focus.focusView=null;if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_de5){dojo.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(_de5);},getColumnTogglingItems:function(){var _de6,_de7=[];_de6=_ddc.map(this.layout.cells,function(cell){if(!cell.menuItems){cell.menuItems=[];}var self=this;var item=new _dd9({label:cell.name,checked:!cell.hidden,_gridCell:cell,onChange:function(_de8){if(self.layout.setColumnVisibility(this._gridCell.index,_de8)){var _de9=this._gridCell.menuItems;if(_de9.length>1){_ddc.forEach(_de9,function(item){if(item!==this){item.setAttribute("checked",_de8);}},this);}_de8=_ddc.filter(self.layout.cells,function(c){if(c.menuItems.length>1){_ddc.forEach(c.menuItems,"item.set('disabled', false);");}else{c.menuItems[0].set("disabled",false);}return !c.hidden;});if(_de8.length==1){_ddc.forEach(_de8[0].menuItems,"item.set('disabled', true);");}}},destroy:function(){var _dea=_ddc.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_dea,1);delete this._gridCell;_dd9.prototype.destroy.apply(this,arguments);}});cell.menuItems.push(item);if(!cell.hidden){_de7.push(item);}return item;},this);if(_de7.length==1){_de7[0].set("disabled",true);}return _de6;},_setHeaderMenuAttr:function(menu){if(this._placeholders&&this._placeholders.length){_ddc.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=menu;if(!menu){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(menu){dojo.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(menu);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_ddc.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_deb){this.setScrollTop(0);},getItem:function(_dec){return null;},showMessage:function(_ded){if(_ded){this.messagesNode.innerHTML=_ded;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_dee,_def){this._pendingChangeSize=_dee;this._pendingResultSize=_def;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||html._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_df0,_df1){_df0=_df0||this._pendingChangeSize;_df1=_df1||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _df2=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_df2.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_df1){_df0=_df1;}if(!this._autoHeight&&_df0){html.marginBox(this.domNode,_df0);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=(this._parentContentBoxHeight>0?this._parentContentBoxHeight:html._getContentBox(pn).h);this.domNode.style.height=Math.max(0,h)+"px";}}var _df3=_ddc.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||html._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_df3&&hh===undefined){hh=this._getHeaderHeight();}}if(_df3){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _df4=(!this.initialWidth&&this.autoWidth);var w=_df4?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_df4){this.domNode.style.width=vw+"px";}},adaptHeight:function(_df5){var t=_df5===undefined?this._getHeaderHeight():_df5;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _df6=0,_df7=0;var _df8=_ddc.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_df6++;}else{_df7++;}return (!has);});if(_df6>0&&_df7>0){_ddc.forEach(_df8,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.get("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();html.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var size=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=size;}},renderRow:function(_df9,_dfa){this.views.renderRow(_df9,_dfa,this._skipRowRenormalize);},rowRemoved:function(_dfb){this.views.rowRemoved(_dfb);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_dfc){_dfc=Number(_dfc);if(this.updating){this.invalidated[_dfc]=true;}else{this.views.updateRow(_dfc);this.scroller.rowHeightChanged(_dfc);}},updateRows:function(_dfd,_dfe){_dfd=Number(_dfd);_dfe=Number(_dfe);var i;if(this.updating){for(i=0;i<_dfe;i++){this.invalidated[i+_dfd]=true;}}else{for(i=0;i<_dfe;i++){this.views.updateRow(i+_dfd,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_dfd);}},updateRowCount:function(_dff){if(this.updating){this.invalidated.rowCount=_dff;}else{this.rowCount=_dff;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_dff);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_e00){this.views.updateRowStyles(_e00);},getRowNode:function(_e01){if(this.focus.focusView&&!(this.focus.focusView instanceof _dd6)){return this.focus.focusView.rowNodes[_e01];}else{for(var i=0,_e02;(_e02=this.views.views[i]);i++){if(!(_e02 instanceof _dd6)){return _e02.rowNodes[_e01];}}}return null;},rowHeightChanged:function(_e03){this.views.renormalizeRow(_e03);this.scroller.rowHeightChanged(_e03);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(has("ie")?100:50),scrollTo:function(_e04){if(!this.fastScroll){this.setScrollTop(_e04);return;}var _e05=Math.abs(this.lastScrollTop-_e04);this.lastScrollTop=_e04;if(_e05>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_e04;this.views.setScrollTop(_e04);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _e06=this;this._pendingScroll=window.setTimeout(function(){delete _e06._pendingScroll;_e06.finishScrollJob();},200);}else{this.setScrollTop(_e04);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_e07){this.scroller.scroll(this.views.setScrollTop(_e07));},scrollToRow:function(_e08){this.setScrollTop(this.scroller.findScrollTop(_e08)+1);},styleRowNode:function(_e09,_e0a){if(_e0a){this.rows.styleRowNode(_e09,_e0a);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_e0b){return this.layout.cells[_e0b];},setCellWidth:function(_e0c,_e0d){this.getCell(_e0c).unitWidth=_e0d;},getCellName:function(_e0e){return "Cell "+_e0e.index;},canSort:function(_e0f){},sort:function(){},getSortAsc:function(_e10){_e10=_e10==undefined?this.sortInfo:_e10;return Boolean(_e10>0);},getSortIndex:function(_e11){_e11=_e11==undefined?this.sortInfo:_e11;return Math.abs(_e11)-1;},setSortIndex:function(_e12,_e13){var si=_e12+1;if(_e13!=undefined){si*=(_e13?1:-1);}else{if(this.getSortIndex()==_e12){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_e14){if(this.canSort(_e14)){this.sortInfo=_e14;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_e15,_e16){this.onStartEdit(_e15,_e16);},doApplyCellEdit:function(_e17,_e18,_e19){this.onApplyCellEdit(_e17,_e18,_e19);},doCancelEdit:function(_e1a){this.onCancelEdit(_e1a);},doApplyEdit:function(_e1b){this.onApplyEdit(_e1b);},addRow:function(){this.updateRowCount(this.get("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_ddf.markupFactory=function(_e1c,node,ctor,_e1d){var _e1e=function(n){var w=html.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_e1c.structure&&node.nodeName.toLowerCase()=="table"){_e1c.structure=_dde("> colgroup",node).map(function(cg){var sv=html.attr(cg,"span");var v={noscroll:(html.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(html.hasAttr(cg,"width")){v.width=_e1e(cg);}return v;});if(!_e1c.structure.length){_e1c.structure.push({__span:Infinity,cells:[]});}_dde("thead > tr",node).forEach(function(tr,_e1f){var _e20=0;var _e21=0;var _e22;var _e23=null;_dde("> th",tr).map(function(th){if(!_e23){_e22=0;_e23=_e1c.structure[0];}else{if(_e20>=(_e22+_e23.__span)){_e21++;_e22+=_e23.__span;var _e24=_e23;_e23=_e1c.structure[_e21];}}var cell={name:lang.trim(html.attr(th,"name")||th.innerHTML),colSpan:parseInt(html.attr(th,"colspan")||1,10),type:lang.trim(html.attr(th,"cellType")||""),id:lang.trim(html.attr(th,"id")||"")};_e20+=cell.colSpan;var _e25=html.attr(th,"rowspan");if(_e25){cell.rowSpan=_e25;}if(html.hasAttr(th,"width")){cell.width=_e1e(th);}if(html.hasAttr(th,"relWidth")){cell.relWidth=window.parseInt(html.attr(th,"relWidth"),10);}if(html.hasAttr(th,"hidden")){cell.hidden=(html.attr(th,"hidden")=="true"||html.attr(th,"hidden")===true);}if(_e1d){_e1d(th,cell);}cell.type=cell.type?lang.getObject(cell.type):_dcb.grid.cells.Cell;if(cell.type&&cell.type.markupFactory){cell.type.markupFactory(th,cell);}if(!_e23.cells[_e1f]){_e23.cells[_e1f]=[];}_e23.cells[_e1f].push(cell);});});}return new ctor(_e1c,node);};return _ddf;});},"dijit/Editor":function(){define("dijit/Editor",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/i18n","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/string","dojo/topic","dojo/_base/window","./_base/focus","./_Container","./Toolbar","./ToolbarSeparator","./layout/_LayoutWidget","./form/ToggleButton","./_editor/_Plugin","./_editor/plugins/EnterKeyHandling","./_editor/html","./_editor/range","./_editor/RichText","./main","dojo/i18n!./_editor/nls/commands"],function(_e26,_e27,_e28,_e29,i18n,_e2a,_e2b,_e2c,_e2d,_e2e,keys,lang,has,_e2f,_e30,win,_e31,_e32,_e33,_e34,_e35,_e36,_e37,_e38,html,_e39,_e3a,_e3b){var _e3c=_e28("dijit.Editor",_e3a,{plugins:null,extraPlugins:null,constructor:function(){if(!lang.isArray(this.plugins)){this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",_e38];}this._plugins=[];this._editInterval=this.editActionInterval*1000;if(has("ie")){this.events.push("onBeforeDeactivate");this.events.push("onBeforeActivate");}},postMixInProperties:function(){this.setValueDeferred=new _e29();this.inherited(arguments);},postCreate:function(){this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);if(lang.isArray(this.extraPlugins)){this.plugins=this.plugins.concat(this.extraPlugins);}this.inherited(arguments);this.commands=i18n.getLocalization("dijit._editor","commands",this.lang);if(!this.toolbar){this.toolbar=new _e33({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang});this.header.appendChild(this.toolbar.domNode);}_e27.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(true);_e2b.add(this.iframe.parentNode,"dijitEditorIFrameContainer");_e2b.add(this.iframe,"dijitEditorIFrame");_e2a.set(this.iframe,"allowTransparency",true);if(has("webkit")){_e2d.set(this.domNode,"KhtmlUserSelect","none");}this.toolbar.startup();this.onNormalizedDisplayChanged();},destroy:function(){_e27.forEach(this._plugins,function(p){if(p&&p.destroy){p.destroy();}});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments);},addPlugin:function(_e3d,_e3e){var args=lang.isString(_e3d)?{name:_e3d}:lang.isFunction(_e3d)?{ctor:_e3d}:_e3d;if(!args.setEditor){var o={"args":args,"plugin":null,"editor":this};if(args.name){if(_e37.registry[args.name]){o.plugin=_e37.registry[args.name](args);}else{_e30.publish(_e3b._scopeName+".Editor.getPlugin",o);}}if(!o.plugin){try{var pc=args.ctor||lang.getObject(args.name)||_e26(args.name);if(pc){o.plugin=new pc(args);}}catch(e){throw new Error(this.id+": cannot find plugin ["+args.name+"]");}}if(!o.plugin){throw new Error(this.id+": cannot find plugin ["+args.name+"]");}_e3d=o.plugin;}if(arguments.length>1){this._plugins[_e3e]=_e3d;}else{this._plugins.push(_e3d);}_e3d.setEditor(this);if(lang.isFunction(_e3d.setToolbar)){_e3d.setToolbar(this.toolbar);}},resize:function(size){if(size){_e35.prototype.resize.apply(this,arguments);}},layout:function(){var _e3f=(this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+_e2c.getPadBorderExtents(this.iframe.parentNode).h+_e2c.getMarginExtents(this.iframe.parentNode).h));this.editingArea.style.height=_e3f+"px";if(this.iframe){this.iframe.style.height="100%";}this._layoutMode=true;},_onIEMouseDown:function(e){var _e40;var b=this.document.body;var _e41=b.clientWidth;var _e42=b.clientHeight;var _e43=b.clientLeft;var _e44=b.offsetWidth;var _e45=b.offsetHeight;var _e46=b.offsetLeft;if(/^rtl$/i.test(b.dir||"")){if(_e41<_e44&&e.x>_e41&&e.x<_e44){_e40=true;}}else{if(e.x<_e43&&e.x>_e46){_e40=true;}}if(!_e40){if(_e42<_e45&&e.y>_e42&&e.y<_e45){_e40=true;}}if(!_e40){delete this._cursorToStart;delete this._savedSelection;if(e.target.tagName=="BODY"){this.defer("placeCursorAtEnd");}this.inherited(arguments);}},onBeforeActivate:function(){this._restoreSelection();},onBeforeDeactivate:function(e){if(this.customUndo){this.endEditing(true);}if(e.target.tagName!="BODY"){this._saveSelection();}},customUndo:true,editActionInterval:3,beginEditing:function(cmd){if(!this._inEditing){this._inEditing=true;this._beginEditing(cmd);}if(this.editActionInterval>0){if(this._editTimer){this._editTimer.remove();}this._editTimer=this.defer("endEditing",this._editInterval);}},_steps:[],_undoedSteps:[],execCommand:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return this[cmd]();}else{if(this.customUndo){this.endEditing();this._beginEditing();}var r=this.inherited(arguments);if(this.customUndo){this._endEditing();}return r;}},_pasteImpl:function(){return this._clipboardCommand("paste");},_cutImpl:function(){return this._clipboardCommand("cut");},_copyImpl:function(){return this._clipboardCommand("copy");},_clipboardCommand:function(cmd){var r;try{r=this.document.execCommand(cmd,false,null);if(has("webkit")&&!r){throw {code:1011};}}catch(e){if(e.code==1011||(e.code==9&&has("opera"))){var sub=_e2f.substitute,_e47={cut:"X",copy:"C",paste:"V"};alert(sub(this.commands.systemShortcut,[this.commands[cmd],sub(this.commands[has("mac")?"appleKey":"ctrlKey"],[_e47[cmd]])]));}r=false;}return r;},queryCommandEnabled:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return cmd=="undo"?(this._steps.length>1):(this._undoedSteps.length>0);}else{return this.inherited(arguments);}},_moveToBookmark:function(b){var _e48=b.mark;var mark=b.mark;var col=b.isCollapsed;var r,_e49,_e4a,sel;if(mark){if(has("ie")<9){if(lang.isArray(mark)){_e48=[];_e27.forEach(mark,function(n){_e48.push(_e39.getNode(n,this.editNode));},this);win.withGlobal(this.window,"moveToBookmark",_e31,[{mark:_e48,isCollapsed:col}]);}else{if(mark.startContainer&&mark.endContainer){sel=_e39.getSelection(this.window);if(sel&&sel.removeAllRanges){sel.removeAllRanges();r=_e39.create(this.window);_e49=_e39.getNode(mark.startContainer,this.editNode);_e4a=_e39.getNode(mark.endContainer,this.editNode);if(_e49&&_e4a){r.setStart(_e49,mark.startOffset);r.setEnd(_e4a,mark.endOffset);sel.addRange(r);}}}}}else{sel=_e39.getSelection(this.window);if(sel&&sel.removeAllRanges){sel.removeAllRanges();r=_e39.create(this.window);_e49=_e39.getNode(mark.startContainer,this.editNode);_e4a=_e39.getNode(mark.endContainer,this.editNode);if(_e49&&_e4a){r.setStart(_e49,mark.startOffset);r.setEnd(_e4a,mark.endOffset);sel.addRange(r);}}}}},_changeToStep:function(from,to){this.setValue(to.text);var b=to.bookmark;if(!b){return;}this._moveToBookmark(b);},undo:function(){var ret=false;if(!this._undoRedoActive){this._undoRedoActive=true;this.endEditing(true);var s=this._steps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(s,this._steps[this._steps.length-1]);this._undoedSteps.push(s);this.onDisplayChanged();delete this._undoRedoActive;ret=true;}delete this._undoRedoActive;}return ret;},redo:function(){var ret=false;if(!this._undoRedoActive){this._undoRedoActive=true;this.endEditing(true);var s=this._undoedSteps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(this._steps[this._steps.length-1],s);this._steps.push(s);this.onDisplayChanged();ret=true;}delete this._undoRedoActive;}return ret;},endEditing:function(_e4b){if(this._editTimer){this._editTimer=this._editTimer.remove();}if(this._inEditing){this._endEditing(_e4b);this._inEditing=false;}},_getBookmark:function(){var b=win.withGlobal(this.window,_e31.getBookmark);var tmp=[];if(b&&b.mark){var mark=b.mark;if(has("ie")<9){var sel=_e39.getSelection(this.window);if(!lang.isArray(mark)){if(sel){var _e4c;if(sel.rangeCount){_e4c=sel.getRangeAt(0);}if(_e4c){b.mark=_e4c.cloneRange();}else{b.mark=win.withGlobal(this.window,_e31.getBookmark);}}}else{_e27.forEach(b.mark,function(n){tmp.push(_e39.getIndex(n,this.editNode).o);},this);b.mark=tmp;}}try{if(b.mark&&b.mark.startContainer){tmp=_e39.getIndex(b.mark.startContainer,this.editNode).o;b.mark={startContainer:tmp,startOffset:b.mark.startOffset,endContainer:b.mark.endContainer===b.mark.startContainer?tmp:_e39.getIndex(b.mark.endContainer,this.editNode).o,endOffset:b.mark.endOffset};}}catch(e){b.mark=null;}}return b;},_beginEditing:function(){if(this._steps.length===0){this._steps.push({"text":html.getChildrenHtml(this.editNode),"bookmark":this._getBookmark()});}},_endEditing:function(){var v=html.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:v,bookmark:this._getBookmark()});},onKeyDown:function(e){if(!has("ie")&&!this.iframe&&e.keyCode==keys.TAB&&!this.tabIndent){this._saveSelection();}if(!this.customUndo){this.inherited(arguments);return;}var k=e.keyCode;if(e.ctrlKey&&!e.altKey){if(k==90||k==122){_e2e.stop(e);this.undo();return;}else{if(k==89||k==121){_e2e.stop(e);this.redo();return;}}}this.inherited(arguments);switch(k){case keys.ENTER:case keys.BACKSPACE:case keys.DELETE:this.beginEditing();break;case 88:case 86:if(e.ctrlKey&&!e.altKey&&!e.metaKey){this.endEditing();if(e.keyCode==88){this.beginEditing("cut");}else{this.beginEditing("paste");}this.defer("endEditing",1);break;}default:if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.keyCode<keys.F1||e.keyCode>keys.F15)){this.beginEditing();break;}case keys.ALT:this.endEditing();break;case keys.UP_ARROW:case keys.DOWN_ARROW:case keys.LEFT_ARROW:case keys.RIGHT_ARROW:case keys.HOME:case keys.END:case keys.PAGE_UP:case keys.PAGE_DOWN:this.endEditing(true);break;case keys.CTRL:case keys.SHIFT:case keys.TAB:break;}},_onBlur:function(){this.inherited(arguments);this.endEditing(true);},_saveSelection:function(){try{this._savedSelection=this._getBookmark();}catch(e){}},_restoreSelection:function(){if(this._savedSelection){delete this._cursorToStart;if(win.withGlobal(this.window,"isCollapsed",_e31)){this._moveToBookmark(this._savedSelection);}delete this._savedSelection;}},onClick:function(){this.endEditing(true);this.inherited(arguments);},replaceValue:function(html){if(!this.customUndo){this.inherited(arguments);}else{if(this.isClosed){this.setValue(html);}else{this.beginEditing();if(!html){html="&#160;";}this.setValue(html);this.endEditing();}}},_setDisabledAttr:function(_e4d){this.setValueDeferred.then(lang.hitch(this,function(){if((!this.disabled&&_e4d)||(!this._buttonEnabledPlugins&&_e4d)){_e27.forEach(this._plugins,function(p){p.set("disabled",true);});}else{if(this.disabled&&!_e4d){_e27.forEach(this._plugins,function(p){p.set("disabled",false);});}}}));this.inherited(arguments);},_setStateClass:function(){try{this.inherited(arguments);if(this.document&&this.document.body){_e2d.set(this.document.body,"color",_e2d.get(this.iframe,"color"));}}catch(e){}}});function _e4e(args){return new _e37({command:args.name});};function _e4f(args){return new _e37({buttonClass:_e36,command:args.name});};lang.mixin(_e37.registry,{"undo":_e4e,"redo":_e4e,"cut":_e4e,"copy":_e4e,"paste":_e4e,"insertOrderedList":_e4e,"insertUnorderedList":_e4e,"indent":_e4e,"outdent":_e4e,"justifyCenter":_e4e,"justifyFull":_e4e,"justifyLeft":_e4e,"justifyRight":_e4e,"delete":_e4e,"selectAll":_e4e,"removeFormat":_e4e,"unlink":_e4e,"insertHorizontalRule":_e4e,"bold":_e4f,"italic":_e4f,"underline":_e4f,"strikethrough":_e4f,"subscript":_e4f,"superscript":_e4f,"|":function(){return new _e37({setEditor:function(_e50){this.editor=_e50;this.button=new _e34({ownerDocument:_e50.ownerDocument});}});}});return _e3c;});},"dojox/gauges/AnalogArcIndicator":function(){define("dojox/gauges/AnalogArcIndicator",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/fx","./AnalogIndicatorBase"],function(_e51,lang,_e52,fx,_e53){return _e51("dojox.gauges.AnalogArcIndicator",[_e53],{_createArc:function(val){if(this.shape){var _e54=this._gauge._mod360(this._gauge.startAngle);var a=this._gauge._getRadians(this._gauge._getAngle(val));var sa=this._gauge._getRadians(_e54);if(this._gauge.orientation=="cclockwise"){var tmp=a;a=sa;sa=tmp;}var _e55;var big=0;if(sa<=a){_e55=a-sa;}else{_e55=2*Math.PI+a-sa;}if(_e55>Math.PI){big=1;}var cosa=Math.cos(a);var sina=Math.sin(a);var _e56=Math.cos(sa);var _e57=Math.sin(sa);var off=this.offset+this.width;var p=["M"];p.push(this._gauge.cx+this.offset*_e57);p.push(this._gauge.cy-this.offset*_e56);p.push("A",this.offset,this.offset,0,big,1);p.push(this._gauge.cx+this.offset*sina);p.push(this._gauge.cy-this.offset*cosa);p.push("L");p.push(this._gauge.cx+off*sina);p.push(this._gauge.cy-off*cosa);p.push("A",off,off,0,big,0);p.push(this._gauge.cx+off*_e57);p.push(this._gauge.cy-off*_e56);p.push("z");this.shape.setShape(p.join(" "));this.currentValue=val;}},draw:function(_e58,_e59){var v=this.value;if(v<this._gauge.min){v=this._gauge.min;}if(v>this._gauge.max){v=this._gauge.max;}if(this.shape){if(_e59){this._createArc(v);}else{var anim=new fx.Animation({curve:[this.currentValue,v],duration:this.duration,easing:this.easing});_e52.connect(anim,"onAnimate",lang.hitch(this,this._createArc));anim.play();}}else{var _e5a=this.color?this.color:"black";var _e5b=this.strokeColor?this.strokeColor:_e5a;var _e5c={color:_e5b,width:1};if(this.color.type&&!this.strokeColor){_e5c.color=this.color.colors[0].color;}this.shape=_e58.createPath().setStroke(_e5c).setFill(_e5a);this._createArc(v);this.shape.connect("onmouseover",this,this.handleMouseOver);this.shape.connect("onmouseout",this,this.handleMouseOut);this.shape.connect("onmousedown",this,this.handleMouseDown);this.shape.connect("touchstart",this,this.handleTouchStart);}}});});},"url:esri/dijit/templates/Geocoder.html":"<div class=\"${theme}\" role=\"presentation\">\r\n    <div class=\"${_GeocoderContainerClass}\" role=\"presentation\">\r\n    \t<div class=\"${_GeocoderClass}\" data-dojo-attach-point=\"containerNode\" role=\"presentation\">\r\n    \t\t<div title=\"${_i18n.widgets.Geocoder.main.searchButtonTitle}\" tabindex=\"0\" class=\"${_searchButtonClass} ${_GeocoderIconClass}\" data-dojo-attach-point=\"submitNode\" data-dojo-attach-event=\"ondijitclick:_findThenSelect\" role=\"button\"></div>\r\n    \t\t<div aria-haspopup=\"true\" id=\"${id}_menu_button\" title=\"${_i18n.widgets.Geocoder.main.geocoderMenuButtonTitle}\" tabindex=\"0\" class=\"${_geocoderMenuArrowClass} ${_GeocoderIconClass}\" data-dojo-attach-point=\"geocoderMenuArrowNode\" role=\"button\" aria-expanded=\"false\" data-dojo-attach-event=\"ondijitclick:_toggleGeolocatorMenu\"></div>\r\n    \t\t<input aria-haspopup=\"true\" id=\"${id}_input\" tabindex=\"0\" placeholder=\"\" value=\"${value}\" autocomplete=\"off\" type=\"text\" data-dojo-attach-point=\"inputNode\" data-dojo-attach-event=\"ondijitclick:_inputClick\" role=\"textbox\">\r\n    \t\t<div tabindex=\"0\" class=\"${_clearButtonClass} ${_GeocoderIconClass}\" data-dojo-attach-point=\"clearNode\" data-dojo-attach-event=\"ondijitclick:clear\" role=\"button\"></div>\r\n    \t\t<div class=\"${_GeocoderClearClass}\" role=\"presentation\"></div>\r\n    \t</div>\r\n    \t<div class=\"${_resultsContainerClass}\" data-dojo-attach-point=\"resultsNode\" aria-labelledby=\"${id}_input\" role=\"menu\" aria-hidden=\"true\"></div>\r\n    \t<div class=\"${_geocoderMenuClass}\" data-dojo-attach-point=\"geocoderMenuNode\" role=\"presentation\">\r\n    \t\t<div class=\"${_geocoderMenuHeaderClass}\">\r\n    \t\t\t${_i18n.widgets.Geocoder.main.geocoderMenuHeader}\r\n    \t\t\t<div role=\"button\" data-dojo-attach-point=\"geocoderMenuCloseNode\" data-dojo-attach-event=\"ondijitclick:_hideGeolocatorMenu\" title=\"${_i18n.widgets.Geocoder.main.geocoderMenuCloseTitle}\" tabindex=\"0\" class=\"${_geocoderMenuCloseClass}\"></div>\r\n    \t\t\t<div class=\"${_GeocoderClearClass}\" role=\"presentation\"></div>\r\n    \t\t</div>\r\n    \t\t<div data-dojo-attach-point=\"geocoderMenuInsertNode\" aria-labelledby=\"${id}_menu_button\" role=\"menu\" aria-hidden=\"true\"></div>\r\n    \t</div>\r\n    </div>\r\n</div>","dijit/Toolbar":function(){define("dijit/Toolbar",["require","dojo/_base/declare","dojo/has","dojo/keys","dojo/ready","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_e5d,_e5e,has,keys,_e5f,_e60,_e61,_e62){if(has("dijit-legacy-requires")){_e5f(0,function(){var _e63=["dijit/ToolbarSeparator"];_e5d(_e63);});}return _e5e("dijit.Toolbar",[_e60,_e62,_e61],{templateString:"<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">"+"</div>",baseClass:"dijitToolbar",postCreate:function(){this.inherited(arguments);this.connectKeyNavHandlers(this.isLeftToRight()?[keys.LEFT_ARROW]:[keys.RIGHT_ARROW],this.isLeftToRight()?[keys.RIGHT_ARROW]:[keys.LEFT_ARROW]);}});});},"esri/dijit/Scalebar":function(){define("esri/dijit/Scalebar",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/query","esri/kernel","esri/lang","esri/domUtils","esri/units","esri/SpatialReference","esri/WKIDUnitConversion","esri/geometry/Point","esri/geometry/ScreenPoint","esri/geometry/Polyline","esri/geometry/geodesicUtils","esri/geometry/webMercatorUtils","esri/geometry/screenUtils","esri/geometry/normalizeUtils"],function(_e64,lang,_e65,conn,_e66,_e67,_e68,_e69,has,_e6a,_e6b,_e6c,_e6d,_e6e,_e6f,_e70,_e71,_e72,_e73,_e74,_e75,_e76,_e77){var _e78=_e64(null,{declaredClass:"esri.dijit.Scalebar",map:null,mapUnit:null,scalebarUnit:null,unitsDictionary:[],domNode:null,screenPt1:null,screenPt2:null,constructor:function(_e79,_e7a){this.metricScalebar=_e67.create("div",{innerHTML:"<div class='esriScaleLabelDiv'><div class='esriScalebarLabel esriScalebarLineLabel esriScalebarSecondNumber'></div></div><div class='esriScalebarLine esriScalebarMetricLine'></div>"});this.englishScalebar=_e67.create("div",{innerHTML:"<div class='esriScalebarLine esriScalebarEnglishLine'></div><div class='esriScaleLabelDiv'><div class='esriScalebarLabel esriScalebarLineLabel esriScalebarSecondNumber'></div></div>"});this.domNode=_e67.create("div");_e79=_e79||{};if(!_e79.map){console.error("scalebar: unable to find the 'map' property in parameters");return;}if(!_e79.scalebarUnit){this.scalebarUnit="english";}else{if(_e79.scalebarUnit!=="english"&&_e79.scalebarUnit!=="metric"&&_e79.scalebarUnit!=="dual"){console.error("scalebar unit only accepts english or metric or dual");return;}else{this.scalebarUnit=_e79.scalebarUnit;}}if(!_e79.scalebarStyle){this.scalebarStyle="ruler";}else{if(_e79.scalebarStyle!=="ruler"&&_e79.scalebarStyle!=="line"){console.error("scalebar style must be ruler or line");return;}else{this.scalebarStyle=_e79.scalebarStyle;}}this.background=_e79.background;switch(this.scalebarUnit){case "english":if(this.scalebarStyle==="ruler"){this.englishScalebar.innerHTML="<div class='esriScalebarRuler'><div class='esriScalebarRulerBlock upper_firstpiece'></div><div class='esriScalebarRulerBlock upper_secondpiece'></div><div class='esriScalebarRulerBlock lower_firstpiece'></div><div class='esriScalebarRulerBlock lower_secondpiece'></div></div><div class='scaleLabelDiv'><div class='esriScalebarLabel' style='left: -3%'>0</div><div class='esriScalebarLabel esriScalebarFirstNumber'></div><div class='esriScalebarLabel esriScalebarSecondNumber'></div></div>";}this.domNode.appendChild(this.englishScalebar);break;case "metric":if(this.scalebarStyle==="ruler"){this.metricScalebar.innerHTML="<div class='esriScalebarRuler'><div class='esriScalebarRulerBlock upper_firstpiece'></div><div class='esriScalebarRulerBlock upper_secondpiece'></div><div class='esriScalebarRulerBlock lower_firstpiece'></div><div class='esriScalebarRulerBlock lower_secondpiece'></div></div><div class='scaleLabelDiv'><div class='esriScalebarLabel' style='left: -3%'>0</div><div class='esriScalebarLabel esriScalebarFirstNumber'></div><div class='esriScalebarLabel esriScalebarSecondNumber'></div></div>";}this.domNode.appendChild(this.metricScalebar);break;case "dual":this.domNode.appendChild(this.metricScalebar);this.domNode.appendChild(this.englishScalebar);break;}this.map=_e79.map;if(_e7a){_e7a.appendChild(this.domNode);}else{this.map.container.appendChild(this.domNode);if(_e79.attachTo){_e66.add(this.domNode,"scalebar_"+_e79.attachTo);}else{_e66.add(this.domNode,"scalebar_bottom-left");}}_e66.add(this.domNode,"esriScalebar");if(this.map.loaded){this._getDistance(this.map.extent);this._checkBingMaps();}else{var _e7b=conn.connect(this.map,"onLoad",this,function(){conn.disconnect(_e7b);_e7b=null;this._getDistance(this.map.extent);this._checkBingMaps();});}this._mapOnPan=conn.connect(this.map,"onPan",this,this._getDistance);this._mapOnExtentChange=conn.connect(this.map,"onExtentChange",this,this._getDistance);_e65.forEach(this.map.layerIds,function(_e7c,idx){if(this.map.getLayer(_e7c).declaredClass==="esri.virtualearth.VETiledLayer"){conn.connect(this.map.getLayer(_e7c),"onVisibilityChange",lang.hitch(this,function(_e7d){this._checkBingMaps();}));}},this);this._mapOnLayerAdd=conn.connect(this.map,"onLayerAdd",lang.hitch(this,function(_e7e){if(_e7e.declaredClass==="esri.virtualearth.VETiledLayer"){conn.connect(_e7e,"onVisibilityChange",lang.hitch(this,function(_e7f){this._checkBingMaps();}));}this._checkBingMaps();}));this._mapOnLayerRemove=conn.connect(this.map,"onLayerRemove",lang.hitch(this,this._checkBingMaps));},hide:function(){this._hidden=true;_e6d.hide(this.domNode);},show:function(){this._hidden=false;_e6d.show(this.domNode);},destroy:function(){conn.disconnect(this._mapOnPan);conn.disconnect(this._mapOnExtentChange);conn.disconnect(this._mapOnLayerAdd);conn.disconnect(this._mapOnLayerRemove);this.hide();this.map=null;_e67.destroy(this.domNode);},_checkBingMaps:function(){if(_e66.contains(this.domNode,"scalebar_bottom-left")){_e69.set(this.domNode,"left","25px");_e65.forEach(this.map.layerIds,function(_e80,idx){if(this.map.getLayer(_e80).declaredClass==="esri.virtualearth.VETiledLayer"&&this.map.getLayer(_e80).visible){var _e81="95px";if(this.map._mapParams.nav){_e81="115px";}_e69.set(this.domNode,"left",_e81);}},this);}},_getDistance:function(_e82){var _e83=_e68.position(this.domNode,true);var _e84=_e83.y-this.map.position.y;_e84=(_e84>this.map.height)?this.map.height:_e84;_e84=(_e84<0)?0:_e84;var _e85=new _e72(0,_e84);var _e86=new _e72(this.map.width,_e84);var _e87,_e88,_e89,_e8a;this.mapUnit="esriDecimalDegrees";var pt1=_e76.toMapPoint(_e82,this.map.width,this.map.height,_e85);var pt2=_e76.toMapPoint(_e82,this.map.width,this.map.height,_e86);var _e8b=new _e71(_e82.xmin,(_e82.ymin+_e82.ymax)/2,this.map.spatialReference);var _e8c=new _e71(_e82.xmax,(_e82.ymin+_e82.ymax)/2,this.map.spatialReference);if(this.map.spatialReference.wkid===3857||this.map.spatialReference.wkid===102100||this.map.spatialReference.wkid===102113||(this.map.spatialReference.wkt&&this.map.spatialReference.wkt.indexOf("WGS_1984_Web_Mercator")!=-1)){pt1=_e75.webMercatorToGeographic(pt1,true);pt2=_e75.webMercatorToGeographic(pt2,true);_e8b=_e75.webMercatorToGeographic(_e8b,true);_e8c=_e75.webMercatorToGeographic(_e8c,true);}else{if(_e6c.isDefined(_e70[this.map.spatialReference.wkid])||(this.map.spatialReference.wkt&&this.map.spatialReference.wkt.indexOf("PROJCS")===0)){this.mapUnit="linearUnit";_e87=Math.abs(_e82.xmax-_e82.xmin);var _e8d;if(_e6c.isDefined(_e70[this.map.spatialReference.wkid])){_e8d=_e70.values[_e70[this.map.spatialReference.wkid]];}else{var wkt=this.map.spatialReference.wkt;var _e8e=wkt.lastIndexOf(",")+1;var end=wkt.lastIndexOf("]]");_e8d=parseFloat(wkt.substring(_e8e,end));}_e87*=_e8d;_e8a=_e87/1609;_e89=_e87/1000;_e87/=1000;}}if(this.mapUnit==="esriDecimalDegrees"){var line=new _e73(new _e6f({wkid:4326}));line.addPath([pt1,pt2]);var _e8f=_e77._straightLineDensify(line,10);_e87=_e74.geodesicLengths([_e8f],_e6e.KILOMETERS)[0];var _e90=new _e73(new _e6f({wkid:4326}));_e90.addPath([_e8b,_e8c]);var _e91=_e77._straightLineDensify(_e90,10);_e88=_e74.geodesicLengths([_e91],_e6e.KILOMETERS)[0];_e8a=_e87/1.609;_e88/=1.609;_e89=_e87;}if(this.scalebarUnit==="english"){this._getScaleBarLength(_e8a,"mi");}else{if(this.scalebarUnit==="metric"){this._getScaleBarLength(_e89,"km");}else{if(this.scalebarUnit==="dual"){this._getScaleBarLength(_e8a,"mi");this._getScaleBarLength(_e89,"km");}}}},_getScaleBarLength:function(_e92,unit){var _e93=50;var _e94=_e93*_e92/this.map.width;var i=0;var _e95=unit;if(_e94<0.1){if(unit==="mi"){_e94*=5280;_e95="ft";}else{if(unit==="km"){_e94*=1000;_e95="m";}}}while(_e94>=1){_e94/=10;i++;}var _e96,_e97;if(_e94>0.5){_e96=1;_e97=0.5;}else{if(_e94>0.3){_e96=0.5;_e97=0.3;}else{if(_e94>0.2){_e96=0.3;_e97=0.2;}else{if(_e94>0.15){_e96=0.2;_e97=0.15;}else{if(_e94>0.1){_e96=0.15;_e97=0.1;}}}}}var _e98=((_e96/_e94)>=(_e94/_e97))?_e97:_e96;var _e99=_e98/_e94;var _e9a=_e93*_e99;var _e9b=Math.pow(10,i)*_e98;this._drawScaleBar(_e9a,_e9b,_e95);},_drawScaleBar:function(_e9c,_e9d,_e9e){var _e9f=2*Math.round(_e9c),_ea0,_ea1,_ea2;if(_e9e==="mi"||_e9e==="ft"){this.englishScalebar.style.width=_e9f+"px";_ea0=_e6a(".esriScalebarFirstNumber",this.englishScalebar);_ea1=_e6a(".esriScalebarSecondNumber",this.englishScalebar);_ea2=_e6a(".esriScalebarMetricLineBackground",this.englishScalebar);}else{this.metricScalebar.style.width=_e9f+"px";_ea0=_e6a(".esriScalebarFirstNumber",this.metricScalebar);_ea1=_e6a(".esriScalebarSecondNumber",this.metricScalebar);_ea2=_e6a(".esriScalebarMetricLineBackground",this.metricScalebar);}_e65.forEach(_ea2,function(_ea3,idx){_ea3.style.width=_e9f-2+"px";},this);_e65.forEach(_ea0,function(_ea4,idx){_ea4.innerHTML=_e9d;},this);_e65.forEach(_ea1,function(_ea5,idx){if(this.mapUnit!=="esriUnknown"){_ea5.innerHTML=2*_e9d+_e9e;}else{_ea5.innerHTML=2*_e9d+"Unknown Unit";}},this);}});if(has("extend-esri")){lang.setObject("dijit.Scalebar",_e78,_e6b);}return _e78;});},"dojo/fx/easing":function(){define(["../_base/lang"],function(lang){var _ea6={linear:function(n){return n;},quadIn:function(n){return Math.pow(n,2);},quadOut:function(n){return n*(n-2)*-1;},quadInOut:function(n){n=n*2;if(n<1){return Math.pow(n,2)/2;}return -1*((--n)*(n-2)-1)/2;},cubicIn:function(n){return Math.pow(n,3);},cubicOut:function(n){return Math.pow(n-1,3)+1;},cubicInOut:function(n){n=n*2;if(n<1){return Math.pow(n,3)/2;}n-=2;return (Math.pow(n,3)+2)/2;},quartIn:function(n){return Math.pow(n,4);},quartOut:function(n){return -1*(Math.pow(n-1,4)-1);},quartInOut:function(n){n=n*2;if(n<1){return Math.pow(n,4)/2;}n-=2;return -1/2*(Math.pow(n,4)-2);},quintIn:function(n){return Math.pow(n,5);},quintOut:function(n){return Math.pow(n-1,5)+1;},quintInOut:function(n){n=n*2;if(n<1){return Math.pow(n,5)/2;}n-=2;return (Math.pow(n,5)+2)/2;},sineIn:function(n){return -1*Math.cos(n*(Math.PI/2))+1;},sineOut:function(n){return Math.sin(n*(Math.PI/2));},sineInOut:function(n){return -1*(Math.cos(Math.PI*n)-1)/2;},expoIn:function(n){return (n==0)?0:Math.pow(2,10*(n-1));},expoOut:function(n){return (n==1)?1:(-1*Math.pow(2,-10*n)+1);},expoInOut:function(n){if(n==0){return 0;}if(n==1){return 1;}n=n*2;if(n<1){return Math.pow(2,10*(n-1))/2;}--n;return (-1*Math.pow(2,-10*n)+2)/2;},circIn:function(n){return -1*(Math.sqrt(1-Math.pow(n,2))-1);},circOut:function(n){n=n-1;return Math.sqrt(1-Math.pow(n,2));},circInOut:function(n){n=n*2;if(n<1){return -1/2*(Math.sqrt(1-Math.pow(n,2))-1);}n-=2;return 1/2*(Math.sqrt(1-Math.pow(n,2))+1);},backIn:function(n){var s=1.70158;return Math.pow(n,2)*((s+1)*n-s);},backOut:function(n){n=n-1;var s=1.70158;return Math.pow(n,2)*((s+1)*n+s)+1;},backInOut:function(n){var s=1.70158*1.525;n=n*2;if(n<1){return (Math.pow(n,2)*((s+1)*n-s))/2;}n-=2;return (Math.pow(n,2)*((s+1)*n+s)+2)/2;},elasticIn:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;n=n-1;return -1*Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p);},elasticOut:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;return Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p)+1;},elasticInOut:function(n){if(n==0){return 0;}n=n*2;if(n==2){return 1;}var p=0.3*1.5;var s=p/4;if(n<1){n-=1;return -0.5*(Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p));}n-=1;return 0.5*(Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p))+1;},bounceIn:function(n){return (1-_ea6.bounceOut(1-n));},bounceOut:function(n){var s=7.5625;var p=2.75;var l;if(n<(1/p)){l=s*Math.pow(n,2);}else{if(n<(2/p)){n-=(1.5/p);l=s*Math.pow(n,2)+0.75;}else{if(n<(2.5/p)){n-=(2.25/p);l=s*Math.pow(n,2)+0.9375;}else{n-=(2.625/p);l=s*Math.pow(n,2)+0.984375;}}}return l;},bounceInOut:function(n){if(n<0.5){return _ea6.bounceIn(n*2)/2;}return (_ea6.bounceOut(n*2-1)/2)+0.5;}};lang.setObject("dojo.fx.easing",_ea6);return _ea6;});},"esri/layers/SnapshotMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/SpatialReference","esri/tasks/query","esri/layers/RenderMode"],function(_ea7,lang,has,_ea8,_ea9,_eaa,_eab){var _eac=_ea7([_eab],{declaredClass:"esri.layers._SnapshotMode",constructor:function(_ead){this.featureLayer=_ead;this._featureMap={};this._drawFeatures=lang.hitch(this,this._drawFeatures);this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},startup:function(){if(this.featureLayer._collection){this._applyTimeFilter();}else{this._fetchAll();}},propertyChangeHandler:function(type){if(this._init){if(type){if(this.featureLayer._collection){console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id = "+this.featureLayer.id);}else{this._fetchAll();}}else{this._applyTimeFilter();}}},drawFeature:function(_eae){var _eaf=this.featureLayer,_eb0=_eaf.objectIdField,oid=_eae.attributes[_eb0];this._addFeatureIIf(oid,_eae);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _eb1=this.featureLayer;if(_eb1._collection){_eb1._fireUpdateStart();_eb1._refresh(true);_eb1._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_eb2){var id="_"+_eb2.name+_eb2.layerId+_eb2._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _eb3=this.featureLayer;if(_eb3._collection){return;}_eb3._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_eb4=this.featureLayer,_eb5=_eb4.getDefinitionExpression();var _eb6=new _eaa();_eb6.outFields=_eb4.getOutFields();_eb6.where=_eb5||"1=1";_eb6.returnGeometry=true;_eb6.outSpatialReference=new _ea9(map.spatialReference.toJson());_eb6.timeExtent=_eb4.getTimeDefinition();_eb6.maxAllowableOffset=_eb4._maxOffset;if(_eb4._ts){_eb6._ts=(new Date()).getTime();}var _eb7;if(_eb4._usePatch){_eb7=this._getRequestId(_eb4);this._cancelPendingRequest(null,_eb7);}_eb4._task.execute(_eb6,this._drawFeatures,this._queryErrorHandler,_eb7);},_drawFeatures:function(_eb8){this._purgeRequests();var _eb9=_eb8.features,_eba=this.featureLayer,_ebb=_eba.objectIdField,i,len=_eb9.length,_ebc,oid;for(i=0;i<len;i++){_ebc=_eb9[i];oid=_ebc.attributes[_ebb];this._addFeatureIIf(oid,_ebc);this._incRefCount(oid);}this._applyTimeFilter(true);_eba._fireUpdateEnd(null,_eb8.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_eb8.exceededTransferLimit){_eba.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _ebd=this.featureLayer;_ebd._errorHandler(err);_ebd._fireUpdateEnd(err);}});if(has("extend-esri")){lang.setObject("layers._SnapshotMode",_eac,_ea8);}return _eac;});},"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n","esri/dijit/InfoView":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/kernel","dojo/has","dojo/query","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","esri/kernel","esri/dijit/_TouchBase"],function(_ebe,lang,_ebf,_ec0,_ec1,has,_ec2,dom,_ec3,_ec4,_ec5,_ec6,_ec7){var IV=_ebe(null,{declaredClass:"esri.dijit.InfoView",_items:[],_top:null,_sections:[],_isDecelerate:false,constructor:function(_ec8,_ec9){var i;this.container=dom.byId(_ec9);this._touchBase=_ec7(this.container,null);this._slideDiv=_ec4.create("div",null,this.container,"first");this.events=[];this._items=_ec8.items;if(_ec8.sections){this._sections=_ec8.sections;}_ec3.add(this.container,"esriMobileInfoView");if(this._sections.length===0){_ec4.create("div",{},this._slideDiv);}else{for(i=0;i<this._sections.length;i++){var _eca=_ec4.create("div",{"class":"esriMobileInfoViewSection"},this._slideDiv);_ec4.create("div",{innerHTML:this._sections[i].title},_eca);}}for(i=0;i<this._items.length;i++){var node,div;var _ecb=0;if(this._items[i].section){_ecb=this._items[i].section;}switch(this._items[i].type){case "div":div=_ec4.create("div",{"class":"esriMobileInfoViewItem",style:this._items[i].style},this._slideDiv.childNodes[_ecb]);node=_ec4.create("div",{innerHTML:this._items[i].text},div);break;}if(this._items[i].className){_ec3.add(node,this._items[i].className);}node._index=i;node._item=this._items[i];this._items[i]._node=node;}this.startTouchY=0;},startup:function(){this.onCreate(this._items);this._animateTo(0);},destroy:function(){_ebf.forEach(this.events,_ec0.disconnect);this._touchBase=null;_ec1.query("img",this.container).forEach(function(node){node._index=null;node._item=null;_ec4.destroy(node);node=null;});this._items=null;_ec4.destroy(this._slideDiv);_ec4.destroy(this.container);this.container=this._slideDiv=null;},getItems:function(){return this._items;},setPreventDefault:function(_ecc){this._touchBase.setPreventDefault(_ecc);},enableTouchScroll:function(){this._touchBase.setPreventDefault(true);this.events.push(_ec0.connect(this._touchBase,"onTouchStart",this,this._onTouchStartHandler));this.events.push(_ec0.connect(this._touchBase,"onTouchMove",this,this._onTouchMoveHandler));this.events.push(_ec0.connect(this._touchBase,"onTouchEnd",this,this._onTouchEndHandler));this._slideDiv.style.webkitTransform="translate3d(0,"+this._top+"px, 0)";},disableTouchScroll:function(){_ec0.disconnect(this.events.pop());_ec0.disconnect(this.events.pop());_ec0.disconnect(this.events.pop());this._touchBase.setPreventDefault(false);this._slideDiv.style.webkitTransform="translate3d(0, 0px, 0)";},animateTo:function(){this._slideDiv.style.WebkitTransitionDuration="0s";this._animateTo(0);},onSelect:function(item){},onUnSelect:function(item){},onCreate:function(_ecd){},onClick:function(e){},onSwipeLeft:function(){},onSwipeRight:function(){},_onTouchStartHandler:function(e){this._slideDiv.style.WebkitTransitionDuration="0s";this._moveDirection=null;this._startTime=new Date();this.startTouchY=e.touches[0].clientY;this.contentStartOffsetY=this.contentOffsetY;},_onTouchMoveHandler:function(e){if(!this._moveDirection){if(Math.abs(e.curY)>Math.abs(e.curX)){this._moveDirection="vertical";}else{this._moveDirection="horizontal";}}if(this._moveDirection==="horizontal"){return;}else{if(this._moveDirection==="vertical"){var _ece=e.touches[0].clientY;var _ecf=_ece-this.startTouchY;var newY=_ecf+this.contentStartOffsetY;this._animateTo(newY);}}},_onTouchEndHandler:function(e){this._endTime=new Date();this._deltaMovement=e.curY;if(this._moveDirection==="vertical"){if(this._shouldStartMomentum()){this._doMomentum();}else{this._snapToBounds();}}else{if(this._moveDirection==="horizontal"){if(e.swipeDirection==="left"){this.onSwipeLeft();}else{if(e.swipeDirection==="right"){this.onSwipeRight();}}}}},_shouldStartMomentum:function(){this._diff=this._endTime-this._startTime;this._velocity=this._deltaMovement/this._diff;if(Math.abs(this._velocity)>0.2&&this._diff<200){return true;}else{return false;}},_pullToStop:function(_ed0){if(Math.abs(_ed0)>80){_ed0=_ed0>0?80:(-contentBox.h+parentBox.h-10)-80;}console.log(_ed0);this._slideDiv.style.webkitTransition="-webkit-transform 200ms cubic-bezier(0, 0, 1, 1)";var _ed1=_ec0.connect(this._slideDiv,"webkitTransitionEnd",this,function(){if(_ed0>0){this._animateTo(0);}else{this._animateTo(-contentBox.h+parentBox.h-10);}_ec0.disconnect(_ed1);});this._animateTo(_ed0);},_doMomentum:function(){var i;var il;var _ed2=_ec5.getContentBox(this.container);var _ed3=this._velocity<0?0.001:-0.001;var _ed4=-(this._velocity*this._velocity)/(2*_ed3);var time=-this._velocity/_ed3;var p0={x:0,y:0};var p1={x:0,y:0.3};var p2={x:0.6,y:1};var p3={x:1,y:1};var cx=3*(p1.x-p0.x);var bx=3*(p2.x-p1.x)-cx;var ax=p3.x-p0.x-cx-bx;var cy=3*(p1.y-p0.y);var by=3*(p2.y-p1.y)-cy;var ay=p3.y-p0.y-cy-by;var temp=0,_ed5=0;if(_ed2.h>this._slideDiv.scrollHeight){this.contentOffsetY=0;_ed5=300;}else{if(this.contentOffsetY+_ed4>0){for(i=0,il=Math.floor(time/20);i<il;i++){temp=(ax*(i*20)^3)+(bx*(i*20)^2)+cx*(i*20)+p0.x;temp=this._velocity<0?-temp:temp;if(this.contentOffsetY+temp>0){_ed5=i*20;break;}}if(_ed5===0){_ed5=300;}this.contentOffsetY=0;}else{if(Math.abs(this.contentOffsetY+_ed4)+_ed2.h>this._slideDiv.scrollHeight){this.contentOffsetY=_ed2.h-this._slideDiv.scrollHeight;for(i=0,il=Math.floor(time/20);i<il;i++){temp=(ax*(i*20)^3)+(bx*(i*20)^2)+cx*(i*20)+p0.x;temp=this._velocity<0?-temp:temp;if(Math.abs(this.contentOffsetY+temp)>this._slideDiv.scrollHeight){_ed5=i*20;break;}}}else{_ed5=time;this.contentOffsetY=this.contentOffsetY+_ed4;}}}this._slideDiv.style.webkitTransition="-webkit-transform "+_ed5+"ms cubic-bezier(0, 0.3, 0.6, 1)";this._animateTo(this.contentOffsetY);},_snapToBounds:function(){var _ed6=_ec5.getContentBox(this.container);if(_ed6.h>this._slideDiv.scrollHeight){this.contentOffsetY=0;}else{if(this.contentOffsetY>0){this.contentOffsetY=0;}else{if(Math.abs(this.contentOffsetY)+_ed6.h>this._slideDiv.scrollHeight){this.contentOffsetY=_ed6.h-this._slideDiv.scrollHeight;}}}this._slideDiv.style.WebkitTransitionDuration="0.5s";this._animateTo(this.contentOffsetY);},_animateTo:function(_ed7){this.contentOffsetY=_ed7;this._slideDiv.style.webkitTransform="translate3d(0, "+_ed7+"px, 0)";},_stopMomentum:function(){if(this._isDecelerating()){var _ed8=document.defaultView.getComputedStyle(this._slideDiv,null);var _ed9=new WebKitCSSMatrix(_ed8.webkitTransform);this._slideDiv.style.webkitTransition="";this.animateTo(_ed9.m42);}},_isDecelerating:function(){if(this.isDecelerate){return true;}else{return false;}},_toggleNode:function(_eda,item){if(item.toggleState==="ON"){item.toggleState="OFF";if(item.src){_eda.src=item.src.toString();}this.onUnSelect(item);}else{item.toggleState="ON";if(item.srcAlt){_eda.src=item.srcAlt;}this.onSelect(item);}}});if(has("extend-esri")){lang.setObject("dijit.InfoView",IV,_ec6);}return IV;});},"dijit/DropDownMenu":function(){require({cache:{"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n"}});define("dijit/DropDownMenu",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(_edb,_edc,keys,_edd,_ede,_edf){return _edb("dijit.DropDownMenu",[_edf,_ede],{templateString:_edd,baseClass:"dijitMenu",postCreate:function(){this.inherited(arguments);var l=this.isLeftToRight();this._openSubMenuKey=l?keys.RIGHT_ARROW:keys.LEFT_ARROW;this._closeSubMenuKey=l?keys.LEFT_ARROW:keys.RIGHT_ARROW;this.connectKeyNavHandlers([keys.UP_ARROW],[keys.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_edc.stop(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_edc.stop(evt);}break;}}});});},"dijit/_editor/plugins/LinkDialog":function(){define("dijit/_editor/plugins/LinkDialog",["require","dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/_base/query","dojo/string","../../_Widget","../_Plugin","../../form/DropDownButton","../range"],function(_ee0,_ee1,_ee2,keys,lang,has,_ee3,_ee4,_ee5,_ee6,_ee7,_ee8){var _ee9=_ee1("dijit._editor.plugins.LinkDialog",_ee6,{buttonClass:_ee7,useDefaultCommand:false,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",emailRegExp:"<?(mailto\\:)([!#-'*+\\-\\/-9=?A-Z^-~]+[.])*[!#-'*+\\-\\/-9=?A-Z^-~]+"+"@"+"((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*>?",htmlTemplate:"<a href=\"${urlInput}\" _djrealurl=\"${urlInput}\""+" target=\"${targetSelect}\""+">${textInput}</a>",tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,linkDialogTemplate:["<table role='presentation'><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='true' "+"id='${id}_urlInput' name='urlInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='true' id='${id}_textInput' "+"name='textInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_targetSelect'>${target}</label>","</td><td>","<select id='${id}_targetSelect' name='targetSelect' data-dojo-type='dijit.form.Select'>","<option selected='selected' value='_self'>${currentWindow}</option>","<option value='_blank'>${newWindow}</option>","<option value='_top'>${topWindow}</option>","<option value='_parent'>${parentWindow}</option>","</select>","</td></tr><tr><td colspan='2'>","<button data-dojo-type='dijit.form.Button' type='submit' id='${id}_setButton'>${set}</button>","<button data-dojo-type='dijit.form.Button' type='button' id='${id}_cancelButton'>${buttonCancel}</button>","</td></tr></table>"].join(""),_initButton:function(){this.inherited(arguments);this.button.loadDropDown=lang.hitch(this,"_loadDropDown");this._connectTagEvents();},_loadDropDown:function(_eea){_ee0(["dojo/i18n","../../TooltipDialog","../../registry","../../form/Button","../../form/Select","../../form/ValidationTextBox","dojo/i18n!../../nls/common","dojo/i18n!../nls/LinkDialog"],lang.hitch(this,function(i18n,_eeb,_eec){var _eed=this;this.tag=this.command=="insertImage"?"img":"a";var _eee=lang.delegate(i18n.getLocalization("dijit","common",this.lang),i18n.getLocalization("dijit._editor","LinkDialog",this.lang));var _eef=(this.dropDown=this.button.dropDown=new _eeb({title:_eee[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:lang.hitch(this,"setValue"),onOpen:function(){_eed._onOpenDialog();_eeb.prototype.onOpen.apply(this,arguments);},onCancel:function(){setTimeout(lang.hitch(_eed,"_onCloseDialog"),0);}}));_eee.urlRegExp=this.urlRegExp;_eee.id=_eec.getUniqueId(this.editor.id);this._uniqueId=_eee.id;this._setContent(_eef.title+"<div style='border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'></div>"+_ee4.substitute(this.linkDialogTemplate,_eee));_eef.startup();this._urlInput=_eec.byId(this._uniqueId+"_urlInput");this._textInput=_eec.byId(this._uniqueId+"_textInput");this._setButton=_eec.byId(this._uniqueId+"_setButton");this.connect(_eec.byId(this._uniqueId+"_cancelButton"),"onClick",function(){this.dropDown.onCancel();});if(this._urlInput){this.connect(this._urlInput,"onChange","_checkAndFixInput");}if(this._textInput){this.connect(this._textInput,"onChange","_checkAndFixInput");}this._urlRegExp=new RegExp("^"+this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=lang.hitch(this,function(){var _ef0=this._urlInput.get("value");return this._urlRegExp.test(_ef0)||this._emailRegExp.test(_ef0);});this.connect(_eef.domNode,"onkeypress",function(e){if(e&&e.charOrCode==keys.ENTER&&!e.shiftKey&&!e.metaKey&&!e.ctrlKey&&!e.altKey){if(!this._setButton.get("disabled")){_eef.onExecute();_eef.execute(_eef.get("value"));}}});_eea();}));},_checkAndFixInput:function(){var self=this;var url=this._urlInput.get("value");var _ef1=function(url){var _ef2=false;var _ef3=false;if(url&&url.length>1){url=lang.trim(url);if(url.indexOf("mailto:")!==0){if(url.indexOf("/")>0){if(url.indexOf("://")===-1){if(url.charAt(0)!=="/"&&url.indexOf("./")&&url.indexOf("../")!==0){if(self._hostRxp.test(url)){_ef2=true;}}}}else{if(self._userAtRxp.test(url)){_ef3=true;}}}}if(_ef2){self._urlInput.set("value","http://"+url);}if(_ef3){self._urlInput.set("value","mailto:"+url);}self._setButton.set("disabled",!self._isValid());};if(this._delayedCheck){clearTimeout(this._delayedCheck);this._delayedCheck=null;}this._delayedCheck=setTimeout(function(){_ef1(url);},250);},_connectTagEvents:function(){this.editor.onLoadDeferred.then(lang.hitch(this,function(){this.connect(this.editor.editNode,"ondblclick",this._onDblClick);}));},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid();},_setContent:function(_ef4){this.dropDown.set({parserScope:"dojo",content:_ef4});},_checkValues:function(args){if(args&&args.urlInput){args.urlInput=args.urlInput.replace(/"/g,"&quot;");}return args;},setValue:function(args){this._onCloseDialog();if(has("ie")<9){var sel=_ee8.getSelection(this.editor.window);var _ef5=sel.getRangeAt(0);var a=_ef5.endContainer;if(a.nodeType===3){a=a.parentNode;}if(a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){a=this.editor._sCall("getSelectedElement",[this.tag]);}if(a&&(a.nodeName&&a.nodeName.toLowerCase()===this.tag)){if(this.editor.queryCommandEnabled("unlink")){this.editor._sCall("selectElementChildren",[a]);this.editor.execCommand("unlink");}}}args=this._checkValues(args);this.editor.execCommand("inserthtml",_ee4.substitute(this.htmlTemplate,args));_ee3("a",this.editor.document).forEach(function(a){if(!a.innerHTML&&!_ee2.has(a,"name")){a.parentNode.removeChild(a);}},this);},_onCloseDialog:function(){this.editor.focus();},_getCurrentValues:function(a){var url,text,_ef6;if(a&&a.tagName.toLowerCase()===this.tag){url=a.getAttribute("_djrealurl")||a.getAttribute("href");_ef6=a.getAttribute("target")||"_self";text=a.textContent||a.innerText;this.editor._sCall("selectElement",[a,true]);}else{text=this.editor._sCall("getSelectedText");}return {urlInput:url||"",textInput:text||"",targetSelect:_ef6||""};},_onOpenDialog:function(){var a,b,fc;if(has("ie")){var sel=_ee8.getSelection(this.editor.window);if(sel.rangeCount){var _ef7=sel.getRangeAt(0);a=_ef7.endContainer;if(a.nodeType===3){a=a.parentNode;}if(a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){a=this.editor._sCall("getSelectedElement",[this.tag]);}if(!a||(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){b=this.editor._sCall("getAncestorElement",[this.tag]);if(b&&(b.nodeName&&b.nodeName.toLowerCase()==this.tag)){a=b;this.editor._sCall("selectElement",[a]);}else{if(_ef7.startContainer===_ef7.endContainer){fc=_ef7.startContainer.firstChild;if(fc&&(fc.nodeName&&fc.nodeName.toLowerCase()==this.tag)){a=fc;this.editor._sCall("selectElement",[a]);}}}}}}else{a=this.editor._sCall("getAncestorElement",[this.tag]);}this.dropDown.reset();this._setButton.set("disabled",true);this.dropDown.set("value",this._getCurrentValues(a));},_onDblClick:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag&&_ee2.get(t,"href")){var _ef8=this.editor;this.editor._sCall("selectElement",[t]);_ef8.onDisplayChanged();if(_ef8._updateTimer){_ef8._updateTimer.remove();delete _ef8._updateTimer;}_ef8.onNormalizedDisplayChanged();var _ef9=this.button;setTimeout(function(){_ef9.set("disabled",false);_ef9.loadAndOpenDropDown().then(function(){if(_ef9.dropDown.focus){_ef9.dropDown.focus();}});},10);}}}});var _efa=_ee1("dijit._editor.plugins.ImgLinkDialog",[_ee9],{linkDialogTemplate:["<table role='presentation'><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input dojoType='dijit.form.ValidationTextBox' regExp='${urlRegExp}' "+"required='true' id='${id}_urlInput' name='urlInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='false' id='${id}_textInput' "+"name='textInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","</td><td>","</td></tr><tr><td colspan='2'>","<button data-dojo-type='dijit.form.Button' type='submit' id='${id}_setButton'>${set}</button>","<button data-dojo-type='dijit.form.Button' type='button' id='${id}_cancelButton'>${buttonCancel}</button>","</td></tr></table>"].join(""),htmlTemplate:"<img src=\"${urlInput}\" _djrealurl=\"${urlInput}\" alt=\"${textInput}\" />",tag:"img",_getCurrentValues:function(img){var url,text;if(img&&img.tagName.toLowerCase()===this.tag){url=img.getAttribute("_djrealurl")||img.getAttribute("src");text=img.getAttribute("alt");this.editor._sCall("selectElement",[img,true]);}else{text=this.editor._sCall("getSelectedText",[]);}return {urlInput:url||"",textInput:text||""};},_isValid:function(){return this._urlInput.isValid();},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(lang.hitch(this,function(){this.connect(this.editor.editNode,"onmousedown",this._selectTag);}));},_selectTag:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag){this.editor._sCall("selectElement",[t]);}}},_checkValues:function(args){if(args&&args.urlInput){args.urlInput=args.urlInput.replace(/"/g,"&quot;");}if(args&&args.textInput){args.textInput=args.textInput.replace(/"/g,"&quot;");}return args;},_onDblClick:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag&&_ee2.get(t,"src")){var _efb=this.editor;this.editor._sCall("selectElement",[t]);_efb.onDisplayChanged();if(_efb._updateTimer){_efb._updateTimer.remove();delete _efb._updateTimer;}_efb.onNormalizedDisplayChanged();var _efc=this.button;setTimeout(function(){_efc.set("disabled",false);_efc.loadAndOpenDropDown().then(function(){if(_efc.dropDown.focus){_efc.dropDown.focus();}});},10);}}}});_ee6.registry["createLink"]=function(){return new _ee9({command:"createLink"});};_ee6.registry["insertImage"]=function(){return new _efa({command:"insertImage"});};_ee9.ImgLinkDialog=_efa;return _ee9;});},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(lang,_efd,_efe){var _eff={};lang.setObject("dojo.data.util.simpleFetch",_eff);_eff.errorHandler=function(_f00,_f01){if(_f01.onError){var _f02=_f01.scope||_efd.global;_f01.onError.call(_f02,_f00,_f01);}};_eff.fetchHandler=function(_f03,_f04){var _f05=_f04.abort||null,_f06=false,_f07=_f04.start?_f04.start:0,_f08=(_f04.count&&(_f04.count!==Infinity))?(_f07+_f04.count):_f03.length;_f04.abort=function(){_f06=true;if(_f05){_f05.call(_f04);}};var _f09=_f04.scope||_efd.global;if(!_f04.store){_f04.store=this;}if(_f04.onBegin){_f04.onBegin.call(_f09,_f03.length,_f04);}if(_f04.sort){_f03.sort(_efe.createSortFunction(_f04.sort,this));}if(_f04.onItem){for(var i=_f07;(i<_f03.length)&&(i<_f08);++i){var item=_f03[i];if(!_f06){_f04.onItem.call(_f09,item,_f04);}}}if(_f04.onComplete&&!_f06){var _f0a=null;if(!_f04.onItem){_f0a=_f03.slice(_f07,_f08);}_f04.onComplete.call(_f09,_f0a,_f04);}};_eff.fetch=function(_f0b){_f0b=_f0b||{};if(!_f0b.store){_f0b.store=this;}this._fetchItems(_f0b,lang.hitch(this,"fetchHandler"),lang.hitch(this,"errorHandler"));return _f0b;};return _eff;});},"dijit/Menu":function(){define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(_f0c,_f0d,_f0e,_f0f,dom,_f10,_f11,_f12,keys,lang,on,has,win,_f13,pm,_f14,_f15){if(has("dijit-legacy-requires")){_f15(0,function(){var _f16=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];_f0c(_f16);});}return _f0e("dijit.Menu",_f14,{constructor:function(){this._bindings=[];},targetNodeIds:[],selector:"",contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(this.ownerDocumentBody);}else{_f0d.forEach(this.targetNodeIds,this.bindDomNode,this);}this.inherited(arguments);},_iframeContentWindow:function(_f17){return _f13.get(this._iframeContentDocument(_f17))||this._iframeContentDocument(_f17)["__parent__"]||(_f17.name&&win.doc.frames[_f17.name])||null;},_iframeContentDocument:function(_f18){return _f18.contentDocument||(_f18.contentWindow&&_f18.contentWindow.document)||(_f18.name&&win.doc.frames[_f18.name]&&win.doc.frames[_f18.name].document)||null;},bindDomNode:function(node){node=dom.byId(node,this.ownerDocument);var cn;if(node.tagName.toLowerCase()=="iframe"){var _f19=node,_f1a=this._iframeContentWindow(_f19);cn=win.body(_f1a.document);}else{cn=(node==win.body(this.ownerDocument)?this.ownerDocument.documentElement:node);}var _f1b={node:node,iframe:_f19};_f10.set(node,"_dijitMenu"+this.id,this._bindings.push(_f1b));var _f1c=lang.hitch(this,function(cn){var _f1d=this.selector,_f1e=_f1d?function(_f1f){return on.selector(_f1d,_f1f);}:function(_f20){return _f20;},self=this;return [on(cn,_f1e(this.leftClickToOpen?"click":"contextmenu"),function(evt){_f0f.stop(evt);self._scheduleOpen(this,_f19,{x:evt.pageX,y:evt.pageY});}),on(cn,_f1e("keydown"),function(evt){if(evt.shiftKey&&evt.keyCode==keys.F10){_f0f.stop(evt);self._scheduleOpen(this,_f19);}})];});_f1b.connects=cn?_f1c(cn):[];if(_f19){_f1b.onloadHandler=lang.hitch(this,function(){var _f21=this._iframeContentWindow(_f19);cn=win.body(_f21.document);_f1b.connects=_f1c(cn);});if(_f19.addEventListener){_f19.addEventListener("load",_f1b.onloadHandler,false);}else{_f19.attachEvent("onload",_f1b.onloadHandler);}}},unBindDomNode:function(_f22){var node;try{node=dom.byId(_f22,this.ownerDocument);}catch(e){return;}var _f23="_dijitMenu"+this.id;if(node&&_f10.has(node,_f23)){var bid=_f10.get(node,_f23)-1,b=this._bindings[bid],h;while((h=b.connects.pop())){h.remove();}var _f24=b.iframe;if(_f24){if(_f24.removeEventListener){_f24.removeEventListener("load",b.onloadHandler,false);}else{_f24.detachEvent("onload",b.onloadHandler);}}_f10.remove(node,_f23);delete this._bindings[bid];}},_scheduleOpen:function(_f25,_f26,_f27){if(!this._openTimer){this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:_f25,iframe:_f26,coords:_f27});},1);}},_openMyself:function(args){var _f28=args.target,_f29=args.iframe,_f2a=args.coords;this.currentTarget=_f28;if(_f2a){if(_f29){var ifc=_f11.position(_f29,true),_f2b=this._iframeContentWindow(_f29),_f2c=_f11.docScroll(_f2b.document);var cs=_f12.getComputedStyle(_f29),tp=_f12.toPixelValue,left=(has("ie")&&has("quirks")?0:tp(_f29,cs.paddingLeft))+(has("ie")&&has("quirks")?tp(_f29,cs.borderLeftWidth):0),top=(has("ie")&&has("quirks")?0:tp(_f29,cs.paddingTop))+(has("ie")&&has("quirks")?tp(_f29,cs.borderTopWidth):0);_f2a.x+=ifc.x+left-_f2c.x;_f2a.y+=ifc.y+top-_f2c.y;}}else{_f2a=_f11.position(_f28,true);_f2a.x+=10;_f2a.y+=10;}var self=this;var _f2d=this._focusManager.get("prevNode");var _f2e=this._focusManager.get("curNode");var _f2f=!_f2e||(dom.isDescendant(_f2e,this.domNode))?_f2d:_f2e;function _f30(){if(self.refocus&&_f2f){_f2f.focus();}pm.close(self);};pm.open({popup:this,x:_f2a.x,y:_f2a.y,onExecute:_f30,onCancel:_f30,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);pm.close(this);};},destroy:function(){_f0d.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});});},"esri/dijit/BookmarkItem":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_f31,lang,has,_f32){var BMI=_f31(null,{declaredClass:"esri.dijit.BookmarkItem",constructor:function(_f33){this.name=_f33.name;this.extent=_f33.extent;},toJson:function(){var json={};var _f34=this.extent.toJson();json.extent={spatialReference:_f34.spatialReference,xmax:_f34.xmax,xmin:_f34.xmin,ymax:_f34.ymax,ymin:_f34.ymin};json.name=this.name;return json;}});if(has("extend-esri")){lang.setObject("dijit.BookmarkItem",BMI,_f32);}return BMI;});},"esri/layers/FeatureType":function(){define("esri/layers/FeatureType",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/lang","esri/symbols/jsonUtils","esri/layers/RangeDomain","esri/layers/CodedValueDomain","esri/layers/InheritedDomain","esri/layers/FeatureTemplate"],function(_f35,lang,_f36,has,_f37,_f38,_f39,_f3a,_f3b,_f3c,_f3d){var _f3e=_f35(null,{declaredClass:"esri.layers.FeatureType",constructor:function(json){if(json&&lang.isObject(json)){this.id=json.id;this.name=json.name;var _f3f=json.symbol;if(_f3f){this.symbol=_f39.fromJson(_f3f);}var _f40=json.domains,_f41,i;var _f42=this.domains={};for(_f41 in _f40){if(_f40.hasOwnProperty(_f41)){var _f43=_f40[_f41];switch(_f43.type){case "range":_f42[_f41]=new _f3a(_f43);break;case "codedValue":_f42[_f41]=new _f3b(_f43);break;case "inherited":_f42[_f41]=new _f3c(_f43);break;}}}var _f44=json.templates;if(_f44){var _f45=this.templates=[];for(i=0;i<_f44.length;i++){_f45.push(new _f3d(_f44[i]));}}}},toJson:function(){var json={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _f46,_f47=this.domains,_f48=this.templates,_f49=_f38.fixJson;if(_f47){var _f4a=json.domains={};for(_f46 in _f47){if(_f47.hasOwnProperty(_f46)){_f4a[_f46]=_f47[_f46]&&_f47[_f46].toJson();}}_f49(_f4a);}if(_f48){json.templates=_f36.map(_f48,function(_f4b){return _f4b.toJson();});}return _f49(json);}});if(has("extend-esri")){lang.setObject("layers.FeatureType",_f3e,_f37);}return _f3e;});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_f4c,_f4d){return _f4c("dijit._Contained",null,{_getSibling:function(_f4e){var node=this.domNode;do{node=node[_f4e+"Sibling"];}while(node&&node.nodeType!=1);return node&&_f4d.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_f4f,_f50,_f51,_f52,keys,_f53,_f54,_f55,lang){return _f53("dijit._KeyNavContainer",[_f51,_f50],{tabIndex:"0",connectKeyNavHandlers:function(_f56,_f57){var _f58=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_f52.forEach(_f56,function(code){_f58[code]=prev;});_f52.forEach(_f57,function(code){_f58[code]=next;});_f58[keys.HOME]=lang.hitch(this,"focusFirstChild");_f58[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_f4f.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_f52.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_f59,_f5a){this.inherited(arguments);this._startupChild(_f59);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_f5b,last){if(!_f5b){return;}if(this.focusedChild&&_f5b!==this.focusedChild){this._onChildBlur(this.focusedChild);}_f5b.set("tabIndex",this.tabIndex);_f5b.focus(last?"end":"start");this._set("focusedChild",_f5b);},_startupChild:function(_f5c){_f5c.set("tabIndex","-1");this.connect(_f5c,"_onFocus",function(){_f5c.set("tabIndex",this.tabIndex);});this.connect(_f5c,"_onBlur",function(){_f5c.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_f55.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_f55.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_f54.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_f5d,dir){if(_f5d){_f5d=this._getSiblingOfChild(_f5d,dir);}var _f5e=this.getChildren();for(var i=0;i<_f5e.length;i++){if(!_f5d){_f5d=_f5e[(dir>0)?0:(_f5e.length-1)];}if(_f5d.isFocusable()){return _f5d;}_f5d=this._getSiblingOfChild(_f5d,dir);}return null;}});});},"dijit/form/DataList":function(){define("dijit/form/DataList",["dojo/_base/declare","dojo/dom","dojo/_base/lang","dojo/query","dojo/store/Memory","../registry"],function(_f5f,dom,lang,_f60,_f61,_f62){function _f63(_f64){return {id:_f64.value,value:_f64.value,name:lang.trim(_f64.innerText||_f64.textContent||"")};};return _f5f("dijit.form.DataList",_f61,{constructor:function(_f65,_f66){this.domNode=dom.byId(_f66);lang.mixin(this,_f65);if(this.id){_f62.add(this);}this.domNode.style.display="none";this.inherited(arguments,[{data:_f60("option",this.domNode).map(_f63)}]);},destroy:function(){_f62.remove(this.id);},fetchSelectedItem:function(){var _f67=_f60("> option[selected]",this.domNode)[0]||_f60("> option",this.domNode)[0];return _f67&&_f63(_f67);}});});},"dojox/timing/_base":function(){define("dojox/timing/_base",["dojo/_base/kernel","dojo/_base/lang"],function(dojo){dojo.experimental("dojox.timing");dojo.getObject("timing",true,dojox);dojox.timing.Timer=function(_f68){this.timer=null;this.isRunning=false;this.interval=_f68;this.onStart=null;this.onStop=null;};dojo.extend(dojox.timing.Timer,{onTick:function(){},setInterval:function(_f69){if(this.isRunning){window.clearInterval(this.timer);}this.interval=_f69;if(this.isRunning){this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);}},start:function(){if(typeof this.onStart=="function"){this.onStart();}this.isRunning=true;this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);},stop:function(){if(typeof this.onStop=="function"){this.onStop();}this.isRunning=false;window.clearInterval(this.timer);}});return dojox.timing;});},"dijit/_editor/_Plugin":function(){define("dijit/_editor/_Plugin",["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../form/Button"],function(_f6a,_f6b,lang,_f6c){var _f6d=_f6b("dijit._editor._Plugin",null,{constructor:function(args){this.params=args||{};lang.mixin(this,this.params);this._connects=[];this._attrPairNames={};},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:true,buttonClass:_f6c,disabled:false,getLabel:function(key){return this.editor.commands[key];},_initButton:function(){if(this.command.length){var _f6e=this.getLabel(this.command),_f6f=this.editor,_f70=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);if(!this.button){var _f71=lang.mixin({label:_f6e,ownerDocument:_f6f.ownerDocument,dir:_f6f.dir,lang:_f6f.lang,showLabel:false,iconClass:_f70,dropDown:this.dropDown,tabIndex:"-1"},this.params||{});this.button=new this.buttonClass(_f71);}}if(this.get("disabled")&&this.button){this.button.set("disabled",this.get("disabled"));}},destroy:function(){var h;while(h=this._connects.pop()){h.remove();}if(this.dropDown){this.dropDown.destroyRecursive();}},connect:function(o,f,tf){this._connects.push(_f6a.connect(o,f,this,tf));},updateState:function(){var e=this.editor,c=this.command,_f72,_f73;if(!e||!e.isLoaded||!c.length){return;}var _f74=this.get("disabled");if(this.button){try{_f73=!_f74&&e.queryCommandEnabled(c);if(this.enabled!==_f73){this.enabled=_f73;this.button.set("disabled",!_f73);}if(_f73){if(typeof this.button.checked=="boolean"){_f72=e.queryCommandState(c);if(this.checked!==_f72){this.checked=_f72;this.button.set("checked",e.queryCommandState(c));}}}}catch(e){console.log(e);}}},setEditor:function(_f75){this.editor=_f75;this._initButton();if(this.button&&this.useDefaultCommand){if(this.editor.queryCommandAvailable(this.command)){this.connect(this.button,"onClick",lang.hitch(this.editor,"execCommand",this.command,this.commandArg));}else{this.button.domNode.style.display="none";}}this.connect(this.editor,"onNormalizedDisplayChanged","updateState");},setToolbar:function(_f76){if(this.button){_f76.addChild(this.button);}},set:function(name,_f77){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _f78=this._getAttrNames(name);if(this[_f78.s]){var _f79=this[_f78.s].apply(this,Array.prototype.slice.call(arguments,1));}else{this._set(name,_f77);}return _f79||this;},get:function(name){var _f7a=this._getAttrNames(name);return this[_f7a.g]?this[_f7a.g]():this[name];},_setDisabledAttr:function(_f7b){this.disabled=_f7b;this.updateState();},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.charAt(0).toUpperCase()+name.substr(1);return (apn[name]={s:"_set"+uc+"Attr",g:"_get"+uc+"Attr"});},_set:function(name,_f7c){this[name]=_f7c;}});_f6d.registry={};return _f6d;});},"esri/tasks/PrintTemplate":function(){define("esri/tasks/PrintTemplate",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_f7d,lang,has,_f7e){var _f7f=_f7d(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,height:1100,dpi:96},layoutOptions:null,format:"PNG32",layout:"MAP_ONLY",preserveScale:true,showAttribution:null});if(has("extend-esri")){lang.setObject("tasks.PrintTemplate",_f7f,_f7e);}return _f7f;});},"esri/dijit/editing/tools/EditingTools":function(){define(["dojo/_base/lang","dojo/has","esri/toolbars/draw","esri/kernel"],function(lang,has,Draw,_f80){var _f81={point:{id:"esriPointTool",_enabledIcon:"toolbarIcon pointIcon",_disabledIcon:"toolbarIcon pointIconDisabled",_drawType:Draw.POINT,_geomType:"esriGeometryPoint",_label:"NLS_pointLbl"},polyline:{id:"toolDrawFreehandPolyline",_enabledIcon:"toolbarIcon polylineIcon",_disabledIcon:"toolbarIcon polylineIconDisabled",_drawType:Draw.POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_polylineLbl"},freehandpolyline:{id:"toolDrawPolyline",_enabledIcon:"toolbarIcon freehandPolylineIcon",_disabledIcon:"toolbarIcon freehandPolylineIcon",_drawType:Draw.FREEHAND_POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_freehandPolylineLbl"},polygon:{id:"toolDrawPolygon",_enabledIcon:"toolbarIcon polygonIcon",_disabledIcon:"toolbarIcon polygonIconDisabled",_drawType:Draw.POLYGON,_geomType:"esriGeometryPolygon",_label:"NLS_polygonLbl"},freehandpolygon:{id:"toolDrawFreehandPolygon",_enabledIcon:"toolbarIcon freehandPolygonIcon",_disabledIcon:"toolbarIcon freehandPolygonIconDisabled",_drawType:Draw.FREEHAND_POLYGON,_label:"NLS_freehandPolygonLbl",_geomType:"esriGeometryPolygon"},autocomplete:{id:"btnFeatureAutoComplete",_enabledIcon:"toolbarIcon autoCompleteIcon",_disabledIcon:"toolbarIcon autoCompleteIcon",_drawType:Draw.POLYGON,_label:"NLS_autoCompleteLbl",_geomType:"esriGeometryPolygon"},rectangle:{id:"toolDrawRect",_enabledIcon:"toolbarIcon rectangleIcon",_disabledIcon:"toolbarIcon rectangleIcon",_drawType:Draw.RECTANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_rectangleLbl"},arrow:{id:"toolDrawArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:Draw.ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLbl"},uparrow:{id:"toolDrawArrowUp",_enabledIcon:"toolbarIcon arrowUpIcon",_disabledIcon:"toolbarIcon arrowUpIcon",_drawType:Draw.UP_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowUpLbl"},downarrow:{id:"toolDrawDownArrow",_enabledIcon:"toolbarIcon arrowDownIcon",_disabledIcon:"toolbarIcon arrowDownIcon",_drawType:Draw.DOWN_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowDownLbl"},leftarrow:{id:"toolDrawLeftArrow",_enabledIcon:"toolbarIcon arrowLeftIcon",_disabledIcon:"toolbarIcon arrowLeftIcon",_drawType:Draw.LEFT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLeftLbl"},rightarrow:{id:"toolDrawRightArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:Draw.RIGHT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowRightLbl"},circle:{id:"toolDrawCircle",_enabledIcon:"toolbarIcon circleIcon",_disabledIcon:"toolbarIcon circleIcon",_drawType:Draw.CIRCLE,_geomType:"esriGeometryPolygon",_label:"NLS_circleLbl"},ellipse:{id:"toolDrawEllipse",_enabledIcon:"toolbarIcon ellipseIcon",_disabledIcon:"toolbarIcon ellipseIcon",_drawType:Draw.ELLIPSE,_geomType:"esriGeometryPolygon",_label:"NLS_ellipseLbl"},triangle:{id:"toolDrawTriangle",_enabledIcon:"toolbarIcon triangleIcon",_disabledIcon:"toolbarIcon triangleIcon",_drawType:Draw.TRIANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_triangleLbl"},attributes:{id:"btnAttributes",_enabledIcon:"toolbarIcon attributesIcon",_disabledIcon:"toolbarIcon attributesIcon",_enabled:false,_label:"NLS_attributesLbl"},del:{id:"btnDelete2",_enabledIcon:"toolbarIcon deleteFeatureIcon",_disabledIcon:"toolbarIcon deleteFeatureIcon",_enabled:false,_label:"NLS_deleteLbl"},undo:{id:"btnUndo",_enabledIcon:"dijitEditorIcon dijitEditorIconUndo",_disabledIcon:"dijitEditorIcon dijitEditorIconUndo",_enabled:false,_label:"NLS_undoLbl"},redo:{id:"btnRedo",_enabledIcon:"dijitEditorIcon dijitEditorIconRedo",_disabledIcon:"dijitEditorIcon dijitEditorIconRedo",_enabled:false,_label:"NLS_redoLbl"}};if(has("extend-esri")){lang.setObject("dijit.editing.tools.EditingTools",_f81,_f80);}return _f81;});},"dojo/dnd/Source":function(){define(["../_base/array","../_base/connect","../_base/declare","../_base/kernel","../_base/lang","../dom-class","../dom-geometry","../mouse","../ready","../topic","./common","./Selector","./Manager"],function(_f82,_f83,_f84,_f85,lang,_f86,_f87,_f88,_f89,_f8a,dnd,_f8b,_f8c){if(!_f85.isAsync){_f89(0,function(){var _f8d=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_f8d);});}var _f8e=_f84("dojo.dnd.Source",_f8b,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_f8f){lang.mixin(this,lang.mixin({},_f8f));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_f86.add(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_f86.add(this.node,"dojoDndTarget");}if(this.horizontal){_f86.add(this.node,"dojoDndHorizontal");}this.topics=[_f8a.subscribe("/dnd/source/over",lang.hitch(this,"onDndSourceOver")),_f8a.subscribe("/dnd/start",lang.hitch(this,"onDndStart")),_f8a.subscribe("/dnd/drop",lang.hitch(this,"onDndDrop")),_f8a.subscribe("/dnd/cancel",lang.hitch(this,"onDndCancel"))];},checkAcceptance:function(_f90,_f91){if(this==_f90){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_f91.length;++i){var type=_f90.getItem(_f91[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_f92,self){if(_f92){return true;}if(arguments.length<2){self=this==_f8c.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){_f8e.superclass.destroy.call(this);_f82.forEach(this.topics,function(t){t.remove();});this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}_f8e.superclass.onMouseMove.call(this,e);var m=_f8c.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _f93=this.getSelectedNodes();if(_f93.length){m.startDrag(this,_f93,this.copyState(dnd.getCopyKeyState(e),true));}}}if(this.isDragging){var _f94=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_f87.position(this.current,true);}if(this.horizontal){_f94=(e.pageX-this.targetBox.x<this.targetBox.w/2)==_f87.isBodyLtr(this.current.ownerDocument);}else{_f94=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_f94!=this.before){this._markTargetAnchor(_f94);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;_f8e.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;_f8e.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_f95){if(this!==_f95){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_f8c.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_f96,_f97,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_f96?(copy?"Copied":"Moved"):"");}var _f98=this.accept&&this.checkAcceptance(_f96,_f97);this._changeState("Target",_f98?"":"Disabled");if(this==_f96){_f8c.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_f99,_f9a,copy,_f9b){if(this==_f9b){this.onDrop(_f99,_f9a,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_f9c,_f9d,copy){if(this!=_f9c){this.onDropExternal(_f9c,_f9d,copy);}else{this.onDropInternal(_f9d,copy);}},onDropExternal:function(_f9e,_f9f,copy){var _fa0=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _fa0.call(this,_f9e.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node){var t=_f9e.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node){var t=_f9e.getItem(node.id);_f9e.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_f9e.selectNone();}this.insertNodes(true,_f9f,this.before,this.current);if(!copy&&this.creator){_f9e.deleteSelectedNodes();}this._normalizedCreator=_fa0;},onDropInternal:function(_fa1,copy){var _fa2=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _fa2.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_fa1,this.before,this.current);this._normalizedCreator=_fa2;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){_f8e.superclass.onOverEvent.call(this);_f8c.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){_f8e.superclass.onOutEvent.call(this);_f8c.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_fa3){if(this.current==this.targetAnchor&&this.before==_fa3){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_fa3;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(e.type!="touchstart"&&!_f88.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(_f86.contains(node,"dojoDndHandle")){return true;}if(_f86.contains(node,"dojoDndItem")||_f86.contains(node,"dojoDndIgnore")){break;}}return false;}});return _f8e;});},"dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","./util/filter","./util/simpleFetch","../date/stamp"],function(_fa4,lang,_fa5,_fa6,xhr,_fa7,_fa8,_fa9,_faa){var _fab=_fa5("dojo.data.ItemFileReadStore",[_fa7],{constructor:function(_fac){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_fac.url;this._ccUrl=_fac.url;this.url=_fac.url;this._jsonData=_fac.data;this.data=null;this._datatypeMap=_fac.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_fad){return _faa.fromISOString(_fad);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_fac.urlPreventCache!==undefined){this.urlPreventCache=_fac.urlPreventCache?true:false;}if(_fac.hierarchical!==undefined){this.hierarchical=_fac.hierarchical?true:false;}if(_fac.clearOnClose){this.clearOnClose=true;}if("failOk" in _fac){this.failOk=_fac.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": Invalid item argument.");}},_assertIsAttribute:function(_fae){if(typeof _fae!=="string"){throw new Error(this.declaredClass+": Invalid attribute argument.");}},getValue:function(item,_faf,_fb0){var _fb1=this.getValues(item,_faf);return (_fb1.length>0)?_fb1[0]:_fb0;},getValues:function(item,_fb2){this._assertIsItem(item);this._assertIsAttribute(_fb2);return (item[_fb2]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _fb3=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_fb3.push(key);}}return _fb3;},hasAttribute:function(item,_fb4){this._assertIsItem(item);this._assertIsAttribute(_fb4);return (_fb4 in item);},containsValue:function(item,_fb5,_fb6){var _fb7=undefined;if(typeof _fb6==="string"){_fb7=_fa8.patternToRegExp(_fb6,false);}return this._containsValue(item,_fb5,_fb6,_fb7);},_containsValue:function(item,_fb8,_fb9,_fba){return _fa6.some(this.getValues(item,_fb8),function(_fbb){if(_fbb!==null&&!lang.isObject(_fbb)&&_fba){if(_fbb.toString().match(_fba)){return true;}}else{if(_fb9===_fbb){return true;}}});},isItem:function(_fbc){if(_fbc&&_fbc[this._storeRefPropName]===this){if(this._arrayOfAllItems[_fbc[this._itemNumPropName]]===_fbc){return true;}}return false;},isItemLoaded:function(_fbd){return this.isItem(_fbd);},loadItem:function(_fbe){this._assertIsItem(_fbe.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},filter:function(_fbf,_fc0,_fc1){var _fc2=[],i,key;if(_fbf.query){var _fc3,_fc4=_fbf.queryOptions?_fbf.queryOptions.ignoreCase:false;var _fc5={};for(key in _fbf.query){_fc3=_fbf.query[key];if(typeof _fc3==="string"){_fc5[key]=_fa8.patternToRegExp(_fc3,_fc4);}else{if(_fc3 instanceof RegExp){_fc5[key]=_fc3;}}}for(i=0;i<_fc0.length;++i){var _fc6=true;var _fc7=_fc0[i];if(_fc7===null){_fc6=false;}else{for(key in _fbf.query){_fc3=_fbf.query[key];if(!this._containsValue(_fc7,key,_fc3,_fc5[key])){_fc6=false;}}}if(_fc6){_fc2.push(_fc7);}}_fc1(_fc2,_fbf);}else{for(i=0;i<_fc0.length;++i){var item=_fc0[i];if(item!==null){_fc2.push(item);}}_fc1(_fc2,_fbf);}},_fetchItems:function(_fc8,_fc9,_fca){var self=this;if(this._loadFinished){this.filter(_fc8,this._getItemsArray(_fc8.queryOptions),_fc9);}else{if(this._jsonFileUrl!==this._ccUrl){_fa4.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_fc8,filter:lang.hitch(self,"filter"),findCallback:lang.hitch(self,_fc9)});}else{this._loadInProgress=true;var _fcb={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _fcc=xhr.get(_fcb);_fcc.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;self.filter(_fc8,self._getItemsArray(_fc8.queryOptions),_fc9);self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_fca(e,_fc8);}});_fcc.addErrback(function(_fcd){self._loadInProgress=false;_fca(_fcd,_fc8);});var _fce=null;if(_fc8.abort){_fce=_fc8.abort;}_fc8.abort=function(){var df=_fcc;if(df&&df.fired===-1){df.cancel();df=null;}if(_fce){_fce.call(_fc8);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;self.filter(_fc8,this._getItemsArray(_fc8.queryOptions),_fc9);}catch(e){_fca(e,_fc8);}}else{_fca(new Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),_fc8);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _fcf=this._queuedFetches[i],_fd0=_fcf.args,_fd1=_fcf.filter,_fd2=_fcf.findCallback;if(_fd1){_fd1(_fd0,this._getItemsArray(_fd0.queryOptions),_fd2);}else{this.fetchItemByIdentity(_fd0);}}this._queuedFetches=[];}},_getItemsArray:function(_fd3){if(_fd3&&_fd3.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_fd4){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug(this.declaredClass+": WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_fd5){var _fd6=false,self=this;function _fd7(_fd8){return (_fd8!==null)&&(typeof _fd8==="object")&&(!lang.isArray(_fd8)||_fd6)&&(!lang.isFunction(_fd8))&&(_fd8.constructor==Object||lang.isArray(_fd8))&&(typeof _fd8._reference==="undefined")&&(typeof _fd8._type==="undefined")&&(typeof _fd8._value==="undefined")&&self.hierarchical;};function _fd9(_fda){self._arrayOfAllItems.push(_fda);for(var _fdb in _fda){var _fdc=_fda[_fdb];if(_fdc){if(lang.isArray(_fdc)){var _fdd=_fdc;for(var k=0;k<_fdd.length;++k){var _fde=_fdd[k];if(_fd7(_fde)){_fd9(_fde);}}}else{if(_fd7(_fdc)){_fd9(_fdc);}}}}};this._labelAttr=_fd5.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_fd5.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_fd6=true;}_fd9(item);item[this._rootItemPropName]=true;}var _fdf={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _fe0=item[key];if(_fe0!==null){if(!lang.isArray(_fe0)){item[key]=[_fe0];}}else{item[key]=[null];}}_fdf[key]=key;}}while(_fdf[this._storeRefPropName]){this._storeRefPropName+="_";}while(_fdf[this._itemNumPropName]){this._itemNumPropName+="_";}while(_fdf[this._reverseRefMap]){this._reverseRefMap+="_";}var _fe1;var _fe2=_fd5.identifier;if(_fe2){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_fe2;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_fe1=item[_fe2];var _fe3=_fe1[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_fe3)){this._itemsByIdentity[_fe3]=item;}else{if(this._jsonFileUrl){throw new Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_fe2+"].  Value collided: ["+_fe3+"]");}else{if(this._jsonData){throw new Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_fe2+"].  Value collided: ["+_fe3+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_fe1=item[key];for(var j=0;j<_fe1.length;++j){_fe0=_fe1[j];if(_fe0!==null&&typeof _fe0=="object"){if(("_type" in _fe0)&&("_value" in _fe0)){var type=_fe0._type;var _fe4=this._datatypeMap[type];if(!_fe4){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_fe4)){_fe1[j]=new _fe4(_fe0._value);}else{if(lang.isFunction(_fe4.deserialize)){_fe1[j]=_fe4.deserialize(_fe0._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_fe0._reference){var _fe5=_fe0._reference;if(!lang.isObject(_fe5)){_fe1[j]=this._getItemByIdentity(_fe5);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _fe6=this._arrayOfAllItems[k],_fe7=true;for(var _fe8 in _fe5){if(_fe6[_fe8]!=_fe5[_fe8]){_fe7=false;}}if(_fe7){_fe1[j]=_fe6;}}}if(this.referenceIntegrity){var _fe9=_fe1[j];if(this.isItem(_fe9)){this._addReferenceToMap(_fe9,item,key);}}}else{if(this.isItem(_fe0)){if(this.referenceIntegrity){this._addReferenceToMap(_fe0,item,key);}}}}}}}},_addReferenceToMap:function(_fea,_feb,_fec){},getIdentity:function(item){var _fed=this._features["dojo.data.api.Identity"];if(_fed===Number){return item[this._itemNumPropName];}else{var _fee=item[_fed];if(_fee){return _fee[0];}}return null;},fetchItemByIdentity:function(_fef){var item,_ff0;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_fa4.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_fef});}else{this._loadInProgress=true;var _ff1={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _ff2=xhr.get(_ff1);_ff2.addCallback(function(data){var _ff3=_fef.scope?_fef.scope:_fa4.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_fef.identity);if(_fef.onItem){_fef.onItem.call(_ff3,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_fef.onError){_fef.onError.call(_ff3,error);}}});_ff2.addErrback(function(_ff4){self._loadInProgress=false;if(_fef.onError){var _ff5=_fef.scope?_fef.scope:_fa4.global;_fef.onError.call(_ff5,_ff4);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_fef.identity);if(_fef.onItem){_ff0=_fef.scope?_fef.scope:_fa4.global;_fef.onItem.call(_ff0,item);}}}}else{item=this._getItemByIdentity(_fef.identity);if(_fef.onItem){_ff0=_fef.scope?_fef.scope:_fa4.global;_fef.onItem.call(_ff0,item);}}},_getItemByIdentity:function(_ff6){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_ff6)){item=this._itemsByIdentity[_ff6];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_ff6)){item=this._arrayOfAllItems[_ff6];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _ff7=this._features["dojo.data.api.Identity"];if(_ff7===Number){return null;}else{return [_ff7];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_fa4.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _ff8={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _ff9=xhr.get(_ff8);_ff9.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_ff9.addErrback(function(_ffa){throw _ffa;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_fab,_fa9);return _fab;});},"esri/toolbars/_VertexMover":function(){define("esri/toolbars/_VertexMover",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/has","dojo/sniff","dojo/dom-style","dojox/gfx/Moveable","esri/kernel","esri/geometry/Point","esri/graphic","esri/geometry/webMercatorUtils"],function(_ffb,lang,_ffc,has,_ffd,_ffe,_fff,_1000,Point,_1001,_1002){var VM=_ffb(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(point,_1003,_1004,_1005,_1006,_1007,_1008,_1009){this.point=point;this.symbol=_1003;this.relatedGraphic=_1004;this.segIndex=_1005;this.ptIndex=_1006;this.segLength=_1007;this.editor=_1008;this.map=_1008.map;this._scratchGL=_1008.toolbar._scratchGL;this._placeholder=_1009||false;this._type=_1004.geometry.type;this._init();this._enable();},refresh:function(force){if(force||this._needRefresh()){this._disable();this._enable();}},destroy:function(){this._disable();if(this.graphic){this._scratchGL.remove(this.graphic);}this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null;},_init:function(){var newPt=new Point(this.point.toJson());var _100a=new _1001(newPt,this.symbol);switch(this._type){case "multipoint":_100a._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(_100a);break;}this.graphic=_100a;},_enable:function(){var shape=this.graphic.getDojoShape();if(shape){shape._hasMover=true;this._moveable=this._getMoveable(shape);var node=shape.getEventSource();if(node){_ffe.set(node,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]);}}},_disable:function(){var _100b=this._moveable;if(_100b){_ffc.disconnect(this._startHandle);_ffc.disconnect(this._firstHandle);_ffc.disconnect(this._movingHandle);_ffc.disconnect(this._stopHandle);var shape=_100b.shape;if(shape){var node=shape.getEventSource();if(node){_ffe.set(node,"cursor",null);}}_100b.destroy();this._moveable=null;}},_needRefresh:function(){var shape=this.graphic.getDojoShape(),need=false;if(shape){switch(this._type){case "multipoint":var group=this.relatedGraphic.getDojoShape();if(group){var child=group.children[this.ptIndex];if(shape!==child){shape=child;this.graphic._shape=shape;need=true;}}break;case "polyline":case "polygon":need=!shape._hasMover;break;}}return need;},_getMoveable:function(shape){var _100c=new _fff(shape,_ffd("mac")&&_ffd("ff")&&!has("esri-touch")&&{leftButtonOnly:true});this._startHandle=_ffc.connect(_100c,"onMoveStart",this,this._moveStartHandler);this._firstHandle=_ffc.connect(_100c,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_ffc.connect(_100c,"onMoving",this,this._movingHandler);this._stopHandle=_ffc.connect(_100c,"onMoveStop",this,this._moveStopHandler);return _100c;},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0);},_getInfo:function(){return {graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()};},_moveStartHandler:function(mover){var map=this.map;if(map.snappingManager){map.snappingManager._setUpSnapping();}mover.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo());},_firstMoveHandler:function(mover){var shape=mover.shape;var edges=this._getControlEdges();var _100d=this._scratchGL._div;var i,lines=[],_100e=mover.host.shape._wrapOffsets[0]||0;for(i=0;i<edges.length;i++){var edge=edges[i];edge.x1+=_100e;edge.x2+=_100e;lines.push([_100d.createLine({x1:edge.x1,y1:edge.y1,x2:edge.x2,y2:edge.y2}).setStroke(this.editor._lineStroke),edge.x1,edge.y1,edge.x2,edge.y2]);}shape._lines=lines;mover.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo());},_movingHandler:function(mover){var shape=mover.shape,tx=shape.getTransform();var i,lines=shape._lines;for(i=0;i<lines.length;i++){var line=lines[i];line[0].setShape({x1:line[1]+tx.dx,y1:line[2]+tx.dy,x2:line[3],y2:line[4]});}this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),tx);},_moveStopHandler:function(mover){var shape=mover.shape,_100f=this.editor.toolbar,tx=shape.getTransform(),map=this.map,host=this.graphic,_1010=_100f._geo?_1002.geographicToWebMercator(host.geometry):host.geometry;var i,lines=shape._lines;if(lines){for(i=0;i<lines.length;i++){lines[i][0].removeShape();}shape._lines=null;}var ph=false,moved=true,info=this._getInfo();if(tx&&(tx.dx||tx.dy)){if(this._placeholder){this._placeholder=false;ph=true;}}else{moved=false;}var _1011;if(map.snappingManager){_1011=map.snappingManager._snappingPoint;}var _1012=_1011||map.toMap(map.toScreen(_1010).offset(tx.dx,tx.dy));if(map.snappingManager){map.snappingManager._killOffSnapping();}shape.setTransform(null);host.setGeometry(_100f._geo?_1002.webMercatorToGeographic(_1012,true):_1012);this.constructor.onMoveStop(this,tx);_100f.onVertexMoveStop(this.relatedGraphic,info,tx);if(!moved){_100f.onVertexClick(this.relatedGraphic,info);}if(ph){_100f.onVertexAdd(this.relatedGraphic,this._getInfo());}},_getControlEdges:function(){var map=this.map;var _1013=this.relatedGraphic.geometry;var _1014=this.segIndex,_1015=this.ptIndex,_1016=this.segLength;var _1017=this._scratchGL._div;var _1018=_1017.getTransform();var sdx=_1018.dx,sdy=_1018.dy;var pt=map.toScreen(this.graphic.geometry);var x=pt.x-sdx,y=pt.y-sdy;var edges=[];var _1019=this.editor._getControlPoints(this,_1013,_1014,_1015,_1016);if(_1019[0]){edges.push({x1:x,y1:y,x2:_1019[0].x-sdx,y2:_1019[0].y-sdy});}if(_1019[1]){edges.push({x1:x,y1:y,x2:_1019[1].x-sdx,y2:_1019[1].y-sdy});}return edges;}});if(has("extend-esri")){lang.setObject("toolbars.VertexMover",VM,_1000);}lang.mixin(VM,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}});return VM;});},"url:esri/dijit/editing/templates/Editor.html":"<div class=\"esriEditor\">\r\n    <div class=\"esriTemplatePicker\" dojoAttachPoint=\"templatePickerDiv\"></div>\r\n    <div class=\"esriDrawingToolbar\" dojoAttachPoint=\"drawingToolbarDiv\"></div>\r\n    <div class=\"progressBar\" dojoAttachPoint=\"progressBar\" indeterminate=\"true\" dojoType=\"dijit.ProgressBar\" />\r\n</div>","esri/toolbars/edit":function(){define("esri/toolbars/edit",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/Color","dojo/has","esri/kernel","esri/lang","esri/sniff","esri/toolbars/_toolbar","esri/toolbars/_Box","esri/toolbars/_GraphicMover","esri/toolbars/_VertexEditor","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"],function(_101a,lang,_101b,array,Color,has,_101c,_101d,_101e,_101f,Box,_1020,_1021,_1022,_1023){var EDT=_101a(_101f,{declaredClass:"esri.toolbars.Edit",constructor:function(map,_1024){this._map=map;this._tool=0;if(this._map.loaded){this._scratchGL=map.graphics;}else{var _1025=_101b.connect(this._map,"onLoad",this,function(){_101b.disconnect(_1025);_1025=null;this._scratchGL=this._map.graphics;});}var touch=has("esri-touch")||has("esri-pointer");this._defaultOptions=lang.mixin({vertexSymbol:new _1022(_1022.STYLE_CIRCLE,touch?20:12,new _1023(_1023.STYLE_SOLID,new Color([0,0,0,0.5]),1),new Color([128,128,128])),ghostVertexSymbol:new _1022(_1022.STYLE_CIRCLE,touch?18:10,new _1023(_1023.STYLE_SOLID,new Color([0,0,0,0.5]),1),new Color([255,255,255,0.75])),ghostLineSymbol:new _1023(_1023.STYLE_DOT,new Color([128,128,128]),2),allowDeleteVertices:true,allowAddVertices:true,rotateHandleOffset:touch?24:16,boxLineSymbol:new _1023(_1023.STYLE_DASH,new Color([64,64,64]),1),boxHandleSymbol:new _1022(_1022.STYLE_SQUARE,touch?16:9,new _1023(_1023.STYLE_SOLID,new Color([0,0,0,0.5]),1),new Color([255,255,255,0.75]))},_1024||{});},activate:function(tool,_1026,_1027){this.deactivate();this._graphic=_1026;this._options=lang.mixin(lang.mixin({},this._defaultOptions),_1027||{});var MOVE=EDT.MOVE,EDIT=EDT.EDIT_VERTICES,SCALE=EDT.SCALE,_1028=EDT.ROTATE,move=false,edit=false,box=false,map=this._map,mapSR=map.spatialReference,_1029=_1026.geometry.spatialReference;this._geo=!!(mapSR&&_1029&&!mapSR.equals(_1029)&&mapSR.isWebMercator()&&_1029.wkid===4326);if((tool&MOVE)===MOVE){move=this._enableMove(_1026);}var scale=((tool&SCALE)===SCALE),_102a=((tool&_1028)===_1028);if(scale||_102a){box=this._enableBoxEditing(_1026,scale,_102a);}if((tool&EDIT)===EDIT){edit=this._enableVertexEditing(_1026);}if(!(move||edit||box)){throw new Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");}this._tool=tool;if(this._tool){this._mapPanEndHandle=_101b.connect(map,"onPanEnd",this,this._mapPanEndHandler);this._mapExtChgHandle=_101b.connect(map,"onExtentChange",this,this._mapExtentChangeHandler);this.onActivate(this._tool,_1026);}if(map.snappingManager&&(move||edit)){map.snappingManager._startSelectionLayerQuery();}},deactivate:function(){var tool=this._tool,_102b=this._graphic;if(!tool){return;}var _102c=!!this._modified;this._clear();_101b.disconnect(this._mapPanEndHandle);_101b.disconnect(this._mapExtChgHandle);this._mapPanEndHandle=this._mapExtChgHandle=null;this._graphic=this._geo=null;this.onDeactivate(tool,_102b,{isModified:_102c});if(this._map.snappingManager){this._map.snappingManager._stopSelectionLayerQuery();}},refresh:function(){this._refreshMoveables(true);},getCurrentState:function(){return {tool:this._tool,graphic:this._graphic,isModified:!!this._modified};},onActivate:function(tool,_102d){},onDeactivate:function(tool,_102e,info){},onGraphicMoveStart:function(_102f){},onGraphicFirstMove:function(_1030){this._modified=true;},onGraphicMove:function(_1031,_1032){},onGraphicMoveStop:function(_1033,_1034){},onGraphicClick:function(_1035,info){},onVertexMoveStart:function(_1036,_1037){},onVertexFirstMove:function(_1038,_1039){this._modified=true;},onVertexMove:function(_103a,_103b,_103c){},onVertexMoveStop:function(_103d,_103e,_103f){},onVertexAdd:function(_1040,_1041){this._modified=true;},onVertexClick:function(_1042,_1043){},onVertexMouseOver:function(_1044,_1045){},onVertexMouseOut:function(_1046,_1047){},onVertexDelete:function(_1048,_1049){this._modified=true;},onScaleStart:function(_104a){},onScaleFirstMove:function(_104b){this._modified=true;},onScale:function(_104c,info){},onScaleStop:function(_104d,info){},onRotateStart:function(_104e){},onRotateFirstMove:function(_104f){this._modified=true;},onRotate:function(_1050,info){},onRotateStop:function(_1051,info){},_eventMap:{activate:["tool","graphic"],deactivate:["tool","graphic","info"],"graphic-move-start":["graphic"],"graphic-first-move":["graphic"],"graphic-move":["graphic","transform"],"graphic-move-stop":["graphic","transform"],"graphic-click":["graphic","info"],"vertex-move-start":["graphic","vertexinfo"],"vertex-first-move":["graphic","vertexinfo"],"vertex-move":["graphic","vertexinfo","transform"],"vertex-move-stop":["graphic","vertexinfo","transform"],"vertex-add":["graphic","vertexinfo"],"vertex-click":["graphic","vertexinfo"],"vertex-mouse-over":["graphic","vertexinfo"],"vertex-mouse-out":["graphic","vertexinfo"],"vertex-delete":["graphic","vertexinfo"],"scale-start":["graphic"],"scale-first-move":["graphic"],scale:["graphic","info"],"scale-stop":["graphic","info"],"rotate-start":["graphic"],"rotate-first-move":["graphic"],rotate:["graphic","info"],"rotate-stop":["graphic","info"]},_enableMove:function(_1052){var map=this._map,type=_1052.geometry.type;switch(type){case "point":case "polyline":case "polygon":this._graphicMover=new _1020(_1052,map,this);return true;case "multipoint":break;}return false;},_enableVertexEditing:function(_1053){var map=this._map,type=_1053.geometry.type;switch(type){case "point":break;case "multipoint":case "polyline":case "polygon":this._vertexEditor=_1021.create(_1053,map,this);return true;}return false;},_enableBoxEditing:function(_1054,scale,_1055){var map=this._map,type=_1054.geometry.type;switch(type){case "point":case "multipoint":break;case "polyline":case "polygon":this._boxEditor=new Box(_1054,map,this,scale,_1055,this._options.uniformScaling);return true;}return false;},_disableMove:function(){var _1056=this._graphicMover;if(_1056){_1056.destroy();this._graphicMover=null;}},_disableVertexEditing:function(){var _1057=this._vertexEditor;if(_1057){_1057.destroy();this._vertexEditor=null;}},_disableBoxEditing:function(){var box=this._boxEditor;if(box){box.destroy();this._boxEditor=null;}},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._tool=0;this._modified=false;},_mapPanEndHandler:function(){this._refreshMoveables();},_mapExtentChangeHandler:function(e,d,_1058){if(_1058){this._refreshMoveables();}},_refreshMoveables:function(force){var tools=array.filter([this._graphicMover,this._vertexEditor,this._boxEditor],_101d.isDefined);array.forEach(tools,function(mov){mov.refresh(force);});},_beginOperation:function(_1059){array.forEach(this._getAffectedTools(_1059),function(tool){tool.suspend();});},_endOperation:function(_105a){array.forEach(this._getAffectedTools(_105a),function(tool){tool.resume();});},_getAffectedTools:function(_105b){var tools=[];switch(_105b){case "MOVE":tools=[this._vertexEditor,this._boxEditor];break;case "VERTICES":tools=[this._boxEditor];break;case "BOX":tools=[this._vertexEditor];break;}tools=array.filter(tools,_101d.isDefined);return tools;}});lang.mixin(EDT,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8});if(has("extend-esri")){lang.setObject("toolbars.Edit",EDT,_101c);}return EDT;});},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(lang){var _105c={};lang.setObject("dojo.data.util.filter",_105c);_105c.patternToRegExp=function(_105d,_105e){var rxp="^";var c=null;for(var i=0;i<_105d.length;i++){c=_105d.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_105d.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_105e){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _105c;});},"esri/tasks/PrintParameters":function(){define("esri/tasks/PrintParameters",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_105f,lang,has,_1060){var _1061=_105f(null,{declaredClass:"esri.tasks.PrintParameters",map:null,template:null,outSpatialReference:null,extraParameters:null});if(has("extend-esri")){lang.setObject("tasks.PrintParameters",_1061,_1060);}return _1061;});},"esri/dijit/editing/toolbars/Drawing":function(){define("esri/dijit/editing/toolbars/Drawing",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dijit/_CssStateMixin","esri/dijit/editing/Util","esri/dijit/editing/toolbars/ToolbarBase","esri/dijit/editing/tools/ButtonToolBase","esri/dijit/editing/tools/Cut","esri/dijit/editing/tools/Union","esri/dijit/editing/tools/Reshape","esri/dijit/editing/tools/Editing","esri/dijit/editing/tools/EditingTools","esri/dijit/editing/tools/Selection","esri/dijit/editing/tools/SelectionTools","esri/kernel"],function(_1062,lang,array,_1063,has,_1064,_1065,_1066,_1067,Cut,Union,_1068,_1069,_106a,_106b,_106c,_106d){var _106e=_1062([_1066,_1064],{declaredClass:"esri.dijit.editing.toolbars.Drawing",onShowAttributeInspector:function(){},_activateTool:function(tool,_106f){this._settings.editor._activeTool=tool;if(tool!=="EDITING"){this._settings.templatePicker.clearSelection();}if(tool!=="ATTRIBUTES"){this._settings.editor._hideAttributeInspector();}if(tool==="CLEAR"){return;}this.inherited(arguments);},_initializeToolbar:function(){var _1070=this._settings.layers;array.forEach(_1070,function(layer){this._tbConnects.push(_1063.connect(layer,"onSelectionComplete",this,"_updateUI"));},this);},activateEditing:function(_1071,layer){this._tools.EDITING._activateTool(_1071,layer.geometryType);this._activeTool=this._tools.EDITING;this._activeTool.setChecked(true);},_updateUI:function(){if(this._settings.undoManager){this._tools.UNDO.set("disabled",this._settings.undoManager.canUndo===false);this._tools.REDO.set("disabled",this._settings.undoManager.canRedo===false);}this._selectedFeatures=_1065.getSelection(this._settings.layers);var count=this._selectedFeatures.length;if(this._tools.DELETE){this._tools.DELETE.set("disabled",count<=0);}if(this._tools.CLEAR){this._tools.CLEAR.set("disabled",count<=0);}if(this._tools.ATTRIBUTES){this._tools.ATTRIBUTES.set("disabled",count<=0);}if(this._tools.UNION){this._tools.UNION.set("disabled",count<2);}},_toolFinished:function(tool){if(tool==="ATTRIBUTES"&&(this._selectedFeatures&&this._selectedFeatures.length)){this.onShowAttributeInspector(this._selectedFeatures[0]);}if(tool==="SELECT"||tool==="CUT"||tool==="RESHAPING"||tool==="EDITING"){this._activeTool.deactivate();this._activeTool.setChecked(false);this._activeTool=null;}if(tool==="DELETE"){this.onDelete();}this._updateUI();},_createTools:function(){this._tools.SELECT=new _106b({settings:this._settings,onClick:lang.hitch(this,"_activateTool","SELECT",true),onFinished:lang.hitch(this,"_toolFinished","SELECT")});this.addChild(this._tools.SELECT);this._tools.CLEAR=new _1067(lang.mixin(_106c.selectClear,{settings:this._settings,onClick:lang.hitch(this._settings.editor,"_clearSelection",false)}));this.addChild(this._tools.CLEAR);this._createSeparator();this._tools.ATTRIBUTES=new _1067(lang.mixin(_106a.attributes,{settings:this._settings,onClick:lang.hitch(this,"_toolFinished","ATTRIBUTES")}));this.addChild(this._tools.ATTRIBUTES);this._createSeparator();this._tools.EDITING=new _1069({settings:this._settings,onClick:lang.hitch(this,"_activateTool","EDITING",true),onApplyEdits:lang.hitch(this,"onApplyEdits"),onFinished:lang.hitch(this,"_toolFinished","EDITING")});this.addChild(this._tools.EDITING);this._tools.DELETE=new _1067(lang.mixin(_106a.del,{settings:this._settings,onClick:lang.hitch(this,"_toolFinished","DELETE")}));this.addChild(this._tools.DELETE);if(this._settings.toolbarOptions){if(this._settings.toolbarOptions.cutVisible||this._settings.toolbarOptions.mergeVisible||this._settings.toolbarOptions.reshapeVisible){this._createSeparator();}if(this._settings.toolbarOptions.cutVisible){this._tools.CUT=new Cut({settings:this._settings,onFinished:lang.hitch(this,"_toolFinished","CUT"),onClick:lang.hitch(this,"_activateTool","CUT",true),onApplyEdits:lang.hitch(this,"onApplyEdits")});this.addChild(this._tools.CUT);}if(this._settings.toolbarOptions.mergeVisible){this._tools.UNION=new Union({settings:this._settings,onFinished:lang.hitch(this,"_toolFinished","UNION"),onApplyEdits:lang.hitch(this,"onApplyEdits")});this.addChild(this._tools.UNION);}if(this._settings.toolbarOptions.reshapeVisible){this._tools.RESHAPING=new _1068({settings:this._settings,onClick:lang.hitch(this,"_activateTool","RESHAPING",true),onFinished:lang.hitch(this,"_toolFinished","RESHAPING"),onApplyEdits:lang.hitch(this,"onApplyEdits")});this.addChild(this._tools.RESHAPING);}}if(this._settings.enableUndoRedo){this._createSeparator();this._tools.UNDO=new _1067(lang.mixin(_106a.undo,{settings:this._settings,onClick:lang.hitch(this,function(){this._tools.UNDO.set("disabled",true);this._tools.REDO.set("disabled",true);this._settings.editor._undo();})}));this.addChild(this._tools.UNDO);this._tools.REDO=new _1067(lang.mixin(_106a.redo,{settings:this._settings,onClick:lang.hitch(this,function(){this._tools.UNDO.set("disabled",true);this._tools.REDO.set("disabled",true);this._settings.editor._redo();})}));this.addChild(this._tools.REDO);}}});if(has("extend-esri")){lang.setObject("dijit.editing.toolbars.Drawing",_106e,_106d);}return _106e;});},"dijit/form/HorizontalRuleLabels":function(){define("dijit/form/HorizontalRuleLabels",["dojo/_base/declare","dojo/number","dojo/query","./HorizontalRule"],function(_1072,_1073,query,_1074){return _1072("dijit.form.HorizontalRuleLabels",_1074,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH\"></div>",labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:"<div class=\"dijitRuleLabelContainer dijitRuleLabelContainerH\" style=\"left:",_labelPrefix:"\"><div class=\"dijitRuleLabel dijitRuleLabelH\">",_suffix:"</div></div>",_calcPosition:function(pos){return pos;},_genHTML:function(pos,ndx){return this._positionPrefix+this._calcPosition(pos)+this._positionSuffix+this.labelStyle+this._labelPrefix+this.labels[ndx]+this._suffix;},getLabels:function(){var _1075=this.labels;if(!_1075.length&&this.srcNodeRef){_1075=query("> li",this.srcNodeRef).map(function(node){return String(node.innerHTML);});}if(!_1075.length&&this.count>1){var start=this.minimum;var inc=(this.maximum-start)/(this.count-1);for(var i=0;i<this.count;i++){_1075.push((i<this.numericMargin||i>=(this.count-this.numericMargin))?"":_1073.format(start,this.constraints));start+=inc;}}return _1075;},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length;}});});},"esri/dijit/editing/tools/Reshape":function(){define("esri/dijit/editing/tools/Reshape",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","esri/layers/FeatureLayer","esri/tasks/query","esri/toolbars/draw","esri/dijit/editing/tools/ToggleToolBase","esri/kernel"],function(_1076,lang,array,_1077,has,_1078,Query,Draw,_1079,_107a){var _107b=_1076([_1079],{declaredClass:"esri.dijit.editing.tools.Reshape",id:"btnFeatureReshape",_enabledIcon:"toolbarIcon reshapeIcon",_disabledIcon:"toolbarIcon reshapeIcon",_drawType:Draw.POLYLINE,_enabled:true,_label:"NLS_reshapeLbl",activate:function(){_1077.disconnect(this._rConnect);this._rConnect=_1077.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");this.inherited(arguments);},deactivate:function(){this.inherited(arguments);_1077.disconnect(this._rConnect);delete this._rConnect;},_onDrawEnd:function(_107c){var _107d=this._settings.layers;var query=new Query();query.geometry=_107c;var _107e=this._reshapeLayers=array.filter(_107d,function(layer){return (layer.geometryType==="esriGeometryPolygon"||"esriGeometryPolyline");});this._settings.editor._selectionHelper.selectFeatures(_107e,query,_1078.SELECTION_NEW,lang.hitch(this,"_reshape",query));},_reshape:function(query,_107f){var edits=[];var _1080=_107f;if(_1080.length!==1){return;}this._settings.geometryService.reshape(_1080[0].geometry,query.geometry,lang.hitch(this,function(_1081){var _1082=[_1080[0].setGeometry(_1081)];this.onApplyEdits([{layer:_1080[0].getLayer(),updates:_1082}],lang.hitch(this,function(){this._settings.editor._selectionHelper.clearSelection(false);this.onFinished();}));}));}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Reshape",_107b,_107a);}return _107b;});},"dojox/fx/_base":function(){define("dojox/fx/_base",["dojo/_base/array","dojo/_base/lang","dojo/_base/fx","dojo/fx","dojo/dom","dojo/dom-style","dojo/dom-geometry","dojo/_base/connect","dojo/_base/html"],function(_1083,lang,_1084,_1085,dom,_1086,_1087,_1088,_1089){var _108a=lang.getObject("dojox.fx",true);lang.mixin(_108a,{anim:_1084.anim,animateProperty:_1084.animateProperty,fadeTo:_1084._fade,fadeIn:_1084.fadeIn,fadeOut:_1084.fadeOut,combine:_1085.combine,chain:_1085.chain,slideTo:_1085.slideTo,wipeIn:_1085.wipeIn,wipeOut:_1085.wipeOut});_108a.sizeTo=function(args){var node=args.node=dom.byId(args.node),abs="absolute";var _108b=args.method||"chain";if(!args.duration){args.duration=500;}if(_108b=="chain"){args.duration=Math.floor(args.duration/2);}var top,_108c,left,_108d,width,_108e=null;var init=(function(n){return function(){var cs=_1086.getComputedStyle(n),pos=cs.position,w=cs.width,h=cs.height;top=(pos==abs?n.offsetTop:parseInt(cs.top)||0);left=(pos==abs?n.offsetLeft:parseInt(cs.left)||0);width=(w=="auto"?0:parseInt(w));_108e=(h=="auto"?0:parseInt(h));_108d=left-Math.floor((args.width-width)/2);_108c=top-Math.floor((args.height-_108e)/2);if(pos!=abs&&pos!="relative"){var ret=_1086.coords(n,true);top=ret.y;left=ret.x;n.style.position=abs;n.style.top=top+"px";n.style.left=left+"px";}};})(node);var anim1=_1084.animateProperty(lang.mixin({properties:{height:function(){init();return {end:args.height||0,start:_108e};},top:function(){return {start:top,end:_108c};}}},args));var anim2=_1084.animateProperty(lang.mixin({properties:{width:function(){return {start:width,end:args.width||0};},left:function(){return {start:left,end:_108d};}}},args));var anim=_1085[(args.method=="combine"?"combine":"chain")]([anim1,anim2]);return anim;};_108a.slideBy=function(args){var node=args.node=dom.byId(args.node),top,left;var init=(function(n){return function(){var cs=_1086.getComputedStyle(n);var pos=cs.position;top=(pos=="absolute"?n.offsetTop:parseInt(cs.top)||0);left=(pos=="absolute"?n.offsetLeft:parseInt(cs.left)||0);if(pos!="absolute"&&pos!="relative"){var ret=_1087.coords(n,true);top=ret.y;left=ret.x;n.style.position="absolute";n.style.top=top+"px";n.style.left=left+"px";}};})(node);init();var _108f=_1084.animateProperty(lang.mixin({properties:{top:top+(args.top||0),left:left+(args.left||0)}},args));_1088.connect(_108f,"beforeBegin",_108f,init);return _108f;};_108a.crossFade=function(args){var node1=args.nodes[0]=dom.byId(args.nodes[0]),op1=_1089.style(node1,"opacity"),node2=args.nodes[1]=dom.byId(args.nodes[1]),op2=_1089.style(node2,"opacity");var _1090=_1085.combine([_1084[(op1==0?"fadeIn":"fadeOut")](lang.mixin({node:node1},args)),_1084[(op1==0?"fadeOut":"fadeIn")](lang.mixin({node:node2},args))]);return _1090;};_108a.highlight=function(args){var node=args.node=dom.byId(args.node);args.duration=args.duration||400;var _1091=args.color||"#ffff99",_1092=_1089.style(node,"backgroundColor");if(_1092=="rgba(0, 0, 0, 0)"){_1092="transparent";}var anim=_1084.animateProperty(lang.mixin({properties:{backgroundColor:{start:_1091,end:_1092}}},args));if(_1092=="transparent"){_1088.connect(anim,"onEnd",anim,function(){node.style.backgroundColor=_1092;});}return anim;};_108a.wipeTo=function(args){args.node=dom.byId(args.node);var node=args.node,s=node.style;var dir=(args.width?"width":"height"),_1093=args[dir],props={};props[dir]={start:function(){s.overflow="hidden";if(s.visibility=="hidden"||s.display=="none"){s[dir]="1px";s.display="";s.visibility="";return 1;}else{var now=_1089.style(node,dir);return Math.max(now,1);}},end:_1093};var anim=_1084.animateProperty(lang.mixin({properties:props},args));return anim;};return _108a;});},"esri/dijit/editing/tools/ToggleToolBase":function(){define("esri/dijit/editing/tools/ToggleToolBase",["dojo/_base/declare","dojo/_base/lang","dojo/has","dijit/form/ToggleButton","esri/dijit/editing/tools/ToolBase","esri/kernel"],function(_1094,lang,has,_1095,_1096,_1097){var TTB=_1094([_1095,_1096],{declaredClass:"esri.dijit.editing.tools.ToggleToolBase",postCreate:function(){this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){_1095.prototype.destroy.apply(this,arguments);_1096.prototype.destroy.apply(this,arguments);},setChecked:function(_1098){_1095.prototype.setChecked.apply(this,arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.ToggleToolBase",TTB,_1097);}return TTB;});},"dojox/grid/_Builder":function(){define("dojox/grid/_Builder",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/event","dojo/_base/sniff","dojo/_base/connect","dojo/dnd/Moveable","dojox/html/metrics","./util","dojo/_base/html"],function(dojox,array,lang,win,event,has,_1099,_109a,_109b,util,html){var dg=dojox.grid;var _109c=function(td){return td.cellIndex>=0?td.cellIndex:array.indexOf(td.parentNode.cells,td);};var _109d=function(tr){return tr.rowIndex>=0?tr.rowIndex:array.indexOf(tr.parentNode.childNodes,tr);};var getTr=function(_109e,index){return _109e&&((_109e.rows||0)[index]||_109e.childNodes[index]);};var _109f=function(node){for(var n=node;n&&n.tagName!="TABLE";n=n.parentNode){}return n;};var _10a0=function(_10a1,_10a2){for(var n=_10a1;n&&_10a2(n);n=n.parentNode){}return n;};var _10a3=function(_10a4){var name=_10a4.toUpperCase();return function(node){return node.tagName!=name;};};var _10a5=util.rowIndexTag;var _10a6=util.gridViewTag;var _10a7=dg._Builder=lang.extend(function(view){if(view){this.view=view;this.grid=view.grid;}},{view:null,_table:"<table class=\"dojoxGridRowTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"",getTableArray:function(){var html=[this._table];if(this.view.viewWidth){html.push([" style=\"width:",this.view.viewWidth,";\""].join(""));}html.push(">");return html;},generateCellMarkup:function(_10a8,_10a9,_10aa,_10ab){var _10ac=[],html;if(_10ab){var _10ad=_10a8.index!=_10a8.grid.getSortIndex()?"":_10a8.grid.sortInfo>0?"aria-sort=\"ascending\"":"aria-sort=\"descending\"";if(!_10a8.id){_10a8.id=this.grid.id+"Hdr"+_10a8.index;}html=["<th tabIndex=\"-1\" aria-readonly=\"true\" role=\"columnheader\"",_10ad,"id=\"",_10a8.id,"\""];}else{var _10ae=this.grid.editable&&!_10a8.editable?"aria-readonly=\"true\"":"";html=["<td tabIndex=\"-1\" role=\"gridcell\"",_10ae];}if(_10a8.colSpan){html.push(" colspan=\"",_10a8.colSpan,"\"");}if(_10a8.rowSpan){html.push(" rowspan=\"",_10a8.rowSpan,"\"");}html.push(" class=\"dojoxGridCell ");if(_10a8.classes){html.push(_10a8.classes," ");}if(_10aa){html.push(_10aa," ");}_10ac.push(html.join(""));_10ac.push("");html=["\" idx=\"",_10a8.index,"\" style=\""];if(_10a9&&_10a9[_10a9.length-1]!=";"){_10a9+=";";}html.push(_10a8.styles,_10a9||"",_10a8.hidden?"display:none;":"");if(_10a8.unitWidth){html.push("width:",_10a8.unitWidth,";");}_10ac.push(html.join(""));_10ac.push("");html=["\""];if(_10a8.attrs){html.push(" ",_10a8.attrs);}html.push(">");_10ac.push(html.join(""));_10ac.push("");_10ac.push(_10ab?"</th>":"</td>");return _10ac;},isCellNode:function(_10af){return Boolean(_10af&&_10af!=win.doc&&html.attr(_10af,"idx"));},getCellNodeIndex:function(_10b0){return _10b0?Number(html.attr(_10b0,"idx")):-1;},getCellNode:function(_10b1,_10b2){for(var i=0,row;((row=getTr(_10b1.firstChild,i))&&row.cells);i++){for(var j=0,cell;(cell=row.cells[j]);j++){if(this.getCellNodeIndex(cell)==_10b2){return cell;}}}return null;},findCellTarget:function(_10b3,_10b4){var n=_10b3;while(n&&(!this.isCellNode(n)||(n.offsetParent&&_10a6 in n.offsetParent.parentNode&&n.offsetParent.parentNode[_10a6]!=this.view.id))&&(n!=_10b4)){n=n.parentNode;}return n!=_10b4?n:null;},baseDecorateEvent:function(e){e.dispatch="do"+e.type;e.grid=this.grid;e.sourceView=this.view;e.cellNode=this.findCellTarget(e.target,e.rowNode);e.cellIndex=this.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);},findTarget:function(_10b5,inTag){var n=_10b5;while(n&&(n!=this.domNode)&&(!(inTag in n)||(_10a6 in n&&n[_10a6]!=this.view.id))){n=n.parentNode;}return (n!=this.domNode)?n:null;},findRowTarget:function(_10b6){return this.findTarget(_10b6,_10a5);},isIntraNodeEvent:function(e){try{return (e.cellNode&&e.relatedTarget&&html.isDescendant(e.relatedTarget,e.cellNode));}catch(x){return false;}},isIntraRowEvent:function(e){try{var row=e.relatedTarget&&this.findRowTarget(e.relatedTarget);return !row&&(e.rowIndex==-1)||row&&(e.rowIndex==row.gridRowIndex);}catch(x){return false;}},dispatchEvent:function(e){if(e.dispatch in this){return this[e.dispatch](e);}return false;},domouseover:function(e){if(e.cellNode&&(e.cellNode!=this.lastOverCellNode)){this.lastOverCellNode=e.cellNode;this.grid.onMouseOver(e);}this.grid.onMouseOverRow(e);},domouseout:function(e){if(e.cellNode&&(e.cellNode==this.lastOverCellNode)&&!this.isIntraNodeEvent(e,this.lastOverCellNode)){this.lastOverCellNode=null;this.grid.onMouseOut(e);if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}},domousedown:function(e){if(e.cellNode){this.grid.onMouseDown(e);}this.grid.onMouseDownRow(e);}});var _10b7=dg._ContentBuilder=lang.extend(function(view){_10a7.call(this,view);},_10a7.prototype,{update:function(){this.prepareHtml();},prepareHtml:function(){var _10b8=this.grid.get,cells=this.view.structure.cells;for(var j=0,row;(row=cells[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.get=cell.get||(cell.value==undefined)&&_10b8;cell.markup=this.generateCellMarkup(cell,cell.cellStyles,cell.cellClasses,false);if(!this.grid.editable&&cell.editable){this.grid.editable=true;}}}},generateHtml:function(_10b9,_10ba){var html=this.getTableArray(),v=this.view,cells=v.structure.cells,item=this.grid.getItem(_10ba);util.fire(this.view,"onBeforeRow",[_10ba,cells]);for(var j=0,row;(row=cells[j]);j++){if(row.hidden||row.header){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,m,cc,cs;(cell=row[i]);i++){m=cell.markup;cc=cell.customClasses=[];cs=cell.customStyles=[];m[5]=cell.format(_10ba,item);m[1]=cc.join(" ");m[3]=cs.join(";");html.push.apply(html,m);}html.push("</tr>");}html.push("</table>");return html.join("");},decorateEvent:function(e){e.rowNode=this.findRowTarget(e.target);if(!e.rowNode){return false;}e.rowIndex=e.rowNode[_10a5];this.baseDecorateEvent(e);e.cell=this.grid.getCell(e.cellIndex);return true;}});var _10bb=dg._HeaderBuilder=lang.extend(function(view){this.moveable=null;_10a7.call(this,view);},_10a7.prototype,{_skipBogusClicks:false,overResizeWidth:4,minColWidth:1,update:function(){if(this.tableMap){this.tableMap.mapRows(this.view.structure.cells);}else{this.tableMap=new dg._TableMap(this.view.structure.cells);}},generateHtml:function(_10bc,_10bd){var html=this.getTableArray(),cells=this.view.structure.cells;util.fire(this.view,"onBeforeRow",[-1,cells]);for(var j=0,row;(row=cells[j]);j++){if(row.hidden){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,_10be;(cell=row[i]);i++){cell.customClasses=[];cell.customStyles=[];if(this.view.simpleStructure){if(cell.draggable){if(cell.headerClasses){if(cell.headerClasses.indexOf("dojoDndItem")==-1){cell.headerClasses+=" dojoDndItem";}}else{cell.headerClasses="dojoDndItem";}}if(cell.attrs){if(cell.attrs.indexOf("dndType='gridColumn_")==-1){cell.attrs+=" dndType='gridColumn_"+this.grid.id+"'";}}else{cell.attrs="dndType='gridColumn_"+this.grid.id+"'";}}_10be=this.generateCellMarkup(cell,cell.headerStyles,cell.headerClasses,true);_10be[5]=(_10bd!=undefined?_10bd:_10bc(cell));_10be[3]=cell.customStyles.join(";");_10be[1]=cell.customClasses.join(" ");html.push(_10be.join(""));}html.push("</tr>");}html.push("</table>");return html.join("");},getCellX:function(e){var n,x=e.layerX;if(has("mozilla")||has("ie")>=9){n=_10a0(e.target,_10a3("th"));x-=(n&&n.offsetLeft)||0;var t=e.sourceView.getScrollbarWidth();if(!this.grid.isLeftToRight()){table=_10a0(n,_10a3("table"));x-=(table&&table.offsetLeft)||0;}}n=_10a0(e.target,function(){if(!n||n==e.cellNode){return false;}x+=(n.offsetLeft<0?0:n.offsetLeft);return true;});return x;},decorateEvent:function(e){this.baseDecorateEvent(e);e.rowIndex=-1;e.cellX=this.getCellX(e);return true;},prepareResize:function(e,mod){do{var i=e.cellIndex;e.cellNode=(i?e.cellNode.parentNode.cells[i+mod]:null);e.cellIndex=(e.cellNode?this.getCellNodeIndex(e.cellNode):-1);}while(e.cellNode&&e.cellNode.style.display=="none");return Boolean(e.cellNode);},canResize:function(e){if(!e.cellNode||e.cellNode.colSpan>1){return false;}var cell=this.grid.getCell(e.cellIndex);return !cell.noresize&&cell.canResize();},overLeftResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return (e.cellIndex>0)&&(e.cellX>0&&e.cellX<this.overResizeWidth)&&this.prepareResize(e,-1);}var t=e.cellNode&&(e.cellX>0&&e.cellX<this.overResizeWidth);return t;},overRightResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return e.cellNode&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth);}return (e.cellIndex>0)&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth)&&this.prepareResize(e,-1);},domousemove:function(e){if(!this.moveable){var c=(this.overRightResizeArea(e)?"dojoxGridColResize":(this.overLeftResizeArea(e)?"dojoxGridColResize":""));if(c&&!this.canResize(e)){c="dojoxGridColNoResize";}html.toggleClass(e.sourceView.headerNode,"dojoxGridColNoResize",(c=="dojoxGridColNoResize"));html.toggleClass(e.sourceView.headerNode,"dojoxGridColResize",(c=="dojoxGridColResize"));if(c){event.stop(e);}}},domousedown:function(e){if(!this.moveable){if((this.overRightResizeArea(e)||this.overLeftResizeArea(e))&&this.canResize(e)){this.beginColumnResize(e);}else{this.grid.onMouseDown(e);this.grid.onMouseOverRow(e);}}},doclick:function(e){if(this._skipBogusClicks){event.stop(e);return true;}return false;},colResizeSetup:function(e,_10bf){var _10c0=html.contentBox(e.sourceView.headerNode);if(_10bf){this.lineDiv=document.createElement("div");var vw=html.position(e.sourceView.headerNode,true);var _10c1=html.contentBox(e.sourceView.domNode);var l=e.pageX;if(!this.grid.isLeftToRight()&&has("ie")<8){l-=_109b.getScrollbar().w;}html.style(this.lineDiv,{top:vw.y+"px",left:l+"px",height:(_10c1.h+_10c0.h)+"px"});html.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=l;win.body().appendChild(this.lineDiv);}var _10c2=[],nodes=this.tableMap.findOverlappingNodes(e.cellNode);for(var i=0,cell;(cell=nodes[i]);i++){_10c2.push({node:cell,index:this.getCellNodeIndex(cell),width:cell.offsetWidth});}var view=e.sourceView;var adj=this.grid.isLeftToRight()?1:-1;var views=e.grid.views.views;var _10c3=[];for(var j=view.idx+adj,cView;(cView=views[j]);j=j+adj){_10c3.push({node:cView.headerNode,left:window.parseInt(cView.headerNode.style.left)});}var table=view.headerContentNode.firstChild;var drag={scrollLeft:e.sourceView.headerNode.scrollLeft,view:view,node:e.cellNode,index:e.cellIndex,w:html.contentBox(e.cellNode).w,vw:_10c0.w,table:table,tw:html.contentBox(table).w,spanners:_10c2,followers:_10c3};return drag;},beginColumnResize:function(e){this.moverDiv=document.createElement("div");html.style(this.moverDiv,{position:"absolute",left:0});win.body().appendChild(this.moverDiv);html.addClass(this.grid.domNode,"dojoxGridColumnResizing");var m=(this.moveable=new _109a(this.moverDiv));var drag=this.colResizeSetup(e,true);m.onMove=lang.hitch(this,"doResizeColumn",drag);_1099.connect(m,"onMoveStop",lang.hitch(this,function(){this.endResizeColumn(drag);if(drag.node.releaseCapture){drag.node.releaseCapture();}this.moveable.destroy();delete this.moveable;this.moveable=null;html.removeClass(this.grid.domNode,"dojoxGridColumnResizing");}));if(e.cellNode.setCapture){e.cellNode.setCapture();}m.onMouseDown(e);},doResizeColumn:function(_10c4,mover,_10c5){var _10c6=_10c5.l;var data={deltaX:_10c6,w:_10c4.w+(this.grid.isLeftToRight()?_10c6:-_10c6),vw:_10c4.vw+_10c6,tw:_10c4.tw+_10c6};this.dragRecord={inDrag:_10c4,mover:mover,leftTop:_10c5};if(data.w>=this.minColWidth){if(!mover){this.doResizeNow(_10c4,data);}else{html.style(this.lineDiv,"left",(this.lineDiv._origLeft+data.deltaX)+"px");}}},endResizeColumn:function(_10c7){if(this.dragRecord){var _10c8=this.dragRecord.leftTop;var _10c9=this.grid.isLeftToRight()?_10c8.l:-_10c8.l;_10c9+=Math.max(_10c7.w+_10c9,this.minColWidth)-(_10c7.w+_10c9);if(has("webkit")&&_10c7.spanners.length){_10c9+=html._getPadBorderExtents(_10c7.spanners[0].node).w;}var data={deltaX:_10c9,w:_10c7.w+_10c9,vw:_10c7.vw+_10c9,tw:_10c7.tw+_10c9};this.doResizeNow(_10c7,data);delete this.dragRecord;}html.destroy(this.lineDiv);html.destroy(this.moverDiv);html.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=true;_10c7.view.update();this._skipBogusClicks=false;this.grid.onResizeColumn(_10c7.index);},doResizeNow:function(_10ca,data){_10ca.view.convertColPctToFixed();if(_10ca.view.flexCells&&!_10ca.view.testFlexCells()){var t=_109f(_10ca.node);if(t){(t.style.width="");}}var i,s,sw,f,fl;for(i=0;(s=_10ca.spanners[i]);i++){sw=s.width+data.deltaX;if(sw>0){s.node.style.width=sw+"px";_10ca.view.setColWidth(s.index,sw);}}if(this.grid.isLeftToRight()||!has("ie")){for(i=0;(f=_10ca.followers[i]);i++){fl=f.left+data.deltaX;f.node.style.left=fl+"px";}}_10ca.node.style.width=data.w+"px";_10ca.view.setColWidth(_10ca.index,data.w);_10ca.view.headerNode.style.width=data.vw+"px";_10ca.view.setColumnsWidth(data.tw);if(!this.grid.isLeftToRight()){_10ca.view.headerNode.scrollLeft=_10ca.scrollLeft+data.deltaX;}}});dg._TableMap=lang.extend(function(rows){this.mapRows(rows);},{map:null,mapRows:function(_10cb){var _10cc=_10cb.length;if(!_10cc){return;}this.map=[];var row;for(var k=0;(row=_10cb[k]);k++){this.map[k]=[];}for(var j=0;(row=_10cb[j]);j++){for(var i=0,x=0,cell,_10cd,_10ce;(cell=row[i]);i++){while(this.map[j][x]){x++;}this.map[j][x]={c:i,r:j};_10ce=cell.rowSpan||1;_10cd=cell.colSpan||1;for(var y=0;y<_10ce;y++){for(var s=0;s<_10cd;s++){this.map[j+y][x+s]=this.map[j][x];}}x+=_10cd;}}},dumpMap:function(){for(var j=0,row,h="";(row=this.map[j]);j++,h=""){for(var i=0,cell;(cell=row[i]);i++){h+=cell.r+","+cell.c+"   ";}}},getMapCoords:function(inRow,inCol){for(var j=0,row;(row=this.map[j]);j++){for(var i=0,cell;(cell=row[i]);i++){if(cell.c==inCol&&cell.r==inRow){return {j:j,i:i};}}}return {j:-1,i:-1};},getNode:function(_10cf,inRow,inCol){var row=_10cf&&_10cf.rows[inRow];return row&&row.cells[inCol];},_findOverlappingNodes:function(_10d0,inRow,inCol){var nodes=[];var m=this.getMapCoords(inRow,inCol);for(var j=0,row;(row=this.map[j]);j++){if(j==m.j){continue;}var rw=row[m.i];var n=(rw?this.getNode(_10d0,rw.r,rw.c):null);if(n){nodes.push(n);}}return nodes;},findOverlappingNodes:function(_10d1){return this._findOverlappingNodes(_109f(_10d1),_109d(_10d1.parentNode),_109c(_10d1));}});return {_Builder:_10a7,_HeaderBuilder:_10bb,_ContentBuilder:_10b7};});},"dojox/gauges/AnalogGauge":function(){define("dojox/gauges/AnalogGauge",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/html","dojo/_base/event","dojox/gfx","./_Gauge","./AnalogLineIndicator","dojo/dom-geometry"],function(dojo,_10d2,arr,lang,html,event,gfx,Gauge,_10d3,_10d4){return _10d2("dojox.gauges.AnalogGauge",Gauge,{startAngle:-90,endAngle:90,cx:0,cy:0,radius:0,orientation:"clockwise",_defaultIndicator:_10d3,startup:function(){if(this.getChildren){arr.forEach(this.getChildren(),function(child){child.startup();});}this.startAngle=Number(this.startAngle);this.endAngle=Number(this.endAngle);this.cx=Number(this.cx);if(!this.cx){this.cx=this.width/2;}this.cy=Number(this.cy);if(!this.cy){this.cy=this.height/2;}this.radius=Number(this.radius);if(!this.radius){this.radius=Math.min(this.cx,this.cy)-25;}this.inherited(arguments);},_getAngle:function(value){var v=Number(value);var angle;if(value==null||isNaN(v)||v<=this.min){angle=this._mod360(this.startAngle);}else{if(v>=this.max){angle=this._mod360(this.endAngle);}else{var _10d5=this._mod360(this.startAngle);var _10d6=(v-this.min);if(this.orientation!="clockwise"){_10d6=-_10d6;}angle=this._mod360(_10d5+this._getAngleRange()*_10d6/Math.abs(this.min-this.max));}}return angle;},_getValueForAngle:function(angle){var _10d7=this._mod360(this.startAngle);var _10d8=this._mod360(this.endAngle);if(!this._angleInRange(angle)){var min1=this._mod360(_10d7-angle);var min2=360-min1;var max1=this._mod360(_10d8-angle);var max2=360-max1;if(Math.min(min1,min2)<Math.min(max1,max2)){return this.min;}else{return this.max;}}else{var range=Math.abs(this.max-this.min);var _10d9=this._mod360(this.orientation=="clockwise"?(angle-_10d7):(-angle+_10d7));return this.min+range*_10d9/this._getAngleRange();}},_getAngleRange:function(){var range;var _10da=this._mod360(this.startAngle);var _10db=this._mod360(this.endAngle);if(_10da==_10db){return 360;}if(this.orientation=="clockwise"){if(_10db<_10da){range=360-(_10da-_10db);}else{range=_10db-_10da;}}else{if(_10db<_10da){range=_10da-_10db;}else{range=360-(_10db-_10da);}}return range;},_angleInRange:function(value){var _10dc=this._mod360(this.startAngle);var _10dd=this._mod360(this.endAngle);if(_10dc==_10dd){return true;}value=this._mod360(value);if(this.orientation=="clockwise"){if(_10dc<_10dd){return value>=_10dc&&value<=_10dd;}else{return !(value>_10dd&&value<_10dc);}}else{if(_10dc<_10dd){return !(value>_10dc&&value<_10dd);}else{return value>=_10dd&&value<=_10dc;}}},_isScaleCircular:function(){return (this._mod360(this.startAngle)==this._mod360(this.endAngle));},_mod360:function(v){while(v>360){v=v-360;}while(v<0){v=v+360;}return v;},_getRadians:function(angle){return angle*Math.PI/180;},_getDegrees:function(_10de){return _10de*180/Math.PI;},drawRange:function(group,range){var path;if(range.shape){range.shape.parent.remove(range.shape);range.shape=null;}var a1,a2;if((range.low==this.min)&&(range.high==this.max)&&((this._mod360(this.endAngle)==this._mod360(this.startAngle)))){path=group.createCircle({cx:this.cx,cy:this.cy,r:this.radius});}else{a1=this._getRadians(this._getAngle(range.low));a2=this._getRadians(this._getAngle(range.high));if(this.orientation=="cclockwise"){var a=a2;a2=a1;a1=a;}var x1=this.cx+this.radius*Math.sin(a1),y1=this.cy-this.radius*Math.cos(a1),x2=this.cx+this.radius*Math.sin(a2),y2=this.cy-this.radius*Math.cos(a2),big=0;var _10df;if(a1<=a2){_10df=a2-a1;}else{_10df=2*Math.PI-a1+a2;}if(_10df>Math.PI){big=1;}path=group.createPath();if(range.size){path.moveTo(this.cx+(this.radius-range.size)*Math.sin(a1),this.cy-(this.radius-range.size)*Math.cos(a1));}else{path.moveTo(this.cx,this.cy);}path.lineTo(x1,y1);path.arcTo(this.radius,this.radius,0,big,1,x2,y2);if(range.size){path.lineTo(this.cx+(this.radius-range.size)*Math.sin(a2),this.cy-(this.radius-range.size)*Math.cos(a2));path.arcTo((this.radius-range.size),(this.radius-range.size),0,big,0,this.cx+(this.radius-range.size)*Math.sin(a1),this.cy-(this.radius-range.size)*Math.cos(a1));}path.closePath();}if(lang.isArray(range.color)||lang.isString(range.color)){path.setStroke({color:range.color});path.setFill(range.color);}else{if(range.color.type){a1=this._getRadians(this._getAngle(range.low));a2=this._getRadians(this._getAngle(range.high));range.color.x1=this.cx+(this.radius*Math.sin(a1))/2;range.color.x2=this.cx+(this.radius*Math.sin(a2))/2;range.color.y1=this.cy-(this.radius*Math.cos(a1))/2;range.color.y2=this.cy-(this.radius*Math.cos(a2))/2;path.setFill(range.color);path.setStroke({color:range.color.colors[0].color});}else{if(gfx.svg){path.setStroke({color:"green"});path.setFill("green");path.getEventSource().setAttribute("class",range.color.style);}}}path.connect("onmouseover",lang.hitch(this,this._handleMouseOverRange,range));path.connect("onmouseout",lang.hitch(this,this._handleMouseOutRange,range));range.shape=path;},getRangeUnderMouse:function(e){var range=null,pos=_10d4.getContentBox(this.gaugeContent),x=e.clientX-pos.x,y=e.clientY-pos.y,r=Math.sqrt((y-this.cy)*(y-this.cy)+(x-this.cx)*(x-this.cx));if(r<this.radius){var angle=this._getDegrees(Math.atan2(y-this.cy,x-this.cx)+Math.PI/2),value=this._getValueForAngle(angle);if(this._rangeData){for(var i=0;(i<this._rangeData.length)&&!range;i++){if((Number(this._rangeData[i].low)<=value)&&(Number(this._rangeData[i].high)>=value)){range=this._rangeData[i];}}}}return range;},_dragIndicator:function(_10e0,e){this._dragIndicatorAt(_10e0,e.pageX,e.pageY);event.stop(e);},_dragIndicatorAt:function(_10e1,x,y){var pos=_10d4.position(_10e1.gaugeContent,true),xf=x-pos.x,yf=y-pos.y,angle=_10e1._getDegrees(Math.atan2(yf-_10e1.cy,xf-_10e1.cx)+Math.PI/2);var value=_10e1._getValueForAngle(angle);value=Math.min(Math.max(value,_10e1.min),_10e1.max);_10e1._drag.value=_10e1._drag.currentValue=value;_10e1._drag.onDragMove(_10e1._drag);_10e1._drag.draw(this._indicatorsGroup,true);_10e1._drag.valueChanged();}});});},"url:esri/dijit/templates/Gauge.html":"<div class=\"gaugeContainer\">\r\n  <div data-dojo-attach-point=\"titleNode\" class=\"gaugeTitle\">${title}</div>\r\n  <div data-dojo-attach-point=\"dataLabelWrapperNode\">\r\n    <div data-dojo-attach-point=\"dataLabelNode\">${dataLabel}</div>\r\n  </div>\r\n  <div data-dojo-attach-point=\"gaugeNode\" style=\"margin: -10px auto 10px auto; width: 240px; height: 120px;\"></div>\r\n  <div data-dojo-attach-point=\"captionNode\" class=\"gaugeCaption\">${caption}</div>\r\n</div>\r\n","dijit/form/FilteringSelect":function(){define("dijit/form/FilteringSelect",["dojo/data/util/filter","dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(_10e2,_10e3,lang,when,_10e4,_10e5){return _10e3("dijit.form.FilteringSelect",[_10e4,_10e5],{required:true,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened;},isValid:function(){return !!this.item||(!this.required&&this.get("displayedValue")=="");},_refreshState:function(){if(!this.searchTimer){this.inherited(arguments);}},_callbackSetLabel:function(_10e6,query,_10e7,_10e8){if((query&&query[this.searchAttr]!==this._lastQuery)||(!query&&_10e6.length&&this.store.getIdentity(_10e6[0])!=this._lastQuery)){return;}if(!_10e6.length){this.set("value","",_10e8||(_10e8===undefined&&!this.focused),this.textbox.value,null);}else{this.set("item",_10e6[0],_10e8);}},_openResultList:function(_10e9,query,_10ea){if(query[this.searchAttr]!==this._lastQuery){return;}this.inherited(arguments);if(this.item===undefined){this.validate(true);}},_getValueAttr:function(){return this.valueNode.value;},_getValueField:function(){return "value";},_setValueAttr:function(value,_10eb,_10ec,item){if(!this._onChangeActive){_10eb=null;}if(item===undefined){if(value===null||value===""){value="";if(!lang.isString(_10ec)){this._setDisplayedValueAttr(_10ec||"",_10eb);return;}}var self=this;this._lastQuery=value;when(this.store.get(value),function(item){self._callbackSetLabel(item?[item]:[],undefined,undefined,_10eb);});}else{this.valueNode.value=value;this.inherited(arguments);}},_setItemAttr:function(item,_10ed,_10ee){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value;},_getDisplayQueryString:function(text){return text.replace(/([\\\*\?])/g,"\\$1");},_setDisplayedValueAttr:function(label,_10ef){if(label==null){label="";}if(!this._created){if(!("displayedValue" in this.params)){return;}_10ef=false;}if(this.store){this.closeDropDown();var query=lang.clone(this.query);var qs=this._getDisplayQueryString(label),q;if(this.store._oldAPI){q=qs;}else{q=_10e2.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=query[this.searchAttr]=q;this.textbox.value=label;this._lastDisplayedValue=label;this._set("displayedValue",label);var _10f0=this;var _10f1={ignoreCase:this.ignoreCase,deep:true};lang.mixin(_10f1,this.fetchProperties);this._fetchHandle=this.store.query(query,_10f1);when(this._fetchHandle,function(_10f2){_10f0._fetchHandle=null;_10f0._callbackSetLabel(_10f2||[],query,_10f1,_10ef);},function(err){_10f0._fetchHandle=null;if(!_10f0._cancelingQuery){console.error("dijit.form.FilteringSelect: "+err.toString());}});}},undo:function(){this.set("displayedValue",this._lastDisplayedValue);}});});},"dojox/grid/_EditManager":function(){define("dojox/grid/_EditManager",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect","dojo/_base/sniff","./util"],function(lang,array,_10f3,_10f4,has,util){return _10f3("dojox.grid._EditManager",null,{constructor:function(_10f5){this.grid=_10f5;if(has("ie")){this.connections=[_10f4.connect(document.body,"onfocus",lang.hitch(this,"_boomerangFocus"))];}else{this.connections=[_10f4.connect(this.grid,"onBlur",this,"apply")];}},info:{},destroy:function(){array.forEach(this.connections,_10f4.disconnect);},cellFocus:function(_10f6,_10f7){if(this.grid.singleClickEdit||this.isEditRow(_10f7)){this.setEditCell(_10f6,_10f7);}else{this.apply();}if(this.isEditing()||(_10f6&&_10f6.editable&&_10f6.alwaysEditing)){this._focusEditor(_10f6,_10f7);}},rowClick:function(e){if(this.isEditing()&&!this.isEditRow(e.rowIndex)){this.apply();}},styleRow:function(inRow){if(inRow.index==this.info.rowIndex){inRow.customClasses+=" dojoxGridRowEditing";}},dispatchEvent:function(e){var c=e.cell,ed=(c&&c["editable"])?c:0;return ed&&ed.dispatchEvent(e.dispatch,e);},isEditing:function(){return this.info.rowIndex!==undefined;},isEditCell:function(_10f8,_10f9){return (this.info.rowIndex===_10f8)&&(this.info.cell.index==_10f9);},isEditRow:function(_10fa){return this.info.rowIndex===_10fa;},setEditCell:function(_10fb,_10fc){if(!this.isEditCell(_10fc,_10fb.index)&&this.grid.canEdit&&this.grid.canEdit(_10fb,_10fc)){this.start(_10fb,_10fc,this.isEditRow(_10fc)||_10fb.editable);}},_focusEditor:function(_10fd,_10fe){util.fire(_10fd,"focus",[_10fe]);},focusEditor:function(){if(this.isEditing()){this._focusEditor(this.info.cell,this.info.rowIndex);}},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>new Date().getTime();},_boomerangFocus:function(){if(this._shouldCatchBoomerang()){this.grid.focus.focusGrid();this.focusEditor();this._catchBoomerang=0;}},_doCatchBoomerang:function(){if(has("ie")){this._catchBoomerang=new Date().getTime()+this._boomerangWindow;}},start:function(_10ff,_1100,_1101){if(!this._isValidInput()){return;}this.grid.beginUpdate();this.editorApply();if(this.isEditing()&&!this.isEditRow(_1100)){this.applyRowEdit();this.grid.updateRow(_1100);}if(_1101){this.info={cell:_10ff,rowIndex:_1100};this.grid.doStartEdit(_10ff,_1100);this.grid.updateRow(_1100);}else{this.info={};}this.grid.endUpdate();this.grid.focus.focusGrid();this._focusEditor(_10ff,_1100);this._doCatchBoomerang();},_editorDo:function(_1102){var c=this.info.cell;if(c&&c.editable){c[_1102](this.info.rowIndex);}},editorApply:function(){this._editorDo("apply");},editorCancel:function(){this._editorDo("cancel");},applyCellEdit:function(_1103,_1104,_1105){if(this.grid.canEdit(_1104,_1105)){this.grid.doApplyCellEdit(_1103,_1105,_1104.field);}},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field);},apply:function(){if(this.isEditing()&&this._isValidInput()){this.grid.beginUpdate();this.editorApply();this.applyRowEdit();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},cancel:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorCancel();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},save:function(_1106,_1107){var c=this.info.cell;if(this.isEditRow(_1106)&&(!_1107||c.view==_1107)&&c.editable){c.save(c,this.info.rowIndex);}},restore:function(_1108,_1109){var c=this.info.cell;if(this.isEditRow(_1109)&&c.view==_1108&&c.editable){c.restore(this.info.rowIndex);}},_isValidInput:function(){var w=(this.info.cell||{}).widget;if(!w||!w.isValid){return true;}w.focused=true;return w.isValid(true);}});});},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(lang){var _110a={};lang.setObject("dojo.data.util.sorter",_110a);_110a.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_110a.createSortFunction=function(_110b,store){var _110c=[];function _110d(attr,dir,comp,s){return function(itemA,itemB){var a=s.getValue(itemA,attr);var b=s.getValue(itemB,attr);return dir*comp(a,b);};};var _110e;var map=store.comparatorMap;var bc=_110a.basicComparator;for(var i=0;i<_110b.length;i++){_110e=_110b[i];var attr=_110e.attribute;if(attr){var dir=(_110e.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_110c.push(_110d(attr,dir,comp,store));}}return function(rowA,rowB){var i=0;while(i<_110c.length){var ret=_110c[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _110a;});},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(dojo,lang,Color,_110f){var _1110={};lang.setObject("dojo.colors",_1110);var _1111=function(m1,m2,h){if(h<0){++h;}if(h>1){--h;}var h6=6*h;if(h6<1){return m1+(m2-m1)*h6;}if(2*h<1){return m2;}if(3*h<2){return m1+(m2-m1)*(2/3-h)*6;}return m1;};dojo.colorFromRgb=Color.fromRgb=function(color,obj){var m=color.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(m){var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1],a;if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){var r=c[0];if(r.charAt(r.length-1)=="%"){a=_110f.map(c,function(x){return parseFloat(x)*2.56;});if(l==4){a[3]=c[3];}return Color.fromArray(a,obj);}return Color.fromArray(c,obj);}if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2;a=[_1111(m1,m2,H+1/3)*256,_1111(m1,m2,H)*256,_1111(m1,m2,H-1/3)*256,1];if(l==4){a[3]=c[3];}return Color.fromArray(a,obj);}}return null;};var _1112=function(c,low,high){c=Number(c);return isNaN(c)?high:c<low?low:c>high?high:c;};Color.prototype.sanitize=function(){var t=this;t.r=Math.round(_1112(t.r,0,255));t.g=Math.round(_1112(t.g,0,255));t.b=Math.round(_1112(t.b,0,255));t.a=_1112(t.a,0,1);return this;};_1110.makeGrey=Color.makeGrey=function(g,a){return Color.fromArray([g,g,g,a]);};lang.mixin(Color.named,{"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"blanchedalmond":[255,235,205],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"oldlace":[253,245,230],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"whitesmoke":[245,245,245],"yellowgreen":[154,205,50]});return Color;});},"url:dijit/form/templates/Spinner.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitButtonNode dijitSpinnerButtonContainer\"\n\t\t><input class=\"dijitReset dijitInputField dijitSpinnerButtonInner\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t/><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\n\t\t\tdata-dojo-attach-point=\"upArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9650; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\tdata-dojo-attach-point=\"downArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' data-dojo-attach-point=\"textbox,focusNode\" type=\"${type}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\"\n\t\t\trole=\"spinbutton\" autocomplete=\"off\" ${!nameAttrSetting}\n\t/></div\n></div>\n","url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n","dojox/date/islamic/Date":function(){define("dojox/date/islamic/Date",["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(lang,_1113,dd){var IDate=_1113("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var len=arguments.length;if(!len){this.fromGregorian(new Date());}else{if(len==1){var arg0=arguments[0];if(typeof arg0=="number"){arg0=new Date(arg0);}if(arg0 instanceof Date){this.fromGregorian(arg0);}else{if(arg0==""){this._date=new Date("");}else{this._year=arg0._year;this._month=arg0._month;this._date=arg0._date;this._hours=arg0._hours;this._minutes=arg0._minutes;this._seconds=arg0._seconds;this._milliseconds=arg0._milliseconds;}}}else{if(len>=3){this._year+=arguments[0];this._month+=arguments[1];this._date+=arguments[2];this._hours+=arguments[3]||0;this._minutes+=arguments[4]||0;this._seconds+=arguments[5]||0;this._milliseconds+=arguments[6]||0;}}}},getDate:function(){return this._date;},getMonth:function(){return this._month;},getFullYear:function(){return this._year;},getDay:function(){return this.toGregorian().getDay();},getHours:function(){return this._hours;},getMinutes:function(){return this._minutes;},getSeconds:function(){return this._seconds;},getMilliseconds:function(){return this._milliseconds;},setDate:function(date){date=parseInt(date);if(date>0&&date<=this.getDaysInIslamicMonth(this._month,this._year)){this._date=date;}else{var mdays;if(date>0){for(mdays=this.getDaysInIslamicMonth(this._month,this._year);date>mdays;date-=mdays,mdays=this.getDaysInIslamicMonth(this._month,this._year)){this._month++;if(this._month>=12){this._year++;this._month-=12;}}this._date=date;}else{for(mdays=this.getDaysInIslamicMonth((this._month-1)>=0?(this._month-1):11,((this._month-1)>=0)?this._year:this._year-1);date<=0;mdays=this.getDaysInIslamicMonth((this._month-1)>=0?(this._month-1):11,((this._month-1)>=0)?this._year:this._year-1)){this._month--;if(this._month<0){this._year--;this._month+=12;}date+=mdays;}this._date=date;}}return this;},setFullYear:function(year){this._year=+year;},setMonth:function(month){this._year+=Math.floor(month/12);if(month>0){this._month=Math.floor(month%12);}else{this._month=Math.floor(((month%12)+12)%12);}},setHours:function(){var _1114=arguments.length;var hours=0;if(_1114>=1){hours=parseInt(arguments[0]);}if(_1114>=2){this._minutes=parseInt(arguments[1]);}if(_1114>=3){this._seconds=parseInt(arguments[2]);}if(_1114==4){this._milliseconds=parseInt(arguments[3]);}while(hours>=24){this._date++;var mdays=this.getDaysInIslamicMonth(this._month,this._year);if(this._date>mdays){this._month++;if(this._month>=12){this._year++;this._month-=12;}this._date-=mdays;}hours-=24;}this._hours=hours;},_addMinutes:function(_1115){_1115+=this._minutes;this.setMinutes(_1115);this.setHours(this._hours+parseInt(_1115/60));return this;},_addSeconds:function(_1116){_1116+=this._seconds;this.setSeconds(_1116);this._addMinutes(parseInt(_1116/60));return this;},_addMilliseconds:function(_1117){_1117+=this._milliseconds;this.setMilliseconds(_1117);this._addSeconds(parseInt(_1117/1000));return this;},setMinutes:function(_1118){this._minutes=_1118%60;return this;},setSeconds:function(_1119){this._seconds=_1119%60;return this;},setMilliseconds:function(_111a){this._milliseconds=_111a%1000;return this;},toString:function(){if(isNaN(this._date)){return "Invalidate Date";}else{var x=new Date();x.setHours(this._hours);x.setMinutes(this._minutes);x.setSeconds(this._seconds);x.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+x.toTimeString();}},toGregorian:function(){var hYear=this._year;var _111b=this._month;var hDate=this._date;var _111c=hDate+Math.ceil(29.5*_111b)+(hYear-1)*354+Math.floor((3+(11*hYear))/30)+this._ISLAMIC_EPOCH-1;var wjd=Math.floor(_111c-0.5)+0.5,_111d=wjd-this._GREGORIAN_EPOCH,_111e=Math.floor(_111d/146097),dqc=this._mod(_111d,146097),cent=Math.floor(dqc/36524),dcent=this._mod(dqc,36524),quad=Math.floor(dcent/1461),dquad=this._mod(dcent,1461),_111f=Math.floor(dquad/365),year=(_111e*400)+(cent*100)+(quad*4)+_111f;if(!(cent==4||_111f==4)){year++;}var _1120=this._GREGORIAN_EPOCH+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400);var _1121=wjd-_1120;var tjd=(this._GREGORIAN_EPOCH-1)+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400)+Math.floor((739/12)+((dd.isLeapYear(new Date(year,3,1))?-1:-2))+1);var _1122=((wjd<tjd)?0:(dd.isLeapYear(new Date(year,3,1))?1:2));var month=Math.floor((((_1121+_1122)*12)+373)/367);var tjd2=(this._GREGORIAN_EPOCH-1)+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400)+Math.floor((((367*month)-362)/12)+((month<=2)?0:(dd.isLeapYear(new Date(year,month,1))?-1:-2))+1);var day=(wjd-tjd2)+1;var gdate=new Date(year,(month-1),day,this._hours,this._minutes,this._seconds,this._milliseconds);return gdate;},fromGregorian:function(gdate){var date=new Date(gdate);var gYear=date.getFullYear(),_1123=date.getMonth(),gDay=date.getDate();var _1124=(this._GREGORIAN_EPOCH-1)+(365*(gYear-1))+Math.floor((gYear-1)/4)+(-Math.floor((gYear-1)/100))+Math.floor((gYear-1)/400)+Math.floor((((367*(_1123+1))-362)/12)+(((_1123+1)<=2)?0:(dd.isLeapYear(date)?-1:-2))+gDay);_1124=Math.floor(_1124)+0.5;var days=_1124-this._ISLAMIC_EPOCH;var hYear=Math.floor((30*days+10646)/10631);var _1125=Math.ceil((days-29-this._yearStart(hYear))/29.5);_1125=Math.min(_1125,11);var hDay=Math.ceil(days-this._monthStart(hYear,_1125))+1;this._date=hDay;this._month=_1125;this._year=hYear;this._hours=date.getHours();this._minutes=date.getMinutes();this._seconds=date.getSeconds();this._milliseconds=date.getMilliseconds();this._day=date.getDay();return this;},valueOf:function(){return this.toGregorian().valueOf();},_yearStart:function(year){return (year-1)*354+Math.floor((3+11*year)/30);},_monthStart:function(year,month){return Math.ceil(29.5*month)+(year-1)*354+Math.floor((3+11*year)/30);},_civilLeapYear:function(year){return (14+11*year)%30<11;},getDaysInIslamicMonth:function(month,year){var _1126=0;_1126=29+((month+1)%2);if(month==11&&this._civilLeapYear(year)){_1126++;}return _1126;},_mod:function(a,b){return a-(b*Math.floor(a/b));}});IDate.getDaysInIslamicMonth=function(month){return new IDate().getDaysInIslamicMonth(month.getMonth(),month.getFullYear());};return IDate;});},"esri/dijit/editing/TemplatePicker":function(){define(["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/html","dojo/_base/array","dojo/_base/json","dojo/_base/kernel","dojo/has","dojo/query","dojo/sniff","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojo/data/ItemFileReadStore","dojox/grid/DataGrid","dojox/gfx","esri/layers/FeatureLayer","esri/symbols/PictureMarkerSymbol","esri/dijit/editing/TemplatePickerItem","esri/kernel","esri/lang","esri/request","esri/dijit/_EventedWidget","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/editing/templates/TemplatePicker.html"],function(_1127,_1128,lang,_1129,html,array,_112a,_112b,has,query,sniff,_112c,_112d,_112e,_112f,_1130,_1131,_1132,_1133,gfx,_1134,_1135,_1136,_1137,_1138,_1139,_113a,_113b,_113c){var TP=_1128([_113a,_1130,_1131],{declaredClass:"esri.dijit.editing.TemplatePicker",widgetsInTemplate:true,templateString:_113c,basePath:_1127.toUrl("esri/dijit/editing")+"/",featureLayers:null,items:null,grouping:true,showTooltip:false,maxLabelLength:0,rows:4,_rows:0,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:true,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(_113d,_113e){_113d=_113d||{};if(!_113d.items&&!_113d.featureLayers){console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");}this._dojo14x=(_112b.version.minor>=4);this._itemWidgets={};if(_113d.featureLayers&&_113d.featureLayers.length){this._flChanged=1;}this._nls=_113b.widgets.templatePicker;this.emptyMessage=_113d.emptyMessage||(this._nls&&this._nls.creationDisabled)||"";},postMixInProperties:function(){this.inherited(arguments);this._preprocess();},startup:function(){this.inherited(arguments);if(this.rows==="auto"&&this.columns==="auto"){var box=_112e.getContentBox(this.domNode);if(!box.w){this.domNode.style.width=this._initialAutoWidth+"px";}if(!box.h){this.domNode.style.height=this._initialAutoHeight+"px";}box=_112e.getContentBox(this.domNode);this._columns=Math.floor(box.w/this._assumedCellWidth)||1;}this._applyGridPatches();this._setGridLayout();_1129.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();if(has("ie")<9){this._repaintItems=lang.hitch(this,this._repaintItems);setTimeout(this._repaintItems,this._ieTimer);}},destroy:function(){this.showTooltip=false;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments);},getSelected:function(){return this._selectedCell?this._selectedItem:null;},clearSelection:function(){var _113f=this._selectedCell,info=this._selectedInfo;if(_113f){this._rowClicked({cellNode:_113f,rowIndex:info.selRow,cellIndex:info.selCol});}},update:function(_1140){var _1141=(this.rows==="auto"&&this.columns==="auto"&&_1140)?true:false,grid=this.grid,box;if(_1141){var _1142=this.domNode,id=_1142.id,width,item=_112b.query("#"+id+".templatePicker div.item")[0];box=_112e.getContentBox(_1142);item=item&&item.parentNode;if(item){width=html.coords(item).w;}else{width=this._assumedCellWidth;}this._columns=Math.floor((box.w-grid.views.views[0].getScrollbarWidth())/width);this._columns=this._columns||1;}var _1143=this._rows;this._preprocess();var _1144=this._rows;this._setGridLayout();this._setGridData();if(_1144!==_1143){grid.set("autoHeight",this._rows,false);}if(_1141){grid._resize({w:box.w,h:box.h});grid.viewsHeaderNode.style.display="none";}else{grid.update();}this._toggleTooltip();var self=this,_1145=this.getSelected();if(_1145){grid.store.fetch({onComplete:function(its){var found=self._locate(_1145,self._selectedInfo,its);var _1146=found&&grid.views.views[0].getCellNode(found[0],found[1]);if(_1146){self._rowClicked({cellNode:_1146,rowIndex:found[0],cellIndex:found[1]},true);}}});}if(has("ie")<9){setTimeout(this._repaintItems,this._ieTimer);}var _1147=this.featureLayers,items=this.items;if((!_1147||!_1147.length)&&(!items||!items.length)&&grid&&this.emptyMessage){grid.showMessage(this.emptyMessage);}},_eventMap:{"selection-change":true},onSelectionChange:function(){},_setUseLegendAttr:function(use){var _1148=this.useLegend;if(!this._started||_1148!==use){if(use){this._flChanged=1;}else{this._clearLegendInfo();}}this.useLegend=use;},_setFeatureLayersAttr:function(_1149){var _114a=this.featureLayers;if(!this._started||_114a!==_1149){this._flChanged=1;}this.featureLayers=_1149;},_adjustRowsCols:function(items){if(this.rows==="auto"&&this.columns==="auto"){if(!this._started){this._rows=false;this._columns=null;this._autoWidth=false;}return;}var len=0;this._rows=this.rows;this._columns=this.columns;if(this.rows==="auto"){if(this.featureLayers){if(this.grouping){len=items.length;array.forEach(items,function(_114b){len+=Math.ceil(_114b.length/this.columns);},this);}else{array.forEach(items,function(_114c){len+=_114c.length;},this);len=Math.ceil(len/this.columns);}}else{len=Math.ceil(items.length/this.columns);}this._rows=len;}else{if(this.columns==="auto"){if(this.featureLayers){if(this.grouping){len=3;}else{array.forEach(items,function(_114d){len+=_114d.length;},this);len=Math.ceil(len/this.rows);}}else{len=Math.ceil(items.length/this.rows);}this._columns=len;}}},_preprocess:function(){if(this.items){this.grouping=false;}this._autoWidth=false;if(this.rows==="auto"||this.columns==="auto"){this._autoWidth=true;}var items;if(this.featureLayers){if(this.useLegend&&this._flChanged){this._legendIndices=[];this._loadingIndices=[];this._legendSymbols={};this._ignoreLegends();this._loadingLegends=[];clearTimeout(this._legendTimer);this._legendTimer=null;this._processSelectionLayers();this._flChanged=0;}if(array.every(this.featureLayers,function(_114e){return _114e.loaded;})){items=this._flItems=this._getItemsFromLayers(this.featureLayers);this._adjustRowsCols(items);}else{var count=this.featureLayers.length;var _114f=[];array.forEach(this.featureLayers,function(_1150){if(_1150.loaded){count--;_114f.push(_1150);}else{var _1151=_1129.connect(_1150,"onLoad",this,function(layer){_1129.disconnect(_1151);_1151=null;count--;_114f.push(layer);if(!count){items=this._flItems=this._getItemsFromLayers(_114f);this._adjustRowsCols(items);this.update();}});}},this);}}else{items=this._itItems=this._getItemsFromItems(this.items);this._adjustRowsCols(items);}},_processSelectionLayers:function(){var map,_1152,info,_1153,key,_1154,_1155,_1156={};array.forEach(this.featureLayers,function(layer,idx){if(layer.mode===_1134.MODE_SELECTION&&layer._map&&layer.url&&layer._params.drawMode&&!layer.source){_1152=lang.trim(layer._url.path).replace(/\/(MapServer|FeatureServer).*/ig,"/MapServer").replace(/^https?:\/\//ig,"").toLowerCase();info=(_1156[_1152]=_1156[_1152]||{});_1153=(info.featureLayers=info.featureLayers||{});_1154=(info.indices=info.indices||[]);_1153[idx]=layer;_1154.push(idx);map=layer._map;}});if(map){array.forEach(map.layerIds,function(layer){layer=map.getLayer(layer);if(layer&&layer.url&&(layer.getImageUrl||layer.getTileUrl)&&layer.loaded&&layer.version>=10.1){_1152=lang.trim(layer._url.path).replace(/(\/MapServer).*/ig,"$1");key=_1152.replace(/^https?:\/\//ig,"").toLowerCase();if(_1156[key]&&(!_1156[key].mapServiceUrl)){info=_1156[key];info.mapServiceUrl=_1152;info.mapServiceLayer=layer;this._legendIndices=this._legendIndices.concat(info.indices);_1155=this._fetchLegend({pickerInstance:this,info:info},key);if(_1155.then){this._loadingIndices=this._loadingIndices.concat(info.indices);this._loadingLegends.push(_1155);}else{this._processLegendResponse(_1155,info);}}}},this);}},_fetchLegend:function(_1157,key){var proto=TP.prototype,_1158=proto.legendCache[key];if(!_1158){_1158=(proto.legendCache[key]=_1139({url:_1157.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}));_1158._contexts=[_1157];_1158.addBoth(function(_1159){if(_1158.canceled){return;}proto.legendCache[key]=_1159;var _115a=_1158._contexts;_1158._contexts=null;array.forEach(_115a,function(ctxt){var _115b=ctxt.pickerInstance,info=ctxt.info,found;if(_115b._destroyed){return;}array.forEach(info.indices,function(idx){found=array.indexOf(_115b._loadingIndices,idx);if(found>-1){_115b._loadingIndices.splice(found,1);}});found=array.indexOf(_115b._loadingLegends,_1158);if(found>-1){_115b._loadingLegends.splice(found,1);}_115b._processLegendResponse(_1159,info);});});}else{if(_1158.then){_1158._contexts.push(_1157);}}return _1158;},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null;},_ignoreLegends:function(){if(this._loadingLegends){array.forEach(this._loadingLegends,function(_115c){var found=-1;array.some(_115c._contexts,function(ctxt,idx){if(ctxt.pickerInstance===this){found=idx;}return (found>-1);},this);if(found>-1){_115c._contexts.splice(found,1);}},this);}},_processLegendResponse:function(_115d,info){if(_115d&&!(_115d instanceof Error)){array.forEach(info.indices,function(idx){var _115e=info.featureLayers[idx].layerId,i,_115f=info.mapServiceUrl+"/"+_115e+"/images/",token=info.mapServiceLayer._getToken(),found,obj,_1160,url;if(this._legendSymbols[idx]){return;}found=null;array.some(_115d.layers,function(_1161){if(_1161.layerId==_115e){found=_1161;}return !!found;});if(found){obj=(this._legendSymbols[idx]={});array.forEach(found.legend,function(_1162){_1160=_1162.values;if(_1160&&_1160.length){for(i=0;i<_1160.length;i++){obj[_1160[i]]=_1162;}}else{obj.defaultSymbol=_1162;}url=_1162.url;if(url&&!_1162._fixed){_1162._fixed=1;if((url.search(/https?\:/)===-1)){_1162.url=_115f+url;}if(token&&_1162.url.search(/https?\:/)!==-1){_1162.url+=(((_1162.url.indexOf("?")>-1)?"&":"?")+"token="+token);}}});}},this);}else{var found;array.forEach(info.indices,function(idx){found=array.indexOf(this._legendIndices,idx);if(found>-1){this._legendIndices.splice(found,1);}},this);}var self=this;if(self._started&&!self._legendTimer){self._legendTimer=setTimeout(function(){clearTimeout(self._legendTimer);self._legendTimer=null;if(!self._destroyed){self.update();}},0);}},_applyGridPatches:function(){var grid=this.grid;var _1163=grid.adaptWidth,views,i,view;grid.adaptWidth=function(){views=this.views.views;for(i=0;view=views[i];i++){_112f.set(view.headerNode,"display","block");}_1163.apply(this,arguments);for(i=0;view=views[i];i++){_112f.set(view.headerNode,"display","none");}};if(this._dojo14x){if(this.rows!=="auto"&&this.columns!=="auto"){var _1164=_1129.connect(grid,"_onFetchComplete",this,function(){_1129.disconnect(_1164);this.grid.set("autoHeight",this._rows);});}_1129.connect(grid,"_onDelete",this,this._destroyItems);_1129.connect(grid,"_clearData",this,this._destroyItems);_1129.connect(grid,"destroy",this,this._destroyItems);var focus=grid.focus;if(focus&&focus.findAndFocusGridCell){focus.findAndFocusGridCell=function(){return false;};}}},_setGridLayout:function(){var _1165=function(_1166){return function(_1167,_1168){return this._cellGet(_1166,_1167,_1168);};};var _1169=lang.hitch(this,this._cellFormatter),cells=[],cols=this._columns,i;for(i=0;i<cols;i++){cells.push({field:"cell"+i,get:lang.hitch(this,_1165(i)),formatter:_1169});}var _116a={cells:[cells]};if(this.grouping){var _116b={field:"groupName",colSpan:cols,get:lang.hitch(this,this._cellGetGroup),formatter:lang.hitch(this,this._cellGroupFormatter)};_116a.cells.push([_116b]);}var grid=this.grid,_116c=_1133.prototype.rowsPerPage;grid.set("rowsPerPage",(this._rows>_116c)?this._rows:_116c);grid.set("structure",_116a);},_setGridData:function(){var _116d=[];if(this.grouping){this._groupRowIndices=[];var _116e,_116f,cols=this._columns;array.forEach(this._flItems,function(_1170,idx){_116d.push({});var index=(idx===0)?0:(_116e+_116f+1);this._groupRowIndices.push(index);_116e=index;_116f=Math.ceil(_1170.length/cols);_116d=_116d.concat(this._getStoreItems(_1170));},this);}else{if(this.featureLayers){array.forEach(this._flItems,function(_1171){_116d=_116d.concat(_1171);});_116d=this._getStoreItems(_116d);}else{_116d=this._getStoreItems(this._itItems);}}var store=new _1132({data:{items:_116d}});this.grid.setStore(store);},_toggleTooltip:function(){if(this.showTooltip){if(this.tooltip){return;}this.tooltip=_112d.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var grid=this.grid;this._mouseOverConnect=_1129.connect(grid,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=_1129.connect(grid,"onCellMouseOut",this,this._cellMouseOut);}else{if(this.tooltip){_1129.disconnect(this._mouseOverConnect);_1129.disconnect(this._mouseOutConnect);_112d.destroy(this.tooltip);this.tooltip=null;}}},_rowClicked:function(evt,_1172){var _1173=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_1173,row,col);if(!cell){return;}var store=this.grid.store;if(store.getValue(cell,"loadingCell")){return;}if(this._selectedCell){_112c.remove(this._selectedCell,"selectedItem");}if(_1173!==this._selectedCell){_112c.add(_1173,"selectedItem");this._selectedCell=_1173;this._selectedItem={featureLayer:store.getValue(cell,"layer"),type:store.getValue(cell,"type"),template:store.getValue(cell,"template"),symbolInfo:store.getValue(cell,"symbolInfo"),item:this._getItem(cell)};this._selectedInfo={selRow:row,selCol:col,index1:store.getValue(cell,"index1"),index2:store.getValue(cell,"index2"),index:store.getValue(cell,"index")};}else{this._selectedCell=this._selectedInfo=this._selectedItem=null;}if(!_1172){this.onSelectionChange();}},_locate:function(_1174,info,_1175){var store=this.grid.store,cols=new Array(this._columns);var found,_1176=info.index1,_1177=info.index2,index=info.index,item=_1174.item;array.some(_1175,function(_1178,_1179){return array.some(cols,function(_117a,_117b){var cell=store.getValue(_1178,"cell"+_117b);if(cell&&(item?(index===store.getValue(cell,"index")):(_1176===store.getValue(cell,"index1")&&_1177===store.getValue(cell,"index2")))){found=[_1179,_117b];return true;}else{return false;}});});return found;},_getCellInfo:function(_117c,row,col){if(!_117c){return;}var grid=this.grid;var item=grid.getItem(row);var cell=grid.store.getValue(item,"cell"+col);return cell;},_getItem:function(cell){var items=this.items;if(items){return items[this.grid.store.getValue(cell,"index")];}},_cellMouseOver:function(evt){var _117d=this.tooltip;var _117e=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_117e,row,col);if(_117d&&cell){var store=this.grid.store;var _117f=store.getValue(cell,"template");var type=store.getValue(cell,"type");var _1180=store.getValue(cell,"symbolInfo");var layer=store.getValue(cell,"layer");var item=this._getItem(cell);var label=(item&&(item.label+(item.description?(": "+item.description):"")))||(_117f&&(_117f.name+(_117f.description?(": "+_117f.description):"")))||(type&&type.name)||(_1180&&(_1180.label+(_1180.description?(": "+_1180.description):"")))||((layer&&layer.name+": ")+"Default");_117d.style.display="none";_117d.innerHTML=label;var _1181=html.coords(_117e.firstChild);_112f.set(_117d,{left:(_1181.x)+"px",top:(_1181.y+_1181.h+5)+"px"});_117d.style.display="";}},_cellMouseOut:function(){var _1182=this.tooltip;if(_1182){_1182.style.display="none";}},_destroyItems:function(){var _1183=this._itemWidgets,w;for(w in _1183){if(!_1183[w]){continue;}_1183[w].destroy();delete _1183[w];}},_repaintItems:function(){var _1184=this._itemWidgets,w;for(w in _1184){var _1185=_1184[w];if(_1185){_1185._repaint(_1185._surface);}}},_getStoreItems:function(_1186){var uid=this._uniqueId;_1186=array.map(_1186,function(item){return lang.mixin({"surfaceId":"tpick-surface-"+(uid.id++)},item);});var len=_1186.length,index=0,obj={},k=0,prop,_1187=[],flag=true,cols=this._columns;while(index<len){flag=true;prop="cell"+k;obj[prop]=_1186[index];index++;k++;if(k%cols===0){flag=false;_1187.push(obj);obj={};k=0;}}if(flag&&len){_1187.push(obj);}return _1187;},_getItemsFromLayers:function(_1188){var items=[];array.forEach(_1188,function(layer,_1189){items.push(this._getItemsFromLayer(layer,_1189));},this);return items;},_getItemsFromLayer:function(layer,_118a){var items=[];if(this.useLegend&&array.indexOf(this._loadingIndices,_118a)>-1){return [{label:(this._nls&&this._nls.loading)||"",symbol:null,layer:layer,type:null,template:null,index1:_118a,index2:0,loadingCell:1}];}var _118b=[];_118b=_118b.concat(layer.templates);array.forEach(layer.types,function(fType){var _118c=fType.templates;array.forEach(_118c,function(_118d){_118d._type_=fType;});_118b=_118b.concat(_118c);});_118b=array.filter(_118b,_1138.isDefined);var _118e=layer.renderer;if(_118e){var _118f=_118e.declaredClass.replace("esri.renderer.","");if(_118b.length>0){array.forEach(_118b,function(_1190){var proto=_1190.prototype;if(proto){var _1191=_118e.getSymbol(proto);if(_1191){var found=null,pms,_1192;if(this.useLegend&&array.indexOf(this._legendIndices,_118a)>-1){_1192=this._legendSymbols&&this._legendSymbols[_118a];if(_1192){switch(_118f){case "SimpleRenderer":found=_1192.defaultSymbol;break;case "UniqueValueRenderer":array.some(_118e.infos,function(info){if(info.symbol===_1191){found=_1192[info.value];}return !!found;});break;case "ClassBreaksRenderer":array.some(_118e.infos,function(info){if(info.symbol===_1191){found=_1192[info.maxValue];}return !!found;});break;}}if(found){pms=_112a.fromJson(_112a.toJson(_1135.defaultProps));pms.url=found.url;pms.imageData=found.imageData;pms.contentType=found.contentType;pms.width=found.width;pms.height=found.height;if(!_1138.isDefined(pms.width)||!_1138.isDefined(pms.height)){pms.width=15;pms.height=15;}found=new _1135(pms);}}items.push({label:this._trimLabel(_1190.name),symbol:found||_1191,legendOverride:!!found,layer:layer,type:_1190._type_,template:_1190,index1:_118a,index2:items.length});}}delete _1190._type_;},this);}else{var infos=[];if(_118f==="TemporalRenderer"){_118e=_118e.observationRenderer;if(_118e){_118f=_118e.declaredClass.replace("esri.renderer.","");}}switch(_118f){case "SimpleRenderer":infos=[{symbol:_118e.symbol,label:_118e.label,description:_118e.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":infos=_118e.infos;break;}items=array.map(infos,function(info,idx){return {label:this._trimLabel(info.label),description:info.description,symbolInfo:lang.mixin({constructor:function(){}},info),symbol:info.symbol,layer:layer,index1:_118a,index2:idx};},this);}}return items;},_getItemsFromItems:function(_1193){return array.map(_1193,function(item,idx){item=lang.mixin({index:idx},item);item.label=this._trimLabel(item.label);return item;},this);},_trimLabel:function(label){var max=this.maxLabelLength;if(max&&label){if(label.length>max){label=label.substr(0,max)+"...";}}return label||"";},_cellGet:function(_1194,_1195,_1196){if(!_1196){return "";}return this.grid.store.getValue(_1196,"cell"+_1194);},_cellFormatter:function(value){if(value){var _1197=this._itemWidgets,store=this.grid.store;var sid=store.getValue(value,"surfaceId");var w=_1197[sid];if(!w){w=(_1197[sid]=new _1136({id:sid,label:store.getValue(value,"label"),symbol:store.getValue(value,"symbol"),legendOverride:store.getValue(value,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:store.getValue(value,"template")}));}return w||"";}else{return "";}},_cellGetGroup:function(_1198,_1199){if(!this._groupRowIndices){return "";}var found=array.indexOf(this._groupRowIndices,_1198);if(!_1199||found===-1){return "";}return (this.featureLayers[found]&&this.featureLayers[found].name)||"";},_cellGroupFormatter:function(value){if(value){return "<div class='groupLabel'>"+value+"</div>";}else{return "";}}});if(has("extend-esri")){lang.setObject("dijit.editing.TemplatePicker",TP,_1137);}return TP;});},"esri/dijit/TimeSlider":function(){require({cache:{"url:dojox/form/resources/HorizontalRangeSlider.html":"<table class=\"dijit dijitReset dijitSlider dijitSliderH dojoxRangeSlider\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\" role=\"presentation\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"topDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderDecrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper\" dojoAttachEvent=\"onmousedown:_onClkDecBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\n\t\t\t/><div role=\"presentation\" class=\"dojoxRangeSliderBarContainer\" dojoAttachPoint=\"sliderBarContainer\"\n\t\t\t\t><div dojoAttachPoint=\"sliderHandle\" tabIndex=\"${tabIndex}\" class=\"dijitSliderMoveable dijitSliderMoveableH\" dojoAttachEvent=\"onmousedown:_onHandleClick\" role=\"slider\"\n\t\t\t\t\t><div class=\"dijitSliderImageHandle dijitSliderImageHandleH\"></div\n\t\t\t\t></div\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"progressBar,focusNode\" class=\"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"></div\n\t\t\t\t><div dojoAttachPoint=\"sliderHandleMax\" tabIndex=\"${tabIndex}\" class=\"dijitSliderMoveable dijitSliderMoveableH\" dojoAttachEvent=\"onmousedown:_onHandleClickMax\" role=\"slider\"\n\t\t\t\t\t><div class=\"dijitSliderImageHandle dijitSliderImageHandleH\"></div\n\t\t\t\t></div\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH\" dojoAttachEvent=\"onmousedown:_onRemainingBarClick\"></div\n\t\t\t></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper\" dojoAttachEvent=\"onmousedown:_onClkIncBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderIncrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"containerNode,bottomDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n></table>\n","url:esri/dijit/templates/TimeSlider.html":"   <div class=\"esriTimeSlider\">\r\n   <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\r\n   <tr>\r\n   <td align=\"right\" valign=\"middle\"><button dojoType=\"dijit.form.Button\" showLabel=\"false\" iconClass=\"tsButton tsPlayButton\" dojoAttachEvent=\"onClick:_onPlay\" dojoAttachPoint=\"playPauseBtn\" type=\"button\">${NLS_play}</button></td>\r\n   <td align=\"center\" valign=\"middle\" width=\"80%\" class=\"tsTmp\"></td>\r\n   <td align=\"left\" valign=\"middle\" width=\"30\"><button dojoType=\"dijit.form.Button\" showLabel=\"false\" iconClass=\"tsButton tsPrevButton\" dojoAttachEvent=\"onClick:_onPrev\" dojoAttachPoint=\"previousBtn\" type=\"button\">${NLS_previous}</button></td>\r\n   <td align=\"left\" valign=\"middle\"><button dojoType=\"dijit.form.Button\" showLabel=\"false\" iconClass=\"tsButton tsNextButton\" dojoAttachEvent=\"onClick:_onNext\" dojoAttachPoint=\"nextBtn\" type=\"button\">${NLS_next}</button></td>\r\n   </tr>    \r\n   </table>\r\n   </div>"}});define("esri/dijit/TimeSlider",["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/kernel","dojo/has","dojo/query","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dijit/_Widget","dijit/_Templated","dijit/form/HorizontalSlider","dijit/form/HorizontalRule","dijit/form/HorizontalRuleLabels","dojox/timing/_base","dojox/form/RangeSlider","dojo/text!dojox/form/resources/HorizontalRangeSlider.html","esri/kernel","esri/lang","esri/TimeExtent","esri/dijit/_EventedWidget","dojo/text!esri/dijit/templates/TimeSlider.html","dojo/i18n!esri/nls/jsapi"],function(_119a,_119b,lang,_119c,_119d,has,query,_119e,_119f,_11a0,_11a1,_11a2,_11a3,_11a4,_11a5,_11a6,_11a7,_11a8,_11a9,_11aa,_11ab,_11ac,_11ad,_11ae){var TS=_119b([_11ac,_11a1,_11a2],{declaredClass:"esri.dijit.TimeSlider",widgetsInTemplate:true,templateString:_11ad,basePath:_119a.toUrl("esri/dijit")+"/",_slideDuration:1000,_defaultCount:10,_eventMap:{"time-extent-change":true,"play":true,"pause":true,"next":true,"previous":true},constructor:function(_11af,_11b0){lang.mixin(this,_11ae.widgets.timeSlider);this._iconClass="tsButton tsPlayButton";this.playing=false;this.loop=false;this.thumbCount=1;this.thumbMovingRate=1000;this._createTimeInstants=false;this._options=lang.mixin({excludeDataAtTrailingThumb:false,excludeDataAtLeadingThumb:false},_11af.options||{});},startup:function(){this.inherited(arguments);this._timer=new _11a6.Timer();this._timer.setInterval(this.thumbMovingRate);this._timer.onTick=lang.hitch(this,"_bumpSlider",1);this._createSlider();},destroy:function(){this._timer.stop();this._timer=null;this.timeStops=null;this._slider.destroy();this._slider=null;if(this._hTicks){this._hTicks.destroyRecursive();this._hTicks=null;}if(this._hLabels){this._hLabels.destroyRecursive();this._hLabels=null;}this.inherited(arguments);},onTimeExtentChange:function(){},onPlay:function(){},onPause:function(){},onNext:function(){},onPrevious:function(){},_onHorizontalChange:function(){var _11b1=this._sliderToTimeExtent();this.onTimeExtentChange(_11b1);},_onPlay:function(){this.playing=!this.playing;this._updateUI();if(this.playing){this._timer.start();this.onPlay(this._sliderToTimeExtent());}else{this._timer.stop();this.onPause(this._sliderToTimeExtent());}var val=this._getSliderValue();this._offset=lang.isArray(val)?(val[1]-val[0]):0;},_onNext:function(){if(!this.playing){this._bumpSlider(1);this.onNext(this._sliderToTimeExtent());}},_onPrev:function(){if(!this.playing){this._bumpSlider(-1);this.onPrevious(this._sliderToTimeExtent());}},createTimeStopsByCount:function(_11b2,count){if(!_11b2||!_11b2.startTime||!_11b2.endTime){console.log(this.NLS_invalidTimeExtent);return;}count=count||this._defaultCount;var _11b3=Math.ceil((_11b2.endTime-_11b2.startTime)/(count-1));this.createTimeStopsByTimeInterval(_11b2,_11b3,"esriTimeUnitsMilliseconds");},createTimeStopsByTimeInterval:function(_11b4,_11b5,_11b6,_11b7){if(!_11b4||!_11b4.startTime||!_11b4.endTime){console.log(this.NLS_invalidTimeExtent);return;}this.fullTimeExtent=new _11ab(_11b4.startTime,_11b4.endTime);if(_11b7&&_11b7.resetStartTime===true){this._resetStartTime(this.fullTimeExtent,_11b6);}this._timeIntervalUnits=_11b6;var te=this.fullTimeExtent.startTime;var _11b8=[];while(te<=_11b4.endTime){_11b8.push(te);te=_11b4._getOffsettedDate(te,_11b5,_11b6);}if(_11b8.length>0&&_11b8[_11b8.length-1]<_11b4.endTime){_11b8.push(te);}this.setTimeStops(_11b8);},getCurrentTimeExtent:function(){return this._sliderToTimeExtent();},setTimeStops:function(_11b9){this.timeStops=_11b9||[];this._numStops=this.timeStops.length;this._numTicks=this._numStops;if(_11aa.isDefined(this.fullTimeExtent)===false){this.fullTimeExtent=new _11ab(_11b9[0],_11b9[_11b9.length-1]);}},setLoop:function(loop){this.loop=loop;},setThumbCount:function(_11ba){this.thumbCount=_11ba;this.singleThumbAsTimeInstant(this._createTimeInstants);if(this._slider){this._createSlider();}},setThumbIndexes:function(_11bb){this.thumbIndexes=lang.clone(_11bb)||[0,1];this._initializeThumbs();},setThumbMovingRate:function(_11bc){this.thumbMovingRate=_11bc;if(this._timer){this._timer.setInterval(this.thumbMovingRate);}},setLabels:function(_11bd){this.labels=_11bd;if(this._slider){this._createSlider();}},setTickCount:function(ticks){this._numTicks=ticks;if(this._slider){this._createSlider();}},singleThumbAsTimeInstant:function(_11be){this._createTimeInstants=(_11be&&this.thumbCount===1);},next:function(){this._onNext();},pause:function(){this.playing=false;this._updateUI();this._timer.stop();},play:function(){if(this.playing===true){return;}this.playing=false;this._onPlay();},previous:function(){this._onPrev();},_updateUI:function(){_119e.remove(this.playPauseBtn.iconNode,this._iconClass);this._iconClass=this.playing?"tsButton tsPauseButton":"tsButton tsPlayButton";_119e.add(this.playPauseBtn.iconNode,this._iconClass);this.previousBtn.set("disabled",this.playing);this.nextBtn.set("disabled",this.playing);},_createSlider:function(){if(this._slider){this._slider.destroy();this._slider=null;}var node=this.domNode;while(node.parentNode&&!node.dir){node=node.parentNode;}var _11bf={onChange:lang.hitch(this,"_onHorizontalChange"),showButtons:false,discreteValues:this._numStops,slideDuration:this._slideDuration,"class":"ts",dir:node.dir};this._ts=_119f.create("div",{},_119d.query(".tsTmp",this.domNode)[0],"first");this._timeSliderTicks=_119f.create("div",{},this._ts,"first");this._timeSliderLabels=_119f.create("div",{},this._ts);if(this.thumbCount===2){this._createRangeSlider(_11bf);}else{this._createSingleSlider(_11bf);}this.thumbIndexes=this.thumbIndexes||[0,1];this._createHorizRule();this._createLabels();if(this._createTimeInstants===true){_119d.query(".dijitSliderProgressBarH, .dijitSliderLeftBumper, .dijitSliderRightBumper").forEach(function(item){_11a0.set(item,{background:"none"});});}this._initializeThumbs();_119c.disconnect(this._onChangeConnect);this._onChangeConnect=_119c.connect(this._slider,"onChange",lang.hitch(this,"_updateThumbIndexes"));},_createRangeSlider:function(_11c0){this._isRangeSlider=true;var _11c1=_119b([_11a3,_11a7],{templateString:_11a8});this._slider=new _11c1(_11c0,this._ts);},_createSingleSlider:function(_11c2){this._isRangeSlider=false;this._slider=new _11a3(_11c2,this._ts);},_createHorizRule:function(){if(this._hTicks){this._hTicks.destroyRecursive();this._hTicks=null;}if(this._numTicks<2){return;}this._hTicks=new _11a4({container:"topDecoration",ruleStyle:"","class":"tsTicks",count:this._numTicks},this._timeSliderTicks);},_createLabels:function(){if(this._hLabels){this._hLabels.destroyRecursive();this._hLabels=null;}if(this.labels&&this.labels.length>0){this._hLabels=new _11a5({labels:this.labels,labelStyle:"","class":"tsLabels"},this._timeSliderLabels);}},_initializeThumbs:function(){if(!this._slider){return;}this._offset=this._toSliderValue(this.thumbIndexes[1])||0;var t1=this._toSliderValue(this.thumbIndexes[0]);t1=(t1>this._slider.maximum||t1<this._slider.minimum)?this._slider.minimum:t1;if(this._isRangeSlider===true){var t2=this._toSliderValue(this.thumbIndexes[1]);t2=(t2>this._slider.maximum||t2<this._slider.minimum)?this._slider.maximum:t2;t2=t2<t1?t1:t2;this._setSliderValue([t1,t2]);}else{this._setSliderValue(t1);}this._onHorizontalChange();},_bumpSlider:function(dir){var val=this._getSliderValue();var max=val,min=max;var _11c3=dir;if(lang.isArray(val)){min=val[0];max=val[1];_11c3=[{"change":dir,"useMaxValue":true},{"change":dir,"useMaxValue":false}];}if((Math.abs(min-this._slider.minimum)<1e-10&&dir<0)||(Math.abs(max-this._slider.maximum)<1e-10&&dir>0)){if(this._timer.isRunning){if(this.loop){this._timer.stop();this._setSliderValue(this._getSliderMinValue());var _11c4=this._sliderToTimeExtent();this.onTimeExtentChange(_11c4);this._timer.start();this.playing=true;}else{this.pause();}}}else{this._slider._bumpValue(_11c3);}},_updateThumbIndexes:function(){var val=this._getSliderValue();if(lang.isArray(val)){this.thumbIndexes[0]=this._toSliderIndex(val[0]);this.thumbIndexes[1]=this._toSliderIndex(val[1]);}else{this.thumbIndexes[0]=this._toSliderIndex(val);}},_sliderToTimeExtent:function(){if(!this.timeStops||this.timeStops.length===0){return;}var _11c5=new _11ab();var val=this._getSliderValue();if(lang.isArray(val)){_11c5.startTime=new Date(this.timeStops[this._toSliderIndex(val[0])]);_11c5.endTime=new Date(this.timeStops[this._toSliderIndex(val[1])]);this._adjustTimeExtent(_11c5);}else{_11c5.startTime=(this._createTimeInstants===true)?new Date(this.timeStops[this._toSliderIndex(val)]):new Date(this.fullTimeExtent.startTime);_11c5.endTime=(this._createTimeInstants===true)?_11c5.startTime:new Date(this.timeStops[this._toSliderIndex(val)]);}return _11c5;},_adjustTimeExtent:function(_11c6){if(this._options.excludeDataAtTrailingThumb===false&&this._options.excludeDataAtLeadingThumb===false){return;}if(_11c6.startTime.getTime()===_11c6.endTime.getTime()){return;}if(this._options.excludeDataAtTrailingThumb){var _11c7=_11c6.startTime;_11c7.setUTCSeconds(_11c7.getUTCSeconds()+1);}if(this._options.excludeDataAtLeadingThumb){var _11c8=_11c6.endTime;_11c8.setUTCSeconds(_11c8.getUTCSeconds()-1);}},_resetStartTime:function(_11c9,_11ca){switch(_11ca){case "esriTimeUnitsSeconds":_11c9.startTime.setUTCMilliseconds(0);break;case "esriTimeUnitsMinutes":_11c9.startTime.setUTCSeconds(0,0,0);break;case "esriTimeUnitsHours":_11c9.startTime.setUTCMinutes(0,0,0);break;case "esriTimeUnitsDays":_11c9.startTime.setUTCHours(0,0,0,0);break;case "esriTimeUnitsWeeks":_11c9.startTime.setUTCDate(_11c9.startTime.getUTCDate()-_11c9.startTime.getUTCDay());break;case "esriTimeUnitsMonths":_11c9.startTime.setUTCDate(1);_11c9.startTime.setUTCHours(0,0,0,0);break;case "esriTimeUnitsDecades":_11c9.startTime.setUTCFullYear(_11c9.startTime.getUTCFullYear()-(_11c9.startTime.getUTCFullYear()%10));break;case "esriTimeUnitsCenturies":_11c9.startTime.setUTCFullYear(_11c9.startTime.getUTCFullYear()-(_11c9.startTime.getUTCFullYear()%100));break;}},_getSliderMinValue:function(){if(this._isRangeSlider){return [this._slider.minimum,this._slider.minimum+this._offset];}else{return this._slider.minimum;}},_toSliderIndex:function(val){var idx=Math.floor((val-this._slider.minimum)*this._numStops/(this._slider.maximum-this._slider.minimum));if(idx<0){idx=0;}if(idx>=this._numStops){idx=this._numStops-1;}return idx;},_toSliderValue:function(val){return val*(this._slider.maximum-this._slider.minimum)/(this._numStops-1)+this._slider.minimum;},_getSliderValue:function(){return this._slider.get("value");},_setSliderValue:function(val){this._slider._setValueAttr(val,false,false);}});if(has("extend-esri")){lang.setObject("dijit.TimeSlider",TS,_11a9);}return TS;});},"dojox/html/entities":function(){define("dojox/html/entities",["dojo/_base/lang"],function(lang){var dhe=lang.getObject("dojox.html.entities",true);var _11cb=function(str,map){var _11cc,_11cd;if(map._encCache&&map._encCache.regexp&&map._encCache.mapper&&map.length==map._encCache.length){_11cc=map._encCache.mapper;_11cd=map._encCache.regexp;}else{_11cc={};_11cd=["["];var i;for(i=0;i<map.length;i++){_11cc[map[i][0]]="&"+map[i][1]+";";_11cd.push(map[i][0]);}_11cd.push("]");_11cd=new RegExp(_11cd.join(""),"g");map._encCache={mapper:_11cc,regexp:_11cd,length:map.length};}str=str.replace(_11cd,function(c){return _11cc[c];});return str;};var _11ce=function(str,map){var _11cf,_11d0;if(map._decCache&&map._decCache.regexp&&map._decCache.mapper&&map.length==map._decCache.length){_11cf=map._decCache.mapper;_11d0=map._decCache.regexp;}else{_11cf={};_11d0=["("];var i;for(i=0;i<map.length;i++){var e="&"+map[i][1]+";";if(i){_11d0.push("|");}_11cf[e]=map[i][0];_11d0.push(e);}_11d0.push(")");_11d0=new RegExp(_11d0.join(""),"g");map._decCache={mapper:_11cf,regexp:_11d0,length:map.length};}str=str.replace(_11d0,function(c){return _11cf[c];});return str;};dhe.html=[["&","amp"],["\"","quot"],["<","lt"],[">","gt"],["","nbsp"]];dhe.latin=[["","iexcl"],["","cent"],["","pound"],["","euro"],["","curren"],["","yen"],["","brvbar"],["","sect"],["","uml"],["","copy"],["","ordf"],["","laquo"],["","not"],["","shy"],["","reg"],["","macr"],["","deg"],["","plusmn"],["","sup2"],["","sup3"],["","acute"],["","micro"],["","para"],["","middot"],["","cedil"],["","sup1"],["","ordm"],["","raquo"],["","frac14"],["","frac12"],["","frac34"],["","iquest"],["","Agrave"],["","Aacute"],["","Acirc"],["","Atilde"],["","Auml"],["","Aring"],["","AElig"],["","Ccedil"],["","Egrave"],["","Eacute"],["","Ecirc"],["","Euml"],["","Igrave"],["","Iacute"],["","Icirc"],["","Iuml"],["","ETH"],["","Ntilde"],["","Ograve"],["","Oacute"],["","Ocirc"],["","Otilde"],["","Ouml"],["","times"],["","Oslash"],["","Ugrave"],["","Uacute"],["","Ucirc"],["","Uuml"],["","Yacute"],["","THORN"],["","szlig"],["","agrave"],["","aacute"],["","acirc"],["","atilde"],["","auml"],["","aring"],["","aelig"],["","ccedil"],["","egrave"],["","eacute"],["","ecirc"],["","euml"],["","igrave"],["","iacute"],["","icirc"],["","iuml"],["","eth"],["","ntilde"],["","ograve"],["","oacute"],["","ocirc"],["","otilde"],["","ouml"],["","divide"],["","oslash"],["","ugrave"],["","uacute"],["","ucirc"],["","uuml"],["","yacute"],["","thorn"],["","yuml"],["","fnof"],["","Alpha"],["","Beta"],["","Gamma"],["","Delta"],["","Epsilon"],["","Zeta"],["","Eta"],["","Theta"],["","Iota"],["","Kappa"],["","Lambda"],["","Mu"],["","Nu"],["","Xi"],["","Omicron"],["","Pi"],["","Rho"],["","Sigma"],["","Tau"],["","Upsilon"],["","Phi"],["","Chi"],["","Psi"],["","Omega"],["","alpha"],["","beta"],["","gamma"],["","delta"],["","epsilon"],["","zeta"],["","eta"],["","theta"],["","iota"],["","kappa"],["","lambda"],["","mu"],["","nu"],["","xi"],["","omicron"],["","pi"],["","rho"],["","sigmaf"],["","sigma"],["","tau"],["","upsilon"],["","phi"],["","chi"],["","psi"],["","omega"],["","thetasym"],["","upsih"],["","piv"],["","bull"],["","hellip"],["","prime"],["","Prime"],["","oline"],["","frasl"],["","weierp"],["","image"],["","real"],["","trade"],["","alefsym"],["","larr"],["","uarr"],["","rarr"],["","darr"],["","harr"],["","crarr"],["","lArr"],["","uArr"],["","rArr"],["","dArr"],["","hArr"],["","forall"],["","part"],["","exist"],["","empty"],["","nabla"],["","isin"],["","notin"],["","ni"],["","prod"],["","sum"],["","minus"],["","lowast"],["","radic"],["","prop"],["","infin"],["","ang"],["","and"],["","or"],["","cap"],["","cup"],["","int"],["","there4"],["","sim"],["","cong"],["","asymp"],["","ne"],["","equiv"],["","le"],["","ge"],["","sub"],["","sup"],["","nsub"],["","sube"],["","supe"],["","oplus"],["","otimes"],["","perp"],["","sdot"],["","lceil"],["","rceil"],["","lfloor"],["","rfloor"],["","lang"],["","rang"],["","loz"],["","spades"],["","clubs"],["","hearts"],["","diams"],["","Elig"],["","oelig"],["","Scaron"],["","scaron"],["","Yuml"],["","circ"],["","tilde"],["","ensp"],["","emsp"],["","thinsp"],["","zwnj"],["","zwj"],["","lrm"],["","rlm"],["","ndash"],["","mdash"],["","lsquo"],["","rsquo"],["","sbquo"],["","ldquo"],["","rdquo"],["","bdquo"],["","dagger"],["","Dagger"],["","permil"],["","lsaquo"],["","rsaquo"]];dhe.encode=function(str,m){if(str){if(!m){str=_11cb(str,dhe.html);str=_11cb(str,dhe.latin);}else{str=_11cb(str,m);}}return str;};dhe.decode=function(str,m){if(str){if(!m){str=_11ce(str,dhe.html);str=_11ce(str,dhe.latin);}else{str=_11ce(str,m);}}return str;};return dhe;});},"dijit/_editor/range":function(){define("dijit/_editor/range",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","../main"],function(array,_11d1,lang,win,dijit){dijit.range={};dijit.range.getIndex=function(node,_11d2){var ret=[],retR=[];var onode=node;var pnode,n;while(node!=_11d2){var i=0;pnode=node.parentNode;while((n=pnode.childNodes[i++])){if(n===node){--i;break;}}ret.unshift(i);retR.unshift(i-pnode.childNodes.length);node=pnode;}if(ret.length>0&&onode.nodeType==3){n=onode.previousSibling;while(n&&n.nodeType==3){ret[ret.length-1]--;n=n.previousSibling;}n=onode.nextSibling;while(n&&n.nodeType==3){retR[retR.length-1]++;n=n.nextSibling;}}return {o:ret,r:retR};};dijit.range.getNode=function(index,_11d3){if(!lang.isArray(index)||index.length==0){return _11d3;}var node=_11d3;array.every(index,function(i){if(i>=0&&i<node.childNodes.length){node=node.childNodes[i];}else{node=null;return false;}return true;});return node;};dijit.range.getCommonAncestor=function(n1,n2,root){root=root||n1.ownerDocument.body;var _11d4=function(n){var as=[];while(n){as.unshift(n);if(n!==root){n=n.parentNode;}else{break;}}return as;};var n1as=_11d4(n1);var n2as=_11d4(n2);var m=Math.min(n1as.length,n2as.length);var com=n1as[0];for(var i=1;i<m;i++){if(n1as[i]===n2as[i]){com=n1as[i];}else{break;}}return com;};dijit.range.getAncestor=function(node,regex,root){root=root||node.ownerDocument.body;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(regex.test(name)){return node;}node=node.parentNode;}return null;};dijit.range.BlockTagNames=/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/;dijit.range.getBlockAncestor=function(node,regex,root){root=root||node.ownerDocument.body;regex=regex||dijit.range.BlockTagNames;var block=null,_11d5;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(!block&&regex.test(name)){block=node;}if(!_11d5&&(/^(?:BODY|TD|TH|CAPTION)$/).test(name)){_11d5=node;}node=node.parentNode;}return {blockNode:block,blockContainer:_11d5||node.ownerDocument.body};};dijit.range.atBeginningOfContainer=function(_11d6,node,_11d7){var _11d8=false;var _11d9=(_11d7==0);if(!_11d9&&node.nodeType==3){if(/^[\s\xA0]+$/.test(node.nodeValue.substr(0,_11d7))){_11d9=true;}}if(_11d9){var cnode=node;_11d8=true;while(cnode&&cnode!==_11d6){if(cnode.previousSibling){_11d8=false;break;}cnode=cnode.parentNode;}}return _11d8;};dijit.range.atEndOfContainer=function(_11da,node,_11db){var atEnd=false;var _11dc=(_11db==(node.length||node.childNodes.length));if(!_11dc&&node.nodeType==3){if(/^[\s\xA0]+$/.test(node.nodeValue.substr(_11db))){_11dc=true;}}if(_11dc){var cnode=node;atEnd=true;while(cnode&&cnode!==_11da){if(cnode.nextSibling){atEnd=false;break;}cnode=cnode.parentNode;}}return atEnd;};dijit.range.adjacentNoneTextNode=function(_11dd,next){var node=_11dd;var len=(0-_11dd.length)||0;var prop=next?"nextSibling":"previousSibling";while(node){if(node.nodeType!=3){break;}len+=node.length;node=node[prop];}return [node,len];};dijit.range.create=function(win){win=win||window;if(win.getSelection){return win.document.createRange();}else{return new dijit.range.W3CRange();}};dijit.range.getSelection=function(_11de,_11df){if(_11de.getSelection){return _11de.getSelection();}else{var s=new dijit.range.ie.selection(_11de);if(!_11df){s._getCurrentSelection();}return s;}};if(!window.getSelection){dijit.range.ie={cachedSelection:{},selection:function(_11e0){this._ranges=[];this.addRange=function(r,_11e1){this._ranges.push(r);if(!_11e1){r._select();}this.rangeCount=this._ranges.length;};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0;};var _11e2=function(){var r=_11e0.document.selection.createRange();var type=_11e0.document.selection.type.toUpperCase();if(type=="CONTROL"){return new dijit.range.W3CRange(dijit.range.ie.decomposeControlRange(r));}else{return new dijit.range.W3CRange(dijit.range.ie.decomposeTextRange(r));}};this.getRangeAt=function(i){return this._ranges[i];};this._getCurrentSelection=function(){this.removeAllRanges();var r=_11e2();if(r){this.addRange(r,true);this.isCollapsed=r.collapsed;}else{this.isCollapsed=true;}};},decomposeControlRange:function(range){var _11e3=range.item(0),_11e4=range.item(range.length-1);var _11e5=_11e3.parentNode,_11e6=_11e4.parentNode;var _11e7=dijit.range.getIndex(_11e3,_11e5).o[0];var _11e8=dijit.range.getIndex(_11e4,_11e6).o[0]+1;return [_11e5,_11e7,_11e6,_11e8];},getEndPoint:function(range,end){var _11e9=range.duplicate();_11e9.collapse(!end);var _11ea="EndTo"+(end?"End":"Start");var _11eb=_11e9.parentElement();var _11ec,_11ed,_11ee;if(_11eb.childNodes.length>0){array.every(_11eb.childNodes,function(node,i){var _11ef;if(node.nodeType!=3){_11e9.moveToElementText(node);if(_11e9.compareEndPoints(_11ea,range)>0){if(_11ee&&_11ee.nodeType==3){_11ec=_11ee;_11ef=true;}else{_11ec=_11eb;_11ed=i;return false;}}else{if(i==_11eb.childNodes.length-1){_11ec=_11eb;_11ed=_11eb.childNodes.length;return false;}}}else{if(i==_11eb.childNodes.length-1){_11ec=node;_11ef=true;}}if(_11ef&&_11ec){var _11f0=dijit.range.adjacentNoneTextNode(_11ec)[0];if(_11f0){_11ec=_11f0.nextSibling;}else{_11ec=_11eb.firstChild;}var _11f1=dijit.range.adjacentNoneTextNode(_11ec);_11f0=_11f1[0];var _11f2=_11f1[1];if(_11f0){_11e9.moveToElementText(_11f0);_11e9.collapse(false);}else{_11e9.moveToElementText(_11eb);}_11e9.setEndPoint(_11ea,range);_11ed=_11e9.text.length-_11f2;return false;}_11ee=node;return true;});}else{_11ec=_11eb;_11ed=0;}if(!end&&_11ec.nodeType==1&&_11ed==_11ec.childNodes.length){var _11f3=_11ec.nextSibling;if(_11f3&&_11f3.nodeType==3){_11ec=_11f3;_11ed=0;}}return [_11ec,_11ed];},setEndPoint:function(range,_11f4,_11f5){var _11f6=range.duplicate(),node,len;if(_11f4.nodeType!=3){if(_11f5>0){node=_11f4.childNodes[_11f5-1];if(node){if(node.nodeType==3){_11f4=node;_11f5=node.length;}else{if(node.nextSibling&&node.nextSibling.nodeType==3){_11f4=node.nextSibling;_11f5=0;}else{_11f6.moveToElementText(node.nextSibling?node:_11f4);var _11f7=node.parentNode;var _11f8=_11f7.insertBefore(node.ownerDocument.createTextNode(" "),node.nextSibling);_11f6.collapse(false);_11f7.removeChild(_11f8);}}}}else{_11f6.moveToElementText(_11f4);_11f6.collapse(true);}}if(_11f4.nodeType==3){var _11f9=dijit.range.adjacentNoneTextNode(_11f4);var _11fa=_11f9[0];len=_11f9[1];if(_11fa){_11f6.moveToElementText(_11fa);_11f6.collapse(false);if(_11fa.contentEditable!="inherit"){len++;}}else{_11f6.moveToElementText(_11f4.parentNode);_11f6.collapse(true);_11f6.move("character",1);_11f6.move("character",-1);}_11f5+=len;if(_11f5>0){if(_11f6.move("character",_11f5)!=_11f5){console.error("Error when moving!");}}}return _11f6;},decomposeTextRange:function(range){var _11fb=dijit.range.ie.getEndPoint(range);var _11fc=_11fb[0],_11fd=_11fb[1];var _11fe=_11fb[0],_11ff=_11fb[1];if(range.htmlText.length){if(range.htmlText==range.text){_11ff=_11fd+range.text.length;}else{_11fb=dijit.range.ie.getEndPoint(range,true);_11fe=_11fb[0],_11ff=_11fb[1];}}return [_11fc,_11fd,_11fe,_11ff];},setRange:function(range,_1200,_1201,_1202,_1203,_1204){var start=dijit.range.ie.setEndPoint(range,_1200,_1201);range.setEndPoint("StartToStart",start);if(!_1204){var end=dijit.range.ie.setEndPoint(range,_1202,_1203);}range.setEndPoint("EndToEnd",end||start);return range;}};_11d1("dijit.range.W3CRange",null,{constructor:function(){if(arguments.length>0){this.setStart(arguments[0][0],arguments[0][1]);this.setEnd(arguments[0][2],arguments[0][3]);}else{this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}},_updateInternal:function(){if(this.startContainer!==this.endContainer){this.commonAncestorContainer=dijit.range.getCommonAncestor(this.startContainer,this.endContainer);}else{this.commonAncestorContainer=this.startContainer;}this.collapsed=(this.startContainer===this.endContainer)&&(this.startOffset==this.endOffset);},setStart:function(node,_1205){_1205=parseInt(_1205);if(this.startContainer===node&&this.startOffset==_1205){return;}delete this._cachedBookmark;this.startContainer=node;this.startOffset=_1205;if(!this.endContainer){this.setEnd(node,_1205);}else{this._updateInternal();}},setEnd:function(node,_1206){_1206=parseInt(_1206);if(this.endContainer===node&&this.endOffset==_1206){return;}delete this._cachedBookmark;this.endContainer=node;this.endOffset=_1206;if(!this.startContainer){this.setStart(node,_1206);}else{this._updateInternal();}},setStartAfter:function(node,_1207){this._setPoint("setStart",node,_1207,1);},setStartBefore:function(node,_1208){this._setPoint("setStart",node,_1208,0);},setEndAfter:function(node,_1209){this._setPoint("setEnd",node,_1209,1);},setEndBefore:function(node,_120a){this._setPoint("setEnd",node,_120a,0);},_setPoint:function(what,node,_120b,ext){var index=dijit.range.getIndex(node,node.parentNode).o;this[what](node.parentNode,index.pop()+ext);},_getIERange:function(){var r=(this._body||this.endContainer.ownerDocument.body).createTextRange();dijit.range.ie.setRange(r,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return r;},getBookmark:function(){this._getIERange();return this._cachedBookmark;},_select:function(){var r=this._getIERange();r.select();},deleteContents:function(){var s=this.startContainer,r=this._getIERange();if(s.nodeType===3&&!this.startOffset){this.setStartBefore(s);}r.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=true;},cloneRange:function(){var r=new dijit.range.W3CRange([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);r._body=this._body;return r;},detach:function(){this._body=null;this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}});}return dijit.range;});},"dojox/widget/AnalogGauge":function(){define("dojox/widget/AnalogGauge",["dijit","dojo","dojox","dojo/require!dojox/widget/gauge/_Gauge,dojox/gauges/AnalogGauge"],function(dijit,dojo,dojox){dojo.provide("dojox.widget.AnalogGauge");dojo.require("dojox.widget.gauge._Gauge");dojo.require("dojox.gauges.AnalogGauge");dojox.widget.AnalogGauge=dojox.gauges.AnalogGauge;dojox.widget.gauge.AnalogLineIndicator=dojox.gauges.AnalogLineIndicator;});},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../_base/Deferred"],function(array,lang,_120c){var _120d=function(_120e){if(!_120e){return _120e;}if(_120e.then){_120e=lang.delegate(_120e);}function _120f(_1210){if(!_120e[_1210]){_120e[_1210]=function(){var args=arguments;return _120c.when(_120e,function(_1211){Array.prototype.unshift.call(args,_1211);return _120d(array[_1210].apply(array,args));});};}};_120f("forEach");_120f("filter");_120f("map");if(!_120e.total){_120e.total=_120c.when(_120e,function(_1212){return _1212.length;});}return _120e;};lang.setObject("dojo.store.util.QueryResults",_120d);return _120d;});},"esri/dijit/Gauge":function(){require({cache:{"url:esri/dijit/templates/Gauge.html":"<div class=\"gaugeContainer\">\r\n  <div data-dojo-attach-point=\"titleNode\" class=\"gaugeTitle\">${title}</div>\r\n  <div data-dojo-attach-point=\"dataLabelWrapperNode\">\r\n    <div data-dojo-attach-point=\"dataLabelNode\">${dataLabel}</div>\r\n  </div>\r\n  <div data-dojo-attach-point=\"gaugeNode\" style=\"margin: -10px auto 10px auto; width: 240px; height: 120px;\"></div>\r\n  <div data-dojo-attach-point=\"captionNode\" class=\"gaugeCaption\">${caption}</div>\r\n</div>\r\n"}});define("esri/dijit/Gauge",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/number","dojo/has","dojo/text!esri/dijit/templates/Gauge.html","dijit/_WidgetBase","dijit/_TemplatedMixin","dojox/widget/AnalogGauge","dojox/widget/gauge/AnalogArcIndicator","esri/kernel"],function(_1213,lang,conn,_1214,_1215,style,_1216,has,_1217,_1218,_1219,_121a,_121b,_121c){var Gauge=_1213([_1218,_1219],{declaredClass:"esri.dijit.Gauge",templateString:_1217,widgetsInTemplate:false,constructor:function(_121d,_121e){this.caption="&nbsp;";this.color="#000";this.dataFormat="value";this.maxDataValue=100;this.title="&nbsp;";this.unitLabel="";this.fromWebmap=false;this.feature=null;this.dataLabel="&nbsp;";lang.mixin(this,_121d);this._majorTicks="";this.value=0;this.numberFormat=this.numberFormat||{"places":0};if(this.fromWebmap){this.dataField=this.field;this.dataFormat=this.valueLabel;this.dataLabelField=this.displayField;this.maxDataValue=this.target;this.unitLabel="";}if(this.dataFormat=="percentage"){this.unitLabel="%";this._majorTicks={offset:90,interval:25,length:3,color:"black"};}this.watch("caption",this._updateCaption);this.watch("dataLabel",this._updateDataLabel);this.watch("title",this._updateTitle);this.watch("value",this._updateValue);this.watch("feature",this._updateFeature);},startup:function(){this.inherited(arguments);var _121f=new _121b({interactionMode:"indicator",noChange:true,value:this.maxDataValue,width:20,offset:65,color:[204,204,204,1],title:"value",hideValue:true,duration:100});var _1220=new _121b({interactionMode:"indicator",noChange:false,value:this.value,width:20,offset:65,color:this.color,title:"value",hideValue:true,onDragMove:"",duration:100});this.gaugeWidget=new _121a({background:[204,204,204,0],width:parseInt(this.gaugeNode.style.width),height:parseInt(this.gaugeNode.style.height)+10,cx:parseInt(this.gaugeNode.style.width)/2,cy:parseInt(this.gaugeNode.style.height),style:"position: absolute;",radius:parseInt(this.gaugeNode.style.width)/2,useTooltip:false,ranges:[{low:0,high:this.maxDataValue,color:"rgba(255,0,0,0)"}],majorTicks:this._majorTicks,indicators:[_121f,_1220]},_1214.create("div",null,this.gaugeNode));this.gaugeWidget.startup();this.gaugeWidget._handleMouseDownIndicator=function(){};this.valueNode=_1214.create("div",{"innerHTML":"0"+this.unitLabel,"style":{"bottom":parseInt(this.gaugeNode.style.height)-(this.gaugeWidget.cy-20)+"px","color":"#000","font-family":"arial","font-size":"1em","left":"-1000px","position":"absolute"}},this.gaugeWidget.domNode);var _1221=_1215.getContentBox(this.valueNode);style.set(this.valueNode,"left",this.gaugeWidget.cx+"px");style.set(this.valueNode,"marginLeft",(-_1221.w/2)+"px");if(this.gaugeWidget.cx){style.set(this.valueNode,"marginBottom",(-_1221.h/2)+"px");}if(this.layer){this._connectMouseOver();}},destroy:function(){if(this._mouseOverHandler){conn.disconnect(this._mouseOverHandler);}this.gaugeWidget.destroy();_1214.empty(this.domNode);},_connectMouseOver:function(){this._mouseOverHandler=conn.connect(this.layer,"onMouseOver",lang.hitch(this,function(e){this.set("feature",e);}));},_formatValue:function(val){if(this.dataFormat=="percentage"){val=Math.round((val/this.maxDataValue)*100);}return _1216.format(val,this.numberFormat);},_updateCaption:function(attr,_1222,_1223){this.captionNode.innerHTML=_1223;},_updateTitle:function(attr,_1224,_1225){this.titleNode.innerHTML=_1225;},_updateValue:function(attr,_1226,_1227){var val=this._formatValue(_1227);this.valueNode.innerHTML=val+this.unitLabel;this.gaugeWidget.indicators[1].update(parseInt(val));},_updateDataLabel:function(attr,_1228,_1229){this.dataLabelNode.innerHTML=_1229;},_updateFeature:function(attr,_122a,_122b){if(!_122b||(_122b.hasOwnPropety&&!_122b.hasOwnProperty("graphic")&&!_122b.declaredClass=="esri.Graphic")){console.log("Gauge Dijit:  a graphic is required to update the gauge.");return;}this.feature=_122b.graphic||_122b;this.set("value",this.feature.attributes[this.dataField]||0);this.set("dataLabel",this.feature.attributes[this.dataLabelField]||this.noDataLabel);}});if(has("extend-esri")){lang.setObject("dijit.Gauge",Gauge,_121c);}return Gauge;});},"dijit/form/_ListBase":function(){define("dijit/form/_ListBase",["dojo/_base/declare","dojo/on","dojo/window"],function(_122c,on,_122d){return _122c("dijit.form._ListBase",null,{selected:null,_listConnect:function(_122e,_122f){var self=this;return self.own(on(self.containerNode,on.selector(function(_1230,_1231,_1232){return _1230.parentNode==_1232;},_122e),function(evt){evt.preventDefault();self[_122f](evt,this);}));},selectFirstNode:function(){var first=this.containerNode.firstChild;while(first&&first.style.display=="none"){first=first.nextSibling;}this._setSelectedAttr(first);},selectLastNode:function(){var last=this.containerNode.lastChild;while(last&&last.style.display=="none"){last=last.previousSibling;}this._setSelectedAttr(last);},selectNextNode:function(){var _1233=this.selected;if(!_1233){this.selectFirstNode();}else{var next=_1233.nextSibling;while(next&&next.style.display=="none"){next=next.nextSibling;}if(!next){this.selectFirstNode();}else{this._setSelectedAttr(next);}}},selectPreviousNode:function(){var _1234=this.selected;if(!_1234){this.selectLastNode();}else{var prev=_1234.previousSibling;while(prev&&prev.style.display=="none"){prev=prev.previousSibling;}if(!prev){this.selectLastNode();}else{this._setSelectedAttr(prev);}}},_setSelectedAttr:function(node){if(this.selected!=node){var _1235=this.selected;if(_1235){this.onDeselect(_1235);this.selected=null;}if(node){this.selected=node;_122d.scrollIntoView(node);this.onSelect(node);}}else{if(node){this.onSelect(node);}}}});});},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(dojo,_1236,_1237){dojo.DeferredList=function(list,_1238,_1239,_123a,_123b){var _123c=[];_1236.call(this);var self=this;if(list.length===0&&!_1238){this.resolve([0,[]]);}var _123d=0;_1237.forEach(list,function(item,i){item.then(function(_123e){if(_1238){self.resolve([i,_123e]);}else{_123f(true,_123e);}},function(error){if(_1239){self.reject(error);}else{_123f(false,error);}if(_123a){return null;}throw error;});function _123f(_1240,_1241){_123c[i]=[_1240,_1241];_123d++;if(_123d===list.length){self.resolve(_123c);}};});};dojo.DeferredList.prototype=new _1236();dojo.DeferredList.prototype.gatherResults=function(_1242){var d=new dojo.DeferredList(_1242,false,true,false);d.addCallback(function(_1243){var ret=[];_1237.forEach(_1243,function(_1244){ret.push(_1244[1]);});return ret;});return d;};return dojo.DeferredList;});},"dijit/CalendarLite":function(){require({cache:{"url:dijit/templates/Calendar.html":"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\" role=\"grid\" aria-labelledby=\"${id}_mddb ${id}_year\">\n\t<thead>\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"decrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\n\t\t\t</th>\n\t\t\t<th class='dijitReset' colspan=\"5\">\n\t\t\t\t<div data-dojo-attach-point=\"monthNode\">\n\t\t\t\t</div>\n\t\t\t</th>\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"incrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\n\t\t\t</th>\n\t\t</tr>\n\t\t<tr role=\"row\">\n\t\t\t${!dayCellsHtml}\n\t\t</tr>\n\t</thead>\n\t<tbody data-dojo-attach-point=\"dateRowsNode\" data-dojo-attach-event=\"onclick: _onDayClick\" class=\"dijitReset dijitCalendarBodyContainer\">\n\t\t\t${!dateRowsHtml}\n\t</tbody>\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\n\t\t<tr>\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\" role=\"presentation\">\n\t\t\t\t<div class=\"dijitCalendarYearLabel\">\n\t\t\t\t\t<span data-dojo-attach-point=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\" role=\"button\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\" role=\"button\" id=\"${id}_year\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\" role=\"button\"></span>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</tfoot>\n</table>\n"}});define("dijit/CalendarLite",["dojo/_base/array","dojo/_base/declare","dojo/cldr/supplemental","dojo/date","dojo/date/locale","dojo/date/stamp","dojo/dom","dojo/dom-class","dojo/_base/event","dojo/_base/lang","dojo/sniff","dojo/string","./_WidgetBase","./_TemplatedMixin","dojo/text!./templates/Calendar.html","./hccss"],function(array,_1245,_1246,date,_1247,stamp,dom,_1248,event,lang,has,_1249,_124a,_124b,_124c){var _124d=_1245("dijit.CalendarLite",[_124a,_124b],{templateString:_124c,dowTemplateString:"<th class=\"dijitReset dijitCalendarDayLabelTemplate\" role=\"columnheader\"><span class=\"dijitCalendarDayLabel\">${d}</span></th>",dateTemplateString:"<td class=\"dijitReset\" role=\"gridcell\" data-dojo-attach-point=\"dateCells\"><span class=\"dijitCalendarDateLabel\" data-dojo-attach-point=\"dateLabels\"></span></td>",weekTemplateString:"<tr class=\"dijitReset dijitCalendarWeekTemplate\" role=\"row\">${d}${d}${d}${d}${d}${d}${d}</tr>",value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date(),baseClass:"dijitCalendar",_isValidDate:function(value){return value&&!isNaN(value)&&typeof value=="object"&&value.toString()!=this.constructor.prototype.value.toString();},_getValueAttr:function(){if(this.value&&!isNaN(this.value)){var value=new this.dateClassObj(this.value);value.setHours(0,0,0,0);if(value.getDate()<this.value.getDate()){value=this.dateModule.add(value,"hour",1);}return value;}else{return null;}},_setValueAttr:function(value,_124e){if(typeof value=="string"){value=stamp.fromISOString(value);}value=this._patchDate(value);if(this._isValidDate(value)&&!this.isDisabledDate(value,this.lang)){this._set("value",value);this.set("currentFocus",value);this._markSelectedDates([value]);if(this._created&&(_124e||typeof _124e=="undefined")){this.onChange(this.get("value"));}}else{this._set("value",null);this._markSelectedDates([]);}},_patchDate:function(value){if(value){value=new this.dateClassObj(value);value.setHours(1,0,0,0);}return value;},_setText:function(node,text){while(node.firstChild){node.removeChild(node.firstChild);}node.appendChild(node.ownerDocument.createTextNode(text));},_populateGrid:function(){var month=new this.dateClassObj(this.currentFocus);month.setDate(1);var _124f=month.getDay(),_1250=this.dateModule.getDaysInMonth(month),_1251=this.dateModule.getDaysInMonth(this.dateModule.add(month,"month",-1)),today=new this.dateClassObj(),_1252=_1246.getFirstDayOfWeek(this.lang);if(_1252>_124f){_1252-=7;}this._date2cell={};array.forEach(this.dateCells,function(_1253,idx){var i=idx+_1252;var date=new this.dateClassObj(month),_1254,clazz="dijitCalendar",adj=0;if(i<_124f){_1254=_1251-_124f+i+1;adj=-1;clazz+="Previous";}else{if(i>=(_124f+_1250)){_1254=i-_124f-_1250+1;adj=1;clazz+="Next";}else{_1254=i-_124f+1;clazz+="Current";}}if(adj){date=this.dateModule.add(date,"month",adj);}date.setDate(_1254);if(!this.dateModule.compare(date,today,"date")){clazz="dijitCalendarCurrentDate "+clazz;}if(this.isDisabledDate(date,this.lang)){clazz="dijitCalendarDisabledDate "+clazz;_1253.setAttribute("aria-disabled","true");}else{clazz="dijitCalendarEnabledDate "+clazz;_1253.removeAttribute("aria-disabled");_1253.setAttribute("aria-selected","false");}var _1255=this.getClassForDate(date,this.lang);if(_1255){clazz=_1255+" "+clazz;}_1253.className=clazz+"Month dijitCalendarDateTemplate";var _1256=date.valueOf();this._date2cell[_1256]=_1253;_1253.dijitDateValue=_1256;this._setText(this.dateLabels[idx],date.getDateLocalized?date.getDateLocalized(this.lang):date.getDate());},this);},_populateControls:function(){var month=new this.dateClassObj(this.currentFocus);month.setDate(1);this.monthWidget.set("month",month);var y=month.getFullYear()-1;var d=new this.dateClassObj();array.forEach(["previous","current","next"],function(name){d.setFullYear(y++);this._setText(this[name+"YearLabelNode"],this.dateLocaleModule.format(d,{selector:"year",locale:this.lang}));},this);},goToToday:function(){this.set("value",new this.dateClassObj());},constructor:function(_1257){this.dateModule=_1257.datePackage?lang.getObject(_1257.datePackage,false):date;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=_1257.datePackage?lang.getObject(_1257.datePackage+".locale",false):_1247;},_createMonthWidget:function(){return _124d._MonthWidget({id:this.id+"_mw",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode);},buildRendering:function(){var d=this.dowTemplateString,_1258=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),_1259=_1246.getFirstDayOfWeek(this.lang);this.dayCellsHtml=_1249.substitute([d,d,d,d,d,d,d].join(""),{d:""},function(){return _1258[_1259++%7];});var r=_1249.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[r,r,r,r,r,r].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);dom.setSelectable(this.domNode,false);var _125a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",_125a,false);},postCreate:function(){this.inherited(arguments);this._connectControls();},_connectControls:function(){var _125b=lang.hitch(this,function(_125c,part,_125d){this.connect(this[_125c],"onclick",function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,part,_125d));});});_125b("incrementMonth","month",1);_125b("decrementMonth","month",-1);_125b("nextYearLabelNode","year",1);_125b("previousYearLabelNode","year",-1);},_setCurrentFocusAttr:function(date,_125e){var _125f=this.currentFocus,_1260=this._getNodeByDate(_125f);date=this._patchDate(date);this._set("currentFocus",date);if(!this._date2cell||this.dateModule.difference(_125f,date,"month")!=0){this._populateGrid();this._populateControls();this._markSelectedDates([this.value]);}var _1261=this._getNodeByDate(date);_1261.setAttribute("tabIndex",this.tabIndex);if(this.focused||_125e){_1261.focus();}if(_1260&&_1260!=_1261){if(has("webkit")){_1260.setAttribute("tabIndex","-1");}else{_1260.removeAttribute("tabIndex");}}},focus:function(){this._setCurrentFocusAttr(this.currentFocus,true);},_onDayClick:function(evt){event.stop(evt);for(var node=evt.target;node&&!node.dijitDateValue;node=node.parentNode){}if(node&&!_1248.contains(node,"dijitCalendarDisabledDate")){this.set("value",node.dijitDateValue);}},_getNodeByDate:function(value){value=this._patchDate(value);return value&&this._date2cell?this._date2cell[value.valueOf()]:null;},_markSelectedDates:function(dates){function mark(_1262,cell){_1248.toggle(cell,"dijitCalendarSelectedDate",_1262);cell.setAttribute("aria-selected",_1262?"true":"false");};array.forEach(this._selectedCells||[],lang.partial(mark,false));this._selectedCells=array.filter(array.map(dates,this._getNodeByDate,this),function(n){return n;});array.forEach(this._selectedCells,lang.partial(mark,true));},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});_124d._MonthWidget=_1245("dijit.CalendarLite._MonthWidget",_124a,{_setMonthAttr:function(month){var _1263=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,month),_1264=(has("ie")==6?"":"<div class='dijitSpacer'>"+array.map(_1263,function(s){return "<div>"+s+"</div>";}).join("")+"</div>");this.domNode.innerHTML=_1264+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+_1263[month.getMonth()]+"</div>";}});return _124d;});},"dijit/CheckedMenuItem":function(){require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n"}});define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_1265,_1266,_1267,_1268){return _1265("dijit.CheckedMenuItem",_1267,{templateString:_1268,checked:false,_setCheckedAttr:function(_1269){_1266.toggle(this.domNode,"dijitCheckedMenuItemChecked",_1269);this.domNode.setAttribute("aria-checked",_1269?"true":"false");this._set("checked",_1269);},iconClass:"",onChange:function(){},_onClick:function(evt){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.onClick(evt);}});});},"esri/dijit/editing/Cut":function(){define("esri/dijit/editing/Cut",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/geometry/jsonUtils","esri/OperationBase"],function(_126a,lang,has,_126b,_126c,_126d){var Cut=_126a(_126d,{declaredClass:"esri.dijit.editing.Cut",type:"edit",label:"Cut Features",constructor:function(_126e){var i;_126e=_126e||{};if(!_126e.featureLayer){console.error("In constructor of 'esri.dijit.editing.Cut', featureLayer not provided");return;}this._featureLayer=_126e.featureLayer;if(!_126e.addedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', addedGraphics for cut not provided");return;}this._addedGraphics=_126e.addedGraphics;if(!_126e.preUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', preUpdatedGraphics not provided");return;}this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(i=0;i<_126e.preUpdatedGraphics.length;i++){this._preUpdatedGraphicsGeometries.push(_126e.preUpdatedGraphics[i].geometry.toJson());this._preUpdatedGraphicsAttributes.push(_126e.preUpdatedGraphics[i].attributes);}if(!_126e.postUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', postUpdatedGraphics not provided");return;}this._postUpdatedGraphics=_126e.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];for(i=0;i<_126e.postUpdatedGraphics.length;i++){this._postUpdatedGraphicsGeometries.push(_126e.postUpdatedGraphics[i].geometry.toJson());this._postUpdatedGraphicsAttributes.push(lang.clone(_126e.postUpdatedGraphics[i].attributes));}},performUndo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_126c.fromJson(this._preUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._preUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._addedGraphics);},performRedo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_126c.fromJson(this._postUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._postUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(this._addedGraphics,this._postUpdatedGraphics,null);}});if(has("extend-esri")){lang.setObject("dijit.editing.Cut",Cut,_126b);}return Cut;});},"dojox/grid/_Events":function(){define("dojox/grid/_Events",["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(keys,_126f,_1270,event,has){return _1270("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(e){this.dispatchKeyEvent(e);},onContentEvent:function(e){this.dispatchContentEvent(e);},onHeaderEvent:function(e){this.dispatchHeaderEvent(e);},onStyleRow:function(inRow){var i=inRow;i.customClasses+=(i.odd?" dojoxGridRowOdd":"")+(i.selected?" dojoxGridRowSelected":"")+(i.over?" dojoxGridRowOver":"");this.focus.styleRow(inRow);this.edit.styleRow(inRow);},onKeyDown:function(e){if(e.altKey||e.metaKey){return;}var _1271;switch(e.keyCode){case keys.ESCAPE:this.edit.cancel();break;case keys.ENTER:if(!this.edit.isEditing()){_1271=this.focus.getHeaderIndex();if(_1271>=0){this.setSortIndex(_1271);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}event.stop(e);}if(!e.shiftKey){var _1272=this.edit.isEditing();this.edit.apply();if(!_1272){this.edit.setEditCell(this.focus.cell,this.focus.rowIndex);}}if(!this.edit.isEditing()){var _1273=this.focus.focusView||this.views.views[0];_1273.content.decorateEvent(e);this.onRowClick(e);event.stop(e);}break;case keys.SPACE:if(!this.edit.isEditing()){_1271=this.focus.getHeaderIndex();if(_1271>=0){this.setSortIndex(_1271);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}event.stop(e);}break;case keys.TAB:this.focus[e.shiftKey?"previousKey":"nextKey"](e);break;case keys.LEFT_ARROW:case keys.RIGHT_ARROW:if(!this.edit.isEditing()){var _1274=e.keyCode;event.stop(e);_1271=this.focus.getHeaderIndex();if(_1271>=0&&(e.shiftKey&&e.ctrlKey)){this.focus.colSizeAdjust(e,_1271,(_1274==keys.LEFT_ARROW?-1:1)*5);}else{var _1275=(_1274==keys.LEFT_ARROW)?1:-1;if(this.isLeftToRight()){_1275*=-1;}this.focus.move(0,_1275);}}break;case keys.UP_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){event.stop(e);this.focus.move(-1,0);}break;case keys.DOWN_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){event.stop(e);this.focus.move(1,0);}break;case keys.PAGE_UP:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){event.stop(e);if(this.focus.rowIndex!=this.scroller.firstVisibleRow+1){this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1));this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0);}}break;case keys.PAGE_DOWN:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){event.stop(e);if(this.focus.rowIndex!=this.scroller.lastVisibleRow-1){this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1));this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0);}}break;default:break;}},onMouseOver:function(e){e.rowIndex==-1?this.onHeaderCellMouseOver(e):this.onCellMouseOver(e);},onMouseOut:function(e){e.rowIndex==-1?this.onHeaderCellMouseOut(e):this.onCellMouseOut(e);},onMouseDown:function(e){e.rowIndex==-1?this.onHeaderCellMouseDown(e):this.onCellMouseDown(e);},onMouseOverRow:function(e){if(!this.rows.isOver(e.rowIndex)){this.rows.setOverRow(e.rowIndex);e.rowIndex==-1?this.onHeaderMouseOver(e):this.onRowMouseOver(e);}},onMouseOutRow:function(e){if(this.rows.isOver(-1)){this.onHeaderMouseOut(e);}else{if(!this.rows.isOver(-2)){this.rows.setOverRow(-2);this.onRowMouseOut(e);}}},onMouseDownRow:function(e){if(e.rowIndex!=-1){this.onRowMouseDown(e);}},onCellMouseOver:function(e){if(e.cellNode){_126f.add(e.cellNode,this.cellOverClass);}},onCellMouseOut:function(e){if(e.cellNode){_126f.remove(e.cellNode,this.cellOverClass);}},onCellMouseDown:function(e){},onCellClick:function(e){this._click[0]=this._click[1];this._click[1]=e;if(!this.edit.isEditCell(e.rowIndex,e.cellIndex)){this.focus.setFocusCell(e.cell,e.rowIndex);}if(this._click.length>1&&this._click[0]==null){this._click.shift();}this.onRowClick(e);},onCellDblClick:function(e){var event;if(this._click.length>1&&has("ie")){event=this._click[1];}else{if(this._click.length>1&&this._click[0].rowIndex!=this._click[1].rowIndex){event=this._click[0];}else{event=e;}}this.focus.setFocusCell(event.cell,event.rowIndex);this.onRowClick(event);this.edit.setEditCell(event.cell,event.rowIndex);this.onRowDblClick(e);},onCellContextMenu:function(e){this.onRowContextMenu(e);},onCellFocus:function(_1276,_1277){this.edit.cellFocus(_1276,_1277);},onRowClick:function(e){this.edit.rowClick(e);this.selection.clickSelectEvent(e);},onRowDblClick:function(e){},onRowMouseOver:function(e){},onRowMouseOut:function(e){},onRowMouseDown:function(e){},onRowContextMenu:function(e){event.stop(e);},onHeaderMouseOver:function(e){},onHeaderMouseOut:function(e){},onHeaderCellMouseOver:function(e){if(e.cellNode){_126f.add(e.cellNode,this.cellOverClass);}},onHeaderCellMouseOut:function(e){if(e.cellNode){_126f.remove(e.cellNode,this.cellOverClass);}},onHeaderCellMouseDown:function(e){},onHeaderClick:function(e){},onHeaderCellClick:function(e){this.setSortIndex(e.cell.index);this.onHeaderClick(e);},onHeaderDblClick:function(e){},onHeaderCellDblClick:function(e){this.onHeaderDblClick(e);},onHeaderCellContextMenu:function(e){this.onHeaderContextMenu(e);},onHeaderContextMenu:function(e){if(!this.headerMenu){event.stop(e);}},onStartEdit:function(_1278,_1279){},onApplyCellEdit:function(_127a,_127b,_127c){},onCancelEdit:function(_127d){},onApplyEdit:function(_127e){},onCanSelect:function(_127f){return true;},onCanDeselect:function(_1280){return true;},onSelected:function(_1281){this.updateRowStyles(_1281);},onDeselected:function(_1282){this.updateRowStyles(_1282);},onSelectionChanged:function(){}});});},"dojox/gfx/Mover":function(){define("dojox/gfx/Mover",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/on","dojo/touch","dojo/_base/event"],function(lang,arr,_1283,on,touch,event){return _1283("dojox.gfx.Mover",null,{constructor:function(shape,e,host){this.shape=shape;this.lastX=e.clientX;this.lastY=e.clientY;var h=this.host=host,d=document,_1284=on(d,touch.move,lang.hitch(this,"onFirstMove"));this.events=[on(d,touch.move,lang.hitch(this,"onMouseMove")),on(d,touch.release,lang.hitch(this,"destroy")),on(d,"dragstart",lang.hitch(event,"stop")),on(d,"selectstart",lang.hitch(event,"stop")),_1284];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){var x=e.clientX;var y=e.clientY;this.host.onMove(this,{dx:x-this.lastX,dy:y-this.lastY});this.lastX=x;this.lastY=y;event.stop(e);},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove();},destroy:function(){arr.forEach(this.events,function(_1285){_1285.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.shape=null;}});});},"dojox/grid/util":function(){define("dojox/grid/util",["../main","dojo/_base/lang","dojo/dom"],function(dojox,lang,dom){var dgu=lang.getObject("grid.util",true,dojox);dgu.na="...";dgu.rowIndexTag="gridRowIndex";dgu.gridViewTag="gridView";dgu.fire=function(ob,ev,args){var fn=ob&&ev&&ob[ev];return fn&&(args?fn.apply(ob,args):ob[ev]());};dgu.setStyleHeightPx=function(_1286,_1287){if(_1287>=0){var s=_1286.style;var v=_1287+"px";if(_1286&&s["height"]!=v){s["height"]=v;}}};dgu.mouseEvents=["mouseover","mouseout","mousedown","mouseup","click","dblclick","contextmenu"];dgu.keyEvents=["keyup","keydown","keypress"];dgu.funnelEvents=function(_1288,_1289,_128a,_128b){var evts=(_128b?_128b:dgu.mouseEvents.concat(dgu.keyEvents));for(var i=0,l=evts.length;i<l;i++){_1289.connect(_1288,"on"+evts[i],_128a);}};dgu.removeNode=function(_128c){_128c=dom.byId(_128c);_128c&&_128c.parentNode&&_128c.parentNode.removeChild(_128c);return _128c;};dgu.arrayCompare=function(inA,inB){for(var i=0,l=inA.length;i<l;i++){if(inA[i]!=inB[i]){return false;}}return (inA.length==inB.length);};dgu.arrayInsert=function(_128d,_128e,_128f){if(_128d.length<=_128e){_128d[_128e]=_128f;}else{_128d.splice(_128e,0,_128f);}};dgu.arrayRemove=function(_1290,_1291){_1290.splice(_1291,1);};dgu.arraySwap=function(_1292,inI,inJ){var cache=_1292[inI];_1292[inI]=_1292[inJ];_1292[inJ]=cache;};return dgu;});},"dijit/form/_ComboBoxMenu":function(){define("dijit/form/_ComboBoxMenu",["dojo/_base/declare","dojo/dom-class","dojo/dom-style","dojo/keys","../_WidgetBase","../_TemplatedMixin","./_ComboBoxMenuMixin","./_ListMouseMixin"],function(_1293,_1294,_1295,keys,_1296,_1297,_1298,_1299){return _1293("dijit.form._ComboBoxMenu",[_1296,_1297,_1299,_1298],{templateString:"<div class='dijitReset dijitMenu' data-dojo-attach-point='containerNode' style='overflow: auto; overflow-x: hidden;' role='listbox'>"+"<div class='dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point='previousButton' role='option'></div>"+"<div class='dijitMenuItem dijitMenuNextButton' data-dojo-attach-point='nextButton' role='option'></div>"+"</div>",baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);if(!this.isLeftToRight()){_1294.add(this.previousButton,"dijitMenuItemRtl");_1294.add(this.nextButton,"dijitMenuItemRtl");}},_createMenuItem:function(){var item=this.ownerDocument.createElement("div");item.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");item.setAttribute("role","option");return item;},onHover:function(node){_1294.add(node,"dijitMenuItemHover");},onUnhover:function(node){_1294.remove(node,"dijitMenuItemHover");},onSelect:function(node){_1294.add(node,"dijitMenuItemSelected");},onDeselect:function(node){_1294.remove(node,"dijitMenuItemSelected");},_page:function(up){var _129a=0;var _129b=this.domNode.scrollTop;var _129c=_1295.get(this.domNode,"height");if(!this.getHighlightedOption()){this.selectNextNode();}while(_129a<_129c){var _129d=this.getHighlightedOption();if(up){if(!_129d.previousSibling||_129d.previousSibling.style.display=="none"){break;}this.selectPreviousNode();}else{if(!_129d.nextSibling||_129d.nextSibling.style.display=="none"){break;}this.selectNextNode();}var _129e=this.domNode.scrollTop;_129a+=(_129e-_129b)*(up?-1:1);_129b=_129e;}},handleKey:function(evt){switch(evt.keyCode){case keys.DOWN_ARROW:this.selectNextNode();return false;case keys.PAGE_DOWN:this._page(false);return false;case keys.UP_ARROW:this.selectPreviousNode();return false;case keys.PAGE_UP:this._page(true);return false;default:return true;}}});});},"url:esri/dijit/editing/templates/AttachmentEditor.html":"<div class=\"attachmentEditor\">\r\n    <br />\r\n    <div>\r\n        <b>${NLS_attachments}</b>\r\n        <hr />\r\n        <div dojoAttachPoint=\"_attachmentError\" style='color:red;display:none'></div>\r\n        <br />\r\n        <span dojoAttachPoint='_attachmentList' style='word-wrap: break-word;'></span>\r\n        <br><br>\r\n        <form dojoAttachPoint='_uploadForm'> ${NLS_add}:&nbsp;&nbsp;<input type='file' name='attachment' dojoAttachPoint='_uploadField' /> </form>\r\n    </div>\r\n</div>","dojox/fx":function(){define("dojox/fx",["./fx/_base"],function(_129f){return _129f;});},"dojox/grid/cells/_base":function(){define("dojox/grid/cells/_base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/_base/array","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_Widget","../util"],function(dojo,_12a0,lang,event,_12a1,array,has,dom,_12a2,_12a3,_12a4,util){var _12a5=_12a0("dojox.grid._DeferredTextWidget",_12a4,{deferred:null,_destroyOnRemove:true,postCreate:function(){if(this.deferred){this.deferred.addBoth(lang.hitch(this,function(text){if(this.domNode){this.domNode.innerHTML=text;}}));}}});var _12a6=function(_12a7){try{util.fire(_12a7,"focus");util.fire(_12a7,"select");}catch(e){}};var _12a8=function(){setTimeout(lang.hitch.apply(dojo,arguments),0);};var _12a9=_12a0("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:false,alwaysEditing:false,formatter:null,defaultValue:"...",value:null,hidden:false,noresize:false,draggable:true,_valueProp:"value",_formatPending:false,constructor:function(_12aa){this._props=_12aa||{};lang.mixin(this,_12aa);if(this.draggable===undefined){this.draggable=true;}},_defaultFormat:function(_12ab,_12ac){var s=this.grid.formatterScope||this;var f=this.formatter;if(f&&s&&typeof f=="string"){f=this.formatter=s[f];}var v=(_12ab!=this.defaultValue&&f)?f.apply(s,_12ac):_12ab;if(typeof v=="undefined"){return this.defaultValue;}if(v&&v.addBoth){v=new _12a5({deferred:v},_12a3.create("span",{innerHTML:this.defaultValue}));}if(v&&v.declaredClass&&v.startup){return "<div class='dojoxGridStubNode' linkWidget='"+v.id+"' cellIdx='"+this.index+"'>"+this.defaultValue+"</div>";}return v;},format:function(_12ad,_12ae){var f,i=this.grid.edit.info,d=this.get?this.get(_12ad,_12ae):(this.value||this.defaultValue);d=(d&&d.replace&&this.grid.escapeHTMLInData)?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"&amp;").replace(/</g,"&lt;"):d;if(this.editable&&(this.alwaysEditing||(i.rowIndex==_12ad&&i.cell==this))){return this.formatEditing(d,_12ad);}else{return this._defaultFormat(d,[d,_12ad,this]);}},formatEditing:function(_12af,_12b0){},getNode:function(_12b1){return this.view.getCellNode(_12b1,this.index);},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index);},getEditNode:function(_12b2){return (this.getNode(_12b2)||0).firstChild||0;},canResize:function(){var uw=this.unitWidth;return uw&&(uw!=="auto");},isFlex:function(){var uw=this.unitWidth;return uw&&lang.isString(uw)&&(uw=="auto"||uw.slice(-1)=="%");},applyEdit:function(_12b3,_12b4){if(this.getNode(_12b4)){this.grid.edit.applyCellEdit(_12b3,this,_12b4);}},cancelEdit:function(_12b5){this.grid.doCancelEdit(_12b5);},_onEditBlur:function(_12b6){if(this.grid.edit.isEditCell(_12b6,this.index)){this.grid.edit.apply();}},registerOnBlur:function(_12b7,_12b8){if(this.commitOnBlur){_12a1.connect(_12b7,"onblur",function(e){setTimeout(lang.hitch(this,"_onEditBlur",_12b8),250);});}},needFormatNode:function(_12b9,_12ba){this._formatPending=true;_12a8(this,"_formatNode",_12b9,_12ba);},cancelFormatNode:function(){this._formatPending=false;},_formatNode:function(_12bb,_12bc){if(this._formatPending){this._formatPending=false;if(!has("ie")){dom.setSelectable(this.grid.domNode,true);}this.formatNode(this.getEditNode(_12bc),_12bb,_12bc);}},formatNode:function(_12bd,_12be,_12bf){if(has("ie")){_12a8(this,"focus",_12bf,_12bd);}else{this.focus(_12bf,_12bd);}},dispatchEvent:function(m,e){if(m in this){return this[m](e);}},getValue:function(_12c0){return this.getEditNode(_12c0)[this._valueProp];},setValue:function(_12c1,_12c2){var n=this.getEditNode(_12c1);if(n){n[this._valueProp]=_12c2;}},focus:function(_12c3,_12c4){_12a6(_12c4||this.getEditNode(_12c3));},save:function(_12c5){this.value=this.value||this.getValue(_12c5);},restore:function(_12c6){this.setValue(_12c6,this.value);},_finish:function(_12c7){dom.setSelectable(this.grid.domNode,false);this.cancelFormatNode();},apply:function(_12c8){this.applyEdit(this.getValue(_12c8),_12c8);this._finish(_12c8);},cancel:function(_12c9){this.cancelEdit(_12c9);this._finish(_12c9);}});_12a9.markupFactory=function(node,_12ca){var _12cb=lang.trim(_12a2.get(node,"formatter")||"");if(_12cb){_12ca.formatter=lang.getObject(_12cb)||_12cb;}var get=lang.trim(_12a2.get(node,"get")||"");if(get){_12ca.get=lang.getObject(get);}var _12cc=function(attr,cell,_12cd){var value=lang.trim(_12a2.get(node,attr)||"");if(value){cell[_12cd||attr]=!(value.toLowerCase()=="false");}};_12cc("sortDesc",_12ca);_12cc("editable",_12ca);_12cc("alwaysEditing",_12ca);_12cc("noresize",_12ca);_12cc("draggable",_12ca);var value=lang.trim(_12a2.get(node,"loadingText")||_12a2.get(node,"defaultValue")||"");if(value){_12ca.defaultValue=value;}var _12ce=function(attr,cell,_12cf){var value=lang.trim(_12a2.get(node,attr)||"")||undefined;if(value){cell[_12cf||attr]=value;}};_12ce("styles",_12ca);_12ce("headerStyles",_12ca);_12ce("cellStyles",_12ca);_12ce("classes",_12ca);_12ce("headerClasses",_12ca);_12ce("cellClasses",_12ca);};var Cell=_12a0("dojox.grid.cells.Cell",_12a9,{constructor:function(){this.keyFilter=this.keyFilter;},keyFilter:null,formatEditing:function(_12d0,_12d1){this.needFormatNode(_12d0,_12d1);return "<input class=\"dojoxGridInput\" type=\"text\" value=\""+_12d0+"\">";},formatNode:function(_12d2,_12d3,_12d4){this.inherited(arguments);this.registerOnBlur(_12d2,_12d4);},doKey:function(e){if(this.keyFilter){var key=String.fromCharCode(e.charCode);if(key.search(this.keyFilter)==-1){event.stop(e);}}},_finish:function(_12d5){this.inherited(arguments);var n=this.getEditNode(_12d5);try{util.fire(n,"blur");}catch(e){}}});Cell.markupFactory=function(node,_12d6){_12a9.markupFactory(node,_12d6);var _12d7=lang.trim(_12a2.get(node,"keyFilter")||"");if(_12d7){_12d6.keyFilter=new RegExp(_12d7);}};var _12d8=_12a0("dojox.grid.cells.RowIndex",Cell,{name:"Row",postscript:function(){this.editable=false;},get:function(_12d9){return _12d9+1;}});_12d8.markupFactory=function(node,_12da){Cell.markupFactory(node,_12da);};var _12db=_12a0("dojox.grid.cells.Select",Cell,{options:null,values:null,returnIndex:-1,constructor:function(_12dc){this.values=this.values||this.options;},formatEditing:function(_12dd,_12de){this.needFormatNode(_12dd,_12de);var h=["<select class=\"dojoxGridSelect\">"];for(var i=0,o,v;((o=this.options[i])!==undefined)&&((v=this.values[i])!==undefined);i++){v=v.replace?v.replace(/&/g,"&amp;").replace(/</g,"&lt;"):v;o=o.replace?o.replace(/&/g,"&amp;").replace(/</g,"&lt;"):o;h.push("<option",(_12dd==v?" selected":"")," value=\""+v+"\"",">",o,"</option>");}h.push("</select>");return h.join("");},_defaultFormat:function(_12df,_12e0){var v=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var i=array.indexOf(this.values,v);if(i>=0){v=this.options[i];}}return v;},getValue:function(_12e1){var n=this.getEditNode(_12e1);if(n){var i=n.selectedIndex,o=n.options[i];return this.returnIndex>-1?i:o.value||o.innerHTML;}}});_12db.markupFactory=function(node,cell){Cell.markupFactory(node,cell);var _12e2=lang.trim(_12a2.get(node,"options")||"");if(_12e2){var o=_12e2.split(",");if(o[0]!=_12e2){cell.options=o;}}var _12e3=lang.trim(_12a2.get(node,"values")||"");if(_12e3){var v=_12e3.split(",");if(v[0]!=_12e3){cell.values=v;}}};var _12e4=_12a0("dojox.grid.cells.AlwaysEdit",Cell,{alwaysEditing:true,_formatNode:function(_12e5,_12e6){this.formatNode(this.getEditNode(_12e6),_12e5,_12e6);},applyStaticValue:function(_12e7){var e=this.grid.edit;e.applyCellEdit(this.getValue(_12e7),this,_12e7);e.start(this,_12e7,true);}});_12e4.markupFactory=function(node,cell){Cell.markupFactory(node,cell);};var Bool=_12a0("dojox.grid.cells.Bool",_12e4,{_valueProp:"checked",formatEditing:function(_12e8,_12e9){return "<input class=\"dojoxGridInput\" type=\"checkbox\""+(_12e8?" checked=\"checked\"":"")+" style=\"width: auto\" />";},doclick:function(e){if(e.target.tagName=="INPUT"){this.applyStaticValue(e.rowIndex);}}});Bool.markupFactory=function(node,cell){_12e4.markupFactory(node,cell);};return _12a9;});},"dijit/form/_DateTimeTextBox":function(){require({cache:{"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"button presentation\" aria-hidden=\"true\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n"}});define("dijit/form/_DateTimeTextBox",["dojo/date","dojo/date/locale","dojo/date/stamp","dojo/_base/declare","dojo/_base/lang","./RangeBoundTextBox","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(date,_12ea,stamp,_12eb,lang,_12ec,_12ed,_12ee){new Date("X");var _12ef=_12eb("dijit.form._DateTimeTextBox",[_12ec,_12ed],{templateString:_12ee,hasDownArrow:true,cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},pattern:_12ea.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text");},compare:function(val1,val2){var _12f0=this._isInvalidDate(val1);var _12f1=this._isInvalidDate(val2);return _12f0?(_12f1?0:-1):(_12f1?1:date.compare(val1,val2,this._selector));},forceWidth:true,format:function(value,_12f2){if(!value){return "";}return this.dateLocaleModule.format(value,_12f2);},"parse":function(value,_12f3){return this.dateLocaleModule.parse(value,_12f3)||(this._isEmpty(value)?null:undefined);},serialize:function(val,_12f4){if(val.toGregorian){val=val.toGregorian();}return stamp.toISOString(val,_12f4);},dropDownDefaultValue:new Date(),value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(_12f5){this.dateModule=_12f5.datePackage?lang.getObject(_12f5.datePackage,false):date;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=_12f5.datePackage?lang.getObject(_12f5.datePackage+".locale",false):_12ea;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString();},buildRendering:function(){this.inherited(arguments);if(!this.hasDownArrow){this._buttonNode.style.display="none";}if(!this.hasDownArrow){this._buttonNode=this.domNode;this.baseClass+=" dijitComboBoxOpenOnClick";}},_setConstraintsAttr:function(_12f6){_12f6.selector=this._selector;_12f6.fullYear=true;var _12f7=stamp.fromISOString;if(typeof _12f6.min=="string"){_12f6.min=_12f7(_12f6.min);}if(typeof _12f6.max=="string"){_12f6.max=_12f7(_12f6.max);}this.inherited(arguments);},_isInvalidDate:function(value){return !value||isNaN(value)||typeof value!="object"||value.toString()==this._invalidDate;},_setValueAttr:function(value,_12f8,_12f9){if(value!==undefined){if(typeof value=="string"){value=stamp.fromISOString(value);}if(this._isInvalidDate(value)){value=null;}if(value instanceof Date&&!(this.dateClassObj instanceof Date)){value=new this.dateClassObj(value);}}this.inherited(arguments);if(this.value instanceof Date){this.filterString="";}if(this.dropDown){this.dropDown.set("value",value,false);}},_set:function(attr,value){if(attr=="value"&&this.value instanceof Date&&this.compare(value,this.value)==0){return;}this.inherited(arguments);},_setDropDownDefaultValueAttr:function(val){if(this._isInvalidDate(val)){val=new this.dateClassObj();}this.dropDownDefaultValue=val;},openDropDown:function(_12fa){if(this.dropDown){this.dropDown.destroy();}var _12fb=lang.isString(this.popupClass)?lang.getObject(this.popupClass,false):this.popupClass,_12fc=this,value=this.get("value");this.dropDown=new _12fb({onChange:function(value){_12fc.set("value",value,true);},id:this.id+"_popup",dir:_12fc.dir,lang:_12fc.lang,value:value,currentFocus:!this._isInvalidDate(value)?value:this.dropDownDefaultValue,constraints:_12fc.constraints,filterString:_12fc.filterString,datePackage:_12fc.params.datePackage,isDisabledDate:function(date){return !_12fc.rangeCheck(date,_12fc.constraints);}});this.inherited(arguments);},_getDisplayedValueAttr:function(){return this.textbox.value;},_setDisplayedValueAttr:function(value,_12fd){this._setValueAttr(this.parse(value,this.constraints),_12fd,value);}});return _12ef;});},"url:esri/dijit/templates/AttributeInspector.html":"<div class=\"esriAttributeInspector\">\r\n    <div class=\"atiLayerName\" dojoAttachPoint=\"layerName\"></div>\r\n    <div class=\"atiAttributes\" dojoAttachPoint=\"attributeTable\"></div>\r\n    <div dojoAttachPoint=\"attachmentEditor\"></div>\r\n    <div class=\"atiEditorTrackingInfo\" dojoAttachPoint=\"editorTrackingInfoDiv\"></div>\r\n    <div class=\"atiButtons\" dojoAttachPoint=\"editButtons\">\r\n        <button  dojoType=\"dijit.form.Button\" class=\"atiButton atiDeleteButton\"  dojoAttachPoint=\"deleteBtn\" dojoAttachEvent=\"onClick: onDeleteBtn\" showLabel=\"true\" type=\"button\">${NLS_deleteFeature}</button>\r\n        <div class=\"atiNavButtons\" dojoAttachPoint=\"navButtons\">\r\n            <div class=\"atiNavMessage\" dojoAttachPoint=\"navMessage\"></div>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiFirstIcon\" dojoAttachPoint=\"firstFeatureButton\" dojoAttachEvent=\"onClick: onFirstFeature\" showLabel=\"false\" type=\"button\">${NLS_first}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiPrevIcon\" dojoAttachPoint=\"prevFeatureButton\" dojoAttachEvent=\"onClick: onPreviousFeature\" showLabel=\"false\" type=\"button\">${NLS_previous}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiNextIcon\" dojoAttachPoint=\"nextFeatureButton\" dojoAttachEvent=\"onClick: onNextFeature\" showLabel=\"false\" type=\"button\">${NLS_next}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiLastIcon\" dojoAttachPoint=\"lastFeatureButton\" dojoAttachEvent=\"onClick: onLastFeature\" showLabel=\"false\" type=\"button\">${NLS_last}</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n","esri/dijit/editing/Delete":function(){define("esri/dijit/editing/Delete",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/OperationBase","esri/dijit/editing/Add"],function(_12fe,lang,has,_12ff,_1300,Add){var _1301=_12fe(_1300,{declaredClass:"esri.dijit.editing.Delete",type:"edit",label:"Delete Features",constructor:function(_1302){_1302=_1302||{};this._add=new Add({featureLayer:_1302.featureLayer,addedGraphics:_1302.deletedGraphics});},performUndo:function(){this._add.performRedo();},performRedo:function(){this._add.performUndo();}});if(has("extend-esri")){lang.setObject("dijit.editing.Delete",_1301,_12ff);}return _1301;});},"url:esri/dijit/templates/TimeSlider.html":"   <div class=\"esriTimeSlider\">\r\n   <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\r\n   <tr>\r\n   <td align=\"right\" valign=\"middle\"><button dojoType=\"dijit.form.Button\" showLabel=\"false\" iconClass=\"tsButton tsPlayButton\" dojoAttachEvent=\"onClick:_onPlay\" dojoAttachPoint=\"playPauseBtn\" type=\"button\">${NLS_play}</button></td>\r\n   <td align=\"center\" valign=\"middle\" width=\"80%\" class=\"tsTmp\"></td>\r\n   <td align=\"left\" valign=\"middle\" width=\"30\"><button dojoType=\"dijit.form.Button\" showLabel=\"false\" iconClass=\"tsButton tsPrevButton\" dojoAttachEvent=\"onClick:_onPrev\" dojoAttachPoint=\"previousBtn\" type=\"button\">${NLS_previous}</button></td>\r\n   <td align=\"left\" valign=\"middle\"><button dojoType=\"dijit.form.Button\" showLabel=\"false\" iconClass=\"tsButton tsNextButton\" dojoAttachEvent=\"onClick:_onNext\" dojoAttachPoint=\"nextBtn\" type=\"button\">${NLS_next}</button></td>\r\n   </tr>    \r\n   </table>\r\n   </div>","dojox/grid/_Scroller":function(){define("dojox/grid/_Scroller",["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],function(_1303,_1304,lang,util,html){var _1305=function(_1306){var i=0,n,p=_1306.parentNode;while((n=p.childNodes[i++])){if(n==_1306){return i-1;}}return -1;};var _1307=function(_1308){if(!_1308){return;}dojo.forEach(_1303.toArray(),function(w){if(w.domNode&&html.isDescendant(w.domNode,_1308,true)){w.destroy();}});};var _1309=function(_130a){var node=html.byId(_130a);return (node&&node.tagName?node.tagName.toLowerCase():"");};var _130b=function(_130c,inTag){var _130d=[];var i=0,n;while((n=_130c.childNodes[i])){i++;if(_1309(n)==inTag){_130d.push(n);}}return _130d;};var _130e=function(_130f){return _130b(_130f,"div");};return _1304("dojox.grid._Scroller",null,{constructor:function(_1310){this.setContentNodes(_1310);this.pageHeights=[];this.pageNodes=[];this.stack=[];},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(_1311,_1312,_1313){switch(arguments.length){case 3:this.rowsPerPage=_1313;case 2:this.keepRows=_1312;case 1:this.rowCount=_1311;default:break;}this.defaultPageHeight=(this.grid.rowHeight>0?this.grid.rowHeight:this.defaultRowHeight)*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();if(this.scrollboxNode){this.scrollboxNode.scrollTop=0;this.scroll(0);this.scrollboxNode.onscroll=lang.hitch(this,"onscroll");}},_getPageCount:function(_1314,_1315){return _1314?(Math.ceil(_1314/_1315)||1):0;},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode;},setKeepInfo:function(_1316){this.keepRows=_1316;this.keepPages=!this.keepRows?this.keepPages:Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2);},setContentNodes:function(_1317){this.contentNodes=_1317;this.colCount=(this.contentNodes?this.contentNodes.length:0);this.pageNodes=[];for(var i=0;i<this.colCount;i++){this.pageNodes[i]=[];}},getDefaultNodes:function(){return this.pageNodes[0]||[];},invalidate:function(){this._invalidating=true;this.invalidateNodes();this.pageHeights=[];this.height=(this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0);this.resize();this._invalidating=false;},updateRowCount:function(_1318){this.invalidateNodes();this.rowCount=_1318;var _1319=this.pageCount;if(_1319===0){this.height=1;}this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<_1319){for(var i=_1319-1;i>=this.pageCount;i--){this.height-=this.getPageHeight(i);delete this.pageHeights[i];}}else{if(this.pageCount>_1319){this.height+=this.defaultPageHeight*(this.pageCount-_1319-1)+this.calcLastPageHeight();}}this.resize();},pageExists:function(_131a){return Boolean(this.getDefaultPageNode(_131a));},measurePage:function(_131b){if(this.grid.rowHeight){return ((_131b+1)*this.rowsPerPage>this.rowCount?this.rowCount-_131b*this.rowsPerPage:this.rowsPerPage)*this.grid.rowHeight;}var n=this.getDefaultPageNode(_131b);return (n&&n.innerHTML)?n.offsetHeight:undefined;},positionPage:function(_131c,inPos){for(var i=0;i<this.colCount;i++){this.pageNodes[i][_131c].style.top=inPos+"px";}},repositionPages:function(_131d){var nodes=this.getDefaultNodes();var last=0;for(var i=0;i<this.stack.length;i++){last=Math.max(this.stack[i],last);}var n=nodes[_131d];var y=(n?this.getPageNodePosition(n)+this.getPageHeight(_131d):0);for(var p=_131d+1;p<=last;p++){n=nodes[p];if(n){if(this.getPageNodePosition(n)==y){return;}this.positionPage(p,y);}y+=this.getPageHeight(p);}},installPage:function(_131e){for(var i=0;i<this.colCount;i++){this.contentNodes[i].appendChild(this.pageNodes[i][_131e]);}},preparePage:function(_131f,_1320){var p=(_1320?this.popPage():null);for(var i=0;i<this.colCount;i++){var nodes=this.pageNodes[i];var new_p=(p===null?this.createPageNode():this.invalidatePageNode(p,nodes));new_p.pageIndex=_131f;nodes[_131f]=new_p;}},renderPage:function(_1321){var nodes=[];var i,j;for(i=0;i<this.colCount;i++){nodes[i]=this.pageNodes[i][_1321];}for(i=0,j=_1321*this.rowsPerPage;(i<this.rowsPerPage)&&(j<this.rowCount);i++,j++){this.renderRow(j,nodes);}},removePage:function(_1322){for(var i=0,j=_1322*this.rowsPerPage;i<this.rowsPerPage;i++,j++){this.removeRow(j);}},destroyPage:function(_1323){for(var i=0;i<this.colCount;i++){var n=this.invalidatePageNode(_1323,this.pageNodes[i]);if(n){html.destroy(n);}}},pacify:function(_1324){},pacifying:false,pacifyTicks:200,setPacifying:function(_1325){if(this.pacifying!=_1325){this.pacifying=_1325;this.pacify(this.pacifying);}},startPacify:function(){this.startPacifyTicks=new Date().getTime();},doPacify:function(){var _1326=(new Date().getTime()-this.startPacifyTicks)>this.pacifyTicks;this.setPacifying(true);this.startPacify();return _1326;},endPacify:function(){this.setPacifying(false);},resize:function(){if(this.scrollboxNode){this.windowHeight=this.scrollboxNode.clientHeight;}for(var i=0;i<this.colCount;i++){util.setStyleHeightPx(this.contentNodes[i],Math.max(1,this.height));}var _1327=(!this._invalidating);if(!_1327){var ah=this.grid.get("autoHeight");if(typeof ah=="number"&&ah<=Math.min(this.rowsPerPage,this.rowCount)){_1327=true;}}if(_1327){this.needPage(this.page,this.pageTop);}var _1328=(this.page<this.pageCount-1)?this.rowsPerPage:((this.rowCount%this.rowsPerPage)||this.rowsPerPage);var _1329=this.getPageHeight(this.page);this.averageRowHeight=(_1329>0&&_1328>0)?(_1329/_1328):0;},calcLastPageHeight:function(){if(!this.pageCount){return 0;}var _132a=this.pageCount-1;var _132b=((this.rowCount%this.rowsPerPage)||(this.rowsPerPage))*this.defaultRowHeight;this.pageHeights[_132a]=_132b;return _132b;},updateContentHeight:function(inDh){this.height+=inDh;this.resize();},updatePageHeight:function(_132c,_132d,_132e){if(this.pageExists(_132c)){var oh=this.getPageHeight(_132c);var h=(this.measurePage(_132c));if(h===undefined){h=oh;}this.pageHeights[_132c]=h;if(oh!=h){this.updateContentHeight(h-oh);var ah=this.grid.get("autoHeight");if((typeof ah=="number"&&ah>this.rowCount)||(ah===true&&!_132d)){if(!_132e){this.grid.sizeChange();}else{var ns=this.grid.viewsNode.style;ns.height=parseInt(ns.height)+h-oh+"px";this.repositionPages(_132c);}}else{this.repositionPages(_132c);}}return h;}return 0;},rowHeightChanged:function(_132f,_1330){this.updatePageHeight(Math.floor(_132f/this.rowsPerPage),false,_1330);},invalidateNodes:function(){while(this.stack.length){this.destroyPage(this.popPage());}},createPageNode:function(){var p=document.createElement("div");html.attr(p,"role","presentation");p.style.position="absolute";p.style[this.grid.isLeftToRight()?"left":"right"]="0";return p;},getPageHeight:function(_1331){var ph=this.pageHeights[_1331];return (ph!==undefined?ph:this.defaultPageHeight);},pushPage:function(_1332){return this.stack.push(_1332);},popPage:function(){return this.stack.shift();},findPage:function(inTop){var i=0,h=0;for(var ph=0;i<this.pageCount;i++,h+=ph){ph=this.getPageHeight(i);if(h+ph>=inTop){break;}}this.page=i;this.pageTop=h;},buildPage:function(_1333,_1334,inPos){this.preparePage(_1333,_1334);this.positionPage(_1333,inPos);this.installPage(_1333);this.renderPage(_1333);this.pushPage(_1333);},needPage:function(_1335,inPos){var h=this.getPageHeight(_1335),oh=h;if(!this.pageExists(_1335)){this.buildPage(_1335,(!this.grid._autoHeight&&this.keepPages&&(this.stack.length>=this.keepPages)),inPos);h=this.updatePageHeight(_1335,true);}else{this.positionPage(_1335,inPos);}return h;},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop);},scroll:function(inTop){this.grid.scrollTop=inTop;if(this.colCount){this.startPacify();this.findPage(inTop);var h=this.height;var b=this.getScrollBottom(inTop);for(var p=this.page,y=this.pageTop;(p<this.pageCount)&&((b<0)||(y<b));p++){y+=this.needPage(p,y);}this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,inTop);this.lastVisibleRow=this.getLastVisibleRow(p-1,y,b);if(h!=this.height){this.repositionPages(p-1);}this.endPacify();}},getScrollBottom:function(inTop){return (this.windowHeight>=0?inTop+this.windowHeight:-1);},processNodeEvent:function(e,_1336){var t=e.target;while(t&&(t!=_1336)&&t.parentNode&&(t.parentNode.parentNode!=_1336)){t=t.parentNode;}if(!t||!t.parentNode||(t.parentNode.parentNode!=_1336)){return false;}var page=t.parentNode;e.topRowIndex=page.pageIndex*this.rowsPerPage;e.rowIndex=e.topRowIndex+_1305(t);e.rowTarget=t;return true;},processEvent:function(e){return this.processNodeEvent(e,this.contentNode);},renderRow:function(_1337,_1338){},removeRow:function(_1339){},getDefaultPageNode:function(_133a){return this.getDefaultNodes()[_133a];},positionPageNode:function(_133b,inPos){},getPageNodePosition:function(_133c){return _133c.offsetTop;},invalidatePageNode:function(_133d,_133e){var p=_133e[_133d];if(p){delete _133e[_133d];this.removePage(_133d,p);_1307(p);p.innerHTML="";}return p;},getPageRow:function(_133f){return _133f*this.rowsPerPage;},getLastPageRow:function(_1340){return Math.min(this.rowCount,this.getPageRow(_1340+1))-1;},getFirstVisibleRow:function(_1341,_1342,_1343){if(!this.pageExists(_1341)){return 0;}var row=this.getPageRow(_1341);var nodes=this.getDefaultNodes();var rows=_130e(nodes[_1341]);for(var i=0,l=rows.length;i<l&&_1342<_1343;i++,row++){_1342+=rows[i].offsetHeight;}return (row?row-1:row);},getLastVisibleRow:function(_1344,_1345,_1346){if(!this.pageExists(_1344)){return 0;}var nodes=this.getDefaultNodes();var row=this.getLastPageRow(_1344);var rows=_130e(nodes[_1344]);for(var i=rows.length-1;i>=0&&_1345>_1346;i--,row--){_1345-=rows[i].offsetHeight;}return row+1;},findTopRow:function(_1347){var nodes=this.getDefaultNodes();var rows=_130e(nodes[this.page]);for(var i=0,l=rows.length,t=this.pageTop,h;i<l;i++){h=rows[i].offsetHeight;t+=h;if(t>=_1347){this.offset=h-(t-_1347);return i+this.page*this.rowsPerPage;}}return -1;},findScrollTop:function(inRow){var _1348=Math.floor(inRow/this.rowsPerPage);var t=0;var i,l;for(i=0;i<_1348;i++){t+=this.getPageHeight(i);}this.pageTop=t;this.page=_1348;this.needPage(_1348,this.pageTop);var nodes=this.getDefaultNodes();var rows=_130e(nodes[_1348]);var r=inRow-this.rowsPerPage*_1348;for(i=0,l=rows.length;i<l&&i<r;i++){t+=rows[i].offsetHeight;}return t;},dummy:0});});},"dijit/Calendar":function(){define("dijit/Calendar",["dojo/_base/array","dojo/date","dojo/date/locale","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/_base/event","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/sniff","./CalendarLite","./_Widget","./_CssStateMixin","./_TemplatedMixin","./form/DropDownButton"],function(array,date,local,_1349,_134a,_134b,event,_134c,keys,lang,has,_134d,_134e,_134f,_1350,_1351){var _1352=_1349("dijit.Calendar",[_134d,_134e,_134f],{cssStateNodes:{"decrementMonth":"dijitCalendarArrow","incrementMonth":"dijitCalendarArrow","previousYearLabelNode":"dijitCalendarPreviousYear","nextYearLabelNode":"dijitCalendarNextYear"},setValue:function(value){_134c.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",value);},_createMonthWidget:function(){return new _1352._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:lang.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onkeydown","_onKeyDown");this.connect(this.dateRowsNode,"onmouseover","_onDayMouseOver");this.connect(this.dateRowsNode,"onmouseout","_onDayMouseOut");this.connect(this.dateRowsNode,"onmousedown","_onDayMouseDown");this.connect(this.dateRowsNode,"onmouseup","_onDayMouseUp");},_onMonthSelect:function(_1353){var date=new this.dateClassObj(this.currentFocus);date.setDate(1);date.setMonth(_1353);var _1354=this.dateModule.getDaysInMonth(date);var _1355=this.currentFocus.getDate();date.setDate(Math.min(_1355,_1354));this._setCurrentFocusAttr(date);},_onDayMouseOver:function(evt){var node=_134b.contains(evt.target,"dijitCalendarDateLabel")?evt.target.parentNode:evt.target;if(node&&((node.dijitDateValue&&!_134b.contains(node,"dijitCalendarDisabledDate"))||node==this.previousYearLabelNode||node==this.nextYearLabelNode)){_134b.add(node,"dijitCalendarHoveredDate");this._currentNode=node;}},_onDayMouseOut:function(evt){if(!this._currentNode){return;}if(evt.relatedTarget&&evt.relatedTarget.parentNode==this._currentNode){return;}var cls="dijitCalendarHoveredDate";if(_134b.contains(this._currentNode,"dijitCalendarActiveDate")){cls+=" dijitCalendarActiveDate";}_134b.remove(this._currentNode,cls);this._currentNode=null;},_onDayMouseDown:function(evt){var node=evt.target.parentNode;if(node&&node.dijitDateValue&&!_134b.contains(node,"dijitCalendarDisabledDate")){_134b.add(node,"dijitCalendarActiveDate");this._currentNode=node;}},_onDayMouseUp:function(evt){var node=evt.target.parentNode;if(node&&node.dijitDateValue){_134b.remove(node,"dijitCalendarActiveDate");}},handleKey:function(evt){var _1356=-1,_1357,_1358=this.currentFocus;switch(evt.keyCode){case keys.RIGHT_ARROW:_1356=1;case keys.LEFT_ARROW:_1357="day";if(!this.isLeftToRight()){_1356*=-1;}break;case keys.DOWN_ARROW:_1356=1;case keys.UP_ARROW:_1357="week";break;case keys.PAGE_DOWN:_1356=1;case keys.PAGE_UP:_1357=evt.ctrlKey||evt.altKey?"year":"month";break;case keys.END:_1358=this.dateModule.add(_1358,"month",1);_1357="day";case keys.HOME:_1358=new this.dateClassObj(_1358);_1358.setDate(1);break;case keys.ENTER:case keys.SPACE:this.set("value",this.currentFocus);break;default:return true;}if(_1357){_1358=this.dateModule.add(_1358,_1357,_1356);}this._setCurrentFocusAttr(_1358);return false;},_onKeyDown:function(evt){if(!this.handleKey(evt)){event.stop(evt);}},onValueSelected:function(){},onChange:function(value){this.onValueSelected(value);},getClassForDate:function(){}});_1352._MonthDropDownButton=_1349("dijit.Calendar._MonthDropDownButton",_1351,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new _1352._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect});},_setMonthAttr:function(month){var _1359=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,month);this.dropDown.set("months",_1359);this.containerNode.innerHTML=(has("ie")==6?"":"<div class='dijitSpacer'>"+this.dropDown.domNode.innerHTML+"</div>")+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+_1359[month.getMonth()]+"</div>";}});_1352._MonthDropDown=_1349("dijit.Calendar._MonthDropDown",[_134e,_1350],{months:[],templateString:"<div class='dijitCalendarMonthMenu dijitMenu' "+"data-dojo-attach-event='onclick:_onClick,onmouseover:_onMenuHover,onmouseout:_onMenuHover'></div>",_setMonthsAttr:function(_135a){this.domNode.innerHTML=array.map(_135a,function(month,idx){return month?"<div class='dijitCalendarMonthLabel' month='"+idx+"'>"+month+"</div>":"";}).join("");},_onClick:function(evt){this.onChange(_134a.get(evt.target,"month"));},onChange:function(){},_onMenuHover:function(evt){_134b.toggle(evt.target,"dijitCalendarMonthLabelHover",evt.type=="mouseover");}});return _1352;});},"dojo/dnd/Container":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../_base/window","../dom","../dom-class","../dom-construct","../Evented","../has","../on","../query","../ready","../touch","./common"],function(array,_135b,event,_135c,lang,win,dom,_135d,_135e,_135f,has,on,query,ready,touch,dnd){var _1360=_135b("dojo.dnd.Container",_135f,{skipForm:false,allowNested:false,constructor:function(node,_1361){this.node=dom.byId(node);if(!_1361){_1361={};}this.creator=_1361.creator||null;this.skipForm=_1361.skipForm;this.parent=_1361.dropParent&&dom.byId(_1361.dropParent);this.map={};this.current=null;this.containerState="";_135d.add(this.node,"dojoDndContainer");if(!(_1361&&_1361._skipStartup)){this.startup();}this.events=[on(this.node,touch.over,lang.hitch(this,"onMouseOver")),on(this.node,touch.out,lang.hitch(this,"onMouseOut")),on(this.node,"dragstart",lang.hitch(this,"onSelectStart")),on(this.node,"selectstart",lang.hitch(this,"onSelectStart"))];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||_135c.global;var m=this.map,e=dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return query((this.allowNested?"":"> ")+".dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_1362,_1363){if(!this.parent.firstChild){_1363=null;}else{if(_1362){if(!_1363){_1363=this.parent.firstChild;}}else{if(_1363){_1363=_1363.nextSibling;}}}var i,t;if(_1363){for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});_1363.parentNode.insertBefore(t.node,_1363);}}else{for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){array.forEach(this.events,function(_1364){_1364.remove();});this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_1365,node,Ctor){_1365._skipStartup=true;return new Ctor(node,_1365);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dnd.isFormElement(e)){event.stop(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_1366){var _1367="dojoDnd"+type;var state=type.toLowerCase()+"State";_135d.replace(this.node,_1367+_1366,_1367+this[state]);this[state]=_1366;},_addItemClass:function(node,type){_135d.add(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){_135d.remove(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _1368=node.parentNode;_1368;node=_1368,_1368=node.parentNode){if((_1368==this.parent||this.allowNested)&&_135d.contains(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!lang.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dnd.getUniqueId();}_135d.add(t.node,"dojoDndItem");return t;}});dnd._createNode=function(tag){if(!tag){return dnd._createSpan;}return function(text){return _135e.create(tag,{innerHTML:text});};};dnd._createTrTd=function(text){var tr=_135e.create("tr");_135e.create("td",{innerHTML:text},tr);return tr;};dnd._createSpan=function(text){return _135e.create("span",{innerHTML:text});};dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dnd._createTrTd:dnd._createNode(dnd._defaultCreatorNodes[tag]);return function(item,hint){var isObj=item&&lang.isObject(item),data,type,n;if(isObj&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(isObj&&item.data)?item.data:item;type=(isObj&&item.type)?item.type:["text"];n=(hint=="avatar"?dnd._createSpan:c)(String(data));}if(!n.id){n.id=dnd.getUniqueId();}return {node:n,data:data,type:type};};};return _1360;});},"dojox/date/islamic":function(){define("dojox/date/islamic",["..","dojo/_base/lang","dojo/date","./islamic/Date"],function(dojox,lang,dd,IDate){var _1369=lang.getObject("date.islamic",true,dojox);_1369.getDaysInMonth=function(month){return month.getDaysInIslamicMonth(month.getMonth(),month.getFullYear());};_1369.compare=function(date1,date2,_136a){if(date1 instanceof IDate){date1=date1.toGregorian();}if(date2 instanceof IDate){date2=date2.toGregorian();}return dd.compare.apply(null,arguments);};_1369.add=function(date,_136b,_136c){var _136d=new IDate(date);switch(_136b){case "day":_136d.setDate(date.getDate()+_136c);break;case "weekday":var day=date.getDay();if(((day+_136c)<5)&&((day+_136c)>0)){_136d.setDate(date.getDate()+_136c);}else{var _136e=0,_136f=0;if(day==5){day=4;_136f=(_136c>0)?-1:1;}else{if(day==6){day=4;_136f=(_136c>0)?-2:2;}}var add=(_136c>0)?(5-day-1):-day;var _1370=_136c-add;var div=parseInt(_1370/5);if(_1370%5!=0){_136e=(_136c>0)?2:-2;}_136e=_136e+div*7+_1370%5+add;_136d.setDate(date.getDate()+_136e+_136f);}break;case "year":_136d.setFullYear(date.getFullYear()+_136c);break;case "week":_136c*=7;_136d.setDate(date.getDate()+_136c);break;case "month":var month=date.getMonth();_136d.setMonth(month+_136c);break;case "hour":_136d.setHours(date.getHours()+_136c);break;case "minute":_136d._addMinutes(_136c);break;case "second":_136d._addSeconds(_136c);break;case "millisecond":_136d._addMilliseconds(_136c);break;}return _136d;};_1369.difference=function(date1,date2,_1371){date2=date2||new IDate();_1371=_1371||"day";var _1372=date2.getFullYear()-date1.getFullYear();var delta=1;switch(_1371){case "weekday":var days=Math.round(_1369.difference(date1,date2,"day"));var weeks=parseInt(_1369.difference(date1,date2,"week"));var mod=days%7;if(mod==0){days=weeks*5;}else{var adj=0;var aDay=date1.getDay();var bDay=date2.getDay();weeks=parseInt(days/7);mod=days%7;var _1373=new IDate(date1);_1373.setDate(_1373.getDate()+(weeks*7));var _1374=_1373.getDay();if(days>0){switch(true){case aDay==5:adj=-1;break;case aDay==6:adj=0;break;case bDay==5:adj=-1;break;case bDay==6:adj=-2;break;case (_1374+mod)>5:adj=-2;}}else{if(days<0){switch(true){case aDay==5:adj=0;break;case aDay==6:adj=1;break;case bDay==5:adj=2;break;case bDay==6:adj=1;break;case (_1374+mod)<0:adj=2;}}}days+=adj;days-=(weeks*2);}delta=days;break;case "year":delta=_1372;break;case "month":var _1375=(date2.toGregorian()>date1.toGregorian())?date2:date1;var _1376=(date2.toGregorian()>date1.toGregorian())?date1:date2;var _1377=_1375.getMonth();var _1378=_1376.getMonth();if(_1372==0){delta=_1375.getMonth()-_1376.getMonth();}else{delta=12-_1378;delta+=_1377;var i=_1376.getFullYear()+1;var e=_1375.getFullYear();for(i;i<e;i++){delta+=12;}}if(date2.toGregorian()<date1.toGregorian()){delta=-delta;}break;case "week":delta=parseInt(_1369.difference(date1,date2,"day")/7);break;case "day":delta/=24;case "hour":delta/=60;case "minute":delta/=60;case "second":delta/=1000;case "millisecond":delta*=date2.toGregorian().getTime()-date1.toGregorian().getTime();}return Math.round(delta);};return _1369;});},"dojox/grid/DataSelection":function(){define("dojox/grid/DataSelection",["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(_1379,_137a,_137b){return _1379("dojox.grid.DataSelection",_137b,{constructor:function(grid){if(grid.keepSelection){this.preserver=new _137a(this);}},destroy:function(){if(this.preserver){this.preserver.destroy();}},getFirstSelected:function(){var idx=_137b.prototype.getFirstSelected.call(this);if(idx==-1){return null;}return this.grid.getItem(idx);},getNextSelected:function(_137c){var _137d=this.grid.getItemIndex(_137c);var idx=_137b.prototype.getNextSelected.call(this,_137d);if(idx==-1){return null;}return this.grid.getItem(idx);},getSelected:function(){var _137e=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_137e.push(this.grid.getItem(i));}}return _137e;},addToSelection:function(_137f){if(this.mode=="none"){return;}var idx=null;if(typeof _137f=="number"||typeof _137f=="string"){idx=_137f;}else{idx=this.grid.getItemIndex(_137f);}_137b.prototype.addToSelection.call(this,idx);},deselect:function(_1380){if(this.mode=="none"){return;}var idx=null;if(typeof _1380=="number"||typeof _1380=="string"){idx=_1380;}else{idx=this.grid.getItemIndex(_1380);}_137b.prototype.deselect.call(this,idx);},deselectAll:function(_1381){var idx=null;if(_1381||typeof _1381=="number"){if(typeof _1381=="number"||typeof _1381=="string"){idx=_1381;}else{idx=this.grid.getItemIndex(_1381);}_137b.prototype.deselectAll.call(this,idx);}else{this.inherited(arguments);}}});});},"esri/tasks/PrintTask":function(){define("esri/tasks/PrintTask",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/_base/Deferred","dojo/has","esri/kernel","esri/lang","esri/deferredUtils","esri/tasks/Task","esri/renderers/SimpleRenderer","esri/geometry/scaleUtils","esri/tasks/Geoprocessor","esri/tasks/PrintTemplate","dojo/has!extend-esri?esri/tasks/PrintParameters","dojo/has!extend-esri?esri/tasks/LegendLayer"],function(_1382,lang,array,_1383,_1384,has,_1385,_1386,_1387,Task,_1388,_1389,_138a,_138b){var _138c=_1382(Task,{declaredClass:"esri.tasks.PrintTask",constructor:function(url,_138d){this.url=url;this.printGp=new _138a(this.url);this._handler=lang.hitch(this,this._handler);if(_138d&&_138d.async){this.async=_138d.async;}},_handler:function(_138e,io,_138f,_1390,dfd){try{var _1391;if(this.async){if(_138e.jobStatus==="esriJobSucceeded"){this.printGp.getResultData(_138e.jobId,"Output_File",lang.hitch(this,function(_1392){_1391=_1392.value;this._successHandler([_1391],"onComplete",_138f,dfd);}));}}else{_1391=_138e[0].value;this._successHandler([_1391],"onComplete",_138f,dfd);}}catch(err){this._errorHandler(err,_1390,dfd);}},execute:function(_1393,_1394,_1395){var _1396=this._handler,_1397=this._errorHandler;var _1398=_1393.template||new _138b();var _1399=_1398.exportOptions;var _139a;if(_1399){var width=_1399.width;var _139b=_1399.height;var dpi=_1399.dpi;_139a={outputSize:[width,_139b],dpi:dpi};}if(_1398.preserveScale===false){this._preserveScale=false;}else{this._preserveScale=true;}var _139c=_1398.layoutOptions;var _139d,_139e=[];if(_139c){this.legendAll=false;if(!_139c.legendLayers){this.legendAll=true;}else{array.forEach(_139c.legendLayers,function(_139f,idx){var _13a0={};_13a0.id=_139f.layerId;if(_139f.subLayerIds){_13a0.subLayerIds=_139f.subLayerIds;}_139e.push(_13a0);});}var _13a1,_13a2;if(_139c.scalebarUnit==="Miles"||_139c.scalebarUnit==="Kilometers"){_13a1="Kilometers";_13a2="Miles";}else{if(_139c.scalebarUnit==="Meters"||_139c.scalebarUnit==="Feet"){_13a1="Meters";_13a2="Feet";}}var _13a3={Miles:"mi",Kilometers:"km",Yards:"yd",Feet:"ft",Meters:"m"};_139d={titleText:_139c.titleText,authorText:_139c.authorText,copyrightText:_139c.copyrightText,customTextElements:_139c.customTextElements,scaleBarOptions:{metricUnit:_13a1,metricLabel:_13a3[_13a1],nonMetricUnit:_13a2,nonMetricLabel:_13a3[_13a2]},legendOptions:{operationalLayers:_139e}};}var map=_1393.map;var _13a4=this._getPrintDefinition(map);if(_1393.outSpatialReference){_13a4.mapOptions.spatialReference=_1393.outSpatialReference.toJson();}if(_1393.template&&_1386.isDefined(_1393.template.showAttribution)){_13a4.mapOptions.showAttribution=_1393.template.showAttribution;}lang.mixin(_13a4,{exportOptions:_139a,layoutOptions:_139d});if(this.allLayerslegend){lang.mixin(_13a4.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}});}var _13a5=_1383.toJson(_1386.fixJson(_13a4));var _13a6=_1398.format;var _13a7=_1398.layout;var _13a8={Web_Map_as_JSON:_13a5,Format:_13a6,Layout_Template:_13a7};if(_1393.extraParameters){_13a8=lang.mixin(_13a8,_1393.extraParameters);}var dfd=new _1384(_1387._dfdCanceller);var load=function(r,i){_1396(r,i,_1394,_1395,dfd);};var error=function(r){_1397(r,_1395,dfd);};if(this.async){dfd._pendingDfd=this.printGp.submitJob(_13a8,load,null,error);}else{dfd._pendingDfd=this.printGp.execute(_13a8,load,error);}return dfd;},onComplete:function(){},_multipointLayer:function(){this.layerDefinition={name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}};this.featureSet={geometryType:"esriGeometryMultipoint",features:[]};},_polygonLayer:function(){this.layerDefinition={name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}};this.featureSet={geometryType:"esriGeometryPolygon",features:[]};},_pointLayer:function(){this.layerDefinition={name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}};this.featureSet={geometryType:"esriGeometryPoint",features:[]};},_polylineLayer:function(){this.layerDefinition={name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}};this.featureSet={geometryType:"esriGeometryPolyline",features:[]};},_createFeatureCollection:function(_13a9){var _13aa=new this._polygonLayer();var _13ab=new this._polylineLayer();var _13ac=new this._pointLayer();var _13ad=new this._multipointLayer();if(_13a9.declaredClass==="esri.layers.FeatureLayer"){_13aa.layerDefinition.name=_13ab.layerDefinition.name=_13ac.layerDefinition.name=_13ad.layerDefinition.name=_13a9.name||_13a9.id;}if(_13a9.renderer&&!lang.isFunction(_13a9.renderer.attributeField)){_13aa.layerDefinition.drawingInfo.renderer=_13a9.renderer.toJson();_13ab.layerDefinition.drawingInfo.renderer=_13a9.renderer.toJson();_13ac.layerDefinition.drawingInfo.renderer=_13a9.renderer.toJson();_13ad.layerDefinition.drawingInfo.renderer=_13a9.renderer.toJson();}else{delete _13aa.layerDefinition.drawingInfo;delete _13ab.layerDefinition.drawingInfo;delete _13ac.layerDefinition.drawingInfo;delete _13ad.layerDefinition.drawingInfo;}if(_13a9.fields){_13aa.layerDefinition.fields=_13a9.fields;_13ab.layerDefinition.fields=_13a9.fields;_13ac.layerDefinition.fields=_13a9.fields;_13ad.layerDefinition.fields=_13a9.fields;}var gJson,i;for(i=0;i<_13a9.graphics.length;i++){var g=_13a9.graphics[i];if(g.visible===false||!g.geometry){continue;}gJson=g.toJson();if(gJson.symbol&&gJson.symbol.outline&&gJson.symbol.outline.color&&gJson.symbol.outline.color[3]){gJson.symbol.outline.color[3]=255;}if(_13a9.renderer&&lang.isFunction(_13a9.renderer.attributeField)&&!gJson.symbol){gJson.symbol=_13a9.renderer.getSymbol(g)?_13a9.renderer.getSymbol(g).toJson():gJson.symbol;}switch(g.geometry.type){case "polygon":_13aa.featureSet.features.push(gJson);break;case "polyline":_13ab.featureSet.features.push(gJson);break;case "point":_13ac.featureSet.features.push(gJson);break;case "multipoint":_13ad.featureSet.features.push(gJson);break;}}var _13ae=[];if(_13ac.featureSet.features.length>0){_13ae.push(_13ac);}if(_13ab.featureSet.features.length>0){_13ae.push(_13ab);}if(_13aa.featureSet.features.length>0){_13ae.push(_13aa);}if(_13ad.featureSet.features.length>0){_13ae.push(_13ad);}var _13af={layers:_13ae};var _13b0={id:_13a9.id,opacity:_13a9.opacity,minScale:_13a9.minScale||0,maxScale:_13a9.maxScale||0,featureCollection:_13af};return _13b0;},_getPrintDefinition:function(map){var _13b1=this._createOperationalLayers(map);var _13b2={operationalLayers:_13b1};var _13b3=map.extent,sr=map.spatialReference;if(map.spatialReference._isWrappable()){_13b3=_13b3._normalize(true);sr=_13b3.spatialReference;}var _13b4={mapOptions:{showAttribution:map.showAttribution,extent:_13b3.toJson(),spatialReference:sr.toJson()}};if(this._preserveScale){lang.mixin(_13b4.mapOptions,{scale:_1389.getScale(map)});}if(map.timeExtent){lang.mixin(_13b4.mapOptions,{time:[map.timeExtent.startTime.getTime(),map.timeExtent.endTime.getTime()]});}var _13b5={};lang.mixin(_13b5,_13b4,_13b2);return _13b5;},_createOperationalLayers:function(map){var i,layer,_13b6,_13b7,_13b8=[],_13b9=[];if(this.legendAll){this.allLayerslegend=[];}else{this.allLayerslegend=null;}for(i=0;i<map.layerIds.length;i++){layer=map.getLayer(map.layerIds[i]);if(!layer.loaded||!layer.visible||array.indexOf(_13b8,layer.id)!==-1){continue;}if(layer.credential&&layer.url.indexOf("token=")===-1){layer.url+="?token="+layer.credential.token;}_13b6=layer.declaredClass;_13b7={id:layer.id,title:layer.id,opacity:layer.opacity,minScale:layer.minScale||0,maxScale:layer.maxScale||0};switch(_13b6){case "esri.layers.ArcGISDynamicMapServiceLayer":var _13ba=[];if(layer._params.dynamicLayers){var _13bb=_1383.fromJson(layer._params.dynamicLayers);array.forEach(_13bb,function(_13bc,idx){_13ba.push({id:_13bc.id,layerDefinition:_13bc});});}else{array.forEach(layer.layerInfos,function(_13bd,idx){var _13be={id:_13bd.id,layerDefinition:{definitionExpression:null,layerTimeOptions:null}};if(layer.layerDefinitions&&layer.layerDefinitions[_13bd.id]){_13be.layerDefinition.definitionExpression=layer.layerDefinitions[_13bd.id];}if(layer.layerTimeOptions&&layer.layerTimeOptions[_13bd.id]){_13be.layerDefinition.layerTimeOptions=layer.layerTimeOptions[_13bd.id];}if(_13be.layerDefinition.definitionExpression||_13be.layerDefinition.layerTimeOptions){_13ba.push(_13be);}});}var _13bf=layer._params.layers?layer.visibleLayers:null;_13b7=lang.mixin(_13b7,{url:layer.url,visibleLayers:_13bf,layers:_13ba});_13b9.push(_13b7);if(this.allLayerslegend){this.allLayerslegend.push({id:layer.id,subLayerIds:layer.visibleLayers});}break;case "esri.layers.ArcGISImageServiceLayer":_13b7=lang.mixin(_13b7,{url:layer.url,bandIds:layer.bandIds,compressionQuality:layer.compressionQuality,format:layer.format,interpolation:layer.interpolation});if(layer.mosaicRule){lang.mixin(_13b7,{mosaicRule:layer.mosaicRule.toJson()});}if(layer.renderingRule){lang.mixin(_13b7,{renderingRule:layer.renderingRule.toJson()});}_13b9.push(_13b7);if(this.allLayerslegend){this.allLayerslegend.push({id:layer.id});}break;case "esri.layers.WMSLayer":_13b7=lang.mixin(_13b7,{url:layer.url,title:layer.title,type:"wms",version:layer.version,transparentBackground:layer.imageTransparency,visibleLayers:layer.visibleLayers});_13b9.push(_13b7);if(this.allLayerslegend){this.allLayerslegend.push({id:layer.id,subLayerIds:layer.visibleLayers});}break;case "esri.virtualearth.VETiledLayer":var _13c0=layer.mapStyle;if(_13c0==="aerialWithLabels"){_13c0="Hybrid";}_13b7=lang.mixin(_13b7,{visibility:layer.visible,type:"BingMaps"+_13c0,culture:layer.culture,key:layer.bingMapsKey});_13b9.push(_13b7);break;case "esri.layers.OpenStreetMapLayer":_13b7=lang.mixin(_13b7,{type:"OpenStreetMap",url:layer.tileServers[0]});_13b9.push(_13b7);break;case "esri.layers.WMTSLayer":_13b7=lang.mixin(_13b7,{url:layer.url,type:"wmts",layer:layer.layerInfos[0].identifier,style:layer.layerInfos[0].style,format:layer.layerInfos[0].format,tileMatrixSet:layer.layerInfos[0].tileMatrixSet});_13b9.push(_13b7);break;case "esri.layers.MapImageLayer":var _13c1=layer.getImages();array.forEach(_13c1,function(image,idx){if(image.href){_13b7={id:layer.id+"_image"+idx,type:"image",title:layer.id,minScale:layer.minScale||0,maxScale:layer.maxScale||0,opacity:layer.opacity,extent:image.extent.toJson(),url:image.href};_13b9.push(_13b7);}});break;case "esri.layers.WebTiledLayer":var _13c2=layer.url.replace(/\$\{/g,"{");_13b7=lang.mixin(_13b7,{type:"WebTiledLayer",urlTemplate:_13c2,credits:layer.copyright});if(layer.subDomains&&layer.subDomains.length>0){_13b7.subDomains=layer.subDomains;}_13b9.push(_13b7);break;default:if(layer.getTileUrl||layer.getImageUrl){_13b7=lang.mixin(_13b7,{url:layer.url});_13b9.push(_13b7);}}}for(i=0;i<map.graphicsLayerIds.length;i++){layer=map.getLayer(map.graphicsLayerIds[i]);if(!layer.loaded||!layer.visible||array.indexOf(_13b8,layer.id)!==-1){continue;}_13b6=layer.declaredClass;switch(_13b6){case "esri.layers.FeatureLayer":if(layer.url&&layer.renderer&&lang.isString(layer.renderer.attributeField)&&layer._getField(layer.renderer.attributeField,true)){if(layer.credential&&layer.url.indexOf("token=")===-1){layer.url+="?token="+layer.credential.token;}_13b7={id:layer.id,url:layer.url,title:layer.id,opacity:layer.opacity,minScale:layer.minScale||0,maxScale:layer.maxScale||0,layerDefinition:{drawingInfo:{renderer:layer.renderer.toJson()}}};if(layer._params.source){var _13c3=layer._params.source.toJson();lang.mixin(_13b7.layerDefinition,{source:_13c3});}if(layer.getDefinitionExpression()){lang.mixin(_13b7.layerDefinition,{definitionExpression:layer.getDefinitionExpression()});}if(layer.mode!==2){if(layer.getSelectedFeatures().length>0){var _13c4=array.map(layer.getSelectedFeatures(),function(_13c5){return _13c5.attributes[layer.objectIdField];});if(_13c4.length>0&&layer.getSelectionSymbol()){lang.mixin(_13b7,{selectionObjectIds:_13c4,selectionSymbol:layer.getSelectionSymbol().toJson()});}}}else{var _13c6=array.map(layer.getSelectedFeatures(),function(_13c7){return _13c7.attributes[layer.objectIdField];});if(_13c6.length===0||!layer._params.drawMode){break;}lang.mixin(_13b7.layerDefinition,{objectIds:_13c6});var _13c8=null;if(layer.getSelectionSymbol()){_13c8=new _1388(layer.getSelectionSymbol());}lang.mixin(_13b7.layerDefinition.drawingInfo,{renderer:_13c8&&_13c8.toJson()});}}else{_13b7=this._createFeatureCollection(layer);}_13b9.push(_13b7);if(this.allLayerslegend){this.allLayerslegend.push({id:layer.id});}break;case "esri.layers.GraphicsLayer":_13b7=this._createFeatureCollection(layer);_13b9.push(_13b7);if(this.allLayerslegend){this.allLayerslegend.push({id:layer.id});}break;default:}}if(map.graphics&&map.graphics.graphics.length>0){_13b7=this._createFeatureCollection(map.graphics);_13b9.push(_13b7);}return _13b9;}});if(has("extend-esri")){lang.setObject("tasks.PrintTask",_138c,_1385);}return _138c;});},"dijit/_editor/selection":function(){define("dijit/_editor/selection",["dojo/dom","dojo/_base/lang","dojo/sniff","dojo/_base/window","../main"],function(dom,lang,has,win,dijit){var _13c9={getType:function(){if(win.doc.getSelection){var stype="text";var oSel;try{oSel=win.global.getSelection();}catch(e){}if(oSel&&oSel.rangeCount==1){var _13ca=oSel.getRangeAt(0);if((_13ca.startContainer==_13ca.endContainer)&&((_13ca.endOffset-_13ca.startOffset)==1)&&(_13ca.startContainer.nodeType!=3)){stype="control";}}return stype;}else{return win.doc.selection.type.toLowerCase();}},getSelectedText:function(){if(win.doc.getSelection){var _13cb=win.global.getSelection();return _13cb?_13cb.toString():"";}else{if(dijit._editor.selection.getType()=="control"){return null;}return win.doc.selection.createRange().text;}},getSelectedHtml:function(){if(win.doc.getSelection){var _13cc=win.global.getSelection();if(_13cc&&_13cc.rangeCount){var i;var html="";for(i=0;i<_13cc.rangeCount;i++){var frag=_13cc.getRangeAt(i).cloneContents();var div=win.doc.createElement("div");div.appendChild(frag);html+=div.innerHTML;}return html;}return null;}else{if(dijit._editor.selection.getType()=="control"){return null;}return win.doc.selection.createRange().htmlText;}},getSelectedElement:function(){if(dijit._editor.selection.getType()=="control"){if(win.doc.getSelection){var _13cd=win.global.getSelection();return _13cd.anchorNode.childNodes[_13cd.anchorOffset];}else{var range=win.doc.selection.createRange();if(range&&range.item){return win.doc.selection.createRange().item(0);}}}return null;},getParentElement:function(){if(dijit._editor.selection.getType()=="control"){var p=this.getSelectedElement();if(p){return p.parentNode;}}else{if(win.doc.getSelection){var _13ce=win.global.getSelection();if(_13ce){var node=_13ce.anchorNode;while(node&&(node.nodeType!=1)){node=node.parentNode;}return node;}}else{var r=win.doc.selection.createRange();r.collapse(true);return r.parentElement();}}return null;},hasAncestorElement:function(_13cf){return this.getAncestorElement.apply(this,arguments)!=null;},getAncestorElement:function(_13d0){var node=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(node,arguments);},isTag:function(node,tags){if(node&&node.tagName){var _13d1=node.tagName.toLowerCase();for(var i=0;i<tags.length;i++){var _13d2=String(tags[i]).toLowerCase();if(_13d1==_13d2){return _13d2;}}}return "";},getParentOfType:function(node,tags){while(node){if(this.isTag(node,tags).length){return node;}node=node.parentNode;}return null;},collapse:function(_13d3){if(win.doc.getSelection){var _13d4=win.global.getSelection();if(_13d4.removeAllRanges){if(_13d3){_13d4.collapseToStart();}else{_13d4.collapseToEnd();}}else{_13d4.collapse(_13d3);}}else{var range=win.doc.selection.createRange();range.collapse(_13d3);range.select();}},remove:function(){var sel=win.doc.selection;if(win.doc.getSelection){sel=win.global.getSelection();sel.deleteFromDocument();return sel;}else{if(sel.type.toLowerCase()!="none"){sel.clear();}return sel;}},selectElementChildren:function(_13d5,_13d6){var doc=win.doc;var range;_13d5=dom.byId(_13d5);if(win.doc.getSelection){var _13d7=win.global.getSelection();if(has("opera")){if(_13d7.rangeCount){range=_13d7.getRangeAt(0);}else{range=doc.createRange();}range.setStart(_13d5,0);range.setEnd(_13d5,(_13d5.nodeType==3)?_13d5.length:_13d5.childNodes.length);_13d7.addRange(range);}else{_13d7.selectAllChildren(_13d5);}}else{range=_13d5.ownerDocument.body.createTextRange();range.moveToElementText(_13d5);if(!_13d6){try{range.select();}catch(e){}}}},selectElement:function(_13d8,_13d9){var range;_13d8=dom.byId(_13d8);var doc=_13d8.ownerDocument;var _13da=win.global;if(doc.getSelection){var _13db=_13da.getSelection();range=doc.createRange();if(_13db.removeAllRanges){if(has("opera")){if(_13db.getRangeAt(0)){range=_13db.getRangeAt(0);}}range.selectNode(_13d8);_13db.removeAllRanges();_13db.addRange(range);}}else{try{var tg=_13d8.tagName?_13d8.tagName.toLowerCase():"";if(tg==="img"||tg==="table"){range=win.body(doc).createControlRange();}else{range=win.body(doc).createRange();}range.addElement(_13d8);if(!_13d9){range.select();}}catch(e){this.selectElementChildren(_13d8,_13d9);}}},inSelection:function(node){if(node){var _13dc;var doc=win.doc;var range;if(win.doc.getSelection){var sel=win.global.getSelection();if(sel&&sel.rangeCount>0){range=sel.getRangeAt(0);}if(range&&range.compareBoundaryPoints&&doc.createRange){try{_13dc=doc.createRange();_13dc.setStart(node,0);if(range.compareBoundaryPoints(range.START_TO_END,_13dc)===1){return true;}}catch(e){}}}else{range=doc.selection.createRange();try{_13dc=node.ownerDocument.body.createControlRange();if(_13dc){_13dc.addElement(node);}}catch(e1){try{_13dc=node.ownerDocument.body.createTextRange();_13dc.moveToElementText(node);}catch(e2){}}if(range&&_13dc){if(range.compareEndPoints("EndToStart",_13dc)===1){return true;}}}}return false;}};lang.setObject("dijit._editor.selection",_13c9);return _13c9;});},"esri/dijit/Bookmarks":function(){define("esri/dijit/Bookmarks",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/_base/kernel","dojo/has","dojo/keys","dojo/query","dojo/dom","dojo/dom-construct","dojo/dom-class","dojo/dom-geometry","dojo/i18n!esri/nls/jsapi","esri/kernel","esri/domUtils","esri/geometry/Extent","esri/dijit/BookmarkItem","esri/Evented"],function(_13dd,_13de,lang,array,_13df,has,keys,query,dom,_13e0,_13e1,_13e2,_13e3,_13e4,_13e5,_13e6,_13e7,_13e8){var BM=_13dd(_13e8,{declaredClass:"esri.dijit.Bookmarks",_eventMap:{"click":true,"edit":true,"remove":true},constructor:function(_13e9,_13ea){this.map=_13e9.map;this.editable=_13e9.editable;this.initBookmarks=_13e9.bookmarks;this._clickHandlers=this._mouseOverHandlers=this._mouseOutHandlers=this._removeHandlers=this._editHandlers=[];this.bookmarkDomNode=_13e0.create("div");_13e1.add(this.bookmarkDomNode,"esriBookmarks");this.bookmarkTable=_13e0.create("table");_13e1.add(this.bookmarkTable,"esriBookmarkTable");this.bookmarkDomNode.appendChild(this.bookmarkTable);_13ea=dom.byId(_13ea);_13ea.appendChild(this.bookmarkDomNode);this._addInitialBookmarks();},onClick:function(){},onEdit:function(){},onRemove:function(){},addBookmark:function(_13eb){var _13ec;if(_13eb.declaredClass=="esri.dijit.BookmarkItem"){_13ec=_13eb;this.bookmarks.push(_13ec);}else{var _13ed=new _13e6(_13eb.extent);_13ec=new _13e7({name:_13eb.name,extent:_13ed});this.bookmarks.push(_13ec);}var _13ee;if(this.editable){var _13ef=_13e3.widgets.bookmarks;console.log(_13ef);var _13f0=_13ef.NLS_bookmark_edit;var _13f1=_13ef.NLS_bookmark_remove;_13ee=_13e0.create("div",{innerHTML:"<div class='esriBookmarkLabel'>"+_13eb.name+"</div><div title='"+_13f1+"' class='esriBookmarkRemoveImage'><br/></div><div title='"+_13f0+"' class='esriBookmarkEditImage'><br/></div>"});var _13f2=_13df.query(".esriBookmarkEditImage",_13ee)[0];var _13f3=_13df.query(".esriBookmarkRemoveImage",_13ee)[0];this._removeHandlers.push(_13de.connect(_13f3,"onclick",this,"_removeBookmark"));this._editHandlers.push(_13de.connect(_13f2,"onclick",this,"_editBookmarkLabel"));}else{_13ee=_13e0.create("div",{innerHTML:"<div class='esriBookmarkLabel' style='width: 210px;'>"+_13eb.name+"</div>"});}_13e1.add(_13ee,"esriBookmarkItem");var _13f4;if(_13eb.extent.declaredClass=="esri.geometry.Extent"){_13f4=_13eb.extent;}else{_13f4=new _13e6(_13eb.extent);}var _13f5=_13df.query(".esriBookmarkLabel",_13ee)[0];this._clickHandlers.push(_13de.connect(_13f5,"onclick",lang.hitch(this,"_onClickHandler",_13eb)));this._mouseOverHandlers.push(_13de.connect(_13ee,"onmouseover",function(){_13e1.add(this,"esriBookmarkHighlight");}));this._mouseOutHandlers.push(_13de.connect(_13ee,"onmouseout",function(){_13e1.remove(this,"esriBookmarkHighlight");}));var table=this.bookmarkTable;var _13f6;if(this.editable){_13f6=table.rows.length-1;}else{_13f6=table.rows.length;}var _13f7=table.insertRow(_13f6);var _13f8=_13f7.insertCell(0);_13f8.appendChild(_13ee);},removeBookmark:function(_13f9){var i;var _13fa=_13df.query(".esriBookmarkLabel",this.bookmarkDomNode);var _13fb=array.filter(_13fa,function(item){return item.innerHTML==_13f9;});array.forEach(_13fb,function(_13fc){_13fc.parentNode.parentNode.parentNode.parentNode.removeChild(_13fc.parentNode.parentNode.parentNode);});for(i=this.bookmarks.length-1;i>=0;i--){if(this.bookmarks[i].name==_13f9){this.bookmarks.splice(i,1);}}this.onRemove();},hide:function(){_13e5.hide(this.bookmarkDomNode);},show:function(){_13e5.show(this.bookmarkDomNode);},destroy:function(){this.map=null;array.forEach(this._clickHandlers,function(_13fd,idx){_13de.disconnect(_13fd);});array.forEach(this._mouseOverHandlers,function(_13fe,idx){_13de.disconnect(_13fe);});array.forEach(this._mouseOutHandlers,function(_13ff,idx){_13de.disconnect(_13ff);});array.forEach(this._removeHandlers,function(_1400,idx){_13de.disconnect(_1400);});array.forEach(this._editHandlers,function(_1401,idx){_13de.disconnect(_1401);});_13e0.destroy(this.bookmarkDomNode);},toJson:function(){var _1402=[];array.forEach(this.bookmarks,function(_1403,idx){_1402.push(_1403.toJson());});return _1402;},_addInitialBookmarks:function(){if(this.editable){var _1404=_13e3.widgets.bookmarks;var _1405=_1404.NLS_add_bookmark;var _1406=_13e0.create("div",{innerHTML:"<div>"+_1405+"</div>"});_13e1.add(_1406,"esriBookmarkItem");_13e1.add(_1406,"esriAddBookmark");this._clickHandlers.push(_13de.connect(_1406,"onclick",this,this._newBookmark));this._mouseOverHandlers.push(_13de.connect(_1406,"onmouseover",function(){_13e1.add(this,"esriBookmarkHighlight");}));this._mouseOutHandlers.push(_13de.connect(_1406,"onmouseout",function(){_13e1.remove(this,"esriBookmarkHighlight");}));var table=this.bookmarkTable;var _1407=table.insertRow(0);var _1408=_1407.insertCell(0);_1408.appendChild(_1406);}this.bookmarks=[];array.forEach(this.initBookmarks,function(_1409,idx){this.addBookmark(_1409);},this);},_removeBookmark:function(e){this.bookmarks.splice(e.target.parentNode.parentNode.parentNode.rowIndex,1);e.target.parentNode.parentNode.parentNode.parentNode.removeChild(e.target.parentNode.parentNode.parentNode);this.onRemove();},_editBookmarkLabel:function(e){var node=e.target.parentNode;var _140a=_13e2.position(node,true);var y=_140a.y;var _140b=_13e0.create("div",{innerHTML:"<input type='text' class='esriBookmarkEditBox' style='left:"+_140a.x+"px; top:"+y+"px;'/>"});this._inputBox=_13df.query("input",_140b)[0];this._label=_13df.query(".esriBookmarkLabel",node)[0];var _140c=_13e3.widgets.bookmarks;var _140d=_140c.NLS_new_bookmark;if(this._label.innerHTML==_140d){this._inputBox.value="";}else{this._inputBox.value=this._label.innerHTML;}_13de.connect(this._inputBox,"onkeyup",this,function(key){switch(key.keyCode){case keys.ENTER:this._finishEdit();break;default:break;}});_13de.connect(this._inputBox,"onblur",this,"_finishEdit");node.appendChild(_140b);this._inputBox.focus();},_finishEdit:function(){this._inputBox.parentNode.parentNode.removeChild(this._inputBox.parentNode);var _140e=_13e3.widgets.bookmarks;var _140f=_140e.NLS_new_bookmark;if(this._inputBox.value==""){this._label.innerHTML=_140f;}else{this._label.innerHTML=this._inputBox.value;}var _1410=_13df.query(".esriBookmarkLabel",this.bookmarkDomNode);array.forEach(this.bookmarks,function(_1411,idx){_1411.name=_1410[idx].innerHTML;});this.onEdit();},_newBookmark:function(){var map=this.map,_1412=_13e3.widgets.bookmarks,_1413=_1412.NLS_new_bookmark,_1414=map.extent,_1415;if(map.spatialReference._isWrappable()){var xmin=_13e6.prototype._normalizeX(_1414.xmin,map.spatialReference._getInfo()).x;var xmax=_13e6.prototype._normalizeX(_1414.xmax,map.spatialReference._getInfo()).x;if(xmin>xmax){var _1416=map.spatialReference.isWebMercator(),maxX=_1416?20037508.342788905:180,minX=_1416?-20037508.342788905:-180,_1417,_1418;if(Math.abs(xmin-maxX)>Math.abs(xmax-minX)){_1417=xmin;_1418=maxX;}else{_1417=minX;_1418=xmax;}_1415=new _13e6(_1417,_1414.ymin,_1418,_1414.ymax,map.spatialReference);}else{_1415=new _13e6(xmin,_1414.ymin,xmax,_1414.ymax,map.spatialReference);}}else{_1415=_1414;}var _1419=new _13e7({"name":_1413,"extent":_1415});this.addBookmark(_1419);var _141a=_13df.query(".esriBookmarkItem",this.bookmarkDomNode);var _141b=_141a[_141a.length-2];var e={"target":{"parentNode":null}};e.target.parentNode=_141b;this._editBookmarkLabel(e);},_onClickHandler:function(_141c){var _141d=_141c.extent;if(!_141c.extent.declaredClass){_141d=new _13e6(_141c.extent);}this.map.setExtent(_141d);this.onClick();}});if(has("extend-esri")){lang.setObject("dijit.Bookmarks",BM,_13e4);}return BM;});},"dojox/grid/_SelectionPreserver":function(){define("dojox/grid/_SelectionPreserver",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(_141e,_141f,lang,array){return _141e("dojox.grid._SelectionPreserver",null,{constructor:function(_1420){this.selection=_1420;var grid=this.grid=_1420.grid;this.reset();this._connects=[_141f.connect(grid,"_setStore",this,"reset"),_141f.connect(grid,"_addItem",this,"_reSelectById"),_141f.connect(_1420,"onSelected",lang.hitch(this,"_selectById",true)),_141f.connect(_1420,"onDeselected",lang.hitch(this,"_selectById",false)),_141f.connect(_1420,"deselectAll",this,"reset")];},destroy:function(){this.reset();array.forEach(this._connects,_141f.disconnect);delete this._connects;},reset:function(){this._selectedById={};},_reSelectById:function(item,index){if(item&&this.grid._hasIdentity){this.selection.selected[index]=this._selectedById[this.grid.store.getIdentity(item)];}},_selectById:function(_1421,_1422){if(this.selection.mode=="none"||!this.grid._hasIdentity){return;}var item=_1422,g=this.grid;if(typeof _1422=="number"||typeof _1422=="string"){var entry=g._by_idx[_1422];item=entry&&entry.item;}if(item){this._selectedById[g.store.getIdentity(item)]=!!_1421;}return item;}});});},"url:esri/dijit/templates/InfoWindow.html":"<div id=\"${id}.infowindow\" class=\"infowindow\" dojoAttachPoint=\"_infowindow\"\r\n  ><div style=\"position:relative;\"\r\n    ><div class=\"window\" dojoAttachPoint=\"_window\"\r\n      ><div class=\"top\"\r\n        ><div class=\"left\" dojoAttachPoint=\"_topleft\"><div class=\"sprite\"></div></div\r\n    \t\t><div class=\"right\" dojoAttachPoint=\"_topright\"\r\n    \t\t\t><div class=\"sprite\"></div\r\n    \t\t\t><div class=\"user\" dojoAttachPoint=\"_user\"\r\n    \t\t\t  ><div class=\"titlebar\" dojoAttachPoint=\"_titlebar\"\r\n    \t\t\t    ><a class=\"hide\" dojoAttachPoint=\"_hide\" dojoAttachEvent=\"onclick:hide\"><div class=\"sprite\"></div></a\r\n              ><div class=\"title\" dojoAttachPoint=\"_title\">${title}</div\r\n    \t\t\t  ></div\r\n            ><div class=\"border\" dojoAttachPoint=\"_border\"></div\r\n    \t\t\t  ><div class=\"layout content\" dojoAttachPoint=\"_content, containerNode\"\r\n    \t\t\t  ></div\r\n    \t\t\t></div\r\n    \t\t></div\r\n        ><div class=\"bottom\"\r\n          ><div class=\"left\" dojoAttachPoint=\"_bottomleft\"><div class=\"sprite\"></div></div\r\n\t\t      ><div class=\"right\" dojoAttachPoint=\"_bottomright\"><div class=\"sprite\"></div></div\r\n        ></div\r\n      ></div\r\n    ></div\r\n    ><div class=\"pointer\" dojoAttachPoint=\"_pointer\"><div dojoAttachPoint=\"_sprite\" class=\"sprite\"></div></div\r\n  ></div\r\n></div>","esri/dijit/InfoWindowLite":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/html","dojo/has","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dijit/registry","esri/kernel","esri/domUtils","esri/InfoWindowBase"],function(_1423,lang,_1424,array,html,has,dom,_1425,_1426,_1427,_1428,_1429,_142a,_142b,_142c){var IWL=_1423([_142c],{declaredClass:"esri.dijit.InfoWindowLite",constructor:function(_142d,_142e){lang.mixin(this,_142d);var _142f=(this.domNode=dom.byId(_142e));_142f.id=this.id||_1429.getUniqueId(this.declaredClass);_1425.add(_142f,"simpleInfoWindow");this._title=_1426.create("div",{"class":"title"},_142f);this._content=_1426.create("div",{"class":"content"},_142f);this._close=_1426.create("div",{"class":"close"},_142f);},domNode:null,anchor:"upperright",fixedAnchor:null,coords:null,isShowing:true,width:250,height:150,title:"Info Window",_bufferWidth:10,_bufferHeight:10,startup:function(){this._anchors=[IWL.ANCHOR_UPPERRIGHT,IWL.ANCHOR_LOWERRIGHT,IWL.ANCHOR_LOWERLEFT,IWL.ANCHOR_UPPERLEFT];this.resize(this.width,this.height);this.hide();this._closeConnect=_1424.connect(this._close,"onclick",this,this.hide);},destroy:function(){if(this.isShowing){this.hide();}this.destroyDijits(this._title);this.destroyDijits(this._content);_1424.disconnect(this._closeConnect);_1426.destroy(this.domNode);this.domNode=this._title=this._content=this._anchors=this._closeConnect=null;},setTitle:function(title){if(!title){_1425.add(this._title,"empty");}else{_1425.remove(this._title,"empty");}this.destroyDijits(this._title);this.__setValue("_title",title);return this;},setContent:function(_1430){if(!_1430){_1425.add(this._title,"empty");}else{_1425.remove(this._title,"empty");}this.destroyDijits(this._content);this.__setValue("_content",_1430);return this;},setFixedAnchor:function(_1431){if(_1431&&array.indexOf(this._anchors,_1431)===-1){return;}this.fixedAnchor=_1431;if(this.isShowing){this.show(this.mapCoords||this.coords,_1431);}this.onAnchorChange(_1431);},show:function(point,_1432){if(!point){return;}if(point.spatialReference){this.mapCoords=point;point=this.coords=this.map.toScreen(point,true);}else{this.mapCoords=null;this.coords=point;}if(!_1432||array.indexOf(this._anchors,_1432)===-1){_1432=this._getAnchor(point);}_1432=(this.anchor=this.fixedAnchor||_1432);_142b.show(this.domNode);this._adjustContentArea();this._adjustPosition(point,_1432);this.isShowing=true;if(!arguments[2]){this.onShow();}},hide:function(){_142b.hide(this.domNode);this.isShowing=false;if(!arguments[1]){this.onHide();}},move:function(_1433,_1434){if(_1434){_1433=this.coords.offset(_1433.x,_1433.y);}else{this.coords=_1433;if(this.mapCoords){this.mapCoords=this.map.toMap(_1433);}}this._adjustPosition(_1433,this.anchor);},resize:function(width,_1435){this.width=width;this.height=_1435;_1428.set(this.domNode,{width:width+"px",height:_1435+"px"});_1428.set(this._close,{left:(width-2)+"px",top:"-12px"});this._adjustContentArea();if(this.coords){this._adjustPosition(this.coords,this.anchor);}this.onResize(width,_1435);},onShow:function(){this.__registerMapListeners();this.startupDijits(this._title);this.startupDijits(this._content);},onHide:function(){this.__unregisterMapListeners();},onResize:function(){},onAnchorChange:function(){},setMap:function(map){this.inherited(arguments);_1426.place(this.domNode,map.root);},_adjustContentArea:function(){var box=_1427.getContentBox(this.domNode);var _1436=html.coords(this._title);var _1437=html.coords(this._content);var _1438=_1427.getContentBox(this._content);var diff=_1437.h-_1438.h;_1428.set(this._content,{height:(box.h-_1436.h-diff)+"px"});},_getAnchor:function(pt){var map=this.map;return (map&&pt)?(((pt.y<(map.height/2))?"lower":"upper")+((pt.x<(map.width/2))?"right":"left")):"upperright";},_adjustPosition:function(_1439,_143a){var posX=Math.round(_1439.x),posY=Math.round(_1439.y);var _143b=this._bufferWidth,_143c=this._bufferHeight;var _143d=html.coords(this.domNode);switch(_143a){case IWL.ANCHOR_UPPERLEFT:posX-=(_143d.w+_143b);posY-=(_143d.h+_143c);break;case IWL.ANCHOR_UPPERRIGHT:posX+=_143b;posY-=(_143d.h+_143c);break;case IWL.ANCHOR_LOWERRIGHT:posX+=_143b;posY+=_143c;break;case IWL.ANCHOR_LOWERLEFT:posX-=(_143d.w+_143b);posY+=_143c;break;}_1428.set(this.domNode,{left:posX+"px",top:posY+"px"});}});lang.mixin(IWL,{ANCHOR_UPPERRIGHT:"upperright",ANCHOR_LOWERRIGHT:"lowerright",ANCHOR_LOWERLEFT:"lowerleft",ANCHOR_UPPERLEFT:"upperleft"});if(has("extend-esri")){lang.setObject("dijit.InfoWindowLite",IWL,_142a);}return IWL;});},"esri/layers/FeatureLayer":function(){define("esri/layers/FeatureLayer",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/_base/Deferred","dojo/date/locale","dojo/sniff","dojo/io-query","dojo/dom-construct","dojo/i18n","esri/kernel","esri/lang","esri/request","esri/deferredUtils","esri/SpatialReference","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/jsonUtils","esri/renderers/SimpleRenderer","esri/renderers/UniqueValueRenderer","esri/renderers/jsonUtils","esri/tasks/QueryTask","esri/tasks/query","esri/tasks/FeatureSet","esri/geometry/Extent","esri/geometry/jsonUtils","esri/geometry/normalizeUtils","esri/layers/GraphicsLayer","esri/layers/Field","esri/layers/TimeInfo","esri/layers/FeatureType","esri/layers/FeatureTemplate","esri/layers/FeatureEditResult","esri/layers/SnapshotMode","esri/layers/OnDemandMode","esri/layers/SelectionMode","esri/layers/TrackManager","dojo/i18n!esri/nls/jsapi","dojo/has!extend-esri?esri/layers/agscommon"],function(_143e,_143f,lang,array,_1440,_1441,_1442,has,ioq,_1443,i18n,_1444,_1445,_1446,_1447,_1448,_1449,_144a,_144b,_144c,_144d,_144e,_144f,_1450,Query,_1451,_1452,_1453,_1454,_1455,Field,_1456,_1457,_1458,_1459,_145a,_145b,_145c,_145d){var _145e=_143e(_1455,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",_eventMap:{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]},constructor:function(url,_145f){this.i18n=i18n.getLocalization("esri","jsapi");this._outFields=_145f&&_145f.outFields;this._loadCallback=_145f&&_145f.loadCallback;var patch=_145f&&_145f._usePatch;this._usePatch=(patch===null||patch===undefined)?true:patch;this._trackIdField=_145f&&_145f.trackIdField;this.objectIdField=_145f&&_145f.objectIdField;this._maxOffset=_145f&&_145f.maxAllowableOffset;this._optEditable=_145f&&_145f.editable;this._optAutoGen=_145f&&_145f.autoGeneralize;this.editSummaryCallback=_145f&&_145f.editSummaryCallback;this.userId=_145f&&_145f.userId;this.userIsAdmin=_145f&&_145f.userIsAdmin;this.useMapTime=(_145f&&_145f.hasOwnProperty("useMapTime"))?(!!_145f.useMapTime):true;this.source=_145f&&_145f.source;this.gdbVersion=_145f&&_145f.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(_1445.isDefined(_145f&&_145f.mode)?_145f.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new _145a(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_145f&&_145f.tileWidth)||512;this._tileHeight=(_145f&&_145f.tileHeight)||512;this._mode=new _145b(this);var _1460=_145f&&_145f.latticeTiling;this.latticeTiling=_1460;break;case ctor.MODE_SELECTION:this._mode=new _145c(this);this._isSelOnly=true;break;}this._initLayer=lang.hitch(this,this._initLayer);this._selectHandler=lang.hitch(this,this._selectHandler);this._editable=false;if(lang.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new _1450(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _1461=this._url.path;this._fserver=false;if(_1461.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _1462=_145f&&_145f.resourceInfo;if(_1462){this._initLayer(_1462);}else{if(this.source){var layer={source:this.source.toJson()};this._url.query=lang.mixin(this._url.query,{layer:_1440.toJson(layer)});}if(this.gdbVersion){this._url.query=lang.mixin(this._url.query,{gdbVersion:this.gdbVersion});}_1446({url:_1461,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}this.registerConnectEvents();},_initLayer:function(_1463,io){if(_1463||io){this._json=_1463;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_1463&&_1463._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new _145a(this);this._isSnapshot=true;this._featureSet=_1463.featureSet;this._nextId=_1463.nextObjectId;_1463=_1463.layerDefinition;}if(_1463.hasOwnProperty("capabilities")){var _1464=(this.capabilities=_1463.capabilities);if(_1464&&_1464.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(_1445.isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=_1440.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_1463.geometryType==="esriGeometryPolyline")||(_1463.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_1445.isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}var _1465=_1463.effectiveMinScale||_1463.minScale,_1466=_1463.effectiveMaxScale||_1463.maxScale;if(!this._hasMin&&_1465){this.setMinScale(_1465);}if(!this._hasMax&&_1466){this.setMaxScale(_1466);}this.layerId=_1463.id;this.name=_1463.name;this.description=_1463.description;this.copyright=_1463.copyrightText;this.type=_1463.type;this.geometryType=_1463.geometryType;this.displayField=_1463.displayField;this.defaultDefinitionExpression=_1463.definitionExpression;this.fullExtent=new _1452(_1463.extent);this.initialExtent=new _1452(this.fullExtent.toJson());if(this.fullExtent.spatialReference){this.spatialReference=new _1448(this.fullExtent.spatialReference.toJson());}this.defaultVisibility=_1463.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_1463.indexedFields;this.maxRecordCount=_1463.maxRecordCount;this.canModifyLayer=_1463.canModifyLayer;this.supportsStatistics=_1463.supportsStatistics;this.supportsAdvancedQueries=_1463.supportsAdvancedQueries;this.hasLabels=_1463.hasLabels;this.canScaleSymbols=_1463.canScaleSymbols;this.supportsRollbackOnFailure=_1463.supportsRollbackOnFailure;this.syncCanReturnChanges=_1463.syncCanReturnChanges;this.isDataVersioned=_1463.isDataVersioned;this.editFieldsInfo=_1463.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_1463.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_1463.relationships;this.allowGeometryUpdates=_1445.isDefined(_1463.allowGeometryUpdates)?_1463.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _1467=(this.fields=[]),_1468=_1463.fields,i;for(i=0;i<_1468.length;i++){_1467.push(new Field(_1468[i]));}if(!this.objectIdField){this.objectIdField=_1463.objectIdField;if(!this.objectIdField){_1468=_1463.fields;for(i=0;i<_1468.length;i++){var field=_1468[i];if(field.type==="esriFieldTypeOID"){this.objectIdField=field.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+_1445.substitute({url:this.url},"objectIdField is not set [url: ${url}]"));}}if(!_1445.isDefined(this._nextId)){var _1469=this.objectIdField,maxId=-1;if(this._collection&&_1469){var fset=this._featureSet,_146a=fset&&fset.features,il=_146a?_146a.length:0,oid,attr;for(i=0;i<il;i++){attr=_146a[i].attributes;oid=attr&&attr[_1469];if(oid>maxId){maxId=oid;}}}this._nextId=(maxId+1);}this.globalIdField=_1463.globalIdField;var _146b=(this.typeIdField=_1463.typeIdField),_146c;if(_146b){_146c=!this._getField(_146b)&&this._getField(_146b,true);if(_146c){this.typeIdField=_146c.name;}}this.visibilityField=_1463.visibilityField;var _146d=_1463.defaultSymbol;if(_146d){this.defaultSymbol=_144c.fromJson(_146d);}var _146e=this.types=[],types=_1463.types,fType,_146f,_1470,_1471=this.editFieldsInfo,_1472=_1471&&_1471.creatorField,_1473=_1471&&_1471.editorField,fix=(_1472||_1473),_1474=[];if(types){for(i=0;i<types.length;i++){fType=new _1457(types[i]);_146f=fType.templates;if(fix&&_146f&&_146f.length){_1474=_1474.concat(_146f);}_146e.push(fType);}}var _1475=_1463.templates,_1476,_1477=this.templates=[];if(_1475){for(i=0;i<_1475.length;i++){_1476=new _1458(_1475[i]);if(fix){_1474.push(_1476);}_1477.push(_1476);}}for(i=0;i<_1474.length;i++){_1470=lang.getObject("prototype.attributes",false,_1474[i]);if(_1470){if(_1472){delete _1470[_1472];}if(_1473){delete _1470[_1473];}}}var _1478=_1463.timeInfo;if(_1478){this.timeInfo=new _1456(_1478);this._startTimeField=_1478.startTimeField;this._endTimeField=_1478.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_1478.trackIdField=this._trackIdField;}else{this._trackIdField=_1478.trackIdField;}}this.hasAttachments=(!this._collection&&_1463.hasAttachments)?true:false;this.htmlPopupType=_1463.htmlPopupType;var _1479=_1463.drawingInfo,_147a;if(!this.renderer){if(_1479&&_1479.renderer){_147a=_1479.renderer;this.setRenderer(_144f.fromJson(_147a));if(_147a.type==="classBreaks"){this.renderer.setMaxInclusive(true);}if(!this._collection){var _147b=_147a.type,_147c=[];_147a=this.renderer;switch(_147b){case "simple":_147c.push(_147a.symbol);break;case "uniqueValue":case "classBreaks":_147c.push(_147a.defaultSymbol);_147c=_147c.concat(array.map(_147a.infos,function(info){return info.symbol;}));break;}_147c=array.filter(_147c,_1445.isDefined);var _147d=this._url.path+"/images/",token=this._getToken();array.forEach(_147c,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_147d+url;}if(token&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+token);}}});}}else{if(_146d){types=this.types;if(types.length>0){_147a=new _144e(this.defaultSymbol,this.typeIdField);array.forEach(types,function(type){_147a.addValue(type.id,type.symbol);});}else{_147a=new _144d(this.defaultSymbol);}this.setRenderer(_147a);}else{if(!this._isTable){var _147e;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_147e=new _1449();break;case "esriGeometryPolyline":_147e=new _144a();break;case "esriGeometryPolygon":_147e=new _144b();break;}this.setRenderer(_147e?new _144d(_147e):null);}}}}var _147f=(_1479&&_1479.transparency)||0;if(!_1445.isDefined(this.opacity)&&_147f>0){this.opacity=1-(_147f/100);}this.version=_1463.currentVersion;if(!this.version){var ver;if("capabilities" in _1463||"drawingInfo" in _1463||"hasAttachments" in _1463||"htmlPopupType" in _1463||"relationships" in _1463||"timeInfo" in _1463||"typeIdField" in _1463||"types" in _1463){ver=10;}else{ver=9.3;}this.version=ver;}if((has("ie")||has("safari"))&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();var _1480=function(){this.onLoad(this);var _1481=this._loadCallback;if(_1481){delete this._loadCallback;_1481(this);}};if(this._collection){this._fireUpdateStart();var _1482=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new _1451(_1482));this._fcAdded=true;_1480.call(this);}else{this._forceIdentity(_1480);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _1483=this.renderer;if(_1483){this._ager=(_1483.declaredClass.indexOf("TemporalRenderer")!==-1&&_1483.observationAger&&_1483.observationRenderer);var _1484=array.filter([_1483,_1483.observationRenderer,_1483.latestObservationRenderer,_1483.trackRenderer],_1445.isDefined);var _1485=[];array.forEach(_1484,function(rnd){if(!lang.isFunction(rnd.attributeField)){_1485.push(rnd.attributeField);}_1485.push(rnd.attributeField2);_1485.push(rnd.attributeField3);},this);this._rendererFields=array.filter(_1485,_1445.isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_setMap:function(map){var div=this.inherited(arguments),mode=this._mode;if(mode){mode.initialize(map);}return div;},_unsetMap:function(map){var mode=this._mode;if(mode){mode.suspend();}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}_143f.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},getOutFields:function(){return array.filter(this._getOutFields(),function(field){return (field==="*"||!!this._getField(field));},this);},setEditable:function(_1486){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_1486;return this;}var _1487=this._editable;this._editable=_1486;this._updateCaps();if(_1487!==_1486){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_1488){var _1489={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _1489;}var _148a=_1488&&_1488.feature,_148b=_1488&&_1488.userId,caps=array.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),lang.trim),_148c=array.indexOf(caps,"editing")>-1,_148d=_148c&&(array.indexOf(caps,"create")>-1),_148e=_148c&&(array.indexOf(caps,"update")>-1),_148f=_148c&&(array.indexOf(caps,"delete")>-1),_1490=this.ownershipBasedAccessControlForFeatures,_1491=this.editFieldsInfo,_1492=_1491&&_1491.creatorField,realm=_1491&&_1491.realm,_1493=_148a&&_148a.attributes,_1494=(_1493&&_1492)?_1493[_1492]:undefined,_1495,_1496=!!this.userIsAdmin,_1497=!_1490||_1496||!!(_1490.allowOthersToUpdate||_1490.allowUpdateToOthers),_1498=!_1490||_1496||!!(_1490.allowOthersToDelete||_1490.allowDeleteToOthers);if(_1496||(_148c&&!(_148d||_148e||_148f))){_148d=_148e=_148f=true;}_1495={"canCreate":_148d,"canUpdate":_148e,"canDelete":_148f};if(_1494===null){_1495.canUpdate=_148e&&_1497;_1495.canDelete=_148f&&_1498;}else{if(_1494===""){return _1495;}else{if(_1494){_148b=_148b||this.getUserId();if(_148b&&realm){_148b=_148b+"@"+realm;}if(_148b.toLowerCase()===_1494.toLowerCase()){return _1495;}else{_1495.canUpdate=_148e&&_1497;_1495.canDelete=_148f&&_1498;}}}}return _1495;},getUserId:function(){var _1499;if(this.loaded){_1499=(this.credential&&this.credential.userId)||this.userId||"";}return _1499;},setUserIsAdmin:function(_149a){this.userIsAdmin=_149a;},setEditSummaryCallback:function(_149b){this.editSummaryCallback=_149b;},getEditSummary:function(_149c,_149d,_149e){_149e=_1445.isDefined(_149e)?_149e:(new Date()).getTime();var _149f="",info=this.getEditInfo(_149c,_149d,_149e),_14a0=(_149d&&_149d.callback)||this.editSummaryCallback;if(_14a0){info=_14a0(_149c,info)||"";}if(lang.isString(info)){_149f=info;}else{if(info){var _14a1=info.action,_14a2=info.userId,_14a3=info.timeValue,count=0;if(_14a1){count++;}if(_14a2){count++;}if(_1445.isDefined(_14a3)){count++;}if(count>1){_149f=(_14a1==="edit"?"edit":"create")+(_14a2?"User":"")+(_1445.isDefined(_14a3)?info.displayPattern:"");}}_149f=_149f&&_1445.substitute(info,this.i18n.layers.FeatureLayer[_149f]);}return _149f;},getEditInfo:function(_14a4,_14a5,_14a6){if(!this.loaded){return;}_14a6=_1445.isDefined(_14a6)?_14a6:(new Date()).getTime();var _14a7=(_14a5&&_14a5.action)||"last",_14a8=this.editFieldsInfo,_14a9=_14a8&&_14a8.creatorField,_14aa=_14a8&&_14a8.creationDateField,_14ab=_14a8&&_14a8.editorField,_14ac=_14a8&&_14a8.editDateField,realm=_14a8&&_14a8.realm,_14ad=_14a4&&_14a4.attributes,_14ae=(_14ad&&_14a9)?_14ad[_14a9]:undefined,_14af=(_14ad&&_14aa)?_14ad[_14aa]:null,_14b0=(_14ad&&_14ab)?_14ad[_14ab]:undefined,_14b1=(_14ad&&_14ac)?_14ad[_14ac]:null,_14b2=this._getEditData(_14ae,_14af,_14a6),_14b3=this._getEditData(_14b0,_14b1,_14a6),_14b4;switch(_14a7){case "creation":_14b4=_14b2;break;case "edit":_14b4=_14b3;break;case "last":_14b4=_14b3||_14b2;break;}if(_14b4){_14b4.action=(_14b4===_14b3)?"edit":"creation";}return _14b4;},_getEditData:function(_14b5,_14b6,_14b7){var data,_14b8,_14b9,_14ba=60000,_14bb=3600000,_14bc=2*_14bb,_14bd=24*_14bb,days7=7*_14bd;if(_1445.isDefined(_14b6)){_14b8=_14b7-_14b6;if(_14b8<0){_14b9="Full";}else{if(_14b8<_14ba){_14b9="Seconds";}else{if(_14b8<(2*_14ba)){_14b9="Minute";}else{if(_14b8<_14bb){_14b9="Minutes";}else{if(_14b8<_14bc){_14b9="Hour";}else{if(_14b8<_14bd){_14b9="Hours";}else{if(_14b8<days7){_14b9="WeekDay";}else{_14b9="Full";}}}}}}}}if((_14b5!==undefined)||_14b9){data=data||{};data.userId=_14b5;if(_14b9){var _14be=_1442.format,_14bf=new Date(_14b6);data.minutes=Math.floor(_14b8/_14ba);data.hours=Math.floor(_14b8/_14bb);data.weekDay=_14be(_14bf,{datePattern:"EEEE",selector:"date"});data.formattedDate=_14be(_14bf,{selector:"date"});data.formattedTime=_14be(_14bf,{selector:"time"});data.displayPattern=_14b9;data.timeValue=_14b6;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_14c0){if(!this.isEditable()){this._maxOffset=_14c0;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_14c1){if(!this.loaded){this._optAutoGen=_14c1;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_14c1;if(_14c1){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setGDBVersion:function(_14c2){if(!this._collection&&(_14c2!==this.gdbVersion)&&(_14c2||this.gdbVersion)){this.gdbVersion=_14c2;this._task.gdbVersion=_14c2;this._url.query=lang.mixin(this._url.query,{gdbVersion:_14c2});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_14c3){if(this._isSnapshot){this._timeDefn=_14c3;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}else{console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id = "+this.id+", Layer URL = "+this.url);}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_14c4,_14c5){this._timeOffset=_14c4;this._timeOffsetUnits=_14c5;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this.suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(query,_14c6,_14c7,_14c8){_14c6=_14c6||this.constructor.SELECTION_NEW;var _14c9=this._getShallowClone(query),map=this._map,_14ca,dfd=_1447._fixDfd(new _1441(_1447._dfdCanceller));_14c9.outFields=this.getOutFields();_14c9.returnGeometry=true;if(map){_14c9.outSpatialReference=new _1448(map.spatialReference.toJson());}if(!this._applyQueryFilters(_14c9)){_14ca={features:[]};this._selectHandler(_14ca,_14c6,_14c7,_14c8,dfd);return dfd;}var _14cb=this._canDoClientSideQuery(_14c9);if(_14cb){_14ca={features:this._doQuery(_14c9,_14cb)};this._selectHandler(_14ca,_14c6,_14c7,_14c8,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+this.invalidParams);this._resolve([err],null,_14c8,dfd,true);return dfd;}var self=this;if(this._ts){_14c9._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_14c9);temp.addCallbacks(function(_14cc){self._selectHandler(_14cc,_14c6,_14c7,_14c8,dfd);},function(err){self._resolve([err],null,_14c8,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _14cd=this._selectedFeatures,_14ce=[],item;for(item in _14cd){if(_14cd.hasOwnProperty(item)){_14ce.push(_14cd[item]);}}return _14ce;},clearSelection:function(_14cf){var _14d0=this._selectedFeatures,mode=this._mode,item;for(item in _14d0){if(_14d0.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_14cf){this.onSelectionClear();}return this;},setSelectionSymbol:function(_14d1){this._selectionSymbol=_14d1;if(_14d1){var _14d2=this._selectedFeatures,item;for(item in _14d2){if(_14d2.hasOwnProperty(item)){_14d2[item].setSymbol(_14d1);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_14d3,_14d4,_14d5,_14d6,_14d7){var _14d8=_14d7.assembly,dfd=_14d7.dfd;this._applyNormalized(adds,_14d8&&_14d8[0]);this._applyNormalized(_14d3,_14d8&&_14d8[1]);this.onBeforeApplyEdits(adds,_14d3,_14d4);var i,_14d9={},_14da=this.objectIdField,_14db={f:"json"},dirty=false;if(this._collection){var _14dc={};_14dc.addResults=adds?array.map(adds,function(){dirty=true;return {objectId:this._nextId++,success:true};},this):null;_14dc.updateResults=_14d3?array.map(_14d3,function(_14dd){dirty=true;var oid=_14dd.attributes[_14da];_14d9[oid]=_14dd;return {objectId:oid,success:true};},this):null;_14dc.deleteResults=_14d4?array.map(_14d4,function(_14de){dirty=true;return {objectId:_14de.attributes[_14da],success:true};},this):null;if(dirty){this._editHandler(_14dc,adds,_14d9,_14d5,_14d6,dfd);}return;}if(adds&&adds.length>0){_14db.adds=this._convertFeaturesToJson(adds,0,1);dirty=true;}if(_14d3&&_14d3.length>0){for(i=0;i<_14d3.length;i++){var _14df=_14d3[i];_14d9[_14df.attributes[_14da]]=_14df;}_14db.updates=this._convertFeaturesToJson(_14d3,0,0,1);dirty=true;}if(_14d4&&_14d4.length>0){var ids=[];for(i=0;i<_14d4.length;i++){ids.push(_14d4[i].attributes[_14da]);}_14db.deletes=ids.join(",");dirty=true;}if(dirty){var self=this;return _1446({url:this._url.path+"/applyEdits",content:lang.mixin(_14db,this._url.query),callbackParamName:"callback",load:function(_14e0){self._editHandler(_14e0,adds,_14d9,_14d5,_14d6,dfd);},error:function(err){self._resolve([err],null,_14d6,dfd,true);}},{usePost:true});}},queryFeatures:function(query,_14e1,_14e2){return this._query("execute","onQueryFeaturesComplete",query,_14e1,_14e2);},queryRelatedFeatures:function(query,_14e3,_14e4){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",query,_14e3,_14e4);},queryIds:function(query,_14e5,_14e6){return this._query("executeForIds","onQueryIdsComplete",query,_14e5,_14e6);},queryCount:function(query,_14e7,_14e8){return this._query("executeForCount","onQueryCountComplete",query,_14e7,_14e8);},queryAttachmentInfos:function(_14e9,_14ea,_14eb){var url=this._url.path+"/"+_14e9+"/attachments",dfd=new _1441(_1447._dfdCanceller),self=this;dfd._pendingDfd=_1446({url:url,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_14ec){var infos=_14ec.attachmentInfos,_14ed;array.forEach(infos,function(info){_14ed=ioq.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_14ed?("?"+_14ed):"");info.objectId=_14e9;});self._resolve([infos],"onQueryAttachmentInfosComplete",_14ea,dfd);},error:function(err){self._resolve([err],null,_14eb,dfd,true);}});return dfd;},addAttachment:function(_14ee,_14ef,_14f0,_14f1){return this._sendAttachment("add",_14ee,_14ef,_14f0,_14f1);},updateAttachment:function(_14f2,_14f3,_14f4,_14f5,_14f6){_14f4.appendChild(_1443.create("input",{type:"hidden",name:"attachmentId",value:_14f3}));return this._sendAttachment("update",_14f2,_14f4,_14f5,_14f6);},deleteAttachments:function(_14f7,_14f8,_14f9,_14fa){var url=this._url.path+"/"+_14f7+"/deleteAttachments",dfd=new _1441(_1447._dfdCanceller),self=this,_14fb={f:"json",attachmentIds:_14f8.join(",")};dfd._pendingDfd=_1446({url:url,content:lang.mixin(_14fb,this._url.query),callbackParamName:"callback",load:lang.hitch(this,function(_14fc){var _14fd=_14fc.deleteAttachmentResults;_14fd=array.map(_14fd,function(_14fe){var res=new _1459(_14fe);res.attachmentId=res.objectId;res.objectId=_14f7;return res;});self._resolve([_14fd],"onDeleteAttachmentsComplete",_14f9,dfd);}),error:function(err){self._resolve([err],null,_14fa,dfd,true);}},{usePost:true});return dfd;},addType:function(_14ff){var types=this.types;if(types){var found=array.some(types,function(type){if(type.id==_14ff.id){return true;}return false;});if(found){return false;}else{types.push(_14ff);}}else{this.types=[_14ff];}this._typesDirty=true;return true;},deleteType:function(_1500){if(!this._collection){return;}var types=this.types;if(types){var found=-1;array.some(types,function(type,index){if(type.id==_1500){found=index;return true;}return false;});if(found>-1){this._typesDirty=true;return types.splice(found,1)[0];}}},toJson:function(){var _1501=this._json,json=lang.isString(_1501)?_1440.fromJson(_1501):lang.clone(_1501);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _1502=json.layerDefinition,_1503=this._collection;if(_1503&&this._typesDirty){_1502.types=array.map(this.types||[],function(type){return type.toJson();});var _1504=this.renderer,_1505=_1502.drawingInfo;if(_1505&&_1504&&_1504.declaredClass.indexOf("TemporalRenderer")===-1){_1505.renderer=_1504.toJson();}}var _1506=null;if(!(_1503&&!this._fcAdded)){_1506={geometryType:_1502.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=lang.mixin({},json.featureSet||{},_1506);if(_1503){json.nextObjectId=this._nextId;_1502.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_forceIdentity:function(_1507){var self=this,path=this._url&&this._url.path;if((this.ownershipBasedAccessControlForFeatures||this.userIsAdmin)&&!this._getToken()&&path&&_1444.id&&_1444.id._hasPortalSession()&&_1444.id._doPortalSignIn(path)){_1444.id.getCredential(path).then(function(){self._findCredential();_1507.call(self);},function(){_1507.call(self);});}else{_1507.call(this);}},_updateCaps:function(){var _1508=this._editable,_1509=lang.trim(this.capabilities||""),_150a=array.map((_1509?_1509.split(","):[]),lang.trim),caps=array.map((_1509?_1509.toLowerCase().split(","):[]),lang.trim),found=array.indexOf(caps,"editing"),cap,i,_150b,_150c={"Create":array.indexOf(caps,"create"),"Update":array.indexOf(caps,"update"),"Delete":array.indexOf(caps,"delete")};if(_1508&&found===-1){_150a.push("Editing");}else{if(!_1508&&found>-1){_150b=[found];for(cap in _150c){if(_150c[cap]>-1){_150b.push(_150c[cap]);}}_150b.sort();for(i=_150b.length-1;i>=0;i--){_150a.splice(_150b[i],1);}}}this.capabilities=_150a.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},onSuspend:function(){this.inherited(arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},onResume:function(evt){this.inherited(arguments);this._toggleTime(true);this._updateMaxOffset();var mode=this._mode,map=this._map,_150d=this.renderer;if(evt.firstOccurrence){this.clearSelection();if(this.timeInfo){if(this._trackIdField||(_150d&&(_150d.latestObservationRenderer||_150d.trackRenderer))){this._trackManager=new _145d(this);this._trackManager.initialize(map);}}this._zoomConnect=_143f.connect(map,"onZoomEnd",this,this._updateMaxOffset);}if(mode){evt.firstOccurrence?mode.startup():mode.resume();}},_updateMaxOffset:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}},_toggleTime:function(_150e){var map=this._map;if(_150e&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=_143f.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;_143f.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_150f){this._mapTimeExtent=_150f;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_1510){var _1511=this._timeOffset,units=this._timeOffsetUnits;return (_1510&&_1511&&units)?_1510.offset(-1*_1511,units):_1510;},_getTimeOverlap:function(_1512,_1513){if(_1512&&_1513){return _1512.intersection(_1513);}else{return _1512||_1513;}},_getTimeFilter:function(_1514){var _1515=this.getTimeDefinition(),_1516=null,_1517;if(_1515||_1516){_1517=this._getTimeOverlap(_1515,_1516);if(!_1517){return [false];}}if(_1514){_1514=_1517?this._getTimeOverlap(_1514,_1517):_1514;if(!_1514){return [false];}}else{_1514=_1517;}return [true,_1514];},_getAttributeFilter:function(_1518){var _1519=this.getDefinitionExpression();if(_1518){_1518=_1519?"("+_1519+") AND ("+_1518+")":_1518;}else{_1518=_1519;}return _1518;},_applyQueryFilters:function(query){query.where=this._getAttributeFilter(query.where);query.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _151a=this._getTimeFilter(query.timeExtent);if(!_151a[0]){return false;}else{query.timeExtent=_151a[1];}}return true;},_add:function(_151b){var _151c=this._selectionSymbol,attr=_151b.attributes,_151d=this.visibilityField;if(_151c&&this._isSelOnly){_151b.setSymbol(_151c);}if(_151d&&attr&&attr.hasOwnProperty(_151d)){_151b[attr[_151d]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(query){var _151e=[],map=this._map;if(this._isTable||!map){return;}if(query.text||(query.where&&query.where!==this.getDefinitionExpression())){return;}var _151f=this._isSnapshot,_1520=this._isSelOnly;var _1521=query.geometry;if(_1521){if(!_1520&&query.spatialRelationship===Query.SPATIAL_REL_INTERSECTS&&(_1521.type==="extent"&&(_151f||map.extent.contains(_1521)))){_151e.push(1);}else{return;}}var ids=query.objectIds;if(ids){if(_151f){_151e.push(2);}else{var len=ids.length,mode=this._mode,_1522=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_1522++;}}if(_1522===len){_151e.push(2);}else{return;}}}if(this.timeInfo){var _1523=query.timeExtent,_1524=this._mapTimeExtent;if(_151f){if(_1523){_151e.push(3);}}else{if(_1520){if(_1523){return;}}else{if(_1524){if(array.indexOf(_151e,2)!==-1){if(_1523){_151e.push(3);}}else{return;}}else{if(_151e.length>0){if(_1523){_151e.push(3);}}else{if(_1523){return;}}}}}}return _151e.length>0?_151e:null;},_doQuery:function(query,_1525,_1526){var _1527=[],mode=this._mode,_1528=this.objectIdField,i,len,_1529;if(array.indexOf(_1525,2)!==-1){_1527=[];var ids=query.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_1527.push(obj);}}if(_1527.length===0){return [];}}if(array.indexOf(_1525,1)!==-1){_1529=_1527.length>0?_1527:this.graphics;len=_1529.length;var _152a=query.geometry._normalize(null,true);_1527=[];for(i=0;i<len;i++){var _152b=_1529[i],_152c=_152b.geometry;if(_152c){if(this.normalization&&_152a.length){if(_152a[0].intersects(_152c)||_152a[1].intersects(_152c)){_1527.push(_152b);}}else{if(_152a.intersects(_152c)){_1527.push(_152b);}}}}if(_1527.length===0){return [];}}if(array.indexOf(_1525,3)!==-1){if(this.timeInfo){_1529=_1527.length>0?_1527:this.graphics;var time=query.timeExtent,_152d=this._filterByTime(_1529,time.startTime,time.endTime);_1527=_152d.match;}}if(_1526){return array.map(_1527,function(obj){return obj.attributes[_1528];},this);}else{return _1527;}},_filterByTime:function(_152e,_152f,_1530){var _1531=this._startTimeField,_1532=this._endTimeField,_1533;if(!this._twoTimeFields){_1533=_1531||_1532;}var isDef=_1445.isDefined,yea=[],nay=[],i,len=_152e.length,_1534,_1535;_152f=_152f?_152f.getTime():-Infinity;_1530=_1530?_1530.getTime():Infinity;if(_1533){for(i=0;i<len;i++){_1534=_152e[i];_1535=_1534.attributes;var time=_1535[_1533];if(time>=_152f&&time<=_1530){yea.push(_1534);}else{nay.push(_1534);}}}else{for(i=0;i<len;i++){_1534=_152e[i];_1535=_1534.attributes;var start=_1535[_1531],end=_1535[_1532];start=isDef(start)?start:-Infinity;end=isDef(end)?end:Infinity;if((start>=_152f&&start<=_1530)||(end>=_152f&&end<=_1530)||(_152f>=start&&_1530<=end)){yea.push(_1534);}else{nay.push(_1534);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_1536,_1537,dfd,_1538){if(_1536){this[_1536].apply(this,args);}if(_1537){_1537.apply(null,args);}if(dfd){_1447._resDfd(dfd,args,_1538);}},_getShallowClone:function(query){var _1539=new Query(),prop;for(prop in query){if(query.hasOwnProperty(prop)){_1539[prop]=query[prop];}}return _1539;},_query:function(type,_153a,query,_153b,_153c){var that=this,map=this._map,dfd=new _1441(_1447._dfdCanceller),_153d=query;var _153e=function(_153f,_1540){if(!_1540&&type==="execute"&&!that._isTable){var _1541=_153f.features,mode=that._mode,_1542=that.objectIdField,il=_1541.length,i;for(i=il-1;i>=0;i--){var oid=_1541[i].attributes[_1542];var _1543=mode._getFeature(oid);if(_1543){_1541.splice(i,1,_1543);}}}that._resolve([_153f],_153a,_153b,dfd);};if(type!=="executeRelationshipQuery"){_153d=this._getShallowClone(query);_153d.outFields=this.getOutFields();_153d.returnGeometry=query.hasOwnProperty("returnGeometry")?query.returnGeometry:true;var _1544;if(map){_153d.outSpatialReference=new _1448(map.spatialReference.toJson());}if(!this._applyQueryFilters(_153d)){switch(type){case "execute":_1544=new _1451({features:[]});break;case "executeForIds":_1544=[];break;case "executeForCount":_1544=0;break;}_153e(_1544,true);return dfd;}var _1545=this._canDoClientSideQuery(_153d);if(_1545){var _1546=this._doQuery(_153d,_1545,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_1544=new _1451();_1544.features=_1546;break;case "executeForIds":_1544=_1546;break;case "executeForCount":_1544=_1546.length;break;}_153e(_1544,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+this.invalidParams);this._resolve([err],null,_153c,dfd,true);return dfd;}if(this._ts){_153d._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_153d);temp.addCallbacks(_153e,function(err){that._resolve([err],null,_153c,dfd,true);});return dfd;},_convertFeaturesToJson:function(_1547,_1548,isAdd,_1549){var json=[],_154a=this._selectionSymbol,_154b=this.visibilityField,i,_154c,_154d=this.objectIdField;if(this.loaded&&(isAdd||_1549)){_154c=array.filter(this.fields,function(field){return (field.editable===false)&&(!_1549||(field.name!==_154d));});}for(i=0;i<_1547.length;i++){var _154e=_1547[i],_154f={},_1550=_154e.geometry,attr=_154e.attributes,_1551=_154e.symbol;if(_1550&&(!_1549||!this.loaded||this.allowGeometryUpdates)){_154f.geometry=_1550.toJson();}if(_154b){_154f.attributes=attr=lang.mixin({},attr);attr[_154b]=_154e.visible?1:0;}else{if(attr){_154f.attributes=lang.mixin({},attr);}}if(_154f.attributes&&_154c&&_154c.length){array.forEach(_154c,function(field){delete _154f.attributes[field.name];});}if(_1551&&(_1551!==_154a)){_154f.symbol=_1551.toJson();}json.push(_154f);}return _1548?json:_1440.toJson(json);},_selectHandler:function(_1552,_1553,_1554,_1555,dfd){var _1556,ctor=this.constructor;switch(_1553){case ctor.SELECTION_NEW:this.clearSelection(true);_1556=true;break;case ctor.SELECTION_ADD:_1556=true;break;case ctor.SELECTION_SUBTRACT:_1556=false;break;}var i,_1557=_1552.features,mode=this._mode,_1558=[],_1559=this.objectIdField,_155a,oid;if(_1556){for(i=0;i<_1557.length;i++){_155a=_1557[i];oid=_155a.attributes[_1559];var added=mode._addFeatureIIf(oid,_155a);_1558.push(added);this._selectFeatureIIf(oid,added,mode);}}else{for(i=0;i<_1557.length;i++){_155a=_1557[i];oid=_155a.attributes[_1559];this._unSelectFeatureIIf(oid,mode);var _155b=mode._removeFeatureIIf(oid);_1558.push(_155b||_155a);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_1558,_1553,_1552.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_1554,dfd);if(_1552.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_155c,mode){var _155d=this._selectedFeatures,found=_155d[oid];if(!found){mode._incRefCount(oid);_155d[oid]=_155c;if(!this._isTable){this._setSelectSymbol(_155c);}}return found||_155c;},_unSelectFeatureIIf:function(oid,mode){var found=this._selectedFeatures[oid];if(found){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(found);}}return found;},_isSelected:function(_155e){},_setSelectSymbol:function(_155f){var _1560=this._selectionSymbol;if(_1560&&!this._isSelOnly){_155f.setSymbol(_1560);}},_setUnSelectSymbol:function(_1561){var _1562=this._selectionSymbol;if(_1562&&!this._isSelOnly){if(_1562===_1561.symbol){_1561.setSymbol(null,true);}}},_getOutFields:function(){var _1563=array.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(field,index,arr){return !!field&&(array.indexOf(arr,field)===index);});var _1564=lang.clone(this._outFields);if(_1564){if(array.indexOf(_1564,"*")!==-1){return _1564;}array.forEach(_1563,function(field){if(array.indexOf(_1564,field)===-1){_1564.push(field);}});return _1564;}else{return _1563;}},_checkFields:function(_1565){var _1566=_1565||this._getOutFields();array.forEach(_1566,function(_1567){if(_1567==="*"){return;}if(!this._getField(_1567)){console.debug("esri.layers.FeatureLayer: "+_1445.substitute({url:this.url,field:_1567},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]"));}},this);if(!_1565&&!this._isTable&&!this._fserver&&!this._collection){var found=array.some(this.fields,function(_1568){return (_1568&&_1568.type==="esriFieldTypeGeometry")?true:false;});if(!found){console.debug("esri.layers.FeatureLayer: "+_1445.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]"));}}},_fixRendererFields:function(){var _1569=this.renderer;if(_1569&&this.fields.length>0){var _156a=array.filter([_1569,_1569.observationRenderer,_1569.latestObservationRenderer,_1569.trackRenderer],_1445.isDefined);var _156b=[];array.forEach(_156a,function(rnd){var _156c,_156d;_156d=rnd.attributeField;if(_156d&&!lang.isFunction(_156d)){_156c=!this._getField(_156d)&&this._getField(_156d,true);if(_156c){rnd.attributeField=_156c.name;}}_156d=rnd.attributeField2;if(_156d){_156c=!this._getField(_156d)&&this._getField(_156d,true);if(_156c){rnd.attributeField2=_156c.name;}}_156d=rnd.attributeField3;if(_156d){_156c=!this._getField(_156d)&&this._getField(_156d,true);if(_156c){rnd.attributeField3=_156c.name;}}if(!lang.isFunction(rnd.attributeField)){_156b.push(rnd.attributeField);}_156b.push(rnd.attributeField2);_156b.push(rnd.attributeField3);},this);this._rendererFields=array.filter(_156b,_1445.isDefined);}},_getField:function(_156e,_156f){var _1570=this.fields;if(!_1570||_1570.length===0){return null;}var _1571;if(_156f){_156e=_156e.toLowerCase();}array.some(_1570,function(_1572){var found=false;if(_156f){found=(_1572&&_1572.name.toLowerCase()===_156e)?true:false;}else{found=(_1572&&_1572.name===_156e)?true:false;}if(found){_1571=_1572;}return found;});return _1571;},_getDateOpts:function(){if(!this._dtOpts){var props=array.map(array.filter(this.fields,function(_1573){return !!(_1573&&_1573.type==="esriFieldTypeDate");}),function(_1574){return _1574.name;});this._dtOpts={properties:props};}return this._dtOpts;},_applyNormalized:function(_1575,_1576){if(_1575&&_1576){array.forEach(_1575,function(_1577,index){if(_1577&&_1576[index]){_1577.setGeometry(_1576[index]);}});}},_editHandler:function(_1578,adds,_1579,_157a,_157b,dfd){var _157c=_1578.addResults,_157d=_1578.updateResults,_157e=_1578.deleteResults,i,_157f,oid,_1580,attr,_1581=this.objectIdField,mode=this._mode,_1582=this._isTable;var _1583=this.editFieldsInfo,_1584=this.getOutFields()||[],_1585=_1583&&_1583.creatorField,_1586=_1583&&_1583.creationDateField,_1587=_1583&&_1583.editorField,_1588=_1583&&_1583.editDateField,realm=_1583&&_1583.realm;if(array.indexOf(_1584,"*")===-1){if(_1585&&array.indexOf(_1584,_1585)===-1){_1585=null;}if(_1586&&array.indexOf(_1584,_1586)===-1){_1586=null;}if(_1587&&array.indexOf(_1584,_1587)===-1){_1587=null;}if(_1588&&array.indexOf(_1584,_1588)===-1){_1588=null;}}var _1589=(_1586||_1588)?(new Date()).getTime():null,_158a=(_1585||_1587)?this.getUserId():undefined;if(_158a&&realm){_158a=_158a+"@"+realm;}if(_157c){for(i=0;i<_157c.length;i++){_157c[i]=new _1459(_157c[i]);if(_1582){continue;}_157f=_157c[i];if(_157f.success){oid=_157f.objectId;_1580=adds[i];var gl=_1580._graphicsLayer;if(gl&&gl!==this){gl.remove(_1580);}attr=_1580.attributes||{};attr[_1581]=oid;if(_1585){attr[_1585]=_158a;}if(_1587){attr[_1587]=_158a;}if(_1586){attr[_1586]=_1589;}if(_1588){attr[_1588]=_1589;}_1580.setAttributes(attr);if(mode._init){mode.drawFeature(_1580);}}}}if(_157d){for(i=0;i<_157d.length;i++){_157d[i]=new _1459(_157d[i]);if(_1582){continue;}_157f=_157d[i];if(_157f.success){oid=_157f.objectId;_1580=_1579[oid];var found=mode._getFeature(oid);if(found){if(found.geometry!==_1580.geometry){found.setGeometry(_1453.fromJson(_1580.geometry.toJson()));}this._repaint(found,oid);}_1580=found||_1580;attr=_1580.attributes||{};if(_1587){attr[_1587]=_158a;}if(_1588){attr[_1588]=_1589;}_1580.setAttributes(attr);}}}if(_157e){var _158b=[];for(i=0;i<_157e.length;i++){_157e[i]=new _1459(_157e[i]);if(_1582){continue;}_157f=_157e[i];if(_157f.success){oid=_157f.objectId;_1580=mode._getFeature(oid);if(_1580){if(this._unSelectFeatureIIf(oid,mode)){_158b.push(_1580);}_1580._count=0;mode._removeFeatureIIf(oid);}}}if(_158b.length>0){this.onSelectionComplete(_158b,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_157c,_157d,_157e],"onEditsComplete",_157a,dfd);},_sendAttachment:function(type,_158c,_158d,_158e,_158f){var _1590=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_158c+"/"+_1590,self=this;var dfd=_1446({url:url,form:_158d,content:lang.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_1591){var _1592=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_1593=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_1594=new _1459(_1591[_1592]);_1594.attachmentId=_1594.objectId;_1594.objectId=_158c;self._resolve([_1594],_1593,_158e);return _1594;}).addErrback(function(error){self._resolve([error],null,_158f,null,true);});return dfd;},_repaint:function(_1595,oid,force){oid=_1445.isDefined(oid)?oid:_1595.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_1595.setSymbol(_1595.symbol,force);}},_getKind:function(_1596){var _1597=this._trackManager;if(_1597){return _1597.isLatestObservation(_1596)?1:0;}return 0;}});lang.mixin(_145e,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});_1454._createWrappers(_145e);if(has("extend-esri")){lang.setObject("layers.FeatureLayer",_145e,_1444);}return _145e;});},"esri/dijit/editing/toolbars/ToolbarBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dijit/Toolbar","dijit/ToolbarSeparator","esri/kernel","esri/lang"],function(_1598,lang,array,_1599,has,_159a,_159b,_159c,_159d){var TBB=_1598([_159a],{declaredClass:"esri.dijit.editing.toolbars.ToolbarBase",_enabled:true,graphicsAdded:function(){},drawEnd:function(){},onApplyEdits:function(){},onDelete:function(){},constructor:function(_159e,_159f){if(!_159e||!_159e.settings){return;}this._tools=[];this._tbConnects=[];this._initialize(_159e.settings);},postCreate:function(){this._createTools();this.deactivate();},destroy:function(){var tool;var tools=this._tools;for(tool in tools){if(tools.hasOwnProperty(tool)&&_159d.isDefined(this._tools[tool])){this._tools[tool].destroy();}}array.forEach(this._tbConnects,_1599.disconnect);this.inherited(arguments);},activate:function(_15a0){this._enabled=true;},deactivate:function(){var tool;this._enabled=false;this._layer=null;this._geometryType=null;var tools=this._tools;for(tool in tools){if(tools.hasOwnProperty(tool)){this._tools[tool].deactivate();this._tools[tool].setChecked(false);}}},isEnabled:function(){return this._enabled;},setActiveSymbol:function(_15a1){this._activeSymbol=_15a1;},_getSymbol:function(){},_createTools:function(){},_initialize:function(_15a2){this._settings=_15a2;this._toolbar=_15a2.drawToolbar;this._editToolbar=_15a2.editToolbar;this._initializeToolbar();},_activateTool:function(tool,_15a3){if(this._activeTool){this._activeTool.deactivate();}if(_15a3===true&&this._activeTool==this._tools[tool]){this._activeTool.setChecked(false);this._activeTool=null;}else{this._activeTool=this._tools[tool];this._activeTool.setChecked(true);this._activeTool.activate(null);}},_createSeparator:function(){this.addChild(new _159b());}});if(has("extend-esri")){lang.setObject("dijit.editing.toolbars.ToolbarBase",TBB,_159c);}return TBB;});},"dijit/form/HorizontalSlider":function(){require({cache:{"url:dijit/form/templates/HorizontalSlider.html":"<table class=\"dijit dijitReset dijitSlider dijitSliderH\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" data-dojo-attach-event=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\"\n\trole=\"presentation\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td data-dojo-attach-point=\"topDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderDecrementIconH\" style=\"display:none\" data-dojo-attach-point=\"decrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper\" data-dojo-attach-event=\"press:_onClkDecBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><input data-dojo-attach-point=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\n\t\t\t/><div class=\"dijitReset dijitSliderBarContainerH\" role=\"presentation\" data-dojo-attach-point=\"sliderBarContainer\"\n\t\t\t\t><div role=\"presentation\" data-dojo-attach-point=\"progressBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH\" data-dojo-attach-event=\"press:_onBarClick\"\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableH\"\n\t\t\t\t\t\t><div data-dojo-attach-point=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleH\" data-dojo-attach-event=\"press:_onHandleClick\" role=\"slider\"></div\n\t\t\t\t\t></div\n\t\t\t\t></div\n\t\t\t\t><div role=\"presentation\" data-dojo-attach-point=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH\" data-dojo-attach-event=\"press:_onBarClick\"></div\n\t\t\t></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper\" data-dojo-attach-event=\"press:_onClkIncBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderIncrementIconH\" style=\"display:none\" data-dojo-attach-point=\"incrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td data-dojo-attach-point=\"containerNode,bottomDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n></table>\n"}});define("dijit/form/HorizontalSlider",["dojo/_base/array","dojo/_base/declare","dojo/dnd/move","dojo/_base/event","dojo/_base/fx","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/dnd/Moveable","dojo/dnd/Mover","dojo/query","dojo/mouse","../registry","../focus","../typematic","./Button","./_FormValueWidget","../_Container","dojo/text!./templates/HorizontalSlider.html"],function(array,_15a4,move,event,fx,_15a5,_15a6,keys,lang,has,_15a7,Mover,query,mouse,_15a8,focus,_15a9,_15aa,_15ab,_15ac,_15ad){var _15ae=_15a4("dijit.form._SliderMover",Mover,{onMouseMove:function(e){var _15af=this.widget;var _15b0=_15af._abspos;if(!_15b0){_15b0=_15af._abspos=_15a5.position(_15af.sliderBarContainer,true);_15af._setPixelValue_=lang.hitch(_15af,"_setPixelValue");_15af._isReversed_=_15af._isReversed();}var _15b1=e[_15af._mousePixelCoord]-_15b0[_15af._startingPixelCoord];_15af._setPixelValue_(_15af._isReversed_?(_15b0[_15af._pixelCount]-_15b1):_15b1,_15b0[_15af._pixelCount],false);},destroy:function(e){Mover.prototype.destroy.apply(this,arguments);var _15b2=this.widget;_15b2._abspos=null;_15b2._setValueAttr(_15b2.value,true);}});var _15b3=_15a4("dijit.form.HorizontalSlider",[_15ab,_15ac],{templateString:_15ad,value:0,showButtons:true,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:true,slideDuration:_15a8.defaultDuration,_setIdAttr:"",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",_onKeyUp:function(e){if(this.disabled||this.readOnly||e.altKey||e.ctrlKey||e.metaKey){return;}this._setValueAttr(this.value,true);},_onKeyPress:function(e){if(this.disabled||this.readOnly||e.altKey||e.ctrlKey||e.metaKey){return;}switch(e.charOrCode){case keys.HOME:this._setValueAttr(this.minimum,false);break;case keys.END:this._setValueAttr(this.maximum,false);break;case ((this._descending||this.isLeftToRight())?keys.RIGHT_ARROW:keys.LEFT_ARROW):case (this._descending===false?keys.DOWN_ARROW:keys.UP_ARROW):case (this._descending===false?keys.PAGE_DOWN:keys.PAGE_UP):this.increment(e);break;case ((this._descending||this.isLeftToRight())?keys.LEFT_ARROW:keys.RIGHT_ARROW):case (this._descending===false?keys.UP_ARROW:keys.DOWN_ARROW):case (this._descending===false?keys.PAGE_UP:keys.PAGE_DOWN):this.decrement(e);break;default:return;}event.stop(e);},_onHandleClick:function(e){if(this.disabled||this.readOnly){return;}if(!has("ie")){focus.focus(this.sliderHandle);}event.stop(e);},_isReversed:function(){return !this.isLeftToRight();},_onBarClick:function(e){if(this.disabled||this.readOnly||!this.clickSelect){return;}focus.focus(this.sliderHandle);event.stop(e);var _15b4=_15a5.position(this.sliderBarContainer,true);var _15b5=e[this._mousePixelCoord]-_15b4[this._startingPixelCoord];this._setPixelValue(this._isReversed()?(_15b4[this._pixelCount]-_15b5):_15b5,_15b4[this._pixelCount],true);this._movable.onMouseDown(e);},_setPixelValue:function(_15b6,_15b7,_15b8){if(this.disabled||this.readOnly){return;}var count=this.discreteValues;if(count<=1||count==Infinity){count=_15b7;}count--;var _15b9=_15b7/count;var _15ba=Math.round(_15b6/_15b9);this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*_15ba/count+this.minimum,this.maximum),this.minimum),_15b8);},_setValueAttr:function(value,_15bb){this._set("value",value);this.valueNode.value=value;this.focusNode.setAttribute("aria-valuenow",value);this.inherited(arguments);var _15bc=(value-this.minimum)/(this.maximum-this.minimum);var _15bd=(this._descending===false)?this.remainingBar:this.progressBar;var _15be=(this._descending===false)?this.progressBar:this.remainingBar;if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){this._inProgressAnim.stop(true);}if(_15bb&&this.slideDuration>0&&_15bd.style[this._progressPixelSize]){var _15bf=this;var props={};var start=parseFloat(_15bd.style[this._progressPixelSize]);var _15c0=this.slideDuration*(_15bc-start/100);if(_15c0==0){return;}if(_15c0<0){_15c0=0-_15c0;}props[this._progressPixelSize]={start:start,end:_15bc*100,units:"%"};this._inProgressAnim=fx.animateProperty({node:_15bd,duration:_15c0,onAnimate:function(v){_15be.style[_15bf._progressPixelSize]=(100-parseFloat(v[_15bf._progressPixelSize]))+"%";},onEnd:function(){delete _15bf._inProgressAnim;},properties:props});this._inProgressAnim.play();}else{_15bd.style[this._progressPixelSize]=(_15bc*100)+"%";_15be.style[this._progressPixelSize]=((1-_15bc)*100)+"%";}},_bumpValue:function(_15c1,_15c2){if(this.disabled||this.readOnly){return;}var s=_15a6.getComputedStyle(this.sliderBarContainer);var c=_15a5.getContentBox(this.sliderBarContainer,s);var count=this.discreteValues;if(count<=1||count==Infinity){count=c[this._pixelCount];}count--;var value=(this.value-this.minimum)*count/(this.maximum-this.minimum)+_15c1;if(value<0){value=0;}if(value>count){value=count;}value=value*(this.maximum-this.minimum)/count+this.minimum;this._setValueAttr(value,_15c2);},_onClkBumper:function(val){if(this.disabled||this.readOnly||!this.clickSelect){return;}this._setValueAttr(val,true);},_onClkIncBumper:function(){this._onClkBumper(this._descending===false?this.minimum:this.maximum);},_onClkDecBumper:function(){this._onClkBumper(this._descending===false?this.maximum:this.minimum);},decrement:function(e){this._bumpValue(e.charOrCode==keys.PAGE_DOWN?-this.pageIncrement:-1);},increment:function(e){this._bumpValue(e.charOrCode==keys.PAGE_UP?this.pageIncrement:1);},_mouseWheeled:function(evt){event.stop(evt);this._bumpValue(evt.wheelDelta<0?-1:1,true);},startup:function(){if(this._started){return;}array.forEach(this.getChildren(),function(child){if(this[child.container]!=this.containerNode){this[child.container].appendChild(child.domNode);}},this);this.inherited(arguments);},_typematicCallback:function(count,_15c3,e){if(count==-1){this._setValueAttr(this.value,true);}else{this[(_15c3==(this._descending?this.incrementButton:this.decrementButton))?"decrement":"increment"](e);}},buildRendering:function(){this.inherited(arguments);if(this.showButtons){this.incrementButton.style.display="";this.decrementButton.style.display="";}var label=query("label[for=\""+this.id+"\"]");if(label.length){if(!label[0].id){label[0].id=this.id+"_label";}this.focusNode.setAttribute("aria-labelledby",label[0].id);}this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum);},postCreate:function(){this.inherited(arguments);if(this.showButtons){this.own(_15a9.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),_15a9.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));}this.connect(this.domNode,mouse.wheel,"_mouseWheeled");var mover=_15a4(_15ae,{widget:this});this._movable=new _15a7(this.sliderHandle,{mover:mover});this._layoutHackIE7();},destroy:function(){this._movable.destroy();if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){this._inProgressAnim.stop(true);}this.inherited(arguments);}});_15b3._Mover=_15ae;return _15b3;});},"*now":function(r){r(["dojo/i18n!*preload*esri/nls/widgets*[\"ar\",\"az\",\"ca\",\"cs\",\"da\",\"de-de\",\"el\",\"en-gb\",\"en-us\",\"es-es\",\"fi-fi\",\"fr-fr\",\"he-il\",\"hu\",\"it-it\",\"ja-jp\",\"ko-kr\",\"nl-nl\",\"nb\",\"pl\",\"pt-br\",\"pt-pt\",\"ro\",\"ru\",\"sk\",\"sl\",\"sv\",\"th\",\"tr\",\"zh-tw\",\"zh-cn\",\"ROOT\"]"]);},"*noref":1}});define("esri/widgets",["esri/layers/FeatureLayer","esri/toolbars/_toolbar","esri/toolbars/draw","esri/toolbars/edit","esri/tasks/geometry","esri/dijit/AttributeInspector","esri/dijit/editing/AttachmentEditor","esri/dijit/editing/Editor","esri/dijit/editing/TemplatePicker","esri/dijit/editing/Util","esri/dijit/editing/SelectionHelper","esri/dijit/_TouchBase","esri/dijit/BasemapGallery","esri/dijit/Bookmarks","esri/dijit/Directions","esri/dijit/Gallery","esri/dijit/Gauge","esri/dijit/Geocoder","esri/dijit/InfoView","esri/dijit/InfoWindow","esri/dijit/InfoWindowLite","esri/dijit/Legend","esri/dijit/Measurement","esri/dijit/NavigationBar","esri/dijit/OverviewMap","esri/dijit/Popup","esri/dijit/PopupMobile","esri/dijit/Print","esri/dijit/Scalebar","esri/dijit/TimeSlider"],function(){return {};});