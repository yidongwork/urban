/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"dojox/grid/DataGrid":function(){define("dojox/grid/DataGrid",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/sniff","dojo/_base/declare","./_Grid","./DataSelection","dojo/_base/html"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){var _a=_6("dojox.grid.DataGrid",_7,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:false,_isLoading:false,keepSelection:false,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments);},destroy:function(){this.selection.destroy();this.inherited(arguments);},createSelection:function(){this.selection=new _8(this);},get:function(_b,_c){if(_c&&this.field=="_item"&&!this.fields){return _c;}else{if(_c&&this.fields){var _d=[];var s=this.grid.store;_2.forEach(this.fields,function(f){_d=_d.concat(s.getValues(_c,f));});return _d;}else{if(!_c&&typeof _b==="string"){return this.inherited(arguments);}}}return (!_c?this.defaultValue:(!this.field?this.value:(this.field=="_item"?_c:this.grid.store.getValue(_c,this.field))));},_checkUpdateStatus:function(){if(this.updateDelay>0){var _e=false;if(this._endUpdateDelay){clearTimeout(this._endUpdateDelay);delete this._endUpdateDelay;_e=true;}if(!this.updating){this.beginUpdate();_e=true;}if(_e){var _f=this;this._endUpdateDelay=setTimeout(function(){delete _f._endUpdateDelay;_f.endUpdate();},this.updateDelay);}}},_onSet:function(_10,_11,_12,_13){this._checkUpdateStatus();var idx=this.getItemIndex(_10);if(idx>-1){this.updateRow(idx);}},_createItem:function(_14,_15){var _16=this._hasIdentity?this.store.getIdentity(_14):_4.toJson(this.query)+":idx:"+_15+":sort:"+_4.toJson(this.getSortProps());var o=this._by_idty[_16]={idty:_16,item:_14};return o;},_addItem:function(_17,_18,_19){this._by_idx[_18]=this._createItem(_17,_18);if(!_19){this.updateRow(_18);}},_onNew:function(_1a,_1b){this._checkUpdateStatus();var _1c=this.get("rowCount");this._addingItem=true;this.updateRowCount(_1c+1);this._addingItem=false;this._addItem(_1a,_1c);this.showMessage();},_onDelete:function(_1d){this._checkUpdateStatus();var idx=this._getItemIndex(_1d,true);if(idx>=0){this._pages=[];this._bop=-1;this._eop=-1;var o=this._by_idx[idx];this._by_idx.splice(idx,1);delete this._by_idty[o.idty];this.updateRowCount(this.get("rowCount")-1);if(this.get("rowCount")===0){this.showMessage(this.noDataMessage);}}if(this.selection.isSelected(idx)){this.selection.deselect(idx);this.selection.selected.splice(idx,1);}},_onRevert:function(){this._refresh();},setStore:function(_1e,_1f,_20){if(this._requestsPending(0)){return;}this._setQuery(_1f,_20);this._setStore(_1e);this._refresh(true);},setQuery:function(_21,_22){if(this._requestsPending(0)){return;}this._setQuery(_21,_22);this._refresh(true);},setItems:function(_23){this.items=_23;this._setStore(this.store);this._refresh(true);},_setQuery:function(_24,_25){this.query=_24;this.queryOptions=_25||this.queryOptions;},_setStore:function(_26){if(this.store&&this._store_connects){_2.forEach(this._store_connects,this.disconnect,this);}this.store=_26;if(this.store){var f=this.store.getFeatures();var h=[];this._canEdit=!!f["dojo.data.api.Write"]&&!!f["dojo.data.api.Identity"];this._hasIdentity=!!f["dojo.data.api.Identity"];if(!!f["dojo.data.api.Notification"]&&!this.items){h.push(this.connect(this.store,"onSet","_onSet"));h.push(this.connect(this.store,"onNew","_onNew"));h.push(this.connect(this.store,"onDelete","_onDelete"));}if(this._canEdit){h.push(this.connect(this.store,"revert","_onRevert"));}this._store_connects=h;}},_onFetchBegin:function(_27,req){if(!this.scroller){return;}if(this.rowCount!=_27){if(req.isRender){this.scroller.init(_27,this.keepRows,this.rowsPerPage);this.rowCount=_27;this._setAutoHeightAttr(this.autoHeight,true);this._skipRowRenormalize=true;this.prerender();this._skipRowRenormalize=false;}else{this.updateRowCount(_27);}}if(!_27){this.views.render();this._resize();this.showMessage(this.noDataMessage);this.focus.initFocusView();}else{this.showMessage();}},_onFetchComplete:function(_28,req){if(!this.scroller){return;}if(_28&&_28.length>0){_2.forEach(_28,function(_29,idx){this._addItem(_29,req.start+idx,true);},this);this.updateRows(req.start,_28.length);if(req.isRender){this.setScrollTop(0);this.postrender();}else{if(this._lastScrollTop){this.setScrollTop(this._lastScrollTop);}}if(_5("ie")){_9.setSelectable(this.domNode,this.selectable);}}delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;}this._pending_requests[req.start]=false;},_onFetchError:function(err,req){console.log(err);delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;this.showMessage(this.errorMessage);}this._pending_requests[req.start]=false;this.onFetchError(err,req);},onFetchError:function(err,req){},_fetch:function(_2a,_2b){_2a=_2a||0;if(this.store&&!this._pending_requests[_2a]){if(!this._isLoaded&&!this._isLoading){this._isLoading=true;this.showMessage(this.loadingMessage);}this._pending_requests[_2a]=true;try{if(this.items){var _2c=this.items;var _2d=this.store;this.rowsPerPage=_2c.length;var req={start:_2a,count:this.rowsPerPage,isRender:_2b};this._onFetchBegin(_2c.length,req);var _2e=0;_2.forEach(_2c,function(i){if(!_2d.isItemLoaded(i)){_2e++;}});if(_2e===0){this._onFetchComplete(_2c,req);}else{var _2f=function(_30){_2e--;if(_2e===0){this._onFetchComplete(_2c,req);}};_2.forEach(_2c,function(i){if(!_2d.isItemLoaded(i)){_2d.loadItem({item:i,onItem:_2f,scope:this});}},this);}}else{this.store.fetch({start:_2a,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:_2b,onBegin:_3.hitch(this,"_onFetchBegin"),onComplete:_3.hitch(this,"_onFetchComplete"),onError:_3.hitch(this,"_onFetchError")});}}catch(e){this._onFetchError(e,{start:_2a,count:this.rowsPerPage});}}},_clearData:function(){this.updateRowCount(0);this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoaded=false;this._isLoading=false;},getItem:function(idx){var _31=this._by_idx[idx];if(!_31||(_31&&!_31.item)){this._preparePage(idx);return null;}return _31.item;},getItemIndex:function(_32){return this._getItemIndex(_32,false);},_getItemIndex:function(_33,_34){if(!_34&&!this.store.isItem(_33)){return -1;}var _35=this._hasIdentity?this.store.getIdentity(_33):null;for(var i=0,l=this._by_idx.length;i<l;i++){var d=this._by_idx[i];if(d&&((_35&&d.idty==_35)||(d.item===_33))){return i;}}return -1;},filter:function(_36,_37){this.query=_36;if(_37){this._clearData();}this._fetch();},_getItemAttr:function(idx,_38){var _39=this.getItem(idx);return (!_39?this.fetchText:this.store.getValue(_39,_38));},_render:function(){if(this.domNode.parentNode){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this._fetch(0,true);}},_requestsPending:function(_3a){return this._pending_requests[_3a];},_rowToPage:function(_3b){return (this.rowsPerPage?Math.floor(_3b/this.rowsPerPage):_3b);},_pageToRow:function(_3c){return (this.rowsPerPage?this.rowsPerPage*_3c:_3c);},_preparePage:function(_3d){if((_3d<this._bop||_3d>=this._eop)&&!this._addingItem){var _3e=this._rowToPage(_3d);this._needPage(_3e);this._bop=_3e*this.rowsPerPage;this._eop=this._bop+(this.rowsPerPage||this.get("rowCount"));}},_needPage:function(_3f){if(!this._pages[_3f]){this._pages[_3f]=true;this._requestPage(_3f);}},_requestPage:function(_40){var row=this._pageToRow(_40);var _41=Math.min(this.rowsPerPage,this.get("rowCount")-row);if(_41>0){this._requests++;if(!this._requestsPending(row)){setTimeout(_3.hitch(this,"_fetch",row,false),1);}}},getCellName:function(_42){return _42.field;},_refresh:function(_43){this._clearData();this._fetch(0,_43);},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh();},canSort:function(){return (!this._isLoading);},getSortProps:function(){var c=this.getCell(this.getSortIndex());if(!c){if(this.sortFields){return this.sortFields;}return null;}else{var _44=c["sortDesc"];var si=!(this.sortInfo>0);if(typeof _44=="undefined"){_44=si;}else{_44=si?!_44:_44;}return [{attribute:c.field,descending:_44}];}},styleRowState:function(_45){if(this.store&&this.store.getState){var _46=this.store.getState(_45.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_46[s]){c=" dojoxGridRow-"+s;break;}}_45.customClasses+=c;}},onStyleRow:function(_47){this.styleRowState(_47);this.inherited(arguments);},canEdit:function(_48,_49){return this._canEdit;},_copyAttr:function(idx,_4a){var row={};var _4b={};var src=this.getItem(idx);return this.store.getValue(src,_4a);},doStartEdit:function(_4c,_4d){if(!this._cache[_4d]){this._cache[_4d]=this._copyAttr(_4d,_4c.field);}this.onStartEdit(_4c,_4d);},doApplyCellEdit:function(_4e,_4f,_50){this.store.fetchItemByIdentity({identity:this._by_idx[_4f].idty,onItem:_3.hitch(this,function(_51){var _52=this.store.getValue(_51,_50);if(typeof _52=="number"){_4e=isNaN(_4e)?_4e:parseFloat(_4e);}else{if(typeof _52=="boolean"){_4e=_4e=="true"?true:_4e=="false"?false:_4e;}else{if(_52 instanceof Date){var _53=new Date(_4e);_4e=isNaN(_53.getTime())?_4e:_53;}}}this.store.setValue(_51,_50,_4e);this.onApplyCellEdit(_4e,_4f,_50);})});},doCancelEdit:function(_54){var _55=this._cache[_54];if(_55){this.updateRow(_54);delete this._cache[_54];}this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_56,_57){var _58=this._cache[_56];this.onApplyEdit(_56);},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();var fx=_3.hitch(this,function(_59){if(_59.length){_2.forEach(_59,this.store.deleteItem,this.store);this.selection.clear();}});if(this.allItemsSelected){this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:fx});}else{fx(this.selection.getSelected());}}}});_a.cell_markupFactory=function(_5a,_5b,_5c){var _5d=_3.trim(_9.attr(_5b,"field")||"");if(_5d){_5c.field=_5d;}_5c.field=_5c.field||_5c.name;var _5e=_3.trim(_9.attr(_5b,"fields")||"");if(_5e){_5c.fields=_5e.split(",");}if(_5a){_5a(_5b,_5c);}};_a.markupFactory=function(_5f,_60,_61,_62){return _7.markupFactory(_5f,_60,_61,_3.partial(_a.cell_markupFactory,_62));};return _a;});},"esri/layers/OnDemandMode":function(){define(["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/geometry/Point","esri/tasks/query","esri/layers/RenderMode","esri/layers/GridLayout"],function(_63,_64,_65,_66,has,_67,_68,_69,_6a,_6b){var _6c=_63([_6a],{declaredClass:"esri.layers._OnDemandMode",constructor:function(_6d){this.featureLayer=_6d;this._featureMap={};this._queryErrorHandler=_65.hitch(this,this._queryErrorHandler);},initialize:function(map){this.inherited(arguments);var _6e=this.featureLayer,_6f=_6e._srInfo;this._gridLayer=new _6b(new _68(_6f?_6f.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_6e._tileWidth,height:_6e._tileHeight},{width:map.width,height:map.height},_6f);this._cellMap={};this._gridLayer.setResolution(map.extent);},startup:function(){this._ioQueue=[];if(!this.featureLayer.suspended){this._zoomHandler();this._enableConnectors();}},propertyChangeHandler:function(_70){if(this._init){if(_70<2){this._zoomHandler();}else{console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id = "+this.featureLayer.id+", Layer URL = "+this.featureLayer.url);}}},destroy:function(){this._disableConnectors();this.inherited(arguments);},drawFeature:function(_71){var _72=this._gridLayer,_73=_71.geometry,_74=[];if(!_73){return;}_74=_72.getCellsInExtent((_73.type==="point")?{xmin:_73.x,ymin:_73.y,xmax:_73.x,ymax:_73.y}:_73.getExtent(),false).cells;var _75=this._cellMap,i,_76,oid=_71.attributes[this.featureLayer.objectIdField],_77,row,col;for(i=0;i<_74.length;i++){_76=_74[i];_77=_76.latticeID;row=_76.row;col=_76.col;if(_77){_76=(_75[_77]=(_75[_77]||_76));}else{_75[row]=_75[row]||{};_76=(_75[row][col]=(_75[row][col]||_76));}_76.features=_76.features||[];_76.features.push(_71);this._addFeatureIIf(oid,_71);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_enableConnectors:function(){var map=this.map;this._zoomConnect=_64.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=_64.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=_64.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){_64.disconnect(this._zoomConnect);_64.disconnect(this._panConnect);_64.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _78=this.featureLayer,map=this.map;if(_78.suspended){return;}_78._fireUpdateStart();this._clearIIf();var _79=_78._trackManager;if(_79){_79.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_7a,_7b){var id="_"+_7a.name+_7a.layerId+_7a._ulid+"_"+_7b.resolution+"_"+(_7b.latticeID||(_7b.row+"_"+_7b.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_7c){this._exceeds=false;var _7d=this.featureLayer,map=this.map,_7e=_7c||map.extent,_7f=this._gridLayer.getCellsInExtent(_7e,_7d.latticeTiling),_80=_7f.cells;if(!_7d.isEditable()){var _81=this._cellMap;_80=_66.filter(_80,function(_82){if(_82.lattice){if(_81[_82.latticeID]){return false;}}else{if(_81[_82.row]&&_81[_82.row][_82.col]){return false;}}return true;});}var _83=_7d.getOutFields(),_84=_7d.getDefinitionExpression(),_85=_7d._getOffsettedTE(_7d._mapTimeExtent),_86=_7d._usePatch,_87=this._ioQueue,i,_88=this,_89=this._drawFeatures,_8a,_8b,_8c;this._pending=this._pending||0;for(i=0;i<_80.length;i++){_8a=_80[i];_8b=new _69();_8b.geometry=_8a.extent||_8a.lattice;_8b.outFields=_83;_8b.where=_84;if(_7d.latticeTiling&&_8a.extent){_8b.spatialRelationship=_69.SPATIAL_REL_CONTAINS;}_8b.returnGeometry=true;_8b.timeExtent=_85;_8b.maxAllowableOffset=_7d._maxOffset;if(_7d._ts){_8b._ts=(new Date()).getTime();}_8c=null;if(_86){_8c=this._getRequestId(_7d,_8a);if(this._isPending(_8c)){continue;}}this._pending++;_87.push(_7d._task.execute(_8b,function(){var _8d=_8a;return function(_8e){_89.apply(_88,[_8e,_8d]);};}.call(this),this._queryErrorHandler,_8c));}this._removeOldCells(_7e);this._endCheck();},_drawFeatures:function(_8f,_90){this._exceeds=this._exceeds||_8f.exceededTransferLimit;this._finalizeIO();var _91=this.featureLayer,map=this.map,_92=map.extent,_93=_90.extent,row=_90.row,col=_90.col,_94=_91.objectIdField,_95=_8f.features,_96=this._gridLayer,_97=this._cellMap,i,len,_98=_90.latticeID,_99=_98?_97[_98]:(_97[row]&&_97[row][col]);if((_90.resolution!=_96._resolution)||(_98?(_98!==_96.getLatticeID(_92)):(!_96.intersects(_93,_92)))){if(_99){this._removeCell(row,col,_98);}}else{if(_99){this._updateCell(_99,_95);}else{_90.features=_95;if(_98){_97[_98]=_90;}else{_97[row]=_97[row]||{};_97[row][col]=_90;}len=_95.length;for(i=0;i<len;i++){var _9a=_95[i];var oid=_9a.attributes[_94];this._addFeatureIIf(oid,_9a);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_9b){if(this._pending===0){this._processIOQueue();var _9c=this.featureLayer,_9d=_9c._trackManager;if(_9d){_9d.clearTracks();_9d.addFeatures(_9c.graphics);if(_9c._ager){_66.forEach(_9c.graphics,function(_9e){if(_9e._shape){_9c._repaint(_9e);}});}_9d.moveLatestToFront();_9d.drawTracks();}this.featureLayer._fireUpdateEnd(_9b&&new Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_9c.onQueryLimitExceeded();}}},_processIOQueue:function(_9f){this._ioQueue=_66.filter(this._ioQueue,function(dfd){var _a0=dfd.fired>-1?false:true;return _a0;});if(_9f){_66.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_a1){var _a2=this._cellMap,_a3=this._gridLayer,_a4,_a5;for(_a4 in _a2){if(_a2[_a4]){var row=_a2[_a4],_a6=row.latticeID,_a7=0,_a8=0;if(_a6){_a7++;if(_a6!==_a3.getLatticeID(_a1)){this._removeCell(null,null,_a6);_a8++;}}else{for(_a5 in row){if(row[_a5]){_a7++;var _a9=row[_a5].extent;if(!_a3.intersects(_a9,_a1)){this._removeCell(_a4,_a5);_a8++;}}}}if(_a8===_a7){delete _a2[_a4];}}}},_updateCell:function(_aa,_ab){var _ac=this.featureLayer,_ad=_ac.objectIdField,_ae=_ac._selectedFeatures,i,len=_ab.length;_aa.features=_aa.features||[];for(i=0;i<len;i++){var _af=_ab[i];var oid=_af.attributes[_ad];var _b0=this._addFeatureIIf(oid,_af);if(_b0===_af){this._incRefCount(oid);_aa.features.push(_b0);}else{if(!(oid in _ae)){_b0.setGeometry(_af.geometry);_b0.setAttributes(_af.attributes);}}}},_removeCell:function(row,col,_b1){var _b2=this._cellMap,_b3=this.featureLayer,_b4=_b3.objectIdField;var _b5=_b1?_b2[_b1]:(_b2[row]&&_b2[row][col]);if(_b5){if(_b1){delete _b2[_b1];}else{delete _b2[row][col];}var _b6=_b5.features,i;for(i=0;i<_b6.length;i++){var _b7=_b6[i];var oid=_b7.attributes[_b4];this._decRefCount(oid);if(oid in _b3._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});if(has("extend-esri")){_65.setObject("layers._OnDemandMode",_6c,_67);}return _6c;});},"esri/toolbars/_Box":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/matrix","esri/kernel","esri/lang","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/webMercatorUtils","esri/geometry/jsonUtils","esri/graphic"],function(_b8,_b9,_ba,_bb,has,_bc,_bd,_be,_bf,_c0,_c1,_c2,_c3,_c4,_c5){var BOX=_b8(null,{declaredClass:"esri.toolbars._Box",constructor:function(_c6,map,_c7,_c8,_c9,_ca){this._graphic=_c6;this._map=map;this._toolbar=_c7;this._scale=_c8;this._rotate=_c9;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=_ca;var _cb=_c7._options;this._markerSymbol=_cb.boxHandleSymbol;this._lineSymbol=_cb.boxLineSymbol;this._moveStartHandler=_b9.hitch(this,this._moveStartHandler);this._firstMoveHandler=_b9.hitch(this,this._firstMoveHandler);this._moveStopHandler=_b9.hitch(this,this._moveStopHandler);this._moveHandler=_b9.hitch(this,this._moveHandler);this._init();},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null;},refresh:function(){this._draw();},suspend:function(){_ba.forEach(this._getAllGraphics(),function(g){g.hide();});},resume:function(){_ba.forEach(this._getAllGraphics(),function(g){g.show();});this._draw();},_init:function(){this._draw();},_cleanUp:function(){if(this._connects){_ba.forEach(this._connects,_bb.disconnect);}var _cc=this._toolbar._scratchGL;if(this._anchors){_ba.forEach(this._anchors,function(_cd){_cc.remove(_cd.graphic);var mov=_cd.moveable;if(mov){mov.destroy();}});}if(this._box){_cc.remove(this._box);}this._box=this._anchors=this._connects=null;},_draw:function(){if(!this._graphic.getDojoShape()){this._cleanUp();return;}var map=this._map,_ce=this._toolbar._scratchGL;var _cf=this._getBoxCoords();var _d0=new _c2(map.spatialReference);var _d1=_b9.clone(_ba.filter(_cf,function(pt,_d2){return (_d2!==8&&_d2%2===0);}));if(_d1[0]){_d1.push([_d1[0][0],_d1[0][1]]);}_d0.addPath(_d1);if(this._rotate){_d0.addPath([_cf[1],_cf[8]]);}if(this._box){this._box.setGeometry(_d0);}else{this._box=new _c5(_d0,this._lineSymbol);_ce.add(this._box);}if(this._anchors){_ba.forEach(this._anchors,function(_d3,_d4){if(!this._scale){_d4=8;}var _d5=new _c1(_cf[_d4],map.spatialReference);_d3.graphic.setGeometry(_d5);var mov=_d3.moveable,_d6=_d3.graphic.getDojoShape();if(_d6){if(!mov){_d3.moveable=this._getMoveable(_d3.graphic,_d4);}else{if(_d6!==mov.shape){mov.destroy();_d3.moveable=this._getMoveable(_d3.graphic,_d4);}}}},this);}else{this._anchors=[];this._connects=[];_ba.forEach(_cf,function(_d7,_d8){if(!this._scale&&_d8<8){return;}_d7=new _c1(_d7,map.spatialReference);var _d9=new _c5(_d7,this._markerSymbol);_ce.add(_d9);this._anchors.push({graphic:_d9,moveable:this._getMoveable(_d9,_d8)});},this);}},_getBoxCoords:function(_da){var _db=this._graphic,map=this._map,_dc=this._getTransformedBoundingBox(_db),_dd=[],pt,_de,_df;_ba.forEach(_dc,function(_e0,_e1,arr){pt=_e0;_de=arr[_e1+1];if(!_de){_de=arr[0];}_df={x:(pt.x+_de.x)/2,y:(pt.y+_de.y)/2};if(!_da){pt=map.toMap(pt);_df=map.toMap(_df);}_dd.push([pt.x,pt.y]);_dd.push([_df.x,_df.y]);});if(this._rotate){var _e2=_b9.clone(_dd[1]);_e2=_da?{x:_e2[0],y:_e2[1]}:map.toScreen({x:_e2[0],y:_e2[1],spatialReference:map.spatialReference});_e2.y-=this._toolbar._options.rotateHandleOffset;if(!_da){_e2=map.toMap(_e2);}_dd.push([_e2.x,_e2.y]);}return _dd;},_getTransformedBoundingBox:function(_e3){var map=this._map,_e4=_e3.geometry.getExtent(),_e5=_e3.geometry.spatialReference,_e6=new _c1(_e4.xmin,_e4.ymax,_e5),_e7=new _c1(_e4.xmax,_e4.ymin,_e5);_e6=map.toScreen(_e6);_e7=map.toScreen(_e7);return [{x:_e6.x,y:_e6.y},{x:_e7.x,y:_e6.y},{x:_e7.x,y:_e7.y},{x:_e6.x,y:_e7.y}];},_getAllGraphics:function(){var _e8=[this._box];if(this._anchors){_ba.forEach(this._anchors,function(_e9){_e8.push(_e9.graphic);});}_e8=_ba.filter(_e8,_c0.isDefined);return _e8;},_getMoveable:function(_ea,_eb){var _ec=_ea.getDojoShape();if(!_ec){return;}var _ed=new _bd(_ec);_ed._index=_eb;this._connects.push(_bb.connect(_ed,"onMoveStart",this._moveStartHandler));this._connects.push(_bb.connect(_ed,"onFirstMove",this._firstMoveHandler));this._connects.push(_bb.connect(_ed,"onMoveStop",this._moveStopHandler));_ed.onMove=this._moveHandler;var _ee=_ec.getEventSource();if(_ee){_bc.set(_ee,"cursor",this._toolbar._cursors["box"+_eb]);}return _ed;},_moveStartHandler:function(_ef){this._toolbar["on"+(_ef.host._index===8?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic);},_firstMoveHandler:function(_f0){var _f1=_f0.host._index,_f2=(this._wrapOffset=_f0.host.shape._wrapOffsets[0]||0),_f3=this._graphic.getLayer()._div.getTransform(),mx=_be,_f4,_f5,_f6,_f7=_ba.map(this._getBoxCoords(true),function(arr){return {x:arr[0]+_f2,y:arr[1]};});_f6={x:_f7[1].x,y:_f7[3].y};this._centerCoord=mx.multiplyPoint(mx.invert(_f3),_f6);if(_f1===8){_f4=mx.multiplyPoint(mx.invert(_f3),_f7[1]);this._startLine=[this._centerCoord,_f4];this._moveLine=_b9.clone(this._startLine);}else{_f4=mx.multiplyPoint(mx.invert(_f3),_f7[_f1]);_f5=mx.multiplyPoint(mx.invert(_f3),_f7[(_f1+4)%8]);this._firstMoverToCenter=Math.sqrt((_f4.x-this._centerCoord.x)*(_f4.x-this._centerCoord.x)+(_f4.y-this._centerCoord.y)*(_f4.y-this._centerCoord.y));this._startBox=_f5;this._startBox.width=(_f7[4].x-_f7[0].x);this._startBox.height=(_f7[4].y-_f7[0].y);this._moveBox=_b9.clone(this._startBox);this._xfactor=_f4.x>_f5.x?1:-1;this._yfactor=_f4.y>_f5.y?1:-1;if(_f1===1||_f1===5){this._xfactor=0;}else{if(_f1===3||_f1===7){this._yfactor=0;}}}this._toolbar._beginOperation("BOX");this._toolbar["on"+(_f1===8?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic);},_moveHandler:function(_f8,_f9){var _fa=_f8.host._index,_fb=this._defaultEventArgs,_fc,_fd,tx,pt,_fe,_ff,_100,_101=0,_102=0,_103,_104,_105;_fb.angle=0;_fb.scaleX=1;_fb.scaleY=1;if(_fa===8){_fc=this._startLine;_fd=this._moveLine;pt=_fd[1];pt.x+=_f9.dx;pt.y+=_f9.dy;_fe=this._getAngle(_fc,_fd);tx=_be.rotategAt(_fe,_fc[0]);this._graphic.getDojoShape().setTransform(tx);_fb.transform=tx;_fb.angle=_fe;_fb.around=_fc[0];}else{_fc=this._startBox;_fd=this._moveBox;_fd.width+=(_f9.dx*this._xfactor);_fd.height+=(_f9.dy*this._yfactor);if(this._uniformScaling){_103=_fd.x+this._xfactor*_fd.width;_104=_fd.y+this._yfactor*_fd.height;_105=Math.sqrt((_103-this._centerCoord.x)*(_103-this._centerCoord.x)+(_104-this._centerCoord.y)*(_104-this._centerCoord.y));_ff=_100=_105/this._firstMoverToCenter;_101=this._xfactor*_fc.width/2;_102=this._yfactor*_fc.height/2;}else{_ff=_fd.width/_fc.width;_100=_fd.height/_fc.height;}if(isNaN(_ff)||_ff===Infinity||_ff===-Infinity){_ff=1;}if(isNaN(_100)||_100===Infinity||_100===-Infinity){_100=1;}tx=_be.scaleAt(_ff,_100,_fc.x+_101,_fc.y+_102);this._graphic.getDojoShape().setTransform(tx);_fb.transform=tx;_fb.scaleX=_ff;_fb.scaleY=_100;_fb.around={x:_fc.x+_101,y:_fc.y+_102};}this._toolbar["on"+(_fa===8?this._rotateEvent:this._scaleEvent)](this._graphic,_fb);},_moveStopHandler:function(_106){var _107=this._graphic,_108=this._toolbar,_109=_108._geo?_c3.geographicToWebMercator(_107.geometry):_107.geometry,_10a=_109.spatialReference,_10b=_107.getDojoShape(),_10c=_10b.getTransform(),_10d=_107.getLayer()._div.getTransform();_109=_109.toJson();this._updateSegments(_109.paths||_109.rings,_10c,_10d,_10a);_10b.setTransform(null);_109=_c4.fromJson(_109);_107.setGeometry(_108._geo?_c3.webMercatorToGeographic(_109,true):_109);this._draw();this._startBox=this._moveBox=this._xfactor=this._yfactor=null;this._startLine=this._moveLine=null;_108._endOperation("BOX");this._defaultEventArgs.transform=_10c;_108["on"+(_106.host._index===8?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs);},_updateSegments:function(_10e,_10f,_110,_111){var mx=_be,map=this._map,_112=this._wrapOffset||0;_ba.forEach(_10e,function(_113){_ba.forEach(_113,function(_114){var _115=map.toScreen({x:_114[0],y:_114[1],spatialReference:_111},true);_115.x+=_112;_115=mx.multiplyPoint([_110,_10f,mx.invert(_110)],_115);_115.x-=_112;var _116=map.toMap(_115);_114[0]=_116.x;_114[1]=_116.y;});});},_getAngle:function(_117,_118){var _119=Math.atan2(_117[0].y-_117[1].y,_117[0].x-_117[1].x)*180/Math.PI,_11a=Math.atan2(_118[0].y-_118[1].y,_118[0].x-_118[1].x)*180/Math.PI;return _11a-_119;}});if(has("extend-esri")){_b9.setObject("toolbars._Box",BOX,_bf);}return BOX;});},"esri/dijit/editing/TemplatePickerItem":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/sniff","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojox/gfx","esri/symbols/jsonUtils","esri/kernel"],function(_11b,lang,_11c,has,_11d,_11e,_11f,_120,gfx,_121,_122){var TPI=_11b([_11f,_120],{declaredClass:"esri.dijit.editing.TemplatePickerItem",templateString:"<div class='item' style='text-align: center;'>"+"<div class='itemSymbol' dojoAttachPoint='_surfaceNode'></div>"+"<div class='itemLabel'>${label}</div>"+"</div>",startup:function(){if(this._started){return;}this.inherited(arguments);this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);},_draw:function(node,_123,_124,_125,_126){if(!_123){return;}var _127=gfx.createSurface(node,_124,_125);if(has("ie")<9){var _128=_127.getEventSource();_11e.set(_128,"position","relative");_11e.set(_128.parentNode,"position","relative");}var _129=(!this.legendOverride&&this._getDrawingToolShape(_123,_126))||_121.getShapeDescriptors(_123);var _12a;try{_12a=_127.createShape(_129.defaultShape).setFill(_129.fill).setStroke(_129.stroke);}catch(e){_127.clear();_127.destroy();return;}var bbox=_12a.getBoundingBox(),_12b=bbox.width,_12c=bbox.height,_12d=-(bbox.x+(_12b/2)),_12e=-(bbox.y+(_12c/2)),dim=_127.getDimensions(),_12f={dx:_12d+dim.width/2,dy:_12e+dim.height/2};if(_12b>_124||_12c>_125){var _130=_12b>_12c?_12b:_12c;var _131=_124<_125?_124:_125;var _132=(_131-5)/_130;lang.mixin(_12f,{xx:_132,yy:_132});}_12a.applyTransform(_12f);return _127;},_getDrawingToolShape:function(_133,_134){var _135,_136=_134?_134.drawingTool||null:null;switch(_136){case "esriFeatureEditToolArrow":_135={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":_135={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":_135={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":_135={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};break;case "esriFeatureEditToolDownArrow":_135={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":_135={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":_135={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":_135={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":_135={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":if(_133.type==="simplelinesymbol"||_133.type==="cartographiclinesymbol"){_135={type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"};}else{_135={type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};}break;default:return null;}return {defaultShape:_135,fill:_133.getFill(),stroke:_133.getStroke()};},_repaint:function(_137){if(!_137){this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);return;}if(_137.getStroke&&_137.setStroke){_137.setStroke(_137.getStroke());}if(_137.getFill&&_137.setFill){_137.setFill(_137.getFill());}if(_137.children&&lang.isArray(_137.children)){_11c.forEach(_137.children,this._repaint,this);}},destroy:function(){if(this._surface){this._surface.destroy();delete this._surface;}this.inherited(arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.TemplatePickerItem",TPI,_122);}return TPI;});},"dojox/grid/_View":function(){require({cache:{"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n"}});define("dojox/grid/_View",["dojo","dijit/registry","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/sniff","dojo/query","dojo/_base/window","dojo/text!./resources/View.html","dojo/dnd/Source","dijit/_Widget","dijit/_TemplatedMixin","dojox/html/metrics","./util","dojo/_base/html","./_Builder","dojo/dnd/Avatar","dojo/dnd/Manager"],function(dojo,_138,_139,_13a,_13b,lang,_13c,has,_13d,win,_13e,_13f,_140,_141,_142,util,html,_143,_144,_145){var _146=function(_147,_148){return _147.style.cssText==undefined?_147.getAttribute("style"):_147.style.cssText;};var _149=_13a("dojox.grid._View",[_140,_141],{defaultWidth:"18em",viewWidth:"",templateString:_13e,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:_143._HeaderBuilder,_contentBuilderClass:_143._ContentBuilder,postMixInProperties:function(){this.rowNodes={};},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");util.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);util.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);if(!this.grid.isLeftToRight()){this.headerNodeContainer.style.width="";}},destroy:function(){html.destroy(this.headerNode);delete this.headerNode;for(var i in this.rowNodes){this._cleanupRowWidgets(this.rowNodes[i]);html.destroy(this.rowNodes[i]);}this.rowNodes={};if(this.source){this.source.destroy();}this.inherited(arguments);},focus:function(){if(has("ie")||has("webkit")||has("opera")){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_14a){var vs=(this.structure=_14a);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||(vs.noscroll?"auto":this.viewWidth);}this._onBeforeRow=vs.onBeforeRow||function(){};this._onAfterRow=vs.onAfterRow||function(){};this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.simpleStructure=Boolean(vs.cells.length==1);this.testFlexCells();this.updateStructure();},_cleanupRowWidgets:function(_14b){if(_14b){_13b.forEach(_13d("[widgetId]",_14b).map(_138.byNode),function(w){if(w._destroyOnRemove){w.destroy();delete w;}else{if(w.domNode&&w.domNode.parentNode){w.domNode.parentNode.removeChild(w.domNode);}}});}},onBeforeRow:function(_14c,_14d){this._onBeforeRow(_14c,_14d);if(_14c>=0){this._cleanupRowWidgets(this.getRowNode(_14c));}},onAfterRow:function(_14e,_14f,_150){this._onAfterRow(_14e,_14f,_150);var g=this.grid;_13b.forEach(_13d(".dojoxGridStubNode",_150),function(n){if(n&&n.parentNode){var lw=n.getAttribute("linkWidget");var _151=window.parseInt(html.attr(n,"cellIdx"),10);var _152=g.getCell(_151);var w=_138.byId(lw);if(w){n.parentNode.replaceChild(w.domNode,n);if(!w._started){w.startup();}dojo.destroy(n);}else{n.innerHTML="";}}},this);},testFlexCells:function(){this.flexCells=false;for(var j=0,row;(row=this.structure.cells[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.view=this;this.flexCells=this.flexCells||cell.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){var _153=this.hasVScrollbar();var _154=html.style(this.scrollboxNode,"overflow");if(this.noscroll||!_154||_154=="hidden"){_153=false;}else{if(_154=="scroll"){_153=true;}}return (_153?_142.getScrollbar().w:0);},getColumnsWidth:function(){var h=this.headerContentNode;return h&&h.firstChild?(h.firstChild.offsetWidth||html.style(h.firstChild,"width")):0;},setColumnsWidth:function(_155){this.headerContentNode.firstChild.style.width=_155+"px";if(this.viewWidth){this.viewWidth=_155+"px";}},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,html._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();if(this._togglingColumn>=0){this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn);this._togglingColumn=-1;}var _156=this.grid.layout.cells;var _157=lang.hitch(this,function(node,_158){!this.grid.isLeftToRight()&&(_158=!_158);var inc=_158?-1:1;var idx=this.header.getCellNodeIndex(node)+inc;var cell=_156[idx];while(cell&&cell.getHeaderNode()&&cell.getHeaderNode().style.display=="none"){idx+=inc;cell=_156[idx];}if(cell){return cell.getHeaderNode();}return null;});if(this.grid.columnReordering&&this.simpleStructure){if(this.source){this.source.destroy();}var _159="dojoxGrid_bottomMarker";var _15a="dojoxGrid_topMarker";if(this.bottomMarker){html.destroy(this.bottomMarker);}this.bottomMarker=html.byId(_159);if(this.topMarker){html.destroy(this.topMarker);}this.topMarker=html.byId(_15a);if(!this.bottomMarker){this.bottomMarker=html.create("div",{"id":_159,"class":"dojoxGridColPlaceBottom"},win.body());this._hide(this.bottomMarker);this.topMarker=html.create("div",{"id":_15a,"class":"dojoxGridColPlaceTop"},win.body());this._hide(this.topMarker);}this.arrowDim=html.contentBox(this.bottomMarker);var _15b=html.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new _13f(this.headerContentNode.firstChild.rows[0],{horizontal:true,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:false,onMouseDown:lang.hitch(this,function(e){this.header.decorateEvent(e);if((this.header.overRightResizeArea(e)||this.header.overLeftResizeArea(e))&&this.header.canResize(e)&&!this.header.moveable){this.header.beginColumnResize(e);}else{if(this.grid.headerMenu){this.grid.headerMenu.onCancel(true);}if(e.button===(has("ie")<9?1:0)){_13f.prototype.onMouseDown.call(this.source,e);}}}),onMouseOver:lang.hitch(this,function(e){var src=this.source;if(src._getChildByEvent(e)){_13f.prototype.onMouseOver.apply(src,arguments);}}),_markTargetAnchor:lang.hitch(this,function(_15c){var src=this.source;if(src.current==src.targetAnchor&&src.before==_15c){return;}if(src.targetAnchor&&_157(src.targetAnchor,src.before)){src._removeItemClass(_157(src.targetAnchor,src.before),src.before?"After":"Before");}_13f.prototype._markTargetAnchor.call(src,_15c);var _15d=_15c?src.targetAnchor:_157(src.targetAnchor,src.before);var _15e=0;if(!_15d){_15d=src.targetAnchor;_15e=html.contentBox(_15d).w+this.arrowDim.w/2+2;}var pos=html.position(_15d,true);var left=Math.floor(pos.x-this.arrowDim.w/2+_15e);html.style(this.bottomMarker,"visibility","visible");html.style(this.topMarker,"visibility","visible");html.style(this.bottomMarker,{"left":left+"px","top":(_15b+pos.y)+"px"});html.style(this.topMarker,{"left":left+"px","top":(pos.y-this.arrowDim.h)+"px"});if(src.targetAnchor&&_157(src.targetAnchor,src.before)){src._addItemClass(_157(src.targetAnchor,src.before),src.before?"After":"Before");}}),_unmarkTargetAnchor:lang.hitch(this,function(){var src=this.source;if(!src.targetAnchor){return;}if(src.targetAnchor&&_157(src.targetAnchor,src.before)){src._removeItemClass(_157(src.targetAnchor,src.before),src.before?"After":"Before");}this._hide(this.bottomMarker);this._hide(this.topMarker);_13f.prototype._unmarkTargetAnchor.call(src);}),destroy:lang.hitch(this,function(){_13c.disconnect(this._source_conn);_13c.unsubscribe(this._source_sub);_13f.prototype.destroy.call(this.source);if(this.bottomMarker){html.destroy(this.bottomMarker);delete this.bottomMarker;}if(this.topMarker){html.destroy(this.topMarker);delete this.topMarker;}}),onDndCancel:lang.hitch(this,function(){_13f.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker);})});this._source_conn=_13c.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=_13c.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup();}},_hide:function(node){html.style(node,{top:"-10000px","visibility":"hidden"});},_onDndDropBefore:function(_15f,_160,copy){if(_145.manager().target!==this.source){return;}this.source._targetNode=this.source.targetAnchor;this.source._beforeTarget=this.source.before;var _161=this.grid.views.views;var _162=_161[_15f.viewIndex];var _163=_161[this.index];if(_163!=_162){_162.convertColPctToFixed();_163.convertColPctToFixed();}},_onDndDrop:function(_164,_165,copy){if(_145.manager().target!==this.source){if(_145.manager().source===this.source){this._removingColumn=true;}return;}this._hide(this.bottomMarker);this._hide(this.topMarker);var _166=function(n){return n?html.attr(n,"idx"):null;};var w=html.marginBox(_165[0]).w;if(_164.viewIndex!==this.index){var _167=this.grid.views.views;var _168=_167[_164.viewIndex];var _169=_167[this.index];if(_168.viewWidth&&_168.viewWidth!="auto"){_168.setColumnsWidth(_168.getColumnsWidth()-w);}if(_169.viewWidth&&_169.viewWidth!="auto"){_169.setColumnsWidth(_169.getColumnsWidth());}}var stn=this.source._targetNode;var stb=this.source._beforeTarget;!this.grid.isLeftToRight()&&(stb=!stb);var _16a=this.grid.layout;var idx=this.index;delete this.source._targetNode;delete this.source._beforeTarget;_16a.moveColumn(_164.viewIndex,idx,_166(_165[0]),_166(stn),stb);},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}util.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode]);},_getHeaderContent:function(_16b){var n=_16b.name||_16b.grid.getCellName(_16b);if(/^\s+$/.test(n)){n="&nbsp;";}var ret=["<div class=\"dojoxGridSortNode"];if(_16b.index!=_16b.grid.getSortIndex()){ret.push("\">");}else{ret=ret.concat([" ",_16b.grid.sortInfo>0?"dojoxGridSortUp":"dojoxGridSortDown","\"><div class=\"dojoxGridArrowButtonChar\">",_16b.grid.sortInfo>0?"&#9650;":"&#9660;","</div><div class=\"dojoxGridArrowButtonNode\" role=\"presentation\"></div>","<div class=\"dojoxGridColCaption\">"]);}ret=ret.concat([n,"</div></div>"]);return ret.join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasHScrollbar:function(_16c){var _16d=this._hasHScroll||false;if(this._hasHScroll==undefined||_16c){if(this.noscroll){this._hasHScroll=false;}else{var _16e=html.style(this.scrollboxNode,"overflow");if(_16e=="hidden"){this._hasHScroll=false;}else{if(_16e=="scroll"){this._hasHScroll=true;}else{this._hasHScroll=(this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);}}}}if(_16d!==this._hasHScroll){this.grid.update();}return this._hasHScroll;},hasVScrollbar:function(_16f){var _170=this._hasVScroll||false;if(this._hasVScroll==undefined||_16f){if(this.noscroll){this._hasVScroll=false;}else{var _171=html.style(this.scrollboxNode,"overflow");if(_171=="hidden"){this._hasVScroll=false;}else{if(_171=="scroll"){this._hasVScroll=true;}else{this._hasVScroll=(this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);}}}}if(_170!==this._hasVScroll){this.grid.update();}return this._hasVScroll;},convertColPctToFixed:function(){var _172=false;this.grid.initialWidth="";var _173=_13d("th",this.headerContentNode);var _174=_13b.map(_173,function(c,vIdx){var w=c.style.width;html.attr(c,"vIdx",vIdx);if(w&&w.slice(-1)=="%"){_172=true;}else{if(w&&w.slice(-2)=="px"){return window.parseInt(w,10);}}return html.contentBox(c).w;});if(_172){_13b.forEach(this.grid.layout.cells,function(cell,idx){if(cell.view==this){var _175=cell.view.getHeaderCellNode(cell.index);if(_175&&html.hasAttr(_175,"vIdx")){var vIdx=window.parseInt(html.attr(_175,"vIdx"));this.setColWidth(idx,_174[vIdx]);html.removeAttr(_175,"vIdx");}}},this);return true;}return false;},adaptHeight:function(_176){if(!this.grid._autoHeight){var h=(this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10))||this.domNode.clientHeight;var self=this;var _177=function(){var v;for(var i in self.grid.views.views){v=self.grid.views.views[i];if(v!==self&&v.hasHScrollbar()){return true;}}return false;};if(_176||(this.noscroll&&_177())){h-=_142.getScrollbar().h;}util.setStyleHeightPx(this.scrollboxNode,h);}this.hasVScrollbar(true);},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();if(!this._removingColumn){w=Math.max(w,this.getColumnsWidth())+"px";}else{w=Math.min(w,this.getColumnsWidth())+"px";this._removingColumn=false;}var cn=this.contentNode;cn.style.width=w;this.hasHScrollbar(true);},setSize:function(w,h){var ds=this.domNode.style;var hs=this.headerNode.style;if(w){ds.width=w;hs.width=w;}ds.height=(h>=0?h+"px":"");},renderRow:function(_178){var _179=this.createRowNode(_178);this.buildRow(_178,_179);return _179;},createRowNode:function(_17a){var node=document.createElement("div");node.className=this.classTag+"Row";if(this instanceof _139.grid._RowSelector){html.attr(node,"role","presentation");}else{html.attr(node,"role","row");if(this.grid.selectionMode!="none"){node.setAttribute("aria-selected","false");}}node[util.gridViewTag]=this.id;node[util.rowIndexTag]=_17a;this.rowNodes[_17a]=node;return node;},buildRow:function(_17b,_17c){this.buildRowContent(_17b,_17c);this.styleRow(_17b,_17c);},buildRowContent:function(_17d,_17e){_17e.innerHTML=this.content.generateHtml(_17d,_17d);if(this.flexCells&&this.contentWidth){_17e.firstChild.style.width=this.contentWidth;}util.fire(this,"onAfterRow",[_17d,this.structure.cells,_17e]);},rowRemoved:function(_17f){if(_17f>=0){this._cleanupRowWidgets(this.getRowNode(_17f));}this.grid.edit.save(this,_17f);delete this.rowNodes[_17f];},getRowNode:function(_180){return this.rowNodes[_180];},getCellNode:function(_181,_182){var row=this.getRowNode(_181);if(row){return this.content.getCellNode(row,_182);}},getHeaderCellNode:function(_183){if(this.headerContentNode){return this.header.getCellNode(this.headerContentNode,_183);}},styleRow:function(_184,_185){_185._style=_146(_185);this.styleRowNode(_184,_185);},styleRowNode:function(_186,_187){if(_187){this.doStyleRowNode(_186,_187);}},doStyleRowNode:function(_188,_189){this.grid.styleRowNode(_188,_189);},updateRow:function(_18a){var _18b=this.getRowNode(_18a);if(_18b){_18b.style.height="";this.buildRow(_18a,_18b);}return _18b;},updateRowStyles:function(_18c){this.styleRowNode(_18c,this.getRowNode(_18c));},lastTop:0,firstScroll:0,_nativeScroll:false,doscroll:function(_18d){if(has("ff")>=13){this._nativeScroll=true;}var _18e=this.grid.isLeftToRight();if(this.firstScroll<2){if((!_18e&&this.firstScroll==1)||(_18e&&this.firstScroll===0)){var s=html.marginBox(this.headerNodeContainer);if(has("ie")){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(has("mozilla")){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";this.scrollboxNode.scrollLeft=_18e?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!==this.lastTop){this.grid.scrollTo(top);}this._nativeScroll=false;},setScrollTop:function(_18f){this.lastTop=_18f;if(!this._nativeScroll){this.scrollboxNode.scrollTop=_18f;}return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_190,_191){this.grid.setCellWidth(_190,_191+"px");},update:function(){if(!this.domNode){return;}this.content.update();this.grid.update();var left=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=left;this.headerNode.scrollLeft=left;}});var _192=_13a("dojox.grid._GridAvatar",_144,{construct:function(){var dd=win.doc;var a=dd.createElement("table");a.cellPadding=a.cellSpacing="0";a.className="dojoxGridDndAvatar";a.style.position="absolute";a.style.zIndex=1999;a.style.margin="0px";var b=dd.createElement("tbody");var tr=dd.createElement("tr");var td=dd.createElement("td");var img=dd.createElement("td");tr.className="dojoxGridDndAvatarItem";img.className="dojoxGridDndAvatarItemImage";img.style.width="16px";var _193=this.manager.source,node;if(_193.creator){node=_193._normalizedCreator(_193.getItem(this.manager.nodes[0].id).data,"avatar").node;}else{node=this.manager.nodes[0].cloneNode(true);var _194,_195;if(node.tagName.toLowerCase()=="tr"){_194=dd.createElement("table");_195=dd.createElement("tbody");_195.appendChild(node);_194.appendChild(_195);node=_194;}else{if(node.tagName.toLowerCase()=="th"){_194=dd.createElement("table");_195=dd.createElement("tbody");var r=dd.createElement("tr");_194.cellPadding=_194.cellSpacing="0";r.appendChild(node);_195.appendChild(r);_194.appendChild(_195);node=_194;}}}node.id="";td.appendChild(node);tr.appendChild(img);tr.appendChild(td);html.style(tr,"opacity",0.9);b.appendChild(tr);a.appendChild(b);this.node=a;var m=_145.manager();this.oldOffsetY=m.OFFSET_Y;m.OFFSET_Y=1;},destroy:function(){_145.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments);}});var _196=_145.manager().makeAvatar;_145.manager().makeAvatar=function(){var src=this.source;if(src.viewIndex!==undefined&&!html.hasClass(win.body(),"dijit_a11y")){return new _192(this);}return _196.call(_145.manager());};return _149;});},"dijit/Menu":function(){define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(_197,_198,_199,_19a,dom,_19b,_19c,_19d,keys,lang,on,has,win,_19e,pm,_19f,_1a0){if(has("dijit-legacy-requires")){_1a0(0,function(){var _1a1=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];_197(_1a1);});}return _199("dijit.Menu",_19f,{constructor:function(){this._bindings=[];},targetNodeIds:[],selector:"",contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(this.ownerDocumentBody);}else{_198.forEach(this.targetNodeIds,this.bindDomNode,this);}this.inherited(arguments);},_iframeContentWindow:function(_1a2){return _19e.get(this._iframeContentDocument(_1a2))||this._iframeContentDocument(_1a2)["__parent__"]||(_1a2.name&&win.doc.frames[_1a2.name])||null;},_iframeContentDocument:function(_1a3){return _1a3.contentDocument||(_1a3.contentWindow&&_1a3.contentWindow.document)||(_1a3.name&&win.doc.frames[_1a3.name]&&win.doc.frames[_1a3.name].document)||null;},bindDomNode:function(node){node=dom.byId(node,this.ownerDocument);var cn;if(node.tagName.toLowerCase()=="iframe"){var _1a4=node,_1a5=this._iframeContentWindow(_1a4);cn=win.body(_1a5.document);}else{cn=(node==win.body(this.ownerDocument)?this.ownerDocument.documentElement:node);}var _1a6={node:node,iframe:_1a4};_19b.set(node,"_dijitMenu"+this.id,this._bindings.push(_1a6));var _1a7=lang.hitch(this,function(cn){var _1a8=this.selector,_1a9=_1a8?function(_1aa){return on.selector(_1a8,_1aa);}:function(_1ab){return _1ab;},self=this;return [on(cn,_1a9(this.leftClickToOpen?"click":"contextmenu"),function(evt){_19a.stop(evt);self._scheduleOpen(this,_1a4,{x:evt.pageX,y:evt.pageY});}),on(cn,_1a9("keydown"),function(evt){if(evt.shiftKey&&evt.keyCode==keys.F10){_19a.stop(evt);self._scheduleOpen(this,_1a4);}})];});_1a6.connects=cn?_1a7(cn):[];if(_1a4){_1a6.onloadHandler=lang.hitch(this,function(){var _1ac=this._iframeContentWindow(_1a4);cn=win.body(_1ac.document);_1a6.connects=_1a7(cn);});if(_1a4.addEventListener){_1a4.addEventListener("load",_1a6.onloadHandler,false);}else{_1a4.attachEvent("onload",_1a6.onloadHandler);}}},unBindDomNode:function(_1ad){var node;try{node=dom.byId(_1ad,this.ownerDocument);}catch(e){return;}var _1ae="_dijitMenu"+this.id;if(node&&_19b.has(node,_1ae)){var bid=_19b.get(node,_1ae)-1,b=this._bindings[bid],h;while((h=b.connects.pop())){h.remove();}var _1af=b.iframe;if(_1af){if(_1af.removeEventListener){_1af.removeEventListener("load",b.onloadHandler,false);}else{_1af.detachEvent("onload",b.onloadHandler);}}_19b.remove(node,_1ae);delete this._bindings[bid];}},_scheduleOpen:function(_1b0,_1b1,_1b2){if(!this._openTimer){this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:_1b0,iframe:_1b1,coords:_1b2});},1);}},_openMyself:function(args){var _1b3=args.target,_1b4=args.iframe,_1b5=args.coords;this.currentTarget=_1b3;if(_1b5){if(_1b4){var ifc=_19c.position(_1b4,true),_1b6=this._iframeContentWindow(_1b4),_1b7=_19c.docScroll(_1b6.document);var cs=_19d.getComputedStyle(_1b4),tp=_19d.toPixelValue,left=(has("ie")&&has("quirks")?0:tp(_1b4,cs.paddingLeft))+(has("ie")&&has("quirks")?tp(_1b4,cs.borderLeftWidth):0),top=(has("ie")&&has("quirks")?0:tp(_1b4,cs.paddingTop))+(has("ie")&&has("quirks")?tp(_1b4,cs.borderTopWidth):0);_1b5.x+=ifc.x+left-_1b7.x;_1b5.y+=ifc.y+top-_1b7.y;}}else{_1b5=_19c.position(_1b3,true);_1b5.x+=10;_1b5.y+=10;}var self=this;var _1b8=this._focusManager.get("prevNode");var _1b9=this._focusManager.get("curNode");var _1ba=!_1b9||(dom.isDescendant(_1b9,this.domNode))?_1b8:_1b9;function _1bb(){if(self.refocus&&_1ba){_1ba.focus();}pm.close(self);};pm.open({popup:this,x:_1b5.x,y:_1b5.y,onExecute:_1bb,onCancel:_1bb,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);pm.close(this);};},destroy:function(){_198.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});});},"dijit/CheckedMenuItem":function(){require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n"}});define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_1bc,_1bd,_1be,_1bf){return _1bc("dijit.CheckedMenuItem",_1be,{templateString:_1bf,checked:false,_setCheckedAttr:function(_1c0){_1bd.toggle(this.domNode,"dijitCheckedMenuItemChecked",_1c0);this.domNode.setAttribute("aria-checked",_1c0?"true":"false");this._set("checked",_1c0);},iconClass:"",onChange:function(){},_onClick:function(evt){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.onClick(evt);}});});},"dijit/_MenuBase":function(){define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./popup","./registry","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_1c1,_1c2,dom,_1c3,_1c4,lang,_1c5,on,_1c6,_1c7,pm,_1c8,_1c9,_1ca,_1cb){return _1c2("dijit._MenuBase",[_1c9,_1cb,_1ca],{parentMenu:null,popupDelay:500,autoFocus:false,childSelector:function(node){var _1cc=_1c8.byNode(node);return node.parentNode==this.containerNode&&_1cc&&_1cc.focus;},postCreate:function(){var self=this,_1cd=typeof this.childSelector=="string"?this.childSelector:lang.hitch(this,"childSelector");this.own(on(this.containerNode,on.selector(_1cd,_1c5.enter),function(){self.onItemHover(_1c8.byNode(this));}),on(this.containerNode,on.selector(_1cd,_1c5.leave),function(){self.onItemUnhover(_1c8.byNode(this));}),on(this.containerNode,on.selector(_1cd,_1c7),function(evt){self.onItemClick(_1c8.byNode(this),evt);evt.stopPropagation();evt.preventDefault();}));this.inherited(arguments);},onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.onItemClick(this.focusedChild,evt);}else{var _1ce=this._getTopMenu();if(_1ce&&_1ce._isMenuBar){_1ce.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _1cf=this.currentPopup.parentMenu;if(_1cf.focusedChild){_1cf.focusedChild._setSelected(false);}_1cf.focusedChild=this.currentPopup.from_item;_1cf.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=this.defer("_openPopup",this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;item._set("hovering",true);},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _1d0=item.popup;if(_1d0){this._stopPendingCloseTimer(_1d0);_1d0._pendingClose_timer=this.defer(function(){_1d0._pendingClose_timer=null;if(_1d0.parentMenu){_1d0.parentMenu.currentPopup=null;}pm.close(_1d0);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}item._set("hovering",false);},_stopPopupTimer:function(){if(this.hover_timer){this.hover_timer=this.hover_timer.remove();}},_stopPendingCloseTimer:function(_1d1){if(_1d1._pendingClose_timer){_1d1._pendingClose_timer=_1d1._pendingClose_timer.remove();}},_stopFocusTimer:function(){if(this._focus_timer){this._focus_timer=this._focus_timer.remove();}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup(evt.type=="keypress");}else{this.onExecute();item._onClick?item._onClick(evt):item.onClick(evt);}},_openPopup:function(_1d2){this._stopPopupTimer();var _1d3=this.focusedChild;if(!_1d3){return;}var _1d4=_1d3.popup;if(!_1d4.isShowingNow){if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_1d4.parentMenu=this;_1d4.from_item=_1d3;var self=this;pm.open({parent:this,popup:_1d4,around:_1d3.domNode,orient:this._orient||["after","before"],onCancel:function(){self.focusChild(_1d3);self._cleanUp();_1d3._setSelected(true);self.focusedChild=_1d3;},onExecute:lang.hitch(this,"_cleanUp")});this.currentPopup=_1d4;_1d4.connect(_1d4.domNode,"onmouseenter",lang.hitch(self,"_onPopupHover"));}if(_1d2&&_1d4.focus){_1d4._focus_timer=this.defer(lang.hitch(_1d4,function(){this._focus_timer=null;this.focus();}));}},_markActive:function(){this.isActive=true;_1c4.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_1c4.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_1c1.indexOf(this._focusManager.activeStack,this.id)>=0){_1c3.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.onItemUnhover(this.focusedChild);this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this.onItemUnhover(this._hoveredChild);}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});},"esri/dijit/editing/TemplatePicker":function(){define(["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/html","dojo/_base/array","dojo/_base/json","dojo/_base/kernel","dojo/has","dojo/query","dojo/sniff","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojo/data/ItemFileReadStore","dojox/grid/DataGrid","dojox/gfx","esri/layers/FeatureLayer","esri/symbols/PictureMarkerSymbol","esri/dijit/editing/TemplatePickerItem","esri/kernel","esri/lang","esri/request","esri/dijit/_EventedWidget","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/editing/templates/TemplatePicker.html"],function(_1d5,_1d6,lang,_1d7,html,_1d8,_1d9,_1da,has,_1db,_1dc,_1dd,_1de,_1df,_1e0,_1e1,_1e2,_1e3,_1e4,gfx,_1e5,_1e6,_1e7,_1e8,_1e9,_1ea,_1eb,_1ec,_1ed){var TP=_1d6([_1eb,_1e1,_1e2],{declaredClass:"esri.dijit.editing.TemplatePicker",widgetsInTemplate:true,templateString:_1ed,basePath:_1d5.toUrl("esri/dijit/editing")+"/",featureLayers:null,items:null,grouping:true,showTooltip:false,maxLabelLength:0,rows:4,_rows:0,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:true,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(_1ee,_1ef){_1ee=_1ee||{};if(!_1ee.items&&!_1ee.featureLayers){console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");}this._dojo14x=(_1da.version.minor>=4);this._itemWidgets={};if(_1ee.featureLayers&&_1ee.featureLayers.length){this._flChanged=1;}this._nls=_1ec.widgets.templatePicker;this.emptyMessage=_1ee.emptyMessage||(this._nls&&this._nls.creationDisabled)||"";},postMixInProperties:function(){this.inherited(arguments);this._preprocess();},startup:function(){this.inherited(arguments);if(this.rows==="auto"&&this.columns==="auto"){var box=_1df.getContentBox(this.domNode);if(!box.w){this.domNode.style.width=this._initialAutoWidth+"px";}if(!box.h){this.domNode.style.height=this._initialAutoHeight+"px";}box=_1df.getContentBox(this.domNode);this._columns=Math.floor(box.w/this._assumedCellWidth)||1;}this._applyGridPatches();this._setGridLayout();_1d7.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();if(has("ie")<9){this._repaintItems=lang.hitch(this,this._repaintItems);setTimeout(this._repaintItems,this._ieTimer);}},destroy:function(){this.showTooltip=false;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments);},getSelected:function(){return this._selectedCell?this._selectedItem:null;},clearSelection:function(){var _1f0=this._selectedCell,info=this._selectedInfo;if(_1f0){this._rowClicked({cellNode:_1f0,rowIndex:info.selRow,cellIndex:info.selCol});}},update:function(_1f1){var _1f2=(this.rows==="auto"&&this.columns==="auto"&&_1f1)?true:false,grid=this.grid,box;if(_1f2){var _1f3=this.domNode,id=_1f3.id,_1f4,item=_1da.query("#"+id+".templatePicker div.item")[0];box=_1df.getContentBox(_1f3);item=item&&item.parentNode;if(item){_1f4=html.coords(item).w;}else{_1f4=this._assumedCellWidth;}this._columns=Math.floor((box.w-grid.views.views[0].getScrollbarWidth())/_1f4);this._columns=this._columns||1;}var _1f5=this._rows;this._preprocess();var _1f6=this._rows;this._setGridLayout();this._setGridData();if(_1f6!==_1f5){grid.set("autoHeight",this._rows,false);}if(_1f2){grid._resize({w:box.w,h:box.h});grid.viewsHeaderNode.style.display="none";}else{grid.update();}this._toggleTooltip();var self=this,_1f7=this.getSelected();if(_1f7){grid.store.fetch({onComplete:function(its){var _1f8=self._locate(_1f7,self._selectedInfo,its);var _1f9=_1f8&&grid.views.views[0].getCellNode(_1f8[0],_1f8[1]);if(_1f9){self._rowClicked({cellNode:_1f9,rowIndex:_1f8[0],cellIndex:_1f8[1]},true);}}});}if(has("ie")<9){setTimeout(this._repaintItems,this._ieTimer);}var _1fa=this.featureLayers,_1fb=this.items;if((!_1fa||!_1fa.length)&&(!_1fb||!_1fb.length)&&grid&&this.emptyMessage){grid.showMessage(this.emptyMessage);}},_eventMap:{"selection-change":true},onSelectionChange:function(){},_setUseLegendAttr:function(use){var _1fc=this.useLegend;if(!this._started||_1fc!==use){if(use){this._flChanged=1;}else{this._clearLegendInfo();}}this.useLegend=use;},_setFeatureLayersAttr:function(_1fd){var _1fe=this.featureLayers;if(!this._started||_1fe!==_1fd){this._flChanged=1;}this.featureLayers=_1fd;},_adjustRowsCols:function(_1ff){if(this.rows==="auto"&&this.columns==="auto"){if(!this._started){this._rows=false;this._columns=null;this._autoWidth=false;}return;}var len=0;this._rows=this.rows;this._columns=this.columns;if(this.rows==="auto"){if(this.featureLayers){if(this.grouping){len=_1ff.length;_1d8.forEach(_1ff,function(_200){len+=Math.ceil(_200.length/this.columns);},this);}else{_1d8.forEach(_1ff,function(_201){len+=_201.length;},this);len=Math.ceil(len/this.columns);}}else{len=Math.ceil(_1ff.length/this.columns);}this._rows=len;}else{if(this.columns==="auto"){if(this.featureLayers){if(this.grouping){len=3;}else{_1d8.forEach(_1ff,function(_202){len+=_202.length;},this);len=Math.ceil(len/this.rows);}}else{len=Math.ceil(_1ff.length/this.rows);}this._columns=len;}}},_preprocess:function(){if(this.items){this.grouping=false;}this._autoWidth=false;if(this.rows==="auto"||this.columns==="auto"){this._autoWidth=true;}var _203;if(this.featureLayers){if(this.useLegend&&this._flChanged){this._legendIndices=[];this._loadingIndices=[];this._legendSymbols={};this._ignoreLegends();this._loadingLegends=[];clearTimeout(this._legendTimer);this._legendTimer=null;this._processSelectionLayers();this._flChanged=0;}if(_1d8.every(this.featureLayers,function(_204){return _204.loaded;})){_203=this._flItems=this._getItemsFromLayers(this.featureLayers);this._adjustRowsCols(_203);}else{var _205=this.featureLayers.length;var _206=[];_1d8.forEach(this.featureLayers,function(_207){if(_207.loaded){_205--;_206.push(_207);}else{var _208=_1d7.connect(_207,"onLoad",this,function(_209){_1d7.disconnect(_208);_208=null;_205--;_206.push(_209);if(!_205){_203=this._flItems=this._getItemsFromLayers(_206);this._adjustRowsCols(_203);this.update();}});}},this);}}else{_203=this._itItems=this._getItemsFromItems(this.items);this._adjustRowsCols(_203);}},_processSelectionLayers:function(){var map,_20a,info,_20b,key,_20c,_20d,_20e={};_1d8.forEach(this.featureLayers,function(_20f,idx){if(_20f.mode===_1e5.MODE_SELECTION&&_20f._map&&_20f.url&&_20f._params.drawMode&&!_20f.source){_20a=lang.trim(_20f._url.path).replace(/\/(MapServer|FeatureServer).*/ig,"/MapServer").replace(/^https?:\/\//ig,"").toLowerCase();info=(_20e[_20a]=_20e[_20a]||{});_20b=(info.featureLayers=info.featureLayers||{});_20c=(info.indices=info.indices||[]);_20b[idx]=_20f;_20c.push(idx);map=_20f._map;}});if(map){_1d8.forEach(map.layerIds,function(_210){_210=map.getLayer(_210);if(_210&&_210.url&&(_210.getImageUrl||_210.getTileUrl)&&_210.loaded&&_210.version>=10.1){_20a=lang.trim(_210._url.path).replace(/(\/MapServer).*/ig,"$1");key=_20a.replace(/^https?:\/\//ig,"").toLowerCase();if(_20e[key]&&(!_20e[key].mapServiceUrl)){info=_20e[key];info.mapServiceUrl=_20a;info.mapServiceLayer=_210;this._legendIndices=this._legendIndices.concat(info.indices);_20d=this._fetchLegend({pickerInstance:this,info:info},key);if(_20d.then){this._loadingIndices=this._loadingIndices.concat(info.indices);this._loadingLegends.push(_20d);}else{this._processLegendResponse(_20d,info);}}}},this);}},_fetchLegend:function(_211,key){var _212=TP.prototype,_213=_212.legendCache[key];if(!_213){_213=(_212.legendCache[key]=_1ea({url:_211.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}));_213._contexts=[_211];_213.addBoth(function(_214){if(_213.canceled){return;}_212.legendCache[key]=_214;var _215=_213._contexts;_213._contexts=null;_1d8.forEach(_215,function(ctxt){var _216=ctxt.pickerInstance,info=ctxt.info,_217;if(_216._destroyed){return;}_1d8.forEach(info.indices,function(idx){_217=_1d8.indexOf(_216._loadingIndices,idx);if(_217>-1){_216._loadingIndices.splice(_217,1);}});_217=_1d8.indexOf(_216._loadingLegends,_213);if(_217>-1){_216._loadingLegends.splice(_217,1);}_216._processLegendResponse(_214,info);});});}else{if(_213.then){_213._contexts.push(_211);}}return _213;},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null;},_ignoreLegends:function(){if(this._loadingLegends){_1d8.forEach(this._loadingLegends,function(_218){var _219=-1;_1d8.some(_218._contexts,function(ctxt,idx){if(ctxt.pickerInstance===this){_219=idx;}return (_219>-1);},this);if(_219>-1){_218._contexts.splice(_219,1);}},this);}},_processLegendResponse:function(_21a,info){if(_21a&&!(_21a instanceof Error)){_1d8.forEach(info.indices,function(idx){var _21b=info.featureLayers[idx].layerId,i,_21c=info.mapServiceUrl+"/"+_21b+"/images/",_21d=info.mapServiceLayer._getToken(),_21e,obj,_21f,url;if(this._legendSymbols[idx]){return;}_21e=null;_1d8.some(_21a.layers,function(_220){if(_220.layerId==_21b){_21e=_220;}return !!_21e;});if(_21e){obj=(this._legendSymbols[idx]={});_1d8.forEach(_21e.legend,function(_221){_21f=_221.values;if(_21f&&_21f.length){for(i=0;i<_21f.length;i++){obj[_21f[i]]=_221;}}else{obj.defaultSymbol=_221;}url=_221.url;if(url&&!_221._fixed){_221._fixed=1;if((url.search(/https?\:/)===-1)){_221.url=_21c+url;}if(_21d&&_221.url.search(/https?\:/)!==-1){_221.url+=(((_221.url.indexOf("?")>-1)?"&":"?")+"token="+_21d);}}});}},this);}else{var _222;_1d8.forEach(info.indices,function(idx){_222=_1d8.indexOf(this._legendIndices,idx);if(_222>-1){this._legendIndices.splice(_222,1);}},this);}var self=this;if(self._started&&!self._legendTimer){self._legendTimer=setTimeout(function(){clearTimeout(self._legendTimer);self._legendTimer=null;if(!self._destroyed){self.update();}},0);}},_applyGridPatches:function(){var grid=this.grid;var _223=grid.adaptWidth,_224,i,view;grid.adaptWidth=function(){_224=this.views.views;for(i=0;view=_224[i];i++){_1e0.set(view.headerNode,"display","block");}_223.apply(this,arguments);for(i=0;view=_224[i];i++){_1e0.set(view.headerNode,"display","none");}};if(this._dojo14x){if(this.rows!=="auto"&&this.columns!=="auto"){var _225=_1d7.connect(grid,"_onFetchComplete",this,function(){_1d7.disconnect(_225);this.grid.set("autoHeight",this._rows);});}_1d7.connect(grid,"_onDelete",this,this._destroyItems);_1d7.connect(grid,"_clearData",this,this._destroyItems);_1d7.connect(grid,"destroy",this,this._destroyItems);var _226=grid.focus;if(_226&&_226.findAndFocusGridCell){_226.findAndFocusGridCell=function(){return false;};}}},_setGridLayout:function(){var _227=function(_228){return function(_229,_22a){return this._cellGet(_228,_229,_22a);};};var _22b=lang.hitch(this,this._cellFormatter),_22c=[],cols=this._columns,i;for(i=0;i<cols;i++){_22c.push({field:"cell"+i,get:lang.hitch(this,_227(i)),formatter:_22b});}var _22d={cells:[_22c]};if(this.grouping){var _22e={field:"groupName",colSpan:cols,get:lang.hitch(this,this._cellGetGroup),formatter:lang.hitch(this,this._cellGroupFormatter)};_22d.cells.push([_22e]);}var grid=this.grid,_22f=_1e4.prototype.rowsPerPage;grid.set("rowsPerPage",(this._rows>_22f)?this._rows:_22f);grid.set("structure",_22d);},_setGridData:function(){var _230=[];if(this.grouping){this._groupRowIndices=[];var _231,_232,cols=this._columns;_1d8.forEach(this._flItems,function(_233,idx){_230.push({});var _234=(idx===0)?0:(_231+_232+1);this._groupRowIndices.push(_234);_231=_234;_232=Math.ceil(_233.length/cols);_230=_230.concat(this._getStoreItems(_233));},this);}else{if(this.featureLayers){_1d8.forEach(this._flItems,function(_235){_230=_230.concat(_235);});_230=this._getStoreItems(_230);}else{_230=this._getStoreItems(this._itItems);}}var _236=new _1e3({data:{items:_230}});this.grid.setStore(_236);},_toggleTooltip:function(){if(this.showTooltip){if(this.tooltip){return;}this.tooltip=_1de.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var grid=this.grid;this._mouseOverConnect=_1d7.connect(grid,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=_1d7.connect(grid,"onCellMouseOut",this,this._cellMouseOut);}else{if(this.tooltip){_1d7.disconnect(this._mouseOverConnect);_1d7.disconnect(this._mouseOutConnect);_1de.destroy(this.tooltip);this.tooltip=null;}}},_rowClicked:function(evt,_237){var _238=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_238,row,col);if(!cell){return;}var _239=this.grid.store;if(_239.getValue(cell,"loadingCell")){return;}if(this._selectedCell){_1dd.remove(this._selectedCell,"selectedItem");}if(_238!==this._selectedCell){_1dd.add(_238,"selectedItem");this._selectedCell=_238;this._selectedItem={featureLayer:_239.getValue(cell,"layer"),type:_239.getValue(cell,"type"),template:_239.getValue(cell,"template"),symbolInfo:_239.getValue(cell,"symbolInfo"),item:this._getItem(cell)};this._selectedInfo={selRow:row,selCol:col,index1:_239.getValue(cell,"index1"),index2:_239.getValue(cell,"index2"),index:_239.getValue(cell,"index")};}else{this._selectedCell=this._selectedInfo=this._selectedItem=null;}if(!_237){this.onSelectionChange();}},_locate:function(_23a,info,_23b){var _23c=this.grid.store,cols=new Array(this._columns);var _23d,_23e=info.index1,_23f=info.index2,_240=info.index,item=_23a.item;_1d8.some(_23b,function(_241,_242){return _1d8.some(cols,function(_243,_244){var cell=_23c.getValue(_241,"cell"+_244);if(cell&&(item?(_240===_23c.getValue(cell,"index")):(_23e===_23c.getValue(cell,"index1")&&_23f===_23c.getValue(cell,"index2")))){_23d=[_242,_244];return true;}else{return false;}});});return _23d;},_getCellInfo:function(_245,row,col){if(!_245){return;}var grid=this.grid;var item=grid.getItem(row);var cell=grid.store.getValue(item,"cell"+col);return cell;},_getItem:function(cell){var _246=this.items;if(_246){return _246[this.grid.store.getValue(cell,"index")];}},_cellMouseOver:function(evt){var _247=this.tooltip;var _248=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_248,row,col);if(_247&&cell){var _249=this.grid.store;var _24a=_249.getValue(cell,"template");var type=_249.getValue(cell,"type");var _24b=_249.getValue(cell,"symbolInfo");var _24c=_249.getValue(cell,"layer");var item=this._getItem(cell);var _24d=(item&&(item.label+(item.description?(": "+item.description):"")))||(_24a&&(_24a.name+(_24a.description?(": "+_24a.description):"")))||(type&&type.name)||(_24b&&(_24b.label+(_24b.description?(": "+_24b.description):"")))||((_24c&&_24c.name+": ")+"Default");_247.style.display="none";_247.innerHTML=_24d;var _24e=html.coords(_248.firstChild);_1e0.set(_247,{left:(_24e.x)+"px",top:(_24e.y+_24e.h+5)+"px"});_247.style.display="";}},_cellMouseOut:function(){var _24f=this.tooltip;if(_24f){_24f.style.display="none";}},_destroyItems:function(){var _250=this._itemWidgets,w;for(w in _250){if(!_250[w]){continue;}_250[w].destroy();delete _250[w];}},_repaintItems:function(){var _251=this._itemWidgets,w;for(w in _251){var _252=_251[w];if(_252){_252._repaint(_252._surface);}}},_getStoreItems:function(_253){var uid=this._uniqueId;_253=_1d8.map(_253,function(item){return lang.mixin({"surfaceId":"tpick-surface-"+(uid.id++)},item);});var len=_253.length,_254=0,obj={},k=0,prop,_255=[],flag=true,cols=this._columns;while(_254<len){flag=true;prop="cell"+k;obj[prop]=_253[_254];_254++;k++;if(k%cols===0){flag=false;_255.push(obj);obj={};k=0;}}if(flag&&len){_255.push(obj);}return _255;},_getItemsFromLayers:function(_256){var _257=[];_1d8.forEach(_256,function(_258,_259){_257.push(this._getItemsFromLayer(_258,_259));},this);return _257;},_getItemsFromLayer:function(_25a,_25b){var _25c=[];if(this.useLegend&&_1d8.indexOf(this._loadingIndices,_25b)>-1){return [{label:(this._nls&&this._nls.loading)||"",symbol:null,layer:_25a,type:null,template:null,index1:_25b,index2:0,loadingCell:1}];}var _25d=[];_25d=_25d.concat(_25a.templates);_1d8.forEach(_25a.types,function(_25e){var _25f=_25e.templates;_1d8.forEach(_25f,function(_260){_260._type_=_25e;});_25d=_25d.concat(_25f);});_25d=_1d8.filter(_25d,_1e9.isDefined);var _261=_25a.renderer;if(_261){var _262=_261.declaredClass.replace("esri.renderer.","");if(_25d.length>0){_1d8.forEach(_25d,function(_263){var _264=_263.prototype;if(_264){var _265=_261.getSymbol(_264);if(_265){var _266=null,pms,_267;if(this.useLegend&&_1d8.indexOf(this._legendIndices,_25b)>-1){_267=this._legendSymbols&&this._legendSymbols[_25b];if(_267){switch(_262){case "SimpleRenderer":_266=_267.defaultSymbol;break;case "UniqueValueRenderer":_1d8.some(_261.infos,function(info){if(info.symbol===_265){_266=_267[info.value];}return !!_266;});break;case "ClassBreaksRenderer":_1d8.some(_261.infos,function(info){if(info.symbol===_265){_266=_267[info.maxValue];}return !!_266;});break;}}if(_266){pms=_1d9.fromJson(_1d9.toJson(_1e6.defaultProps));pms.url=_266.url;pms.imageData=_266.imageData;pms.contentType=_266.contentType;pms.width=_266.width;pms.height=_266.height;if(!_1e9.isDefined(pms.width)||!_1e9.isDefined(pms.height)){pms.width=15;pms.height=15;}_266=new _1e6(pms);}}_25c.push({label:this._trimLabel(_263.name),symbol:_266||_265,legendOverride:!!_266,layer:_25a,type:_263._type_,template:_263,index1:_25b,index2:_25c.length});}}delete _263._type_;},this);}else{var _268=[];if(_262==="TemporalRenderer"){_261=_261.observationRenderer;if(_261){_262=_261.declaredClass.replace("esri.renderer.","");}}switch(_262){case "SimpleRenderer":_268=[{symbol:_261.symbol,label:_261.label,description:_261.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":_268=_261.infos;break;}_25c=_1d8.map(_268,function(info,idx){return {label:this._trimLabel(info.label),description:info.description,symbolInfo:lang.mixin({constructor:function(){}},info),symbol:info.symbol,layer:_25a,index1:_25b,index2:idx};},this);}}return _25c;},_getItemsFromItems:function(_269){return _1d8.map(_269,function(item,idx){item=lang.mixin({index:idx},item);item.label=this._trimLabel(item.label);return item;},this);},_trimLabel:function(_26a){var max=this.maxLabelLength;if(max&&_26a){if(_26a.length>max){_26a=_26a.substr(0,max)+"...";}}return _26a||"";},_cellGet:function(_26b,_26c,_26d){if(!_26d){return "";}return this.grid.store.getValue(_26d,"cell"+_26b);},_cellFormatter:function(_26e){if(_26e){var _26f=this._itemWidgets,_270=this.grid.store;var sid=_270.getValue(_26e,"surfaceId");var w=_26f[sid];if(!w){w=(_26f[sid]=new _1e7({id:sid,label:_270.getValue(_26e,"label"),symbol:_270.getValue(_26e,"symbol"),legendOverride:_270.getValue(_26e,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:_270.getValue(_26e,"template")}));}return w||"";}else{return "";}},_cellGetGroup:function(_271,_272){if(!this._groupRowIndices){return "";}var _273=_1d8.indexOf(this._groupRowIndices,_271);if(!_272||_273===-1){return "";}return (this.featureLayers[_273]&&this.featureLayers[_273].name)||"";},_cellGroupFormatter:function(_274){if(_274){return "<div class='groupLabel'>"+_274+"</div>";}else{return "";}}});if(has("extend-esri")){lang.setObject("dijit.editing.TemplatePicker",TP,_1e8);}return TP;});},"esri/layers/FeatureLayer":function(){define("esri/layers/FeatureLayer",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/_base/Deferred","dojo/date/locale","dojo/sniff","dojo/io-query","dojo/dom-construct","dojo/i18n","esri/kernel","esri/lang","esri/request","esri/deferredUtils","esri/SpatialReference","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/jsonUtils","esri/renderers/SimpleRenderer","esri/renderers/UniqueValueRenderer","esri/renderers/jsonUtils","esri/tasks/QueryTask","esri/tasks/query","esri/tasks/FeatureSet","esri/geometry/Extent","esri/geometry/jsonUtils","esri/geometry/normalizeUtils","esri/layers/GraphicsLayer","esri/layers/Field","esri/layers/TimeInfo","esri/layers/FeatureType","esri/layers/FeatureTemplate","esri/layers/FeatureEditResult","esri/layers/SnapshotMode","esri/layers/OnDemandMode","esri/layers/SelectionMode","esri/layers/TrackManager","dojo/i18n!esri/nls/jsapi","dojo/has!extend-esri?esri/layers/agscommon"],function(_275,_276,lang,_277,_278,_279,_27a,has,ioq,_27b,i18n,_27c,_27d,_27e,_27f,_280,_281,_282,_283,_284,_285,_286,_287,_288,_289,_28a,_28b,_28c,_28d,_28e,_28f,_290,_291,_292,_293,_294,_295,_296,_297){var _298=_275(_28e,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",_eventMap:{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]},constructor:function(url,_299){this.i18n=i18n.getLocalization("esri","jsapi");this._outFields=_299&&_299.outFields;this._loadCallback=_299&&_299.loadCallback;var _29a=_299&&_299._usePatch;this._usePatch=(_29a===null||_29a===undefined)?true:_29a;this._trackIdField=_299&&_299.trackIdField;this.objectIdField=_299&&_299.objectIdField;this._maxOffset=_299&&_299.maxAllowableOffset;this._optEditable=_299&&_299.editable;this._optAutoGen=_299&&_299.autoGeneralize;this.editSummaryCallback=_299&&_299.editSummaryCallback;this.userId=_299&&_299.userId;this.userIsAdmin=_299&&_299.userIsAdmin;this.useMapTime=(_299&&_299.hasOwnProperty("useMapTime"))?(!!_299.useMapTime):true;this.source=_299&&_299.source;this.gdbVersion=_299&&_299.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(_27d.isDefined(_299&&_299.mode)?_299.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new _294(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_299&&_299.tileWidth)||512;this._tileHeight=(_299&&_299.tileHeight)||512;this._mode=new _295(this);var _29b=_299&&_299.latticeTiling;this.latticeTiling=_29b;break;case ctor.MODE_SELECTION:this._mode=new _296(this);this._isSelOnly=true;break;}this._initLayer=lang.hitch(this,this._initLayer);this._selectHandler=lang.hitch(this,this._selectHandler);this._editable=false;if(lang.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new _288(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _29c=this._url.path;this._fserver=false;if(_29c.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _29d=_299&&_299.resourceInfo;if(_29d){this._initLayer(_29d);}else{if(this.source){var _29e={source:this.source.toJson()};this._url.query=lang.mixin(this._url.query,{layer:_278.toJson(_29e)});}if(this.gdbVersion){this._url.query=lang.mixin(this._url.query,{gdbVersion:this.gdbVersion});}_27e({url:_29c,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}this.registerConnectEvents();},_initLayer:function(_29f,io){if(_29f||io){this._json=_29f;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_29f&&_29f._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new _294(this);this._isSnapshot=true;this._featureSet=_29f.featureSet;this._nextId=_29f.nextObjectId;_29f=_29f.layerDefinition;}if(_29f.hasOwnProperty("capabilities")){var _2a0=(this.capabilities=_29f.capabilities);if(_2a0&&_2a0.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(_27d.isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=_278.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_29f.geometryType==="esriGeometryPolyline")||(_29f.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_27d.isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}var _2a1=_29f.effectiveMinScale||_29f.minScale,_2a2=_29f.effectiveMaxScale||_29f.maxScale;if(!this._hasMin&&_2a1){this.setMinScale(_2a1);}if(!this._hasMax&&_2a2){this.setMaxScale(_2a2);}this.layerId=_29f.id;this.name=_29f.name;this.description=_29f.description;this.copyright=_29f.copyrightText;this.type=_29f.type;this.geometryType=_29f.geometryType;this.displayField=_29f.displayField;this.defaultDefinitionExpression=_29f.definitionExpression;this.fullExtent=new _28b(_29f.extent);this.initialExtent=new _28b(this.fullExtent.toJson());if(this.fullExtent.spatialReference){this.spatialReference=new _280(this.fullExtent.spatialReference.toJson());}this.defaultVisibility=_29f.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_29f.indexedFields;this.maxRecordCount=_29f.maxRecordCount;this.canModifyLayer=_29f.canModifyLayer;this.supportsStatistics=_29f.supportsStatistics;this.supportsAdvancedQueries=_29f.supportsAdvancedQueries;this.hasLabels=_29f.hasLabels;this.canScaleSymbols=_29f.canScaleSymbols;this.supportsRollbackOnFailure=_29f.supportsRollbackOnFailure;this.syncCanReturnChanges=_29f.syncCanReturnChanges;this.isDataVersioned=_29f.isDataVersioned;this.editFieldsInfo=_29f.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_29f.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_29f.relationships;this.allowGeometryUpdates=_27d.isDefined(_29f.allowGeometryUpdates)?_29f.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _2a3=(this.fields=[]),_2a4=_29f.fields,i;for(i=0;i<_2a4.length;i++){_2a3.push(new _28f(_2a4[i]));}if(!this.objectIdField){this.objectIdField=_29f.objectIdField;if(!this.objectIdField){_2a4=_29f.fields;for(i=0;i<_2a4.length;i++){var _2a5=_2a4[i];if(_2a5.type==="esriFieldTypeOID"){this.objectIdField=_2a5.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+_27d.substitute({url:this.url},"objectIdField is not set [url: ${url}]"));}}if(!_27d.isDefined(this._nextId)){var _2a6=this.objectIdField,_2a7=-1;if(this._collection&&_2a6){var fset=this._featureSet,_2a8=fset&&fset.features,il=_2a8?_2a8.length:0,oid,attr;for(i=0;i<il;i++){attr=_2a8[i].attributes;oid=attr&&attr[_2a6];if(oid>_2a7){_2a7=oid;}}}this._nextId=(_2a7+1);}this.globalIdField=_29f.globalIdField;var _2a9=(this.typeIdField=_29f.typeIdField),_2aa;if(_2a9){_2aa=!this._getField(_2a9)&&this._getField(_2a9,true);if(_2aa){this.typeIdField=_2aa.name;}}this.visibilityField=_29f.visibilityField;var _2ab=_29f.defaultSymbol;if(_2ab){this.defaultSymbol=_284.fromJson(_2ab);}var _2ac=this.types=[],_2ad=_29f.types,_2ae,_2af,_2b0,_2b1=this.editFieldsInfo,_2b2=_2b1&&_2b1.creatorField,_2b3=_2b1&&_2b1.editorField,fix=(_2b2||_2b3),_2b4=[];if(_2ad){for(i=0;i<_2ad.length;i++){_2ae=new _291(_2ad[i]);_2af=_2ae.templates;if(fix&&_2af&&_2af.length){_2b4=_2b4.concat(_2af);}_2ac.push(_2ae);}}var _2b5=_29f.templates,_2b6,_2b7=this.templates=[];if(_2b5){for(i=0;i<_2b5.length;i++){_2b6=new _292(_2b5[i]);if(fix){_2b4.push(_2b6);}_2b7.push(_2b6);}}for(i=0;i<_2b4.length;i++){_2b0=lang.getObject("prototype.attributes",false,_2b4[i]);if(_2b0){if(_2b2){delete _2b0[_2b2];}if(_2b3){delete _2b0[_2b3];}}}var _2b8=_29f.timeInfo;if(_2b8){this.timeInfo=new _290(_2b8);this._startTimeField=_2b8.startTimeField;this._endTimeField=_2b8.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_2b8.trackIdField=this._trackIdField;}else{this._trackIdField=_2b8.trackIdField;}}this.hasAttachments=(!this._collection&&_29f.hasAttachments)?true:false;this.htmlPopupType=_29f.htmlPopupType;var _2b9=_29f.drawingInfo,_2ba;if(!this.renderer){if(_2b9&&_2b9.renderer){_2ba=_2b9.renderer;this.setRenderer(_287.fromJson(_2ba));if(_2ba.type==="classBreaks"){this.renderer.setMaxInclusive(true);}if(!this._collection){var _2bb=_2ba.type,_2bc=[];_2ba=this.renderer;switch(_2bb){case "simple":_2bc.push(_2ba.symbol);break;case "uniqueValue":case "classBreaks":_2bc.push(_2ba.defaultSymbol);_2bc=_2bc.concat(_277.map(_2ba.infos,function(info){return info.symbol;}));break;}_2bc=_277.filter(_2bc,_27d.isDefined);var _2bd=this._url.path+"/images/",_2be=this._getToken();_277.forEach(_2bc,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_2bd+url;}if(_2be&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_2be);}}});}}else{if(_2ab){_2ad=this.types;if(_2ad.length>0){_2ba=new _286(this.defaultSymbol,this.typeIdField);_277.forEach(_2ad,function(type){_2ba.addValue(type.id,type.symbol);});}else{_2ba=new _285(this.defaultSymbol);}this.setRenderer(_2ba);}else{if(!this._isTable){var _2bf;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_2bf=new _281();break;case "esriGeometryPolyline":_2bf=new _282();break;case "esriGeometryPolygon":_2bf=new _283();break;}this.setRenderer(_2bf?new _285(_2bf):null);}}}}var _2c0=(_2b9&&_2b9.transparency)||0;if(!_27d.isDefined(this.opacity)&&_2c0>0){this.opacity=1-(_2c0/100);}this.version=_29f.currentVersion;if(!this.version){var ver;if("capabilities" in _29f||"drawingInfo" in _29f||"hasAttachments" in _29f||"htmlPopupType" in _29f||"relationships" in _29f||"timeInfo" in _29f||"typeIdField" in _29f||"types" in _29f){ver=10;}else{ver=9.3;}this.version=ver;}if((has("ie")||has("safari"))&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();var _2c1=function(){this.onLoad(this);var _2c2=this._loadCallback;if(_2c2){delete this._loadCallback;_2c2(this);}};if(this._collection){this._fireUpdateStart();var _2c3=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new _28a(_2c3));this._fcAdded=true;_2c1.call(this);}else{this._forceIdentity(_2c1);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _2c4=this.renderer;if(_2c4){this._ager=(_2c4.declaredClass.indexOf("TemporalRenderer")!==-1&&_2c4.observationAger&&_2c4.observationRenderer);var _2c5=_277.filter([_2c4,_2c4.observationRenderer,_2c4.latestObservationRenderer,_2c4.trackRenderer],_27d.isDefined);var _2c6=[];_277.forEach(_2c5,function(rnd){if(!lang.isFunction(rnd.attributeField)){_2c6.push(rnd.attributeField);}_2c6.push(rnd.attributeField2);_2c6.push(rnd.attributeField3);},this);this._rendererFields=_277.filter(_2c6,_27d.isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_setMap:function(map){var div=this.inherited(arguments),mode=this._mode;if(mode){mode.initialize(map);}return div;},_unsetMap:function(map){var mode=this._mode;if(mode){mode.suspend();}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}_276.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},getOutFields:function(){return _277.filter(this._getOutFields(),function(_2c7){return (_2c7==="*"||!!this._getField(_2c7));},this);},setEditable:function(_2c8){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_2c8;return this;}var _2c9=this._editable;this._editable=_2c8;this._updateCaps();if(_2c9!==_2c8){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_2ca){var _2cb={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _2cb;}var _2cc=_2ca&&_2ca.feature,_2cd=_2ca&&_2ca.userId,caps=_277.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),lang.trim),_2ce=_277.indexOf(caps,"editing")>-1,_2cf=_2ce&&(_277.indexOf(caps,"create")>-1),_2d0=_2ce&&(_277.indexOf(caps,"update")>-1),_2d1=_2ce&&(_277.indexOf(caps,"delete")>-1),_2d2=this.ownershipBasedAccessControlForFeatures,_2d3=this.editFieldsInfo,_2d4=_2d3&&_2d3.creatorField,_2d5=_2d3&&_2d3.realm,_2d6=_2cc&&_2cc.attributes,_2d7=(_2d6&&_2d4)?_2d6[_2d4]:undefined,_2d8,_2d9=!!this.userIsAdmin,_2da=!_2d2||_2d9||!!(_2d2.allowOthersToUpdate||_2d2.allowUpdateToOthers),_2db=!_2d2||_2d9||!!(_2d2.allowOthersToDelete||_2d2.allowDeleteToOthers);if(_2d9||(_2ce&&!(_2cf||_2d0||_2d1))){_2cf=_2d0=_2d1=true;}_2d8={"canCreate":_2cf,"canUpdate":_2d0,"canDelete":_2d1};if(_2d7===null){_2d8.canUpdate=_2d0&&_2da;_2d8.canDelete=_2d1&&_2db;}else{if(_2d7===""){return _2d8;}else{if(_2d7){_2cd=_2cd||this.getUserId();if(_2cd&&_2d5){_2cd=_2cd+"@"+_2d5;}if(_2cd.toLowerCase()===_2d7.toLowerCase()){return _2d8;}else{_2d8.canUpdate=_2d0&&_2da;_2d8.canDelete=_2d1&&_2db;}}}}return _2d8;},getUserId:function(){var _2dc;if(this.loaded){_2dc=(this.credential&&this.credential.userId)||this.userId||"";}return _2dc;},setUserIsAdmin:function(_2dd){this.userIsAdmin=_2dd;},setEditSummaryCallback:function(_2de){this.editSummaryCallback=_2de;},getEditSummary:function(_2df,_2e0,_2e1){_2e1=_27d.isDefined(_2e1)?_2e1:(new Date()).getTime();var _2e2="",info=this.getEditInfo(_2df,_2e0,_2e1),_2e3=(_2e0&&_2e0.callback)||this.editSummaryCallback;if(_2e3){info=_2e3(_2df,info)||"";}if(lang.isString(info)){_2e2=info;}else{if(info){var _2e4=info.action,_2e5=info.userId,_2e6=info.timeValue,_2e7=0;if(_2e4){_2e7++;}if(_2e5){_2e7++;}if(_27d.isDefined(_2e6)){_2e7++;}if(_2e7>1){_2e2=(_2e4==="edit"?"edit":"create")+(_2e5?"User":"")+(_27d.isDefined(_2e6)?info.displayPattern:"");}}_2e2=_2e2&&_27d.substitute(info,this.i18n.layers.FeatureLayer[_2e2]);}return _2e2;},getEditInfo:function(_2e8,_2e9,_2ea){if(!this.loaded){return;}_2ea=_27d.isDefined(_2ea)?_2ea:(new Date()).getTime();var _2eb=(_2e9&&_2e9.action)||"last",_2ec=this.editFieldsInfo,_2ed=_2ec&&_2ec.creatorField,_2ee=_2ec&&_2ec.creationDateField,_2ef=_2ec&&_2ec.editorField,_2f0=_2ec&&_2ec.editDateField,_2f1=_2ec&&_2ec.realm,_2f2=_2e8&&_2e8.attributes,_2f3=(_2f2&&_2ed)?_2f2[_2ed]:undefined,_2f4=(_2f2&&_2ee)?_2f2[_2ee]:null,_2f5=(_2f2&&_2ef)?_2f2[_2ef]:undefined,_2f6=(_2f2&&_2f0)?_2f2[_2f0]:null,_2f7=this._getEditData(_2f3,_2f4,_2ea),_2f8=this._getEditData(_2f5,_2f6,_2ea),_2f9;switch(_2eb){case "creation":_2f9=_2f7;break;case "edit":_2f9=_2f8;break;case "last":_2f9=_2f8||_2f7;break;}if(_2f9){_2f9.action=(_2f9===_2f8)?"edit":"creation";}return _2f9;},_getEditData:function(_2fa,_2fb,_2fc){var data,_2fd,_2fe,_2ff=60000,_300=3600000,_301=2*_300,_302=24*_300,_303=7*_302;if(_27d.isDefined(_2fb)){_2fd=_2fc-_2fb;if(_2fd<0){_2fe="Full";}else{if(_2fd<_2ff){_2fe="Seconds";}else{if(_2fd<(2*_2ff)){_2fe="Minute";}else{if(_2fd<_300){_2fe="Minutes";}else{if(_2fd<_301){_2fe="Hour";}else{if(_2fd<_302){_2fe="Hours";}else{if(_2fd<_303){_2fe="WeekDay";}else{_2fe="Full";}}}}}}}}if((_2fa!==undefined)||_2fe){data=data||{};data.userId=_2fa;if(_2fe){var _304=_27a.format,_305=new Date(_2fb);data.minutes=Math.floor(_2fd/_2ff);data.hours=Math.floor(_2fd/_300);data.weekDay=_304(_305,{datePattern:"EEEE",selector:"date"});data.formattedDate=_304(_305,{selector:"date"});data.formattedTime=_304(_305,{selector:"time"});data.displayPattern=_2fe;data.timeValue=_2fb;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_306){if(!this.isEditable()){this._maxOffset=_306;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_307){if(!this.loaded){this._optAutoGen=_307;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_307;if(_307){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setGDBVersion:function(_308){if(!this._collection&&(_308!==this.gdbVersion)&&(_308||this.gdbVersion)){this.gdbVersion=_308;this._task.gdbVersion=_308;this._url.query=lang.mixin(this._url.query,{gdbVersion:_308});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_309){if(this._isSnapshot){this._timeDefn=_309;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}else{console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id = "+this.id+", Layer URL = "+this.url);}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_30a,_30b){this._timeOffset=_30a;this._timeOffsetUnits=_30b;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this.suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(_30c,_30d,_30e,_30f){_30d=_30d||this.constructor.SELECTION_NEW;var _310=this._getShallowClone(_30c),map=this._map,_311,dfd=_27f._fixDfd(new _279(_27f._dfdCanceller));_310.outFields=this.getOutFields();_310.returnGeometry=true;if(map){_310.outSpatialReference=new _280(map.spatialReference.toJson());}if(!this._applyQueryFilters(_310)){_311={features:[]};this._selectHandler(_311,_30d,_30e,_30f,dfd);return dfd;}var _312=this._canDoClientSideQuery(_310);if(_312){_311={features:this._doQuery(_310,_312)};this._selectHandler(_311,_30d,_30e,_30f,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+this.invalidParams);this._resolve([err],null,_30f,dfd,true);return dfd;}var self=this;if(this._ts){_310._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_310);temp.addCallbacks(function(_313){self._selectHandler(_313,_30d,_30e,_30f,dfd);},function(err){self._resolve([err],null,_30f,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _314=this._selectedFeatures,_315=[],item;for(item in _314){if(_314.hasOwnProperty(item)){_315.push(_314[item]);}}return _315;},clearSelection:function(_316){var _317=this._selectedFeatures,mode=this._mode,item;for(item in _317){if(_317.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_316){this.onSelectionClear();}return this;},setSelectionSymbol:function(_318){this._selectionSymbol=_318;if(_318){var _319=this._selectedFeatures,item;for(item in _319){if(_319.hasOwnProperty(item)){_319[item].setSymbol(_318);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_31a,_31b,_31c,_31d,_31e){var _31f=_31e.assembly,dfd=_31e.dfd;this._applyNormalized(adds,_31f&&_31f[0]);this._applyNormalized(_31a,_31f&&_31f[1]);this.onBeforeApplyEdits(adds,_31a,_31b);var i,_320={},_321=this.objectIdField,_322={f:"json"},_323=false;if(this._collection){var _324={};_324.addResults=adds?_277.map(adds,function(){_323=true;return {objectId:this._nextId++,success:true};},this):null;_324.updateResults=_31a?_277.map(_31a,function(_325){_323=true;var oid=_325.attributes[_321];_320[oid]=_325;return {objectId:oid,success:true};},this):null;_324.deleteResults=_31b?_277.map(_31b,function(_326){_323=true;return {objectId:_326.attributes[_321],success:true};},this):null;if(_323){this._editHandler(_324,adds,_320,_31c,_31d,dfd);}return;}if(adds&&adds.length>0){_322.adds=this._convertFeaturesToJson(adds,0,1);_323=true;}if(_31a&&_31a.length>0){for(i=0;i<_31a.length;i++){var _327=_31a[i];_320[_327.attributes[_321]]=_327;}_322.updates=this._convertFeaturesToJson(_31a,0,0,1);_323=true;}if(_31b&&_31b.length>0){var ids=[];for(i=0;i<_31b.length;i++){ids.push(_31b[i].attributes[_321]);}_322.deletes=ids.join(",");_323=true;}if(_323){var self=this;return _27e({url:this._url.path+"/applyEdits",content:lang.mixin(_322,this._url.query),callbackParamName:"callback",load:function(_328){self._editHandler(_328,adds,_320,_31c,_31d,dfd);},error:function(err){self._resolve([err],null,_31d,dfd,true);}},{usePost:true});}},queryFeatures:function(_329,_32a,_32b){return this._query("execute","onQueryFeaturesComplete",_329,_32a,_32b);},queryRelatedFeatures:function(_32c,_32d,_32e){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_32c,_32d,_32e);},queryIds:function(_32f,_330,_331){return this._query("executeForIds","onQueryIdsComplete",_32f,_330,_331);},queryCount:function(_332,_333,_334){return this._query("executeForCount","onQueryCountComplete",_332,_333,_334);},queryAttachmentInfos:function(_335,_336,_337){var url=this._url.path+"/"+_335+"/attachments",dfd=new _279(_27f._dfdCanceller),self=this;dfd._pendingDfd=_27e({url:url,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_338){var _339=_338.attachmentInfos,_33a;_277.forEach(_339,function(info){_33a=ioq.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_33a?("?"+_33a):"");info.objectId=_335;});self._resolve([_339],"onQueryAttachmentInfosComplete",_336,dfd);},error:function(err){self._resolve([err],null,_337,dfd,true);}});return dfd;},addAttachment:function(_33b,_33c,_33d,_33e){return this._sendAttachment("add",_33b,_33c,_33d,_33e);},updateAttachment:function(_33f,_340,_341,_342,_343){_341.appendChild(_27b.create("input",{type:"hidden",name:"attachmentId",value:_340}));return this._sendAttachment("update",_33f,_341,_342,_343);},deleteAttachments:function(_344,_345,_346,_347){var url=this._url.path+"/"+_344+"/deleteAttachments",dfd=new _279(_27f._dfdCanceller),self=this,_348={f:"json",attachmentIds:_345.join(",")};dfd._pendingDfd=_27e({url:url,content:lang.mixin(_348,this._url.query),callbackParamName:"callback",load:lang.hitch(this,function(_349){var _34a=_349.deleteAttachmentResults;_34a=_277.map(_34a,function(_34b){var res=new _293(_34b);res.attachmentId=res.objectId;res.objectId=_344;return res;});self._resolve([_34a],"onDeleteAttachmentsComplete",_346,dfd);}),error:function(err){self._resolve([err],null,_347,dfd,true);}},{usePost:true});return dfd;},addType:function(_34c){var _34d=this.types;if(_34d){var _34e=_277.some(_34d,function(type){if(type.id==_34c.id){return true;}return false;});if(_34e){return false;}else{_34d.push(_34c);}}else{this.types=[_34c];}this._typesDirty=true;return true;},deleteType:function(_34f){if(!this._collection){return;}var _350=this.types;if(_350){var _351=-1;_277.some(_350,function(type,_352){if(type.id==_34f){_351=_352;return true;}return false;});if(_351>-1){this._typesDirty=true;return _350.splice(_351,1)[0];}}},toJson:function(){var _353=this._json,json=lang.isString(_353)?_278.fromJson(_353):lang.clone(_353);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _354=json.layerDefinition,_355=this._collection;if(_355&&this._typesDirty){_354.types=_277.map(this.types||[],function(type){return type.toJson();});var _356=this.renderer,_357=_354.drawingInfo;if(_357&&_356&&_356.declaredClass.indexOf("TemporalRenderer")===-1){_357.renderer=_356.toJson();}}var _358=null;if(!(_355&&!this._fcAdded)){_358={geometryType:_354.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=lang.mixin({},json.featureSet||{},_358);if(_355){json.nextObjectId=this._nextId;_354.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_forceIdentity:function(_359){var self=this,path=this._url&&this._url.path;if((this.ownershipBasedAccessControlForFeatures||this.userIsAdmin)&&!this._getToken()&&path&&_27c.id&&_27c.id._hasPortalSession()&&_27c.id._doPortalSignIn(path)){_27c.id.getCredential(path).then(function(){self._findCredential();_359.call(self);},function(){_359.call(self);});}else{_359.call(this);}},_updateCaps:function(){var _35a=this._editable,_35b=lang.trim(this.capabilities||""),_35c=_277.map((_35b?_35b.split(","):[]),lang.trim),caps=_277.map((_35b?_35b.toLowerCase().split(","):[]),lang.trim),_35d=_277.indexOf(caps,"editing"),cap,i,_35e,_35f={"Create":_277.indexOf(caps,"create"),"Update":_277.indexOf(caps,"update"),"Delete":_277.indexOf(caps,"delete")};if(_35a&&_35d===-1){_35c.push("Editing");}else{if(!_35a&&_35d>-1){_35e=[_35d];for(cap in _35f){if(_35f[cap]>-1){_35e.push(_35f[cap]);}}_35e.sort();for(i=_35e.length-1;i>=0;i--){_35c.splice(_35e[i],1);}}}this.capabilities=_35c.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},onSuspend:function(){this.inherited(arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},onResume:function(evt){this.inherited(arguments);this._toggleTime(true);this._updateMaxOffset();var mode=this._mode,map=this._map,_360=this.renderer;if(evt.firstOccurrence){this.clearSelection();if(this.timeInfo){if(this._trackIdField||(_360&&(_360.latestObservationRenderer||_360.trackRenderer))){this._trackManager=new _297(this);this._trackManager.initialize(map);}}this._zoomConnect=_276.connect(map,"onZoomEnd",this,this._updateMaxOffset);}if(mode){evt.firstOccurrence?mode.startup():mode.resume();}},_updateMaxOffset:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}},_toggleTime:function(_361){var map=this._map;if(_361&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=_276.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;_276.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_362){this._mapTimeExtent=_362;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_363){var _364=this._timeOffset,_365=this._timeOffsetUnits;return (_363&&_364&&_365)?_363.offset(-1*_364,_365):_363;},_getTimeOverlap:function(_366,_367){if(_366&&_367){return _366.intersection(_367);}else{return _366||_367;}},_getTimeFilter:function(_368){var _369=this.getTimeDefinition(),_36a=null,_36b;if(_369||_36a){_36b=this._getTimeOverlap(_369,_36a);if(!_36b){return [false];}}if(_368){_368=_36b?this._getTimeOverlap(_368,_36b):_368;if(!_368){return [false];}}else{_368=_36b;}return [true,_368];},_getAttributeFilter:function(_36c){var _36d=this.getDefinitionExpression();if(_36c){_36c=_36d?"("+_36d+") AND ("+_36c+")":_36c;}else{_36c=_36d;}return _36c;},_applyQueryFilters:function(_36e){_36e.where=this._getAttributeFilter(_36e.where);_36e.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _36f=this._getTimeFilter(_36e.timeExtent);if(!_36f[0]){return false;}else{_36e.timeExtent=_36f[1];}}return true;},_add:function(_370){var _371=this._selectionSymbol,attr=_370.attributes,_372=this.visibilityField;if(_371&&this._isSelOnly){_370.setSymbol(_371);}if(_372&&attr&&attr.hasOwnProperty(_372)){_370[attr[_372]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_373){var _374=[],map=this._map;if(this._isTable||!map){return;}if(_373.text||(_373.where&&_373.where!==this.getDefinitionExpression())){return;}var _375=this._isSnapshot,_376=this._isSelOnly;var _377=_373.geometry;if(_377){if(!_376&&_373.spatialRelationship===_289.SPATIAL_REL_INTERSECTS&&(_377.type==="extent"&&(_375||map.extent.contains(_377)))){_374.push(1);}else{return;}}var ids=_373.objectIds;if(ids){if(_375){_374.push(2);}else{var len=ids.length,mode=this._mode,_378=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_378++;}}if(_378===len){_374.push(2);}else{return;}}}if(this.timeInfo){var _379=_373.timeExtent,_37a=this._mapTimeExtent;if(_375){if(_379){_374.push(3);}}else{if(_376){if(_379){return;}}else{if(_37a){if(_277.indexOf(_374,2)!==-1){if(_379){_374.push(3);}}else{return;}}else{if(_374.length>0){if(_379){_374.push(3);}}else{if(_379){return;}}}}}}return _374.length>0?_374:null;},_doQuery:function(_37b,_37c,_37d){var _37e=[],mode=this._mode,_37f=this.objectIdField,i,len,_380;if(_277.indexOf(_37c,2)!==-1){_37e=[];var ids=_37b.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_37e.push(obj);}}if(_37e.length===0){return [];}}if(_277.indexOf(_37c,1)!==-1){_380=_37e.length>0?_37e:this.graphics;len=_380.length;var _381=_37b.geometry._normalize(null,true);_37e=[];for(i=0;i<len;i++){var _382=_380[i],_383=_382.geometry;if(_383){if(this.normalization&&_381.length){if(_381[0].intersects(_383)||_381[1].intersects(_383)){_37e.push(_382);}}else{if(_381.intersects(_383)){_37e.push(_382);}}}}if(_37e.length===0){return [];}}if(_277.indexOf(_37c,3)!==-1){if(this.timeInfo){_380=_37e.length>0?_37e:this.graphics;var time=_37b.timeExtent,_384=this._filterByTime(_380,time.startTime,time.endTime);_37e=_384.match;}}if(_37d){return _277.map(_37e,function(obj){return obj.attributes[_37f];},this);}else{return _37e;}},_filterByTime:function(_385,_386,_387){var _388=this._startTimeField,_389=this._endTimeField,_38a;if(!this._twoTimeFields){_38a=_388||_389;}var _38b=_27d.isDefined,yea=[],nay=[],i,len=_385.length,_38c,_38d;_386=_386?_386.getTime():-Infinity;_387=_387?_387.getTime():Infinity;if(_38a){for(i=0;i<len;i++){_38c=_385[i];_38d=_38c.attributes;var time=_38d[_38a];if(time>=_386&&time<=_387){yea.push(_38c);}else{nay.push(_38c);}}}else{for(i=0;i<len;i++){_38c=_385[i];_38d=_38c.attributes;var _38e=_38d[_388],end=_38d[_389];_38e=_38b(_38e)?_38e:-Infinity;end=_38b(end)?end:Infinity;if((_38e>=_386&&_38e<=_387)||(end>=_386&&end<=_387)||(_386>=_38e&&_387<=end)){yea.push(_38c);}else{nay.push(_38c);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_38f,_390,dfd,_391){if(_38f){this[_38f].apply(this,args);}if(_390){_390.apply(null,args);}if(dfd){_27f._resDfd(dfd,args,_391);}},_getShallowClone:function(_392){var _393=new _289(),prop;for(prop in _392){if(_392.hasOwnProperty(prop)){_393[prop]=_392[prop];}}return _393;},_query:function(type,_394,_395,_396,_397){var that=this,map=this._map,dfd=new _279(_27f._dfdCanceller),_398=_395;var _399=function(_39a,_39b){if(!_39b&&type==="execute"&&!that._isTable){var _39c=_39a.features,mode=that._mode,_39d=that.objectIdField,il=_39c.length,i;for(i=il-1;i>=0;i--){var oid=_39c[i].attributes[_39d];var _39e=mode._getFeature(oid);if(_39e){_39c.splice(i,1,_39e);}}}that._resolve([_39a],_394,_396,dfd);};if(type!=="executeRelationshipQuery"){_398=this._getShallowClone(_395);_398.outFields=this.getOutFields();_398.returnGeometry=_395.hasOwnProperty("returnGeometry")?_395.returnGeometry:true;var _39f;if(map){_398.outSpatialReference=new _280(map.spatialReference.toJson());}if(!this._applyQueryFilters(_398)){switch(type){case "execute":_39f=new _28a({features:[]});break;case "executeForIds":_39f=[];break;case "executeForCount":_39f=0;break;}_399(_39f,true);return dfd;}var _3a0=this._canDoClientSideQuery(_398);if(_3a0){var _3a1=this._doQuery(_398,_3a0,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_39f=new _28a();_39f.features=_3a1;break;case "executeForIds":_39f=_3a1;break;case "executeForCount":_39f=_3a1.length;break;}_399(_39f,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+this.invalidParams);this._resolve([err],null,_397,dfd,true);return dfd;}if(this._ts){_398._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_398);temp.addCallbacks(_399,function(err){that._resolve([err],null,_397,dfd,true);});return dfd;},_convertFeaturesToJson:function(_3a2,_3a3,_3a4,_3a5){var json=[],_3a6=this._selectionSymbol,_3a7=this.visibilityField,i,_3a8,_3a9=this.objectIdField;if(this.loaded&&(_3a4||_3a5)){_3a8=_277.filter(this.fields,function(_3aa){return (_3aa.editable===false)&&(!_3a5||(_3aa.name!==_3a9));});}for(i=0;i<_3a2.length;i++){var _3ab=_3a2[i],_3ac={},_3ad=_3ab.geometry,attr=_3ab.attributes,_3ae=_3ab.symbol;if(_3ad&&(!_3a5||!this.loaded||this.allowGeometryUpdates)){_3ac.geometry=_3ad.toJson();}if(_3a7){_3ac.attributes=attr=lang.mixin({},attr);attr[_3a7]=_3ab.visible?1:0;}else{if(attr){_3ac.attributes=lang.mixin({},attr);}}if(_3ac.attributes&&_3a8&&_3a8.length){_277.forEach(_3a8,function(_3af){delete _3ac.attributes[_3af.name];});}if(_3ae&&(_3ae!==_3a6)){_3ac.symbol=_3ae.toJson();}json.push(_3ac);}return _3a3?json:_278.toJson(json);},_selectHandler:function(_3b0,_3b1,_3b2,_3b3,dfd){var _3b4,ctor=this.constructor;switch(_3b1){case ctor.SELECTION_NEW:this.clearSelection(true);_3b4=true;break;case ctor.SELECTION_ADD:_3b4=true;break;case ctor.SELECTION_SUBTRACT:_3b4=false;break;}var i,_3b5=_3b0.features,mode=this._mode,_3b6=[],_3b7=this.objectIdField,_3b8,oid;if(_3b4){for(i=0;i<_3b5.length;i++){_3b8=_3b5[i];oid=_3b8.attributes[_3b7];var _3b9=mode._addFeatureIIf(oid,_3b8);_3b6.push(_3b9);this._selectFeatureIIf(oid,_3b9,mode);}}else{for(i=0;i<_3b5.length;i++){_3b8=_3b5[i];oid=_3b8.attributes[_3b7];this._unSelectFeatureIIf(oid,mode);var _3ba=mode._removeFeatureIIf(oid);_3b6.push(_3ba||_3b8);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_3b6,_3b1,_3b0.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_3b2,dfd);if(_3b0.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_3bb,mode){var _3bc=this._selectedFeatures,_3bd=_3bc[oid];if(!_3bd){mode._incRefCount(oid);_3bc[oid]=_3bb;if(!this._isTable){this._setSelectSymbol(_3bb);}}return _3bd||_3bb;},_unSelectFeatureIIf:function(oid,mode){var _3be=this._selectedFeatures[oid];if(_3be){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_3be);}}return _3be;},_isSelected:function(_3bf){},_setSelectSymbol:function(_3c0){var _3c1=this._selectionSymbol;if(_3c1&&!this._isSelOnly){_3c0.setSymbol(_3c1);}},_setUnSelectSymbol:function(_3c2){var _3c3=this._selectionSymbol;if(_3c3&&!this._isSelOnly){if(_3c3===_3c2.symbol){_3c2.setSymbol(null,true);}}},_getOutFields:function(){var _3c4=_277.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_3c5,_3c6,arr){return !!_3c5&&(_277.indexOf(arr,_3c5)===_3c6);});var _3c7=lang.clone(this._outFields);if(_3c7){if(_277.indexOf(_3c7,"*")!==-1){return _3c7;}_277.forEach(_3c4,function(_3c8){if(_277.indexOf(_3c7,_3c8)===-1){_3c7.push(_3c8);}});return _3c7;}else{return _3c4;}},_checkFields:function(_3c9){var _3ca=_3c9||this._getOutFields();_277.forEach(_3ca,function(_3cb){if(_3cb==="*"){return;}if(!this._getField(_3cb)){console.debug("esri.layers.FeatureLayer: "+_27d.substitute({url:this.url,field:_3cb},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]"));}},this);if(!_3c9&&!this._isTable&&!this._fserver&&!this._collection){var _3cc=_277.some(this.fields,function(_3cd){return (_3cd&&_3cd.type==="esriFieldTypeGeometry")?true:false;});if(!_3cc){console.debug("esri.layers.FeatureLayer: "+_27d.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]"));}}},_fixRendererFields:function(){var _3ce=this.renderer;if(_3ce&&this.fields.length>0){var _3cf=_277.filter([_3ce,_3ce.observationRenderer,_3ce.latestObservationRenderer,_3ce.trackRenderer],_27d.isDefined);var _3d0=[];_277.forEach(_3cf,function(rnd){var _3d1,_3d2;_3d2=rnd.attributeField;if(_3d2&&!lang.isFunction(_3d2)){_3d1=!this._getField(_3d2)&&this._getField(_3d2,true);if(_3d1){rnd.attributeField=_3d1.name;}}_3d2=rnd.attributeField2;if(_3d2){_3d1=!this._getField(_3d2)&&this._getField(_3d2,true);if(_3d1){rnd.attributeField2=_3d1.name;}}_3d2=rnd.attributeField3;if(_3d2){_3d1=!this._getField(_3d2)&&this._getField(_3d2,true);if(_3d1){rnd.attributeField3=_3d1.name;}}if(!lang.isFunction(rnd.attributeField)){_3d0.push(rnd.attributeField);}_3d0.push(rnd.attributeField2);_3d0.push(rnd.attributeField3);},this);this._rendererFields=_277.filter(_3d0,_27d.isDefined);}},_getField:function(_3d3,_3d4){var _3d5=this.fields;if(!_3d5||_3d5.length===0){return null;}var _3d6;if(_3d4){_3d3=_3d3.toLowerCase();}_277.some(_3d5,function(_3d7){var _3d8=false;if(_3d4){_3d8=(_3d7&&_3d7.name.toLowerCase()===_3d3)?true:false;}else{_3d8=(_3d7&&_3d7.name===_3d3)?true:false;}if(_3d8){_3d6=_3d7;}return _3d8;});return _3d6;},_getDateOpts:function(){if(!this._dtOpts){var _3d9=_277.map(_277.filter(this.fields,function(_3da){return !!(_3da&&_3da.type==="esriFieldTypeDate");}),function(_3db){return _3db.name;});this._dtOpts={properties:_3d9};}return this._dtOpts;},_applyNormalized:function(_3dc,_3dd){if(_3dc&&_3dd){_277.forEach(_3dc,function(_3de,_3df){if(_3de&&_3dd[_3df]){_3de.setGeometry(_3dd[_3df]);}});}},_editHandler:function(_3e0,adds,_3e1,_3e2,_3e3,dfd){var _3e4=_3e0.addResults,_3e5=_3e0.updateResults,_3e6=_3e0.deleteResults,i,_3e7,oid,_3e8,attr,_3e9=this.objectIdField,mode=this._mode,_3ea=this._isTable;var _3eb=this.editFieldsInfo,_3ec=this.getOutFields()||[],_3ed=_3eb&&_3eb.creatorField,_3ee=_3eb&&_3eb.creationDateField,_3ef=_3eb&&_3eb.editorField,_3f0=_3eb&&_3eb.editDateField,_3f1=_3eb&&_3eb.realm;if(_277.indexOf(_3ec,"*")===-1){if(_3ed&&_277.indexOf(_3ec,_3ed)===-1){_3ed=null;}if(_3ee&&_277.indexOf(_3ec,_3ee)===-1){_3ee=null;}if(_3ef&&_277.indexOf(_3ec,_3ef)===-1){_3ef=null;}if(_3f0&&_277.indexOf(_3ec,_3f0)===-1){_3f0=null;}}var _3f2=(_3ee||_3f0)?(new Date()).getTime():null,_3f3=(_3ed||_3ef)?this.getUserId():undefined;if(_3f3&&_3f1){_3f3=_3f3+"@"+_3f1;}if(_3e4){for(i=0;i<_3e4.length;i++){_3e4[i]=new _293(_3e4[i]);if(_3ea){continue;}_3e7=_3e4[i];if(_3e7.success){oid=_3e7.objectId;_3e8=adds[i];var gl=_3e8._graphicsLayer;if(gl&&gl!==this){gl.remove(_3e8);}attr=_3e8.attributes||{};attr[_3e9]=oid;if(_3ed){attr[_3ed]=_3f3;}if(_3ef){attr[_3ef]=_3f3;}if(_3ee){attr[_3ee]=_3f2;}if(_3f0){attr[_3f0]=_3f2;}_3e8.setAttributes(attr);if(mode._init){mode.drawFeature(_3e8);}}}}if(_3e5){for(i=0;i<_3e5.length;i++){_3e5[i]=new _293(_3e5[i]);if(_3ea){continue;}_3e7=_3e5[i];if(_3e7.success){oid=_3e7.objectId;_3e8=_3e1[oid];var _3f4=mode._getFeature(oid);if(_3f4){if(_3f4.geometry!==_3e8.geometry){_3f4.setGeometry(_28c.fromJson(_3e8.geometry.toJson()));}this._repaint(_3f4,oid);}_3e8=_3f4||_3e8;attr=_3e8.attributes||{};if(_3ef){attr[_3ef]=_3f3;}if(_3f0){attr[_3f0]=_3f2;}_3e8.setAttributes(attr);}}}if(_3e6){var _3f5=[];for(i=0;i<_3e6.length;i++){_3e6[i]=new _293(_3e6[i]);if(_3ea){continue;}_3e7=_3e6[i];if(_3e7.success){oid=_3e7.objectId;_3e8=mode._getFeature(oid);if(_3e8){if(this._unSelectFeatureIIf(oid,mode)){_3f5.push(_3e8);}_3e8._count=0;mode._removeFeatureIIf(oid);}}}if(_3f5.length>0){this.onSelectionComplete(_3f5,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_3e4,_3e5,_3e6],"onEditsComplete",_3e2,dfd);},_sendAttachment:function(type,_3f6,_3f7,_3f8,_3f9){var _3fa=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_3f6+"/"+_3fa,self=this;var dfd=_27e({url:url,form:_3f7,content:lang.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_3fb){var _3fc=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_3fd=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_3fe=new _293(_3fb[_3fc]);_3fe.attachmentId=_3fe.objectId;_3fe.objectId=_3f6;self._resolve([_3fe],_3fd,_3f8);return _3fe;}).addErrback(function(_3ff){self._resolve([_3ff],null,_3f9,null,true);});return dfd;},_repaint:function(_400,oid,_401){oid=_27d.isDefined(oid)?oid:_400.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_400.setSymbol(_400.symbol,_401);}},_getKind:function(_402){var _403=this._trackManager;if(_403){return _403.isLatestObservation(_402)?1:0;}return 0;}});lang.mixin(_298,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});_28d._createWrappers(_298);if(has("extend-esri")){lang.setObject("layers.FeatureLayer",_298,_27c);}return _298;});},"dojox/main":function(){define("dojox/main",["dojo/_base/kernel"],function(dojo){return dojo.dojox;});},"dojox/grid/cells/_base":function(){define("dojox/grid/cells/_base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/_base/array","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_Widget","../util"],function(dojo,_404,lang,_405,_406,_407,has,dom,_408,_409,_40a,util){var _40b=_404("dojox.grid._DeferredTextWidget",_40a,{deferred:null,_destroyOnRemove:true,postCreate:function(){if(this.deferred){this.deferred.addBoth(lang.hitch(this,function(text){if(this.domNode){this.domNode.innerHTML=text;}}));}}});var _40c=function(_40d){try{util.fire(_40d,"focus");util.fire(_40d,"select");}catch(e){}};var _40e=function(){setTimeout(lang.hitch.apply(dojo,arguments),0);};var _40f=_404("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:false,alwaysEditing:false,formatter:null,defaultValue:"...",value:null,hidden:false,noresize:false,draggable:true,_valueProp:"value",_formatPending:false,constructor:function(_410){this._props=_410||{};lang.mixin(this,_410);if(this.draggable===undefined){this.draggable=true;}},_defaultFormat:function(_411,_412){var s=this.grid.formatterScope||this;var f=this.formatter;if(f&&s&&typeof f=="string"){f=this.formatter=s[f];}var v=(_411!=this.defaultValue&&f)?f.apply(s,_412):_411;if(typeof v=="undefined"){return this.defaultValue;}if(v&&v.addBoth){v=new _40b({deferred:v},_409.create("span",{innerHTML:this.defaultValue}));}if(v&&v.declaredClass&&v.startup){return "<div class='dojoxGridStubNode' linkWidget='"+v.id+"' cellIdx='"+this.index+"'>"+this.defaultValue+"</div>";}return v;},format:function(_413,_414){var f,i=this.grid.edit.info,d=this.get?this.get(_413,_414):(this.value||this.defaultValue);d=(d&&d.replace&&this.grid.escapeHTMLInData)?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"&amp;").replace(/</g,"&lt;"):d;if(this.editable&&(this.alwaysEditing||(i.rowIndex==_413&&i.cell==this))){return this.formatEditing(d,_413);}else{return this._defaultFormat(d,[d,_413,this]);}},formatEditing:function(_415,_416){},getNode:function(_417){return this.view.getCellNode(_417,this.index);},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index);},getEditNode:function(_418){return (this.getNode(_418)||0).firstChild||0;},canResize:function(){var uw=this.unitWidth;return uw&&(uw!=="auto");},isFlex:function(){var uw=this.unitWidth;return uw&&lang.isString(uw)&&(uw=="auto"||uw.slice(-1)=="%");},applyEdit:function(_419,_41a){if(this.getNode(_41a)){this.grid.edit.applyCellEdit(_419,this,_41a);}},cancelEdit:function(_41b){this.grid.doCancelEdit(_41b);},_onEditBlur:function(_41c){if(this.grid.edit.isEditCell(_41c,this.index)){this.grid.edit.apply();}},registerOnBlur:function(_41d,_41e){if(this.commitOnBlur){_406.connect(_41d,"onblur",function(e){setTimeout(lang.hitch(this,"_onEditBlur",_41e),250);});}},needFormatNode:function(_41f,_420){this._formatPending=true;_40e(this,"_formatNode",_41f,_420);},cancelFormatNode:function(){this._formatPending=false;},_formatNode:function(_421,_422){if(this._formatPending){this._formatPending=false;if(!has("ie")){dom.setSelectable(this.grid.domNode,true);}this.formatNode(this.getEditNode(_422),_421,_422);}},formatNode:function(_423,_424,_425){if(has("ie")){_40e(this,"focus",_425,_423);}else{this.focus(_425,_423);}},dispatchEvent:function(m,e){if(m in this){return this[m](e);}},getValue:function(_426){return this.getEditNode(_426)[this._valueProp];},setValue:function(_427,_428){var n=this.getEditNode(_427);if(n){n[this._valueProp]=_428;}},focus:function(_429,_42a){_40c(_42a||this.getEditNode(_429));},save:function(_42b){this.value=this.value||this.getValue(_42b);},restore:function(_42c){this.setValue(_42c,this.value);},_finish:function(_42d){dom.setSelectable(this.grid.domNode,false);this.cancelFormatNode();},apply:function(_42e){this.applyEdit(this.getValue(_42e),_42e);this._finish(_42e);},cancel:function(_42f){this.cancelEdit(_42f);this._finish(_42f);}});_40f.markupFactory=function(node,_430){var _431=lang.trim(_408.get(node,"formatter")||"");if(_431){_430.formatter=lang.getObject(_431)||_431;}var get=lang.trim(_408.get(node,"get")||"");if(get){_430.get=lang.getObject(get);}var _432=function(attr,cell,_433){var _434=lang.trim(_408.get(node,attr)||"");if(_434){cell[_433||attr]=!(_434.toLowerCase()=="false");}};_432("sortDesc",_430);_432("editable",_430);_432("alwaysEditing",_430);_432("noresize",_430);_432("draggable",_430);var _435=lang.trim(_408.get(node,"loadingText")||_408.get(node,"defaultValue")||"");if(_435){_430.defaultValue=_435;}var _436=function(attr,cell,_437){var _438=lang.trim(_408.get(node,attr)||"")||undefined;if(_438){cell[_437||attr]=_438;}};_436("styles",_430);_436("headerStyles",_430);_436("cellStyles",_430);_436("classes",_430);_436("headerClasses",_430);_436("cellClasses",_430);};var Cell=_404("dojox.grid.cells.Cell",_40f,{constructor:function(){this.keyFilter=this.keyFilter;},keyFilter:null,formatEditing:function(_439,_43a){this.needFormatNode(_439,_43a);return "<input class=\"dojoxGridInput\" type=\"text\" value=\""+_439+"\">";},formatNode:function(_43b,_43c,_43d){this.inherited(arguments);this.registerOnBlur(_43b,_43d);},doKey:function(e){if(this.keyFilter){var key=String.fromCharCode(e.charCode);if(key.search(this.keyFilter)==-1){_405.stop(e);}}},_finish:function(_43e){this.inherited(arguments);var n=this.getEditNode(_43e);try{util.fire(n,"blur");}catch(e){}}});Cell.markupFactory=function(node,_43f){_40f.markupFactory(node,_43f);var _440=lang.trim(_408.get(node,"keyFilter")||"");if(_440){_43f.keyFilter=new RegExp(_440);}};var _441=_404("dojox.grid.cells.RowIndex",Cell,{name:"Row",postscript:function(){this.editable=false;},get:function(_442){return _442+1;}});_441.markupFactory=function(node,_443){Cell.markupFactory(node,_443);};var _444=_404("dojox.grid.cells.Select",Cell,{options:null,values:null,returnIndex:-1,constructor:function(_445){this.values=this.values||this.options;},formatEditing:function(_446,_447){this.needFormatNode(_446,_447);var h=["<select class=\"dojoxGridSelect\">"];for(var i=0,o,v;((o=this.options[i])!==undefined)&&((v=this.values[i])!==undefined);i++){v=v.replace?v.replace(/&/g,"&amp;").replace(/</g,"&lt;"):v;o=o.replace?o.replace(/&/g,"&amp;").replace(/</g,"&lt;"):o;h.push("<option",(_446==v?" selected":"")," value=\""+v+"\"",">",o,"</option>");}h.push("</select>");return h.join("");},_defaultFormat:function(_448,_449){var v=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var i=_407.indexOf(this.values,v);if(i>=0){v=this.options[i];}}return v;},getValue:function(_44a){var n=this.getEditNode(_44a);if(n){var i=n.selectedIndex,o=n.options[i];return this.returnIndex>-1?i:o.value||o.innerHTML;}}});_444.markupFactory=function(node,cell){Cell.markupFactory(node,cell);var _44b=lang.trim(_408.get(node,"options")||"");if(_44b){var o=_44b.split(",");if(o[0]!=_44b){cell.options=o;}}var _44c=lang.trim(_408.get(node,"values")||"");if(_44c){var v=_44c.split(",");if(v[0]!=_44c){cell.values=v;}}};var _44d=_404("dojox.grid.cells.AlwaysEdit",Cell,{alwaysEditing:true,_formatNode:function(_44e,_44f){this.formatNode(this.getEditNode(_44f),_44e,_44f);},applyStaticValue:function(_450){var e=this.grid.edit;e.applyCellEdit(this.getValue(_450),this,_450);e.start(this,_450,true);}});_44d.markupFactory=function(node,cell){Cell.markupFactory(node,cell);};var Bool=_404("dojox.grid.cells.Bool",_44d,{_valueProp:"checked",formatEditing:function(_451,_452){return "<input class=\"dojoxGridInput\" type=\"checkbox\""+(_451?" checked=\"checked\"":"")+" style=\"width: auto\" />";},doclick:function(e){if(e.target.tagName=="INPUT"){this.applyStaticValue(e.rowIndex);}}});Bool.markupFactory=function(node,cell){_44d.markupFactory(node,cell);};return _40f;});},"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n","esri/toolbars/_VertexEditor":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dijit/Menu","dijit/MenuItem","esri/kernel","esri/toolbars/_VertexMover","esri/geometry/Point","esri/geometry/jsonUtils","dojo/i18n!esri/nls/jsapi"],function(_453,lang,_454,_455,has,Menu,_456,_457,_458,_459,_45a,_45b){var GVE=_453(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(_45c,map,_45d){this.graphic=_45c;this.map=map;this.toolbar=_45d;var _45e=_45d._options;this._symbol1=_45e.vertexSymbol;this._symbol2=_45e.ghostVertexSymbol;var _45f=_45e.ghostLineSymbol;this._lineStroke={style:_45f.style,width:_45f.width,color:_45f.color};this._canDel=_45e.allowDeleteVertices;this._canAdd=_45e.allowAddVertices;this._addControllers();},destroy:function(){this._removeControllers();},refresh:function(_460){if(_460){this._removeControllers();this._addControllers();}else{this._refresh(this._vertexMovers);this._refresh(this._mpVertexMovers);}},suspend:function(){if(!this._suspended){this._removeControllers();}this._suspended=true;},resume:function(){if(this._suspended){this._addControllers();}this._suspended=false;},_addControllers:function(){this._firstMoveHandle=_454.connect(_458,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=_454.connect(_458,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);if(this._canAdd){this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,true);}var _461=this._getGraphicsLayer();this._mouseOverHandle=_454.connect(_461,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=_454.connect(_461,"onMouseOut",this,this._mouseOutHandler);if(this._canDel){this._ctxMenu=new Menu({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"});var _462=(this._ctxDelete=new _456({label:_45b.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}));this._deleteHandle=_454.connect(_462,"onClick",this,this._deleteHandler);this._ctxMenu.addChild(_462);this._ctxMenu.startup();}},_removeControllers:function(){_454.disconnect(this._firstMoveHandle);_454.disconnect(this._moveStopHandle);_454.disconnect(this._mouseOverHandle);_454.disconnect(this._mouseOutHandle);_454.disconnect(this._deleteHandle);if(this._ctxMenu){this._ctxDelete=null;this._unbindCtxNode();this._ctxMenu.destroyRecursive();}this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=null;},_add:function(_463,_464,_465){var i,j,_466=this.graphic,_467=[];for(i=0;i<_463.length;i++){var _468=_463[i],_469=[];for(j=0;j<_468.length;j++){_469.push(new _458(_468[j],_464,_466,i,j,_468.length,this,_465));}_467.push(_469);}return _467;},_remove:function(_46a){if(_46a){_455.forEach(_46a,function(_46b){_455.forEach(_46b,function(_46c){_46c.destroy();});});}},_refresh:function(_46d){if(_46d){_455.forEach(_46d,function(_46e){_455.forEach(_46e,function(_46f){_46f.refresh();});});}},_isNew:function(_470){return (_455.indexOf(this._vertexMovers[_470.segIndex],_470)===-1)?true:false;},_getGraphicsLayer:function(){return this.toolbar._scratchGL;},_deleteHandler:function(evt){var _471=this._selectedMover,_472=_471.ptIndex;this._updateRelatedGraphic(_471,_471.relatedGraphic,_471.graphic.geometry,_471.segIndex,_471.ptIndex,_471.segLength,false,true);if(this._canAdd){this._deleteMidpoints(_471);}this._deleteVertex(_471);this.toolbar._endOperation("VERTICES");},_mouseOverHandler:function(evt){var _473=evt.graphic,_474=this._findMover(_473);if(_474){this.toolbar.onVertexMouseOver(this.graphic,_474._getInfo());if(!_474._placeholder){this._selectedMover=_474;if(this._canDel){this._bindCtxNode(_473.getDojoShape().getNode());}}}},_mouseOutHandler:function(evt){var _475=evt.graphic,_476=this._findMover(_475);if(_476){this.toolbar.onVertexMouseOut(this.graphic,_476._getInfo());}},_bindCtxNode:function(node){this._unbindCtxNode();this._ctxDelete.set("disabled",(this._selectedMover.segLength<=this.minLength)?true:false);this._ctxMenu.bindDomNode(node);this._bindNode=node;},_unbindCtxNode:function(){var node=this._bindNode;if(node){this._ctxMenu.unBindDomNode(node);}},_findMover:function(_477){var i,_478=[],_479=this._mpVertexMovers;_455.forEach(this._vertexMovers,function(_47a){_478=_478.concat(_47a);});if(_479){_455.forEach(_479,function(_47b){_478=_478.concat(_47b);});}for(i=0;i<_478.length;i++){var _47c=_478[i];if(_47c.graphic===_477){return _47c;}}},_firstMoveHandler:function(_47d){if(!this._isNew(_47d)&&this._canAdd){this._hideRelatedMidpoints(_47d);}this.toolbar._beginOperation("VERTICES");},_moveStopHandler:function(_47e,tx){var add=this._isNew(_47e);if(!tx||!tx.dx&&!tx.dy){if(!add&&this._canAdd){this._showRelatedMidpoints(_47e);}return;}this._updateRelatedGraphic(_47e,_47e.relatedGraphic,_47e.graphic.geometry,_47e.segIndex,_47e.ptIndex,_47e.segLength,add);if(this._canAdd){if(add){this._addMidpoints(_47e);}else{this._repositionRelatedMidpoints(_47e);this._showRelatedMidpoints(_47e);}}this.toolbar._endOperation("VERTICES");},_showRelatedMidpoints:function(_47f){var i,_480=this._getAdjacentMidpoints(_47f.ptIndex,_47f.segLength),_481=this._mpVertexMovers[_47f.segIndex];for(i=0;i<_480.length;i++){var mvr=_481[_480[i]];mvr.graphic.show();mvr.refresh();}},_hideRelatedMidpoints:function(_482){var i,_483=this._getAdjacentMidpoints(_482.ptIndex,_482.segLength),_484=this._mpVertexMovers[_482.segIndex];for(i=0;i<_483.length;i++){_484[_483[i]].graphic.hide();}},_repositionRelatedMidpoints:function(_485){var i,_486=this._getAdjacentMidpoints(_485.ptIndex,_485.segLength),_487=this._mpVertexMovers[_485.segIndex];for(i=0;i<_486.length;i++){var _488=this._getAdjacentVertices(_486[i],_485.segLength);var _489=_485.relatedGraphic.geometry.getPoint(_485.segIndex,_488[0]),_48a=_485.relatedGraphic.geometry.getPoint(_485.segIndex,_488[1]);var _48b=new _459({x:(_489.x+_48a.x)/2,y:(_489.y+_48a.y)/2,spatialReference:_489.spatialReference.toJson()});_487[_486[i]].graphic.setGeometry(_48b);}},_addMidpoints:function(_48c){var _48d=_48c.segIndex,_48e=_48c.ptIndex,_48f=_48c.segLength;var _490=_48e+1;var i,_491=_48f+1;this._mpVertexMovers[_48d].splice(_48e,1);var _492=this._vertexMovers[_48d];for(i=0;i<_490;i++){_492[i].segLength+=1;}for(i=_490;i<_492.length;i++){_492[i].ptIndex+=1;_492[i].segLength+=1;}_48c.ptIndex=_490;_48c.segLength=_492.length+1;_492.splice(_490,0,_48c);_48c.graphic.setSymbol(this._symbol1);_492=this._mpVertexMovers[_48d];for(i=0;i<_48e;i++){_492[i].segLength+=1;}for(i=_48e;i<_48f-1;i++){_492[i].ptIndex+=1;_492[i].segLength+=1;}var _493=this._getAdjacentVertices(_48e,_491);var _494=this._getAdjacentVertices(_48e+1,_491);var _495,_496;_495=_48c.relatedGraphic.geometry.getPoint(_48c.segIndex,_493[0]);_496=_48c.relatedGraphic.geometry.getPoint(_48c.segIndex,_493[1]);var _497=new _459({x:(_495.x+_496.x)/2,y:(_495.y+_496.y)/2,spatialReference:_495.spatialReference.toJson()});_495=_48c.relatedGraphic.geometry.getPoint(_48c.segIndex,_494[0]);_496=_48c.relatedGraphic.geometry.getPoint(_48c.segIndex,_494[1]);var _498=new _459({x:(_495.x+_496.x)/2,y:(_495.y+_496.y)/2,spatialReference:_495.spatialReference.toJson()});var mvr1=new _458(_497,this._symbol2,this.graphic,_48c.segIndex,_48e,_491,this,true);var mvr2=new _458(_498,this._symbol2,this.graphic,_48c.segIndex,_48e+1,_491,this,true);_492.splice(_48e,0,mvr1,mvr2);},_deleteVertex:function(_499){var i,_49a=_499.segIndex,_49b=_499.ptIndex;var _49c=this._vertexMovers[_49a];for(i=0;i<_49b;i++){_49c[i].segLength-=1;}for(i=_49b+1;i<_49c.length;i++){var mvr=_49c[i];mvr.ptIndex-=1;mvr.segLength-=1;}_49c.splice(_49b,1);var info=_499._getInfo();_499.destroy();this.toolbar.onVertexDelete(this.graphic,info);}});lang.mixin(GVE,{create:function(_49d,map,_49e){var type=_49d.geometry.type;switch(type){case "multipoint":return new GVE.MultipointVertexEditor(_49d,map,_49e);break;case "polyline":return new GVE.PolylineVertexEditor(_49d,map,_49e);break;case "polygon":return new GVE.PolygonVertexEditor(_49d,map,_49e);break;}}});GVE.MultipointVertexEditor=_453(GVE,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=_454.connect(_458,"onMoveStart",this,this._moveStartHandler);_454.disconnect(this._firstMoveHandle);},destroy:function(){this.inherited(arguments);_454.disconnect(this._moveStartHandle);},_getSegments:function(_49f){var i,_4a0=_49f.points,_4a1=[],sr=_49f.spatialReference;for(i=0;i<_4a0.length;i++){var _4a2=_4a0[i];_4a1.push(new _459({x:_4a2[0],y:_4a2[1],spatialReference:sr.toJson()}));}return [_4a1];},_getMidpointSegments:function(_4a3){return [];},_getControlPoints:function(_4a4,_4a5,_4a6,_4a7,_4a8){return [];},_getGraphicsLayer:function(){return this.graphic._graphicsLayer;},_mouseOverHandler:function(evt){var _4a9=evt.graphic,_4aa=this._findMover(evt);if(_4aa){this.toolbar.onVertexMouseOver(_4a9,_4aa._getInfo());this._selectedMover=_4aa;if(this._canDel){this._bindCtxNode(_4aa.graphic.getDojoShape().getNode());}}},_mouseOutHandler:function(evt){var _4ab=evt.graphic,_4ac=this._findMover(evt);if(_4ac){this.toolbar.onVertexMouseOut(_4ab,_4ac._getInfo());}},_findMover:function(evt){var i,_4ad=[].concat(this._vertexMovers[0]),_4ae=evt.target;for(i=0;i<_4ad.length;i++){var _4af=_4ad[i];if(_4af.graphic.getDojoShape().getNode()===_4ae){return _4af;}}},_moveStartHandler:function(_4b0){var geom=_4b0.relatedGraphic.geometry,_4b1=_4b0.ptIndex;var _4b2=_4b0.segLength-1;var _4b3=geom.points;var _4b4=_4b3.splice(_4b1,1);_4b3.push(_4b4[0]);var j,_4b5=this._vertexMovers[0];for(j=_4b2;j>_4b1;j--){_4b5[j].ptIndex-=1;}_4b4=_4b5.splice(_4b1,1);_4b5.push(_4b4[0]);_4b4[0].ptIndex=_4b2;},_moveStopHandler:function(_4b6){this._updateRelatedGraphic(_4b6,_4b6.relatedGraphic,_4b6.graphic.geometry,_4b6.segIndex,_4b6.ptIndex,_4b6.segLength);this.toolbar._endOperation("VERTICES");},_updateRelatedGraphic:function(_4b7,_4b8,_4b9,_4ba,_4bb,_4bc,add,del){var geom=_4b8.geometry;if(del){geom.removePoint(_4bb);}else{geom.setPoint(_4bb,_4b9);}_4b8.setGeometry(geom);},_deleteMidpoints:function(_4bd){}});GVE.PolylineVertexEditor=_453(GVE,{declaredClass:"esri.toolbars._PolylineVertexEditor",minLength:2,_getSegments:function(_4be){var i,j,_4bf=_4be.paths,_4c0=[];for(i=0;i<_4bf.length;i++){var path=_4bf[i],_4c1=[];for(j=0;j<path.length;j++){_4c1.push(_4be.getPoint(i,j));}_4c0.push(_4c1);}return _4c0;},_getMidpointSegments:function(_4c2){var i,j,_4c3=_4c2.paths,_4c4=[],sr=_4c2.spatialReference;for(i=0;i<_4c3.length;i++){var path=_4c3[i],_4c5=[];for(j=0;j<path.length-1;j++){var _4c6=_4c2.getPoint(i,j),_4c7=_4c2.getPoint(i,j+1);var midX=(_4c6.x+_4c7.x)/2,midY=(_4c6.y+_4c7.y)/2;var _4c8=new _459({x:midX,y:midY,spatialReference:sr.toJson()});_4c5.push(_4c8);}_4c4.push(_4c5);}return _4c4;},_getControlPoints:function(_4c9,_4ca,_4cb,_4cc,_4cd){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_4c9)){idx1=_4cc;idx2=_4cc+1;if(idx1>=0){pt1=map.toScreen(_4ca.getPoint(_4cb,idx1));}if(idx2<=_4cd){pt2=map.toScreen(_4ca.getPoint(_4cb,idx2));}}else{idx1=_4cc-1;idx2=_4cc+1;if(idx1>=0){pt1=map.toScreen(_4ca.getPoint(_4cb,idx1));}if(idx2<_4cd){pt2=map.toScreen(_4ca.getPoint(_4cb,idx2));}}return [pt1,pt2];},_getAdjacentMidpoints:function(_4ce,_4cf){var _4d0=[];var idx1=_4ce-1;if(idx1>=0){_4d0.push(idx1);}var idx2=_4ce;if(idx2<_4cf-1){_4d0.push(idx2);}return _4d0;},_getAdjacentVertices:function(_4d1,_4d2){return [_4d1,_4d1+1];},_deleteMidpoints:function(_4d3){var _4d4=_4d3.segIndex,_4d5=_4d3.ptIndex,_4d6=_4d3.segLength;var _4d7=this._mpVertexMovers[_4d4],_4d8=_4d7.length-1;var _4d9=this._getAdjacentMidpoints(_4d5,_4d6).sort();var i,min=_4d9[0];for(i=0;i<min;i++){_4d7[i].segLength-=1;}for(i=min+1;i<_4d7.length;i++){var mvr=_4d7[i];mvr.ptIndex-=1;mvr.segLength-=1;}if(_4d9.length===1){_4d7.splice(min,1)[0].destroy();}else{var _4da=this._getAdjacentVertices(min,_4d8);var _4db=_4d3.relatedGraphic.geometry.getPoint(_4d3.segIndex,_4da[0]);var _4dc=_4d3.relatedGraphic.geometry.getPoint(_4d3.segIndex,_4da[1]);var _4dd=new _459({x:(_4db.x+_4dc.x)/2,y:(_4db.y+_4dc.y)/2,spatialReference:_4db.spatialReference.toJson()});var mvr1=new _458(_4dd,this._symbol2,this.graphic,_4d3.segIndex,min,_4d8,this,true);var _4de=_4d7.splice(min,_4d9.length,mvr1);for(i=0;i<_4de.length;i++){_4de[i].destroy();}}},_updateRelatedGraphic:function(_4df,_4e0,_4e1,_4e2,_4e3,_4e4,add,del){var geom=_4e0.geometry;if(add){geom.insertPoint(_4e2,_4e3+1,_45a.fromJson(_4e1.toJson()));}else{if(del){geom.removePoint(_4e2,_4e3);}else{geom.setPoint(_4e2,_4e3,_45a.fromJson(_4e1.toJson()));}}_4e0.setGeometry(geom);}});GVE.PolygonVertexEditor=_453(GVE,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(_4e5){var i,j,_4e6=_4e5.rings,_4e7=[];for(i=0;i<_4e6.length;i++){var ring=_4e6[i],_4e8=[];for(j=0;j<ring.length-1;j++){_4e8.push(_4e5.getPoint(i,j));}_4e7.push(_4e8);}return _4e7;},_getMidpointSegments:function(_4e9){var i,j,_4ea=_4e9.rings,_4eb=[],sr=_4e9.spatialReference;for(i=0;i<_4ea.length;i++){var ring=_4ea[i],_4ec=[];for(j=0;j<ring.length-1;j++){var _4ed=_4e9.getPoint(i,j),_4ee=_4e9.getPoint(i,j+1);var midX=(_4ed.x+_4ee.x)/2,midY=(_4ed.y+_4ee.y)/2;var _4ef=new _459({x:midX,y:midY,spatialReference:sr.toJson()});_4ec.push(_4ef);}_4eb.push(_4ec);}return _4eb;},_getControlPoints:function(_4f0,_4f1,_4f2,_4f3,_4f4){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_4f0)){idx1=_4f3;idx2=(_4f3+1)%_4f4;}else{idx1=_4f3-1;idx1=idx1<0?(_4f4+idx1)%_4f4:idx1;idx2=(_4f3+1)%_4f4;}pt1=map.toScreen(_4f1.getPoint(_4f2,idx1));pt2=map.toScreen(_4f1.getPoint(_4f2,idx2));return [pt1,pt2];},_getAdjacentMidpoints:function(_4f5,_4f6){var idx1=_4f5-1;idx1=idx1<0?(_4f6+idx1)%_4f6:idx1;var idx2=_4f5;return [idx1,idx2];},_getAdjacentVertices:function(_4f7,_4f8){return [_4f7,(_4f7+1)%_4f8];},_deleteMidpoints:function(_4f9){var _4fa=_4f9.segIndex,_4fb=_4f9.ptIndex,_4fc=_4f9.segLength;var _4fd=this._mpVertexMovers[_4fa],_4fe=_4fd.length-1,_4ff=this._getAdjacentMidpoints(_4fb,_4fc).sort(),_500,_501,_502,_503,i,mvr1,mvr,min=_4ff[0],max=_4ff[_4ff.length-1];if(_4fb===0){_500=this._getAdjacentVertices(_4fe-1,_4fe);_501=_4f9.relatedGraphic.geometry.getPoint(_4f9.segIndex,_500[0]);_502=_4f9.relatedGraphic.geometry.getPoint(_4f9.segIndex,_500[1]);_503=new _459({x:(_501.x+_502.x)/2,y:(_501.y+_502.y)/2,spatialReference:_501.spatialReference.toJson()});mvr1=new _458(_503,this._symbol2,this.graphic,_4f9.segIndex,_4fe-1,_4fe,this,true);_4fd.splice(max,1,mvr1)[0].destroy();_4fd.splice(min,1)[0].destroy();for(i=0;i<_4fd.length-1;i++){mvr=_4fd[i];mvr.ptIndex-=1;mvr.segLength-=1;}}else{_500=this._getAdjacentVertices(min,_4fe);_501=_4f9.relatedGraphic.geometry.getPoint(_4f9.segIndex,_500[0]);_502=_4f9.relatedGraphic.geometry.getPoint(_4f9.segIndex,_500[1]);_503=new _459({x:(_501.x+_502.x)/2,y:(_501.y+_502.y)/2,spatialReference:_501.spatialReference.toJson()});mvr1=new _458(_503,this._symbol2,this.graphic,_4f9.segIndex,min,_4fe,this,true);var _504=_4fd.splice(min,_4ff.length,mvr1);for(i=0;i<_504.length;i++){_504[i].destroy();}for(i=0;i<min;i++){_4fd[i].segLength-=1;}for(i=min+1;i<_4fd.length;i++){mvr=_4fd[i];mvr.ptIndex-=1;mvr.segLength-=1;}}},_updateRelatedGraphic:function(_505,_506,_507,_508,_509,_50a,add,del){var geom=_506.geometry;if(add){geom.insertPoint(_508,_509+1,_45a.fromJson(_507.toJson()));}else{if(del){geom.removePoint(_508,_509);if(_509===0){geom.setPoint(_508,_50a-1,_45a.fromJson(geom.getPoint(_508,0).toJson()));}}else{geom.setPoint(_508,_509,_45a.fromJson(_507.toJson()));if(_509===0){geom.setPoint(_508,_50a,_45a.fromJson(_507.toJson()));}}}_506.setGeometry(geom);}});if(has("extend-esri")){lang.setObject("toolbars._GraphicVertexEditor",GVE,_457);lang.setObject("toolbars._MultipointVertexEditor",GVE.MultipointVertexEditor,_457);lang.setObject("toolbars._PolylineVertexEditor",GVE.PolylineVertexEditor,_457);lang.setObject("toolbars._PolygonVertexEditor",GVE.PolygonVertexEditor,_457);}return GVE;});},"url:esri/dijit/editing/templates/TemplatePicker.html":"<div class=\"templatePicker\">\r\n\r\n  <table dojoType=\"dojox.grid.DataGrid\" noDataMessage=\"${emptyMessage}\" selectionMode=\"none\" autoHeight=\"${_rows}\" autoWidth=\"${_autoWidth}\"\r\n         query=\"{ query: '*' }\" dojoAttachPoint=\"grid\" class=\"grid\">\r\n  </table>\r\n  \r\n</div>","esri/layers/RenderMode":function(){define("esri/layers/RenderMode",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/io/script","esri/kernel"],function(_50b,_50c,lang,_50d,has,_50e,_50f){var _510=_50c(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(_50b._scopeName||"dojo")+"IoScript";},initialize:function(map){this.map=map;this._init=true;},startup:function(){},propertyChangeHandler:function(type){},destroy:function(){this._init=false;},drawFeature:function(_511){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _512=this._featureMap[oid];if(_512){_512._count++;}},_decRefCount:function(oid){var _513=this._featureMap[oid];if(_513){_513._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_514){var fmap=this._featureMap,_515=fmap[oid],_516=this.featureLayer;if(!_515){fmap[oid]=_514;_516._add(_514);_514._count=0;}return _515||_514;},_removeFeatureIIf:function(oid){var _517=this._featureMap[oid],_518=this.featureLayer;if(_517){if(_517._count){return;}delete this._featureMap[oid];_518._remove(_517);}return _517;},_clearIIf:function(){var i,_519=this.featureLayer,_51a=_519.graphics,_51b=_519._selectedFeatures,_51c=_519.objectIdField;for(i=_51a.length-1;i>=0;i--){var _51d=_51a[i];var oid=_51d.attributes[_51c];if(oid in _51b){_51d._count=1;continue;}_51d._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=_50e[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||_50e[this._prefix+id];if(dfd){try{dfd.cancel();_50e._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){_50e._validCheck(null);},_toggleVisibility:function(show){var _51e=this.featureLayer,_51f=_51e.graphics,_520=show?"show":"hide",i,len=_51f.length;show=show&&_51e._ager;for(i=0;i<len;i++){var _521=_51f[i];_521[_520]();if(show){_51e._repaint(_521);}}},_applyTimeFilter:function(_522){var _523=this.featureLayer;if(!_523.timeInfo||_523.suspended){return;}if(!_522){_523._fireUpdateStart();}var _524=_523._trackManager;if(_524){_524.clearTracks();}var defn=_523.getTimeDefinition(),_525=_523._getOffsettedTE(_523._mapTimeExtent);if(_525){_525=_523._getTimeOverlap(defn,_525);if(_525){var _526=_523._filterByTime(_523.graphics,_525.startTime,_525.endTime);if(_524){_524.addFeatures(_526.match);}_50d.forEach(_526.match,function(_527){var _528=_527._shape;if(!_527.visible){_527.show();_528=_527._shape;_528&&_528._moveToFront();}if(_523._ager&&_528){_523._repaint(_527);}});_50d.forEach(_526.noMatch,function(_529){if(_529.visible){_529.hide();}});}else{this._toggleVisibility(false);}}else{if(_524){_524.addFeatures(_523.graphics);}this._toggleVisibility(true);}if(_524){_524.moveLatestToFront();_524.drawTracks();}if(!_522){_523._fireUpdateEnd();}}});if(has("extend-esri")){lang.setObject("layers._RenderMode",_510,_50f);}return _510;});},"esri/layers/FeatureType":function(){define("esri/layers/FeatureType",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/lang","esri/symbols/jsonUtils","esri/layers/RangeDomain","esri/layers/CodedValueDomain","esri/layers/InheritedDomain","esri/layers/FeatureTemplate"],function(_52a,lang,_52b,has,_52c,_52d,_52e,_52f,_530,_531,_532){var _533=_52a(null,{declaredClass:"esri.layers.FeatureType",constructor:function(json){if(json&&lang.isObject(json)){this.id=json.id;this.name=json.name;var _534=json.symbol;if(_534){this.symbol=_52e.fromJson(_534);}var _535=json.domains,_536,i;var _537=this.domains={};for(_536 in _535){if(_535.hasOwnProperty(_536)){var _538=_535[_536];switch(_538.type){case "range":_537[_536]=new _52f(_538);break;case "codedValue":_537[_536]=new _530(_538);break;case "inherited":_537[_536]=new _531(_538);break;}}}var _539=json.templates;if(_539){var _53a=this.templates=[];for(i=0;i<_539.length;i++){_53a.push(new _532(_539[i]));}}}},toJson:function(){var json={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _53b,_53c=this.domains,_53d=this.templates,_53e=_52d.fixJson;if(_53c){var _53f=json.domains={};for(_53b in _53c){if(_53c.hasOwnProperty(_53b)){_53f[_53b]=_53c[_53b]&&_53c[_53b].toJson();}}_53e(_53f);}if(_53d){json.templates=_52b.map(_53d,function(_540){return _540.toJson();});}return _53e(json);}});if(has("extend-esri")){lang.setObject("layers.FeatureType",_533,_52c);}return _533;});},"esri/layers/TrackManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/graphic","esri/geometry/Polyline","esri/layers/GraphicsLayer"],function(_541,lang,_542,has,_543,_544,_545,_546){var _547=_541(null,{declaredClass:"esri.layers._TrackManager",constructor:function(_548){this.layer=_548;this.trackMap={};},initialize:function(map){this.map=map;var _549=this.layer,_54a=_549.renderer.trackRenderer;if(_54a&&(_549.geometryType==="esriGeometryPoint")){var _54b=(this.container=new _546._GraphicsLayer({id:_549.id+"_tracks",_child:true}));_54b.loaded=true;_54b.onLoad(_54b);_54b._setMap(map,_549._div);_54b.setRenderer(_54a);}},addFeatures:function(_54c){var tkid,_54d=this.trackMap,_54e=this.layer,_54f=_54e._trackIdField;_542.forEach(_54c,function(_550){var _551=_550.attributes;tkid=_551[_54f];var ary=(_54d[tkid]=(_54d[tkid]||[]));ary.push(_550);});var _552=_54e._startTimeField,_553=_54e.objectIdField;var _554=function(a,b){var _555=a.attributes[_552],_556=b.attributes[_552];if(_555===_556){return (a.attributes[_553]<b.attributes[_553])?-1:1;}else{return (_555<_556)?-1:1;}};for(tkid in _54d){_54d[tkid].sort(_554);}},drawTracks:function(){var _557=this.container;if(!_557){return;}var _558=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_559,_55a=this.layer._trackIdField,_55b;for(tkid in _558){ary=_558[tkid];path=[];for(i=ary.length-1;i>=0;i--){_559=ary[i].geometry;if(_559){path.push([_559.x,_559.y]);}}_55b={};_55b[_55a]=tkid;if(path.length>0){_557.add(new _544(new _545({paths:[path],spatialReference:sr}),null,_55b));}}},moveLatestToFront:function(){_542.forEach(this.getLatestObservations(),function(_55c){var _55d=_55c._shape;_55d&&_55d._moveToFront();this._repaint(_55c,null,true);},this.layer);},getLatestObservations:function(){var _55e=[];if(!this.layer.renderer.latestObservationRenderer){return _55e;}var _55f=this.trackMap,tkid;for(tkid in _55f){var ary=_55f[tkid];_55e.push(ary[ary.length-1]);}return _55e;},clearTracks:function(){var _560=this.getLatestObservations();this.trackMap={};var _561=this.container;if(_561){_561.clear();}_542.forEach(_560,function(_562){this._repaint(_562,null,true);},this.layer);},isLatestObservation:function(_563){var _564=this.layer._trackIdField;var _565=this.trackMap[_563.attributes[_564]];if(_565){return (_565[_565.length-1]===_563);}return false;},destroy:function(){var _566=this.container;if(_566){_566.clear();_566._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});if(has("extend-esri")){lang.setObject("layers._TrackManager",_547,_543);}return _547;});},"dojox/grid/Selection":function(){define("dojox/grid/Selection",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(_567,_568,lang,_569){return _567("dojox.grid.Selection",null,{constructor:function(_56a){this.grid=_56a;this.selected=[];this.setMode(_56a.selectionMode);},mode:"extended",selected:null,updating:0,selectedIndex:-1,rangeStartIndex:-1,setMode:function(mode){if(this.selected.length){this.deselectAll();}if(mode!="extended"&&mode!="multiple"&&mode!="single"&&mode!="none"){this.mode="extended";}else{this.mode=mode;}},onCanSelect:function(_56b){return this.grid.onCanSelect(_56b);},onCanDeselect:function(_56c){return this.grid.onCanDeselect(_56c);},onSelected:function(_56d){},onDeselected:function(_56e){},onChanging:function(){},onChanged:function(){},isSelected:function(_56f){if(this.mode=="none"){return false;}return this.selected[_56f];},getFirstSelected:function(){if(!this.selected.length||this.mode=="none"){return -1;}for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getNextSelected:function(_570){if(this.mode=="none"){return -1;}for(var i=_570+1,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getSelected:function(){var _571=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_571.push(i);}}return _571;},getSelectedCount:function(){var c=0;for(var i=0;i<this.selected.length;i++){if(this.selected[i]){c++;}}return c;},_beginUpdate:function(){if(this.updating===0){this.onChanging();}this.updating++;},_endUpdate:function(){this.updating--;if(this.updating===0){this.onChanged();}},select:function(_572){if(this.mode=="none"){return;}if(this.mode!="multiple"){this.deselectAll(_572);this.addToSelection(_572);}else{this.toggleSelect(_572);}},addToSelection:function(_573){if(this.mode=="none"){return;}if(lang.isArray(_573)){_568.forEach(_573,this.addToSelection,this);return;}_573=Number(_573);if(this.selected[_573]){this.selectedIndex=_573;}else{if(this.onCanSelect(_573)!==false){this.selectedIndex=_573;var _574=this.grid.getRowNode(_573);if(_574){_569.set(_574,"aria-selected","true");}this._beginUpdate();this.selected[_573]=true;this.onSelected(_573);this._endUpdate();}}},deselect:function(_575){if(this.mode=="none"){return;}if(lang.isArray(_575)){_568.forEach(_575,this.deselect,this);return;}_575=Number(_575);if(this.selectedIndex==_575){this.selectedIndex=-1;}if(this.selected[_575]){if(this.onCanDeselect(_575)===false){return;}var _576=this.grid.getRowNode(_575);if(_576){_569.set(_576,"aria-selected","false");}this._beginUpdate();delete this.selected[_575];this.onDeselected(_575);this._endUpdate();}},setSelected:function(_577,_578){this[(_578?"addToSelection":"deselect")](_577);},toggleSelect:function(_579){if(lang.isArray(_579)){_568.forEach(_579,this.toggleSelect,this);return;}this.setSelected(_579,!this.selected[_579]);},_range:function(_57a,inTo,func){var s=(_57a>=0?_57a:inTo),e=inTo;if(s>e){e=s;s=inTo;}for(var i=s;i<=e;i++){func(i);}},selectRange:function(_57b,inTo){this._range(_57b,inTo,lang.hitch(this,"addToSelection"));},deselectRange:function(_57c,inTo){this._range(_57c,inTo,lang.hitch(this,"deselect"));},insert:function(_57d){this.selected.splice(_57d,0,false);if(this.selectedIndex>=_57d){this.selectedIndex++;}},remove:function(_57e){this.selected.splice(_57e,1);if(this.selectedIndex>=_57e){this.selectedIndex--;}},deselectAll:function(_57f){for(var i in this.selected){if((i!=_57f)&&(this.selected[i]===true)){this.deselect(i);}}},clickSelect:function(_580,_581,_582){if(this.mode=="none"){return;}this._beginUpdate();if(this.mode!="extended"){this.select(_580);}else{if(!_582||this.rangeStartIndex<0){this.rangeStartIndex=_580;}if(!_581){this.deselectAll(_580);}if(_582){this.selectRange(this.rangeStartIndex,_580);}else{if(_581){this.toggleSelect(_580);}else{this.addToSelection(_580);}}}this._endUpdate();},clickSelectEvent:function(e){this.clickSelect(e.rowIndex,dojo.isCopyKey(e),e.shiftKey);},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate();}});});},"esri/layers/GridLayout":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/SpatialReference","esri/geometry/Extent","esri/geometry/Polyline"],function(_583,lang,_584,has,_585,_586,_587,_588){var _589=_583(null,{declaredClass:"esri.layers._GridLayout",constructor:function(_58a,_58b,_58c,_58d){this.origin=_58a;this.cellWidth=_58b.width;this.cellHeight=_58b.height;this.mapWidth=_58c.width;this.mapHeight=_58c.height;this.srInfo=_58d;},setResolution:function(_58e){this._resolution=(_58e.xmax-_58e.xmin)/this.mapWidth;if(this.srInfo){var _58f=Math.round((2*this.srInfo.valid[1])/this._resolution),_590=Math.round(_58f/this.cellWidth);this._frameStats=[_590,0,_590-1];}},getCellCoordinates:function(_591){var res=this._resolution,_592=this.origin;return {row:Math.floor((_592.y-_591.y)/(this.cellHeight*res)),col:Math.floor((_591.x-_592.x)/(this.cellWidth*res))};},normalize:function(col){var _593=this._frameStats;if(_593){var _594=_593[0],m180=_593[1],p180=_593[2];if(col<m180){col=col%_594;col=col<m180?col+_594:col;}else{if(col>p180){col=col%_594;}}}return col;},intersects:function(_595,_596){var _597=this.srInfo;if(_597){return _584.some(_596._getParts(_597),function(_598){return _595.intersects(_598.extent);});}else{return _595.intersects(_596);}},getCellExtent:function(row,col){var res=this._resolution,_599=this.origin,_59a=this.cellWidth,_59b=this.cellHeight;return new _587((col*_59a*res)+_599.x,_599.y-((row+1)*_59b*res),((col+1)*_59a*res)+_599.x,_599.y-(row*_59b*res),new _586(_599.spatialReference.toJson()));},getLatticeID:function(_59c){var _59d=this.getCellCoordinates({x:_59c.xmin,y:_59c.ymax}),_59e=this.getCellCoordinates({x:_59c.xmax,y:_59c.ymin}),_59f=_59d.row,_5a0=_59e.row,_5a1=this.normalize(_59d.col),_5a2=this.normalize(_59e.col);return _59f+"_"+_5a0+"_"+_5a1+"_"+_5a2;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_5a3,_5a4){var _5a5=this.getCellCoordinates({x:_5a3.xmin,y:_5a3.ymax}),_5a6=this.getCellCoordinates({x:_5a3.xmax,y:_5a3.ymin}),_5a7=_5a5.row,_5a8=_5a6.row,_5a9=_5a5.col,_5aa=_5a6.col,_5ab=[],i,j,nj,_5ac=[],_5ad=[],len,xmin,xmax,ymin,ymax,_5ae=[],_5af,_5b0;for(i=_5a7;i<=_5a8;i++){for(j=_5a9;j<=_5aa;j++){nj=this.normalize(j);_5a3=this.getCellExtent(i,nj);_5ab.push({row:i,col:nj,extent:_5a3,resolution:this._resolution});if(_5a4){_5ac.push(_5a3.xmin,_5a3.xmax);_5ad.push(_5a3.ymin,_5a3.ymax);}}}_5a9=this.normalize(_5a9);_5aa=this.normalize(_5aa);_5ac.sort(this.sorter);_5ad.sort(this.sorter);len=_5ac.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_5ac[i]===_5ac[i+1]){_5ac.splice(i,1);}}}len=_5ad.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_5ad[i]===_5ad[i+1]){_5ad.splice(i,1);}}}if(_5ac.length&&_5ad.length){xmin=_5ac[0];xmax=_5ac[_5ac.length-1];ymin=_5ad[0];ymax=_5ad[_5ad.length-1];len=_5ac.length;for(i=0;i<len;i++){_5ae.push([[_5ac[i],ymax],[_5ac[i],ymin]]);}len=_5ad.length;for(i=0;i<len;i++){_5ae.push([[xmin,_5ad[i]],[xmax,_5ad[i]]]);}_5af=new _588({paths:_5ae,spatialReference:this.origin.spatialReference.toJson()});_5b0=_5a7+"_"+_5a8+"_"+_5a9+"_"+_5aa;_5ab.push({latticeID:_5b0,lattice:_5af,resolution:this._resolution});}return {minRow:_5a7,maxRow:_5a8,minCol:_5a9,maxCol:_5aa,cells:_5ab};}});if(has("extend-esri")){lang.setObject("layers._GridLayout",_589,_585);}return _589;});},"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n","dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(lang,_5b1,_5b2){var _5b3={};lang.setObject("dojo.data.util.simpleFetch",_5b3);_5b3.errorHandler=function(_5b4,_5b5){if(_5b5.onError){var _5b6=_5b5.scope||_5b1.global;_5b5.onError.call(_5b6,_5b4,_5b5);}};_5b3.fetchHandler=function(_5b7,_5b8){var _5b9=_5b8.abort||null,_5ba=false,_5bb=_5b8.start?_5b8.start:0,_5bc=(_5b8.count&&(_5b8.count!==Infinity))?(_5bb+_5b8.count):_5b7.length;_5b8.abort=function(){_5ba=true;if(_5b9){_5b9.call(_5b8);}};var _5bd=_5b8.scope||_5b1.global;if(!_5b8.store){_5b8.store=this;}if(_5b8.onBegin){_5b8.onBegin.call(_5bd,_5b7.length,_5b8);}if(_5b8.sort){_5b7.sort(_5b2.createSortFunction(_5b8.sort,this));}if(_5b8.onItem){for(var i=_5bb;(i<_5b7.length)&&(i<_5bc);++i){var item=_5b7[i];if(!_5ba){_5b8.onItem.call(_5bd,item,_5b8);}}}if(_5b8.onComplete&&!_5ba){var _5be=null;if(!_5b8.onItem){_5be=_5b7.slice(_5bb,_5bc);}_5b8.onComplete.call(_5bd,_5be,_5b8);}};_5b3.fetch=function(_5bf){_5bf=_5bf||{};if(!_5bf.store){_5bf.store=this;}this._fetchItems(_5bf,lang.hitch(this,"fetchHandler"),lang.hitch(this,"errorHandler"));return _5bf;};return _5b3;});},"dojo/dnd/Selector":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../dom","../dom-construct","../mouse","../_base/NodeList","../on","../touch","./common","./Container"],function(_5c0,_5c1,_5c2,_5c3,lang,dom,_5c4,_5c5,_5c6,on,_5c7,dnd,_5c8){var _5c9=_5c1("dojo.dnd.Selector",_5c8,{constructor:function(node,_5ca){if(!_5ca){_5ca={};}this.singular=_5ca.singular;this.autoSync=_5ca.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(on(this.node,_5c7.press,lang.hitch(this,"onMouseDown")),on(this.node,_5c7.release,lang.hitch(this,"onMouseUp")));},singular:false,getSelectedNodes:function(){var t=new _5c6();var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dom.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dom.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dom.byId(i);this.delItem(i);_5c4.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||_5c3.global;var s=this.selection,e=dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){_5c9.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}_5c0.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_5cb,data,_5cc,_5cd){var _5ce=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_5ce.call(this,item,hint);if(_5cb){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};_5c9.superclass.insertNodes.call(this,data,_5cc,_5cd);this._normalizedCreator=_5ce;return this;},destroy:function(){_5c9.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(_5c5.isLeft(e)){_5c2.stop(e);}return;}if(!this.singular&&e.shiftKey){if(!dnd.getCopyKeyState(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0,node;for(;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dnd.getCopyKeyState(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dnd.getCopyKeyState(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}_5c2.stop(e);},onMouseUp:function(){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=on(this.node,_5c7.move,lang.hitch(this,"onMouseMove"));},onOutEvent:function(){if(this.onmousemoveEvent){this.onmousemoveEvent.remove();delete this.onmousemoveEvent;}},_removeSelection:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dom.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return _5c9;});},"dojox/grid/_Grid":function(){require({cache:{"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n"}});define("dojox/grid/_Grid",["dojo/_base/kernel","../main","dojo/_base/declare","./_Events","./_Scroller","./_Layout","./_View","./_ViewManager","./_RowManager","./_FocusManager","./_EditManager","./Selection","./_RowSelector","./util","dijit/_Widget","dijit/_TemplatedMixin","dijit/CheckedMenuItem","dojo/text!./resources/_Grid.html","dojo/string","dojo/_base/array","dojo/_base/lang","dojo/_base/sniff","dojox/html/metrics","dojo/_base/html","dojo/query","dojo/dnd/common","dojo/i18n!dijit/nls/loading"],function(dojo,_5cf,_5d0,_5d1,_5d2,_5d3,_5d4,_5d5,_5d6,_5d7,_5d8,_5d9,_5da,util,_5db,_5dc,_5dd,_5de,_5df,_5e0,lang,has,_5e1,html,_5e2){if(!dojo.isCopyKey){dojo.isCopyKey=dojo.dnd.getCopyKeyState;}var _5e3=_5d0("dojox.grid._Grid",[_5db,_5dc,_5d1],{templateString:_5de,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,summary:"",_setSummaryAttr:"domNode",sortInfo:0,_placeholders:null,_layoutClass:_5d3,buildRendering:function(){this.inherited(arguments);if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_5e1.initOnFontResize();this.connect(_5e1,"onFontResize","textSizeChanged");util.funnelEvents(this.domNode,this,"doKeyEvent",util.keyEvents);if(this.selectionMode!="none"){this.domNode.setAttribute("aria-multiselectable",this.selectionMode=="single"?"false":"true");}html.addClass(this.domNode,this.classTag);if(!this.isLeftToRight()){html.addClass(this.domNode,this.classTag+"Rtl");}if(this.rowHeight>0){html.addClass(this.viewsNode,this.classTag+"FixedRowHeight");}},postMixInProperties:function(){this.inherited(arguments);var _5e4=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_5df.substitute(this.loadingMessage,_5e4);this.errorMessage=_5df.substitute(this.errorMessage,_5e4);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){html.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;if(this.scroller){this.scroller.destroy();delete this.scroller;}this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_5e0.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_5e5){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.get("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_5e5){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _5d6(this);this.focus=new _5d7(this);this.edit=new _5d8(this);},createSelection:function(){this.selection=new _5d9(this);},createScroller:function(){this.scroller=new _5d2();this.scroller.grid=this;this.scroller.renderRow=lang.hitch(this,"renderRow");this.scroller.removeRow=lang.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.update();},onResizeColumn:function(_5e6){},createViews:function(){this.views=new _5d5(this);this.views.createView=lang.hitch(this,"createView");},createView:function(_5e7,idx){var c=lang.getObject(_5e7);var view=new c({grid:this,index:idx});this.viewsNode.appendChild(view.domNode);this.viewsHeaderNode.appendChild(view.headerNode);this.views.addView(view);html.attr(this.domNode,"align",this.isLeftToRight()?"left":"right");return view;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_5cf._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_5e8){var s=_5e8;if(s&&lang.isString(s)){dojo.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0");s=lang.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();this.focus.focusView=null;if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_5e9){dojo.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(_5e9);},getColumnTogglingItems:function(){var _5ea,_5eb=[];_5ea=_5e0.map(this.layout.cells,function(cell){if(!cell.menuItems){cell.menuItems=[];}var self=this;var item=new _5dd({label:cell.name,checked:!cell.hidden,_gridCell:cell,onChange:function(_5ec){if(self.layout.setColumnVisibility(this._gridCell.index,_5ec)){var _5ed=this._gridCell.menuItems;if(_5ed.length>1){_5e0.forEach(_5ed,function(item){if(item!==this){item.setAttribute("checked",_5ec);}},this);}_5ec=_5e0.filter(self.layout.cells,function(c){if(c.menuItems.length>1){_5e0.forEach(c.menuItems,"item.set('disabled', false);");}else{c.menuItems[0].set("disabled",false);}return !c.hidden;});if(_5ec.length==1){_5e0.forEach(_5ec[0].menuItems,"item.set('disabled', true);");}}},destroy:function(){var _5ee=_5e0.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_5ee,1);delete this._gridCell;_5dd.prototype.destroy.apply(this,arguments);}});cell.menuItems.push(item);if(!cell.hidden){_5eb.push(item);}return item;},this);if(_5eb.length==1){_5eb[0].set("disabled",true);}return _5ea;},_setHeaderMenuAttr:function(menu){if(this._placeholders&&this._placeholders.length){_5e0.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=menu;if(!menu){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(menu){dojo.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(menu);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_5e0.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_5ef){this.setScrollTop(0);},getItem:function(_5f0){return null;},showMessage:function(_5f1){if(_5f1){this.messagesNode.innerHTML=_5f1;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_5f2,_5f3){this._pendingChangeSize=_5f2;this._pendingResultSize=_5f3;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||html._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_5f4,_5f5){_5f4=_5f4||this._pendingChangeSize;_5f5=_5f5||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _5f6=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_5f6.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_5f5){_5f4=_5f5;}if(!this._autoHeight&&_5f4){html.marginBox(this.domNode,_5f4);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=(this._parentContentBoxHeight>0?this._parentContentBoxHeight:html._getContentBox(pn).h);this.domNode.style.height=Math.max(0,h)+"px";}}var _5f7=_5e0.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||html._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_5f7&&hh===undefined){hh=this._getHeaderHeight();}}if(_5f7){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _5f8=(!this.initialWidth&&this.autoWidth);var w=_5f8?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_5f8){this.domNode.style.width=vw+"px";}},adaptHeight:function(_5f9){var t=_5f9===undefined?this._getHeaderHeight():_5f9;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _5fa=0,_5fb=0;var _5fc=_5e0.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_5fa++;}else{_5fb++;}return (!has);});if(_5fa>0&&_5fb>0){_5e0.forEach(_5fc,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.get("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();html.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var size=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=size;}},renderRow:function(_5fd,_5fe){this.views.renderRow(_5fd,_5fe,this._skipRowRenormalize);},rowRemoved:function(_5ff){this.views.rowRemoved(_5ff);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_600){_600=Number(_600);if(this.updating){this.invalidated[_600]=true;}else{this.views.updateRow(_600);this.scroller.rowHeightChanged(_600);}},updateRows:function(_601,_602){_601=Number(_601);_602=Number(_602);var i;if(this.updating){for(i=0;i<_602;i++){this.invalidated[i+_601]=true;}}else{for(i=0;i<_602;i++){this.views.updateRow(i+_601,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_601);}},updateRowCount:function(_603){if(this.updating){this.invalidated.rowCount=_603;}else{this.rowCount=_603;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_603);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_604){this.views.updateRowStyles(_604);},getRowNode:function(_605){if(this.focus.focusView&&!(this.focus.focusView instanceof _5da)){return this.focus.focusView.rowNodes[_605];}else{for(var i=0,_606;(_606=this.views.views[i]);i++){if(!(_606 instanceof _5da)){return _606.rowNodes[_605];}}}return null;},rowHeightChanged:function(_607){this.views.renormalizeRow(_607);this.scroller.rowHeightChanged(_607);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(has("ie")?100:50),scrollTo:function(_608){if(!this.fastScroll){this.setScrollTop(_608);return;}var _609=Math.abs(this.lastScrollTop-_608);this.lastScrollTop=_608;if(_609>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_608;this.views.setScrollTop(_608);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _60a=this;this._pendingScroll=window.setTimeout(function(){delete _60a._pendingScroll;_60a.finishScrollJob();},200);}else{this.setScrollTop(_608);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_60b){this.scroller.scroll(this.views.setScrollTop(_60b));},scrollToRow:function(_60c){this.setScrollTop(this.scroller.findScrollTop(_60c)+1);},styleRowNode:function(_60d,_60e){if(_60e){this.rows.styleRowNode(_60d,_60e);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_60f){return this.layout.cells[_60f];},setCellWidth:function(_610,_611){this.getCell(_610).unitWidth=_611;},getCellName:function(_612){return "Cell "+_612.index;},canSort:function(_613){},sort:function(){},getSortAsc:function(_614){_614=_614==undefined?this.sortInfo:_614;return Boolean(_614>0);},getSortIndex:function(_615){_615=_615==undefined?this.sortInfo:_615;return Math.abs(_615)-1;},setSortIndex:function(_616,_617){var si=_616+1;if(_617!=undefined){si*=(_617?1:-1);}else{if(this.getSortIndex()==_616){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_618){if(this.canSort(_618)){this.sortInfo=_618;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_619,_61a){this.onStartEdit(_619,_61a);},doApplyCellEdit:function(_61b,_61c,_61d){this.onApplyCellEdit(_61b,_61c,_61d);},doCancelEdit:function(_61e){this.onCancelEdit(_61e);},doApplyEdit:function(_61f){this.onApplyEdit(_61f);},addRow:function(){this.updateRowCount(this.get("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_5e3.markupFactory=function(_620,node,ctor,_621){var _622=function(n){var w=html.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_620.structure&&node.nodeName.toLowerCase()=="table"){_620.structure=_5e2("> colgroup",node).map(function(cg){var sv=html.attr(cg,"span");var v={noscroll:(html.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(html.hasAttr(cg,"width")){v.width=_622(cg);}return v;});if(!_620.structure.length){_620.structure.push({__span:Infinity,cells:[]});}_5e2("thead > tr",node).forEach(function(tr,_623){var _624=0;var _625=0;var _626;var _627=null;_5e2("> th",tr).map(function(th){if(!_627){_626=0;_627=_620.structure[0];}else{if(_624>=(_626+_627.__span)){_625++;_626+=_627.__span;var _628=_627;_627=_620.structure[_625];}}var cell={name:lang.trim(html.attr(th,"name")||th.innerHTML),colSpan:parseInt(html.attr(th,"colspan")||1,10),type:lang.trim(html.attr(th,"cellType")||""),id:lang.trim(html.attr(th,"id")||"")};_624+=cell.colSpan;var _629=html.attr(th,"rowspan");if(_629){cell.rowSpan=_629;}if(html.hasAttr(th,"width")){cell.width=_622(th);}if(html.hasAttr(th,"relWidth")){cell.relWidth=window.parseInt(html.attr(th,"relWidth"),10);}if(html.hasAttr(th,"hidden")){cell.hidden=(html.attr(th,"hidden")=="true"||html.attr(th,"hidden")===true);}if(_621){_621(th,cell);}cell.type=cell.type?lang.getObject(cell.type):_5cf.grid.cells.Cell;if(cell.type&&cell.type.markupFactory){cell.type.markupFactory(th,cell);}if(!_627.cells[_623]){_627.cells[_623]=[];}_627.cells[_623].push(cell);});});}return new ctor(_620,node);};return _5e3;});},"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n","dojo/data/util/sorter":function(){define(["../../_base/lang"],function(lang){var _62a={};lang.setObject("dojo.data.util.sorter",_62a);_62a.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_62a.createSortFunction=function(_62b,_62c){var _62d=[];function _62e(attr,dir,comp,s){return function(_62f,_630){var a=s.getValue(_62f,attr);var b=s.getValue(_630,attr);return dir*comp(a,b);};};var _631;var map=_62c.comparatorMap;var bc=_62a.basicComparator;for(var i=0;i<_62b.length;i++){_631=_62b[i];var attr=_631.attribute;if(attr){var dir=(_631.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_62d.push(_62e(attr,dir,comp,_62c));}}return function(rowA,rowB){var i=0;while(i<_62d.length){var ret=_62d[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _62a;});},"esri/toolbars/_GraphicMover":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/json","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/Mover","dojox/gfx/matrix","esri/kernel","esri/geometry/webMercatorUtils","esri/geometry/ScreenPoint"],function(_632,lang,_633,_634,has,_635,_636,_637,_638,_639,_63a,_63b){var GM=_632(null,{declaredClass:"esri.toolbars._GraphicMover",constructor:function(_63c,map,_63d){this.graphic=_63c;this.map=map;this.toolbar=_63d;this._enableGraphicMover();this._moved=false;},refresh:function(_63e){var _63f=this.graphic.getDojoShape();if(_63f&&(_63e||!_63f._hostGraphic)){this._disableGraphicMover();this._enableGraphicMover();}},destroy:function(){this._disableGraphicMover();},hasMoved:function(){return this._moved;},_enableGraphicMover:function(){var _640=this.graphic,_641=_640.getDojoShape();if(_641){_641._hostGraphic=_640;this._moveable=new _636(_641,{mover:GM.Mover});this._moveStartHandle=_633.connect(this._moveable,"onMoveStart",this,this._moveStartHandler);this._firstMoveHandle=_633.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_633.connect(this._moveable,"onMoving",this,this._movingHandler);this._moveStopHandle=_633.connect(this._moveable,"onMoveStop",this,this._moveStopHandler);var node=_641.getEventSource();if(node){_635.set(node,"cursor",this.toolbar._cursors.move);}}},_disableGraphicMover:function(){var _642=this._moveable;if(_642){_633.disconnect(this._moveStartHandle);_633.disconnect(this._firstMoveHandle);_633.disconnect(this._movingHandle);_633.disconnect(this._moveStopHandle);var _643=_642.shape;if(_643){_643._hostGraphic=null;var node=_643.getEventSource();if(node){_635.set(node,"cursor",null);}}_642.destroy();}this._moveable=null;},_moveStartHandler:function(){var _644=this.graphic,map=this.map;this._startTx=_644.getDojoShape().getTransform();if(this.graphic.geometry.type==="point"){if(map.snappingManager){map.snappingManager._setUpSnapping();}}this.toolbar.onGraphicMoveStart(_644);},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic);},_movingHandler:function(_645){this.toolbar.onGraphicMove(this.graphic,_645.shape.getTransform());},_moveStopHandler:function(_646){var _647=this.graphic,_648=this.toolbar,map=this.map,mx=_638,_649=_648._geo?_63a.geographicToWebMercator(_647.geometry):_647.geometry,type=_649.type,_64a=_647.getDojoShape(),tx=_64a.getTransform();if(_634.toJson(tx)!==_634.toJson(this._startTx)){this._moved=true;switch(type){case "point":var _64b=[tx,mx.invert(this._startTx)],_64c;if(map.snappingManager){_64c=map.snappingManager._snappingPoint;}_649=_64c||map.toMap(mx.multiplyPoint(_64b,map.toScreen(_649,true)));if(map.snappingManager){map.snappingManager._killOffSnapping();}break;case "polyline":_649=this._updatePolyGeometry(_649,_649.paths,tx);break;case "polygon":_649=this._updatePolyGeometry(_649,_649.rings,tx);break;}_64a.setTransform(null);_647.setGeometry(_648._geo?_63a.webMercatorToGeographic(_649,true):_649);}else{this._moved=false;}_648._endOperation("MOVE");_648.onGraphicMoveStop(_647,tx);if(!this._moved){var e=_646.__e,_64d=this.map.position,pt=new _63b(e.pageX-_64d.x,e.pageY-_64d.y);_648.onGraphicClick(_647,{screenPoint:pt,mapPoint:this.map.toMap(pt)});}},_updatePolyGeometry:function(_64e,_64f,_650){var map=this.map,_651=_64e.getPoint(0,0),_652=map.toMap(map.toScreen(_651).offset(_650.dx,_650.dy)),_653=_652.x-_651.x,_654=_652.y-_651.y,i,j,seg,_655;for(i=0;i<_64f.length;i++){seg=_64f[i];for(j=0;j<seg.length;j++){_655=_64e.getPoint(i,j);_64e.setPoint(i,j,_655.offset(_653,_654));}}return _64e;}});GM.Mover=_632(_637,{declaredClass:"esri.toolbars._Mover",constructor:function(_656,e,host){this.__e=e;}});if(has("extend-esri")){lang.setObject("toolbars._GraphicMover",GM,_639);lang.setObject("toolbars._Mover",GM.Mover,_639);}return GM;});},"dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_657,_658,_659,_65a,keys,_65b,_65c,_65d,lang){return _65b("dijit._KeyNavContainer",[_659,_658],{tabIndex:"0",connectKeyNavHandlers:function(_65e,_65f){var _660=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_65a.forEach(_65e,function(code){_660[code]=prev;});_65a.forEach(_65f,function(code){_660[code]=next;});_660[keys.HOME]=lang.hitch(this,"focusFirstChild");_660[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_657.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_65a.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_661,_662){this.inherited(arguments);this._startupChild(_661);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_663,last){if(!_663){return;}if(this.focusedChild&&_663!==this.focusedChild){this._onChildBlur(this.focusedChild);}_663.set("tabIndex",this.tabIndex);_663.focus(last?"end":"start");this._set("focusedChild",_663);},_startupChild:function(_664){_664.set("tabIndex","-1");this.connect(_664,"_onFocus",function(){_664.set("tabIndex",this.tabIndex);});this.connect(_664,"_onBlur",function(){_664.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_65d.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_65d.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_65c.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_665,dir){if(_665){_665=this._getSiblingOfChild(_665,dir);}var _666=this.getChildren();for(var i=0;i<_666.length;i++){if(!_665){_665=_666[(dir>0)?0:(_666.length-1)];}if(_665.isFocusable()){return _665;}_665=this._getSiblingOfChild(_665,dir);}return null;}});});},"esri/toolbars/edit":function(){define("esri/toolbars/edit",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/Color","dojo/has","esri/kernel","esri/lang","esri/sniff","esri/toolbars/_toolbar","esri/toolbars/_Box","esri/toolbars/_GraphicMover","esri/toolbars/_VertexEditor","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"],function(_667,lang,_668,_669,_66a,has,_66b,_66c,_66d,_66e,Box,_66f,_670,_671,_672){var EDT=_667(_66e,{declaredClass:"esri.toolbars.Edit",constructor:function(map,_673){this._map=map;this._tool=0;if(this._map.loaded){this._scratchGL=map.graphics;}else{var _674=_668.connect(this._map,"onLoad",this,function(){_668.disconnect(_674);_674=null;this._scratchGL=this._map.graphics;});}var _675=has("esri-touch")||has("esri-pointer");this._defaultOptions=lang.mixin({vertexSymbol:new _671(_671.STYLE_CIRCLE,_675?20:12,new _672(_672.STYLE_SOLID,new _66a([0,0,0,0.5]),1),new _66a([128,128,128])),ghostVertexSymbol:new _671(_671.STYLE_CIRCLE,_675?18:10,new _672(_672.STYLE_SOLID,new _66a([0,0,0,0.5]),1),new _66a([255,255,255,0.75])),ghostLineSymbol:new _672(_672.STYLE_DOT,new _66a([128,128,128]),2),allowDeleteVertices:true,allowAddVertices:true,rotateHandleOffset:_675?24:16,boxLineSymbol:new _672(_672.STYLE_DASH,new _66a([64,64,64]),1),boxHandleSymbol:new _671(_671.STYLE_SQUARE,_675?16:9,new _672(_672.STYLE_SOLID,new _66a([0,0,0,0.5]),1),new _66a([255,255,255,0.75]))},_673||{});},activate:function(tool,_676,_677){this.deactivate();this._graphic=_676;this._options=lang.mixin(lang.mixin({},this._defaultOptions),_677||{});var MOVE=EDT.MOVE,EDIT=EDT.EDIT_VERTICES,_678=EDT.SCALE,_679=EDT.ROTATE,move=false,edit=false,box=false,map=this._map,_67a=map.spatialReference,_67b=_676.geometry.spatialReference;this._geo=!!(_67a&&_67b&&!_67a.equals(_67b)&&_67a.isWebMercator()&&_67b.wkid===4326);if((tool&MOVE)===MOVE){move=this._enableMove(_676);}var _67c=((tool&_678)===_678),_67d=((tool&_679)===_679);if(_67c||_67d){box=this._enableBoxEditing(_676,_67c,_67d);}if((tool&EDIT)===EDIT){edit=this._enableVertexEditing(_676);}if(!(move||edit||box)){throw new Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");}this._tool=tool;if(this._tool){this._mapPanEndHandle=_668.connect(map,"onPanEnd",this,this._mapPanEndHandler);this._mapExtChgHandle=_668.connect(map,"onExtentChange",this,this._mapExtentChangeHandler);this.onActivate(this._tool,_676);}if(map.snappingManager&&(move||edit)){map.snappingManager._startSelectionLayerQuery();}},deactivate:function(){var tool=this._tool,_67e=this._graphic;if(!tool){return;}var _67f=!!this._modified;this._clear();_668.disconnect(this._mapPanEndHandle);_668.disconnect(this._mapExtChgHandle);this._mapPanEndHandle=this._mapExtChgHandle=null;this._graphic=this._geo=null;this.onDeactivate(tool,_67e,{isModified:_67f});if(this._map.snappingManager){this._map.snappingManager._stopSelectionLayerQuery();}},refresh:function(){this._refreshMoveables(true);},getCurrentState:function(){return {tool:this._tool,graphic:this._graphic,isModified:!!this._modified};},onActivate:function(tool,_680){},onDeactivate:function(tool,_681,info){},onGraphicMoveStart:function(_682){},onGraphicFirstMove:function(_683){this._modified=true;},onGraphicMove:function(_684,_685){},onGraphicMoveStop:function(_686,_687){},onGraphicClick:function(_688,info){},onVertexMoveStart:function(_689,_68a){},onVertexFirstMove:function(_68b,_68c){this._modified=true;},onVertexMove:function(_68d,_68e,_68f){},onVertexMoveStop:function(_690,_691,_692){},onVertexAdd:function(_693,_694){this._modified=true;},onVertexClick:function(_695,_696){},onVertexMouseOver:function(_697,_698){},onVertexMouseOut:function(_699,_69a){},onVertexDelete:function(_69b,_69c){this._modified=true;},onScaleStart:function(_69d){},onScaleFirstMove:function(_69e){this._modified=true;},onScale:function(_69f,info){},onScaleStop:function(_6a0,info){},onRotateStart:function(_6a1){},onRotateFirstMove:function(_6a2){this._modified=true;},onRotate:function(_6a3,info){},onRotateStop:function(_6a4,info){},_eventMap:{activate:["tool","graphic"],deactivate:["tool","graphic","info"],"graphic-move-start":["graphic"],"graphic-first-move":["graphic"],"graphic-move":["graphic","transform"],"graphic-move-stop":["graphic","transform"],"graphic-click":["graphic","info"],"vertex-move-start":["graphic","vertexinfo"],"vertex-first-move":["graphic","vertexinfo"],"vertex-move":["graphic","vertexinfo","transform"],"vertex-move-stop":["graphic","vertexinfo","transform"],"vertex-add":["graphic","vertexinfo"],"vertex-click":["graphic","vertexinfo"],"vertex-mouse-over":["graphic","vertexinfo"],"vertex-mouse-out":["graphic","vertexinfo"],"vertex-delete":["graphic","vertexinfo"],"scale-start":["graphic"],"scale-first-move":["graphic"],scale:["graphic","info"],"scale-stop":["graphic","info"],"rotate-start":["graphic"],"rotate-first-move":["graphic"],rotate:["graphic","info"],"rotate-stop":["graphic","info"]},_enableMove:function(_6a5){var map=this._map,type=_6a5.geometry.type;switch(type){case "point":case "polyline":case "polygon":this._graphicMover=new _66f(_6a5,map,this);return true;case "multipoint":break;}return false;},_enableVertexEditing:function(_6a6){var map=this._map,type=_6a6.geometry.type;switch(type){case "point":break;case "multipoint":case "polyline":case "polygon":this._vertexEditor=_670.create(_6a6,map,this);return true;}return false;},_enableBoxEditing:function(_6a7,_6a8,_6a9){var map=this._map,type=_6a7.geometry.type;switch(type){case "point":case "multipoint":break;case "polyline":case "polygon":this._boxEditor=new Box(_6a7,map,this,_6a8,_6a9,this._options.uniformScaling);return true;}return false;},_disableMove:function(){var _6aa=this._graphicMover;if(_6aa){_6aa.destroy();this._graphicMover=null;}},_disableVertexEditing:function(){var _6ab=this._vertexEditor;if(_6ab){_6ab.destroy();this._vertexEditor=null;}},_disableBoxEditing:function(){var box=this._boxEditor;if(box){box.destroy();this._boxEditor=null;}},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._tool=0;this._modified=false;},_mapPanEndHandler:function(){this._refreshMoveables();},_mapExtentChangeHandler:function(e,d,_6ac){if(_6ac){this._refreshMoveables();}},_refreshMoveables:function(_6ad){var _6ae=_669.filter([this._graphicMover,this._vertexEditor,this._boxEditor],_66c.isDefined);_669.forEach(_6ae,function(mov){mov.refresh(_6ad);});},_beginOperation:function(_6af){_669.forEach(this._getAffectedTools(_6af),function(tool){tool.suspend();});},_endOperation:function(_6b0){_669.forEach(this._getAffectedTools(_6b0),function(tool){tool.resume();});},_getAffectedTools:function(_6b1){var _6b2=[];switch(_6b1){case "MOVE":_6b2=[this._vertexEditor,this._boxEditor];break;case "VERTICES":_6b2=[this._boxEditor];break;case "BOX":_6b2=[this._vertexEditor];break;}_6b2=_669.filter(_6b2,_66c.isDefined);return _6b2;}});lang.mixin(EDT,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8});if(has("extend-esri")){lang.setObject("toolbars.Edit",EDT,_66b);}return EDT;});},"esri/layers/SnapshotMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/SpatialReference","esri/tasks/query","esri/layers/RenderMode"],function(_6b3,lang,has,_6b4,_6b5,_6b6,_6b7){var _6b8=_6b3([_6b7],{declaredClass:"esri.layers._SnapshotMode",constructor:function(_6b9){this.featureLayer=_6b9;this._featureMap={};this._drawFeatures=lang.hitch(this,this._drawFeatures);this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},startup:function(){if(this.featureLayer._collection){this._applyTimeFilter();}else{this._fetchAll();}},propertyChangeHandler:function(type){if(this._init){if(type){if(this.featureLayer._collection){console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id = "+this.featureLayer.id);}else{this._fetchAll();}}else{this._applyTimeFilter();}}},drawFeature:function(_6ba){var _6bb=this.featureLayer,_6bc=_6bb.objectIdField,oid=_6ba.attributes[_6bc];this._addFeatureIIf(oid,_6ba);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _6bd=this.featureLayer;if(_6bd._collection){_6bd._fireUpdateStart();_6bd._refresh(true);_6bd._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_6be){var id="_"+_6be.name+_6be.layerId+_6be._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _6bf=this.featureLayer;if(_6bf._collection){return;}_6bf._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_6c0=this.featureLayer,_6c1=_6c0.getDefinitionExpression();var _6c2=new _6b6();_6c2.outFields=_6c0.getOutFields();_6c2.where=_6c1||"1=1";_6c2.returnGeometry=true;_6c2.outSpatialReference=new _6b5(map.spatialReference.toJson());_6c2.timeExtent=_6c0.getTimeDefinition();_6c2.maxAllowableOffset=_6c0._maxOffset;if(_6c0._ts){_6c2._ts=(new Date()).getTime();}var _6c3;if(_6c0._usePatch){_6c3=this._getRequestId(_6c0);this._cancelPendingRequest(null,_6c3);}_6c0._task.execute(_6c2,this._drawFeatures,this._queryErrorHandler,_6c3);},_drawFeatures:function(_6c4){this._purgeRequests();var _6c5=_6c4.features,_6c6=this.featureLayer,_6c7=_6c6.objectIdField,i,len=_6c5.length,_6c8,oid;for(i=0;i<len;i++){_6c8=_6c5[i];oid=_6c8.attributes[_6c7];this._addFeatureIIf(oid,_6c8);this._incRefCount(oid);}this._applyTimeFilter(true);_6c6._fireUpdateEnd(null,_6c4.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_6c4.exceededTransferLimit){_6c6.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _6c9=this.featureLayer;_6c9._errorHandler(err);_6c9._fireUpdateEnd(err);}});if(has("extend-esri")){lang.setObject("layers._SnapshotMode",_6b8,_6b4);}return _6b8;});},"dojox/gfx/Mover":function(){define("dojox/gfx/Mover",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/on","dojo/touch","dojo/_base/event"],function(lang,arr,_6ca,on,_6cb,_6cc){return _6ca("dojox.gfx.Mover",null,{constructor:function(_6cd,e,host){this.shape=_6cd;this.lastX=e.clientX;this.lastY=e.clientY;var h=this.host=host,d=document,_6ce=on(d,_6cb.move,lang.hitch(this,"onFirstMove"));this.events=[on(d,_6cb.move,lang.hitch(this,"onMouseMove")),on(d,_6cb.release,lang.hitch(this,"destroy")),on(d,"dragstart",lang.hitch(_6cc,"stop")),on(d,"selectstart",lang.hitch(_6cc,"stop")),_6ce];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){var x=e.clientX;var y=e.clientY;this.host.onMove(this,{dx:x-this.lastX,dy:y-this.lastY});this.lastX=x;this.lastY=y;_6cc.stop(e);},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove();},destroy:function(){arr.forEach(this.events,function(_6cf){_6cf.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.shape=null;}});});},"esri/layers/SelectionMode":function(){define("esri/layers/SelectionMode",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/layers/RenderMode"],function(_6d0,lang,has,_6d1,_6d2){var _6d3=_6d0([_6d2],{declaredClass:"esri.layers._SelectionMode",constructor:function(_6d4){this.featureLayer=_6d4;this._featureMap={};},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},resume:function(){this.propertyChangeHandler(0);}});if(has("extend-esri")){lang.setObject("layers._SelectionMode",_6d3,_6d1);}return _6d3;});},"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n","dojox/grid/_EditManager":function(){define("dojox/grid/_EditManager",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect","dojo/_base/sniff","./util"],function(lang,_6d5,_6d6,_6d7,has,util){return _6d6("dojox.grid._EditManager",null,{constructor:function(_6d8){this.grid=_6d8;if(has("ie")){this.connections=[_6d7.connect(document.body,"onfocus",lang.hitch(this,"_boomerangFocus"))];}else{this.connections=[_6d7.connect(this.grid,"onBlur",this,"apply")];}},info:{},destroy:function(){_6d5.forEach(this.connections,_6d7.disconnect);},cellFocus:function(_6d9,_6da){if(this.grid.singleClickEdit||this.isEditRow(_6da)){this.setEditCell(_6d9,_6da);}else{this.apply();}if(this.isEditing()||(_6d9&&_6d9.editable&&_6d9.alwaysEditing)){this._focusEditor(_6d9,_6da);}},rowClick:function(e){if(this.isEditing()&&!this.isEditRow(e.rowIndex)){this.apply();}},styleRow:function(_6db){if(_6db.index==this.info.rowIndex){_6db.customClasses+=" dojoxGridRowEditing";}},dispatchEvent:function(e){var c=e.cell,ed=(c&&c["editable"])?c:0;return ed&&ed.dispatchEvent(e.dispatch,e);},isEditing:function(){return this.info.rowIndex!==undefined;},isEditCell:function(_6dc,_6dd){return (this.info.rowIndex===_6dc)&&(this.info.cell.index==_6dd);},isEditRow:function(_6de){return this.info.rowIndex===_6de;},setEditCell:function(_6df,_6e0){if(!this.isEditCell(_6e0,_6df.index)&&this.grid.canEdit&&this.grid.canEdit(_6df,_6e0)){this.start(_6df,_6e0,this.isEditRow(_6e0)||_6df.editable);}},_focusEditor:function(_6e1,_6e2){util.fire(_6e1,"focus",[_6e2]);},focusEditor:function(){if(this.isEditing()){this._focusEditor(this.info.cell,this.info.rowIndex);}},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>new Date().getTime();},_boomerangFocus:function(){if(this._shouldCatchBoomerang()){this.grid.focus.focusGrid();this.focusEditor();this._catchBoomerang=0;}},_doCatchBoomerang:function(){if(has("ie")){this._catchBoomerang=new Date().getTime()+this._boomerangWindow;}},start:function(_6e3,_6e4,_6e5){if(!this._isValidInput()){return;}this.grid.beginUpdate();this.editorApply();if(this.isEditing()&&!this.isEditRow(_6e4)){this.applyRowEdit();this.grid.updateRow(_6e4);}if(_6e5){this.info={cell:_6e3,rowIndex:_6e4};this.grid.doStartEdit(_6e3,_6e4);this.grid.updateRow(_6e4);}else{this.info={};}this.grid.endUpdate();this.grid.focus.focusGrid();this._focusEditor(_6e3,_6e4);this._doCatchBoomerang();},_editorDo:function(_6e6){var c=this.info.cell;if(c&&c.editable){c[_6e6](this.info.rowIndex);}},editorApply:function(){this._editorDo("apply");},editorCancel:function(){this._editorDo("cancel");},applyCellEdit:function(_6e7,_6e8,_6e9){if(this.grid.canEdit(_6e8,_6e9)){this.grid.doApplyCellEdit(_6e7,_6e9,_6e8.field);}},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field);},apply:function(){if(this.isEditing()&&this._isValidInput()){this.grid.beginUpdate();this.editorApply();this.applyRowEdit();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},cancel:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorCancel();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},save:function(_6ea,_6eb){var c=this.info.cell;if(this.isEditRow(_6ea)&&(!_6eb||c.view==_6eb)&&c.editable){c.save(c,this.info.rowIndex);}},restore:function(_6ec,_6ed){var c=this.info.cell;if(this.isEditRow(_6ed)&&c.view==_6ec&&c.editable){c.restore(this.info.rowIndex);}},_isValidInput:function(){var w=(this.info.cell||{}).widget;if(!w||!w.isValid){return true;}w.focused=true;return w.isValid(true);}});});},"dojox/grid/_ViewManager":function(){define("dojox/grid/_ViewManager",["dojo/_base/declare","dojo/_base/sniff","dojo/dom-class"],function(_6ee,has,_6ef){return _6ee("dojox.grid._ViewManager",null,{constructor:function(_6f0){this.grid=_6f0;},defaultWidth:200,views:[],resize:function(){this.onEach("resize");},render:function(){this.onEach("render");},addView:function(_6f1){_6f1.idx=this.views.length;this.views.push(_6f1);},destroyViews:function(){for(var i=0,v;v=this.views[i];i++){v.destroy();}this.views=[];},getContentNodes:function(){var _6f2=[];for(var i=0,v;v=this.views[i];i++){_6f2.push(v.contentNode);}return _6f2;},forEach:function(_6f3){for(var i=0,v;v=this.views[i];i++){_6f3(v,i);}},onEach:function(_6f4,_6f5){_6f5=_6f5||[];for(var i=0,v;v=this.views[i];i++){if(_6f4 in v){v[_6f4].apply(v,_6f5);}}},normalizeHeaderNodeHeight:function(){var _6f6=[];for(var i=0,v;(v=this.views[i]);i++){if(v.headerContentNode.firstChild){_6f6.push(v.headerContentNode);}}this.normalizeRowNodeHeights(_6f6);},normalizeRowNodeHeights:function(_6f7){var h=0;var _6f8=[];if(this.grid.rowHeight){h=this.grid.rowHeight;}else{if(_6f7.length<=1){return;}for(var i=0,n;(n=_6f7[i]);i++){if(!_6ef.contains(n,"dojoxGridNonNormalizedCell")){_6f8[i]=n.firstChild.offsetHeight;h=Math.max(h,_6f8[i]);}}h=(h>=0?h:0);if((has("mozilla")||has("ie")>8)&&h){h++;}}for(i=0;(n=_6f7[i]);i++){if(_6f8[i]!=h){n.firstChild.style.height=h+"px";}}},resetHeaderNodeHeight:function(){for(var i=0,v,n;(v=this.views[i]);i++){n=v.headerContentNode.firstChild;if(n){n.style.height="";}}},renormalizeRow:function(_6f9){var _6fa=[];for(var i=0,v,n;(v=this.views[i])&&(n=v.getRowNode(_6f9));i++){n.firstChild.style.height="";_6fa.push(n);}this.normalizeRowNodeHeights(_6fa);},getViewWidth:function(_6fb){return this.views[_6fb].getWidth()||this.defaultWidth;},measureHeader:function(){this.resetHeaderNodeHeight();this.forEach(function(_6fc){_6fc.headerContentNode.style.height="";});var h=0;this.forEach(function(_6fd){h=Math.max(_6fd.headerNode.offsetHeight,h);});return h;},measureContent:function(){var h=0;this.forEach(function(_6fe){h=Math.max(_6fe.domNode.offsetHeight,h);});return h;},findClient:function(_6ff){var c=this.grid.elasticView||-1;if(c<0){for(var i=1,v;(v=this.views[i]);i++){if(v.viewWidth){for(i=1;(v=this.views[i]);i++){if(!v.viewWidth){c=i;break;}}break;}}}if(c<0){c=Math.floor(this.views.length/2);}return c;},arrange:function(l,w){var i,v,vw,len=this.views.length,self=this;var c=(w<=0?len:this.findClient());var _700=function(v,l){var ds=v.domNode.style;var hs=v.headerNode.style;if(!self.grid.isLeftToRight()){ds.right=l+"px";if(has("ff")<4){hs.right=l+v.getScrollbarWidth()+"px";}else{hs.right=l+"px";}if(!has("webkit")){hs.width=parseInt(hs.width,10)-v.getScrollbarWidth()+"px";}}else{ds.left=l+"px";hs.left=l+"px";}ds.top=0+"px";hs.top=0;};for(i=0;(v=this.views[i])&&(i<c);i++){vw=this.getViewWidth(i);v.setSize(vw,0);_700(v,l);if(v.headerContentNode&&v.headerContentNode.firstChild){vw=v.getColumnsWidth()+v.getScrollbarWidth();}else{vw=v.domNode.offsetWidth;}l+=vw;}i++;var r=w;for(var j=len-1;(v=this.views[j])&&(i<=j);j--){vw=this.getViewWidth(j);v.setSize(vw,0);vw=v.domNode.offsetWidth;r-=vw;_700(v,r);}if(c<len){v=this.views[c];vw=Math.max(1,r-l);v.setSize(vw+"px",0);_700(v,l);}return l;},renderRow:function(_701,_702,_703){var _704=[];for(var i=0,v,n,_705;(v=this.views[i])&&(n=_702[i]);i++){_705=v.renderRow(_701);n.appendChild(_705);_704.push(_705);}if(!_703){this.normalizeRowNodeHeights(_704);}},rowRemoved:function(_706){this.onEach("rowRemoved",[_706]);},updateRow:function(_707,_708){for(var i=0,v;v=this.views[i];i++){v.updateRow(_707);}if(!_708){this.renormalizeRow(_707);}},updateRowStyles:function(_709){this.onEach("updateRowStyles",[_709]);},setScrollTop:function(_70a){var top=_70a;for(var i=0,v;v=this.views[i];i++){top=v.setScrollTop(_70a);if(has("ie")&&v.headerNode&&v.scrollboxNode){v.headerNode.scrollLeft=v.scrollboxNode.scrollLeft;}}return top;},getFirstScrollingView:function(){for(var i=0,v;(v=this.views[i]);i++){if(v.hasHScrollbar()||v.hasVScrollbar()){return v;}}return null;}});});},"dojox/grid/util":function(){define("dojox/grid/util",["../main","dojo/_base/lang","dojo/dom"],function(_70b,lang,dom){var dgu=lang.getObject("grid.util",true,_70b);dgu.na="...";dgu.rowIndexTag="gridRowIndex";dgu.gridViewTag="gridView";dgu.fire=function(ob,ev,args){var fn=ob&&ev&&ob[ev];return fn&&(args?fn.apply(ob,args):ob[ev]());};dgu.setStyleHeightPx=function(_70c,_70d){if(_70d>=0){var s=_70c.style;var v=_70d+"px";if(_70c&&s["height"]!=v){s["height"]=v;}}};dgu.mouseEvents=["mouseover","mouseout","mousedown","mouseup","click","dblclick","contextmenu"];dgu.keyEvents=["keyup","keydown","keypress"];dgu.funnelEvents=function(_70e,_70f,_710,_711){var evts=(_711?_711:dgu.mouseEvents.concat(dgu.keyEvents));for(var i=0,l=evts.length;i<l;i++){_70f.connect(_70e,"on"+evts[i],_710);}};dgu.removeNode=function(_712){_712=dom.byId(_712);_712&&_712.parentNode&&_712.parentNode.removeChild(_712);return _712;};dgu.arrayCompare=function(inA,inB){for(var i=0,l=inA.length;i<l;i++){if(inA[i]!=inB[i]){return false;}}return (inA.length==inB.length);};dgu.arrayInsert=function(_713,_714,_715){if(_713.length<=_714){_713[_714]=_715;}else{_713.splice(_714,0,_715);}};dgu.arrayRemove=function(_716,_717){_716.splice(_717,1);};dgu.arraySwap=function(_718,inI,inJ){var _719=_718[inI];_718[inI]=_718[inJ];_718[inJ]=_719;};return dgu;});},"dojox/grid/DataSelection":function(){define("dojox/grid/DataSelection",["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(_71a,_71b,_71c){return _71a("dojox.grid.DataSelection",_71c,{constructor:function(grid){if(grid.keepSelection){this.preserver=new _71b(this);}},destroy:function(){if(this.preserver){this.preserver.destroy();}},getFirstSelected:function(){var idx=_71c.prototype.getFirstSelected.call(this);if(idx==-1){return null;}return this.grid.getItem(idx);},getNextSelected:function(_71d){var _71e=this.grid.getItemIndex(_71d);var idx=_71c.prototype.getNextSelected.call(this,_71e);if(idx==-1){return null;}return this.grid.getItem(idx);},getSelected:function(){var _71f=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_71f.push(this.grid.getItem(i));}}return _71f;},addToSelection:function(_720){if(this.mode=="none"){return;}var idx=null;if(typeof _720=="number"||typeof _720=="string"){idx=_720;}else{idx=this.grid.getItemIndex(_720);}_71c.prototype.addToSelection.call(this,idx);},deselect:function(_721){if(this.mode=="none"){return;}var idx=null;if(typeof _721=="number"||typeof _721=="string"){idx=_721;}else{idx=this.grid.getItemIndex(_721);}_71c.prototype.deselect.call(this,idx);},deselectAll:function(_722){var idx=null;if(_722||typeof _722=="number"){if(typeof _722=="number"||typeof _722=="string"){idx=_722;}else{idx=this.grid.getItemIndex(_722);}_71c.prototype.deselectAll.call(this,idx);}else{this.inherited(arguments);}}});});},"dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","./util/filter","./util/simpleFetch","../date/stamp"],function(_723,lang,_724,_725,xhr,_726,_727,_728,_729){var _72a=_724("dojo.data.ItemFileReadStore",[_726],{constructor:function(_72b){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_72b.url;this._ccUrl=_72b.url;this.url=_72b.url;this._jsonData=_72b.data;this.data=null;this._datatypeMap=_72b.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_72c){return _729.fromISOString(_72c);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_72b.urlPreventCache!==undefined){this.urlPreventCache=_72b.urlPreventCache?true:false;}if(_72b.hierarchical!==undefined){this.hierarchical=_72b.hierarchical?true:false;}if(_72b.clearOnClose){this.clearOnClose=true;}if("failOk" in _72b){this.failOk=_72b.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": Invalid item argument.");}},_assertIsAttribute:function(_72d){if(typeof _72d!=="string"){throw new Error(this.declaredClass+": Invalid attribute argument.");}},getValue:function(item,_72e,_72f){var _730=this.getValues(item,_72e);return (_730.length>0)?_730[0]:_72f;},getValues:function(item,_731){this._assertIsItem(item);this._assertIsAttribute(_731);return (item[_731]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _732=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_732.push(key);}}return _732;},hasAttribute:function(item,_733){this._assertIsItem(item);this._assertIsAttribute(_733);return (_733 in item);},containsValue:function(item,_734,_735){var _736=undefined;if(typeof _735==="string"){_736=_727.patternToRegExp(_735,false);}return this._containsValue(item,_734,_735,_736);},_containsValue:function(item,_737,_738,_739){return _725.some(this.getValues(item,_737),function(_73a){if(_73a!==null&&!lang.isObject(_73a)&&_739){if(_73a.toString().match(_739)){return true;}}else{if(_738===_73a){return true;}}});},isItem:function(_73b){if(_73b&&_73b[this._storeRefPropName]===this){if(this._arrayOfAllItems[_73b[this._itemNumPropName]]===_73b){return true;}}return false;},isItemLoaded:function(_73c){return this.isItem(_73c);},loadItem:function(_73d){this._assertIsItem(_73d.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},filter:function(_73e,_73f,_740){var _741=[],i,key;if(_73e.query){var _742,_743=_73e.queryOptions?_73e.queryOptions.ignoreCase:false;var _744={};for(key in _73e.query){_742=_73e.query[key];if(typeof _742==="string"){_744[key]=_727.patternToRegExp(_742,_743);}else{if(_742 instanceof RegExp){_744[key]=_742;}}}for(i=0;i<_73f.length;++i){var _745=true;var _746=_73f[i];if(_746===null){_745=false;}else{for(key in _73e.query){_742=_73e.query[key];if(!this._containsValue(_746,key,_742,_744[key])){_745=false;}}}if(_745){_741.push(_746);}}_740(_741,_73e);}else{for(i=0;i<_73f.length;++i){var item=_73f[i];if(item!==null){_741.push(item);}}_740(_741,_73e);}},_fetchItems:function(_747,_748,_749){var self=this;if(this._loadFinished){this.filter(_747,this._getItemsArray(_747.queryOptions),_748);}else{if(this._jsonFileUrl!==this._ccUrl){_723.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_747,filter:lang.hitch(self,"filter"),findCallback:lang.hitch(self,_748)});}else{this._loadInProgress=true;var _74a={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _74b=xhr.get(_74a);_74b.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;self.filter(_747,self._getItemsArray(_747.queryOptions),_748);self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_749(e,_747);}});_74b.addErrback(function(_74c){self._loadInProgress=false;_749(_74c,_747);});var _74d=null;if(_747.abort){_74d=_747.abort;}_747.abort=function(){var df=_74b;if(df&&df.fired===-1){df.cancel();df=null;}if(_74d){_74d.call(_747);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;self.filter(_747,this._getItemsArray(_747.queryOptions),_748);}catch(e){_749(e,_747);}}else{_749(new Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),_747);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _74e=this._queuedFetches[i],_74f=_74e.args,_750=_74e.filter,_751=_74e.findCallback;if(_750){_750(_74f,this._getItemsArray(_74f.queryOptions),_751);}else{this.fetchItemByIdentity(_74f);}}this._queuedFetches=[];}},_getItemsArray:function(_752){if(_752&&_752.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_753){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug(this.declaredClass+": WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_754){var _755=false,self=this;function _756(_757){return (_757!==null)&&(typeof _757==="object")&&(!lang.isArray(_757)||_755)&&(!lang.isFunction(_757))&&(_757.constructor==Object||lang.isArray(_757))&&(typeof _757._reference==="undefined")&&(typeof _757._type==="undefined")&&(typeof _757._value==="undefined")&&self.hierarchical;};function _758(_759){self._arrayOfAllItems.push(_759);for(var _75a in _759){var _75b=_759[_75a];if(_75b){if(lang.isArray(_75b)){var _75c=_75b;for(var k=0;k<_75c.length;++k){var _75d=_75c[k];if(_756(_75d)){_758(_75d);}}}else{if(_756(_75b)){_758(_75b);}}}}};this._labelAttr=_754.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_754.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_755=true;}_758(item);item[this._rootItemPropName]=true;}var _75e={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _75f=item[key];if(_75f!==null){if(!lang.isArray(_75f)){item[key]=[_75f];}}else{item[key]=[null];}}_75e[key]=key;}}while(_75e[this._storeRefPropName]){this._storeRefPropName+="_";}while(_75e[this._itemNumPropName]){this._itemNumPropName+="_";}while(_75e[this._reverseRefMap]){this._reverseRefMap+="_";}var _760;var _761=_754.identifier;if(_761){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_761;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_760=item[_761];var _762=_760[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_762)){this._itemsByIdentity[_762]=item;}else{if(this._jsonFileUrl){throw new Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_761+"].  Value collided: ["+_762+"]");}else{if(this._jsonData){throw new Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_761+"].  Value collided: ["+_762+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_760=item[key];for(var j=0;j<_760.length;++j){_75f=_760[j];if(_75f!==null&&typeof _75f=="object"){if(("_type" in _75f)&&("_value" in _75f)){var type=_75f._type;var _763=this._datatypeMap[type];if(!_763){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_763)){_760[j]=new _763(_75f._value);}else{if(lang.isFunction(_763.deserialize)){_760[j]=_763.deserialize(_75f._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_75f._reference){var _764=_75f._reference;if(!lang.isObject(_764)){_760[j]=this._getItemByIdentity(_764);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _765=this._arrayOfAllItems[k],_766=true;for(var _767 in _764){if(_765[_767]!=_764[_767]){_766=false;}}if(_766){_760[j]=_765;}}}if(this.referenceIntegrity){var _768=_760[j];if(this.isItem(_768)){this._addReferenceToMap(_768,item,key);}}}else{if(this.isItem(_75f)){if(this.referenceIntegrity){this._addReferenceToMap(_75f,item,key);}}}}}}}},_addReferenceToMap:function(_769,_76a,_76b){},getIdentity:function(item){var _76c=this._features["dojo.data.api.Identity"];if(_76c===Number){return item[this._itemNumPropName];}else{var _76d=item[_76c];if(_76d){return _76d[0];}}return null;},fetchItemByIdentity:function(_76e){var item,_76f;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_723.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_76e});}else{this._loadInProgress=true;var _770={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _771=xhr.get(_770);_771.addCallback(function(data){var _772=_76e.scope?_76e.scope:_723.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_76e.identity);if(_76e.onItem){_76e.onItem.call(_772,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_76e.onError){_76e.onError.call(_772,error);}}});_771.addErrback(function(_773){self._loadInProgress=false;if(_76e.onError){var _774=_76e.scope?_76e.scope:_723.global;_76e.onError.call(_774,_773);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_76e.identity);if(_76e.onItem){_76f=_76e.scope?_76e.scope:_723.global;_76e.onItem.call(_76f,item);}}}}else{item=this._getItemByIdentity(_76e.identity);if(_76e.onItem){_76f=_76e.scope?_76e.scope:_723.global;_76e.onItem.call(_76f,item);}}},_getItemByIdentity:function(_775){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_775)){item=this._itemsByIdentity[_775];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_775)){item=this._arrayOfAllItems[_775];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _776=this._features["dojo.data.api.Identity"];if(_776===Number){return null;}else{return [_776];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_723.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _777={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _778=xhr.get(_777);_778.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_778.addErrback(function(_779){throw _779;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_72a,_728);return _72a;});},"esri/toolbars/_VertexMover":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/has","dojo/sniff","dojo/dom-style","dojox/gfx/Moveable","esri/kernel","esri/geometry/Point","esri/graphic","esri/geometry/webMercatorUtils"],function(_77a,lang,_77b,has,_77c,_77d,_77e,_77f,_780,_781,_782){var VM=_77a(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(_783,_784,_785,_786,_787,_788,_789,_78a){this.point=_783;this.symbol=_784;this.relatedGraphic=_785;this.segIndex=_786;this.ptIndex=_787;this.segLength=_788;this.editor=_789;this.map=_789.map;this._scratchGL=_789.toolbar._scratchGL;this._placeholder=_78a||false;this._type=_785.geometry.type;this._init();this._enable();},refresh:function(_78b){if(_78b||this._needRefresh()){this._disable();this._enable();}},destroy:function(){this._disable();if(this.graphic){this._scratchGL.remove(this.graphic);}this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null;},_init:function(){var _78c=new _780(this.point.toJson());var _78d=new _781(_78c,this.symbol);switch(this._type){case "multipoint":_78d._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(_78d);break;}this.graphic=_78d;},_enable:function(){var _78e=this.graphic.getDojoShape();if(_78e){_78e._hasMover=true;this._moveable=this._getMoveable(_78e);var node=_78e.getEventSource();if(node){_77d.set(node,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]);}}},_disable:function(){var _78f=this._moveable;if(_78f){_77b.disconnect(this._startHandle);_77b.disconnect(this._firstHandle);_77b.disconnect(this._movingHandle);_77b.disconnect(this._stopHandle);var _790=_78f.shape;if(_790){var node=_790.getEventSource();if(node){_77d.set(node,"cursor",null);}}_78f.destroy();this._moveable=null;}},_needRefresh:function(){var _791=this.graphic.getDojoShape(),need=false;if(_791){switch(this._type){case "multipoint":var _792=this.relatedGraphic.getDojoShape();if(_792){var _793=_792.children[this.ptIndex];if(_791!==_793){_791=_793;this.graphic._shape=_791;need=true;}}break;case "polyline":case "polygon":need=!_791._hasMover;break;}}return need;},_getMoveable:function(_794){var _795=new _77e(_794,_77c("mac")&&_77c("ff")&&!has("esri-touch")&&{leftButtonOnly:true});this._startHandle=_77b.connect(_795,"onMoveStart",this,this._moveStartHandler);this._firstHandle=_77b.connect(_795,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_77b.connect(_795,"onMoving",this,this._movingHandler);this._stopHandle=_77b.connect(_795,"onMoveStop",this,this._moveStopHandler);return _795;},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0);},_getInfo:function(){return {graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()};},_moveStartHandler:function(_796){var map=this.map;if(map.snappingManager){map.snappingManager._setUpSnapping();}_796.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo());},_firstMoveHandler:function(_797){var _798=_797.shape;var _799=this._getControlEdges();var _79a=this._scratchGL._div;var i,_79b=[],_79c=_797.host.shape._wrapOffsets[0]||0;for(i=0;i<_799.length;i++){var edge=_799[i];edge.x1+=_79c;edge.x2+=_79c;_79b.push([_79a.createLine({x1:edge.x1,y1:edge.y1,x2:edge.x2,y2:edge.y2}).setStroke(this.editor._lineStroke),edge.x1,edge.y1,edge.x2,edge.y2]);}_798._lines=_79b;_797.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo());},_movingHandler:function(_79d){var _79e=_79d.shape,tx=_79e.getTransform();var i,_79f=_79e._lines;for(i=0;i<_79f.length;i++){var line=_79f[i];line[0].setShape({x1:line[1]+tx.dx,y1:line[2]+tx.dy,x2:line[3],y2:line[4]});}this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),tx);},_moveStopHandler:function(_7a0){var _7a1=_7a0.shape,_7a2=this.editor.toolbar,tx=_7a1.getTransform(),map=this.map,host=this.graphic,_7a3=_7a2._geo?_782.geographicToWebMercator(host.geometry):host.geometry;var i,_7a4=_7a1._lines;if(_7a4){for(i=0;i<_7a4.length;i++){_7a4[i][0].removeShape();}_7a1._lines=null;}var ph=false,_7a5=true,info=this._getInfo();if(tx&&(tx.dx||tx.dy)){if(this._placeholder){this._placeholder=false;ph=true;}}else{_7a5=false;}var _7a6;if(map.snappingManager){_7a6=map.snappingManager._snappingPoint;}var _7a7=_7a6||map.toMap(map.toScreen(_7a3).offset(tx.dx,tx.dy));if(map.snappingManager){map.snappingManager._killOffSnapping();}_7a1.setTransform(null);host.setGeometry(_7a2._geo?_782.webMercatorToGeographic(_7a7,true):_7a7);this.constructor.onMoveStop(this,tx);_7a2.onVertexMoveStop(this.relatedGraphic,info,tx);if(!_7a5){_7a2.onVertexClick(this.relatedGraphic,info);}if(ph){_7a2.onVertexAdd(this.relatedGraphic,this._getInfo());}},_getControlEdges:function(){var map=this.map;var _7a8=this.relatedGraphic.geometry;var _7a9=this.segIndex,_7aa=this.ptIndex,_7ab=this.segLength;var _7ac=this._scratchGL._div;var _7ad=_7ac.getTransform();var sdx=_7ad.dx,sdy=_7ad.dy;var pt=map.toScreen(this.graphic.geometry);var x=pt.x-sdx,y=pt.y-sdy;var _7ae=[];var _7af=this.editor._getControlPoints(this,_7a8,_7a9,_7aa,_7ab);if(_7af[0]){_7ae.push({x1:x,y1:y,x2:_7af[0].x-sdx,y2:_7af[0].y-sdy});}if(_7af[1]){_7ae.push({x1:x,y1:y,x2:_7af[1].x-sdx,y2:_7af[1].y-sdy});}return _7ae;}});if(has("extend-esri")){lang.setObject("toolbars.VertexMover",VM,_77f);}lang.mixin(VM,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}});return VM;});},"dojox/grid/cells":function(){define("dojox/grid/cells",["../main","./cells/_base"],function(_7b0){return _7b0.grid.cells;});},"dojox/html/metrics":function(){define("dojox/html/metrics",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/ready","dojo/_base/unload","dojo/_base/window","dojo/dom-geometry"],function(_7b1,lang,has,_7b2,_7b3,_7b4,_7b5){var dhm=lang.getObject("dojox.html.metrics",true);var _7b6=lang.getObject("dojox");dhm.getFontMeasurements=function(){var _7b7={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(has("ie")){_7b4.doc.documentElement.style.fontSize="100%";}var div=_7b4.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";_7b4.body().appendChild(div);for(var p in _7b7){ds.fontSize=p;_7b7[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_7b4.body().removeChild(div);div=null;return _7b7;};var _7b8=null;dhm.getCachedFontMeasurements=function(_7b9){if(_7b9||!_7b8){_7b8=dhm.getFontMeasurements();}return _7b8;};var _7ba=null,_7bb={};dhm.getTextBox=function(text,_7bc,_7bd){var m,s;if(!_7ba){m=_7ba=_7b4.doc.createElement("div");var c=_7b4.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";_7b4.body().appendChild(c);}else{m=_7ba;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_7bc){for(var i in _7bc){if(i in _7bb){continue;}s[i]=_7bc[i];}}if(arguments.length>2&&_7bd){m.className=_7bd;}m.innerHTML=text;var box=_7b5.position(m);box.w=m.parentNode.scrollWidth;return box;};var _7be={w:16,h:16};dhm.getScrollbar=function(){return {w:_7be.w,h:_7be.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_7bf){var f=dhm._fontResizeNode=_7b4.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";fs.display="none";if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[_7b6._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[_7b6._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");_7b4.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};_7b3.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(has("ie")&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});_7b2(function(){try{var n=_7b4.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";_7b4.body().appendChild(n);_7be.w=n.offsetWidth-n.clientWidth;_7be.h=n.offsetHeight-n.clientHeight;_7b4.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in _7b1.config&&!!_7b1.config.fontSizeWatch){dhm.initOnFontResize();}});return dhm;});},"dojox/grid/_Builder":function(){define("dojox/grid/_Builder",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/event","dojo/_base/sniff","dojo/_base/connect","dojo/dnd/Moveable","dojox/html/metrics","./util","dojo/_base/html"],function(_7c0,_7c1,lang,win,_7c2,has,_7c3,_7c4,_7c5,util,html){var dg=_7c0.grid;var _7c6=function(td){return td.cellIndex>=0?td.cellIndex:_7c1.indexOf(td.parentNode.cells,td);};var _7c7=function(tr){return tr.rowIndex>=0?tr.rowIndex:_7c1.indexOf(tr.parentNode.childNodes,tr);};var _7c8=function(_7c9,_7ca){return _7c9&&((_7c9.rows||0)[_7ca]||_7c9.childNodes[_7ca]);};var _7cb=function(node){for(var n=node;n&&n.tagName!="TABLE";n=n.parentNode){}return n;};var _7cc=function(_7cd,_7ce){for(var n=_7cd;n&&_7ce(n);n=n.parentNode){}return n;};var _7cf=function(_7d0){var name=_7d0.toUpperCase();return function(node){return node.tagName!=name;};};var _7d1=util.rowIndexTag;var _7d2=util.gridViewTag;var _7d3=dg._Builder=lang.extend(function(view){if(view){this.view=view;this.grid=view.grid;}},{view:null,_table:"<table class=\"dojoxGridRowTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"",getTableArray:function(){var html=[this._table];if(this.view.viewWidth){html.push([" style=\"width:",this.view.viewWidth,";\""].join(""));}html.push(">");return html;},generateCellMarkup:function(_7d4,_7d5,_7d6,_7d7){var _7d8=[],html;if(_7d7){var _7d9=_7d4.index!=_7d4.grid.getSortIndex()?"":_7d4.grid.sortInfo>0?"aria-sort=\"ascending\"":"aria-sort=\"descending\"";if(!_7d4.id){_7d4.id=this.grid.id+"Hdr"+_7d4.index;}html=["<th tabIndex=\"-1\" aria-readonly=\"true\" role=\"columnheader\"",_7d9,"id=\"",_7d4.id,"\""];}else{var _7da=this.grid.editable&&!_7d4.editable?"aria-readonly=\"true\"":"";html=["<td tabIndex=\"-1\" role=\"gridcell\"",_7da];}if(_7d4.colSpan){html.push(" colspan=\"",_7d4.colSpan,"\"");}if(_7d4.rowSpan){html.push(" rowspan=\"",_7d4.rowSpan,"\"");}html.push(" class=\"dojoxGridCell ");if(_7d4.classes){html.push(_7d4.classes," ");}if(_7d6){html.push(_7d6," ");}_7d8.push(html.join(""));_7d8.push("");html=["\" idx=\"",_7d4.index,"\" style=\""];if(_7d5&&_7d5[_7d5.length-1]!=";"){_7d5+=";";}html.push(_7d4.styles,_7d5||"",_7d4.hidden?"display:none;":"");if(_7d4.unitWidth){html.push("width:",_7d4.unitWidth,";");}_7d8.push(html.join(""));_7d8.push("");html=["\""];if(_7d4.attrs){html.push(" ",_7d4.attrs);}html.push(">");_7d8.push(html.join(""));_7d8.push("");_7d8.push(_7d7?"</th>":"</td>");return _7d8;},isCellNode:function(_7db){return Boolean(_7db&&_7db!=win.doc&&html.attr(_7db,"idx"));},getCellNodeIndex:function(_7dc){return _7dc?Number(html.attr(_7dc,"idx")):-1;},getCellNode:function(_7dd,_7de){for(var i=0,row;((row=_7c8(_7dd.firstChild,i))&&row.cells);i++){for(var j=0,cell;(cell=row.cells[j]);j++){if(this.getCellNodeIndex(cell)==_7de){return cell;}}}return null;},findCellTarget:function(_7df,_7e0){var n=_7df;while(n&&(!this.isCellNode(n)||(n.offsetParent&&_7d2 in n.offsetParent.parentNode&&n.offsetParent.parentNode[_7d2]!=this.view.id))&&(n!=_7e0)){n=n.parentNode;}return n!=_7e0?n:null;},baseDecorateEvent:function(e){e.dispatch="do"+e.type;e.grid=this.grid;e.sourceView=this.view;e.cellNode=this.findCellTarget(e.target,e.rowNode);e.cellIndex=this.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);},findTarget:function(_7e1,_7e2){var n=_7e1;while(n&&(n!=this.domNode)&&(!(_7e2 in n)||(_7d2 in n&&n[_7d2]!=this.view.id))){n=n.parentNode;}return (n!=this.domNode)?n:null;},findRowTarget:function(_7e3){return this.findTarget(_7e3,_7d1);},isIntraNodeEvent:function(e){try{return (e.cellNode&&e.relatedTarget&&html.isDescendant(e.relatedTarget,e.cellNode));}catch(x){return false;}},isIntraRowEvent:function(e){try{var row=e.relatedTarget&&this.findRowTarget(e.relatedTarget);return !row&&(e.rowIndex==-1)||row&&(e.rowIndex==row.gridRowIndex);}catch(x){return false;}},dispatchEvent:function(e){if(e.dispatch in this){return this[e.dispatch](e);}return false;},domouseover:function(e){if(e.cellNode&&(e.cellNode!=this.lastOverCellNode)){this.lastOverCellNode=e.cellNode;this.grid.onMouseOver(e);}this.grid.onMouseOverRow(e);},domouseout:function(e){if(e.cellNode&&(e.cellNode==this.lastOverCellNode)&&!this.isIntraNodeEvent(e,this.lastOverCellNode)){this.lastOverCellNode=null;this.grid.onMouseOut(e);if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}},domousedown:function(e){if(e.cellNode){this.grid.onMouseDown(e);}this.grid.onMouseDownRow(e);}});var _7e4=dg._ContentBuilder=lang.extend(function(view){_7d3.call(this,view);},_7d3.prototype,{update:function(){this.prepareHtml();},prepareHtml:function(){var _7e5=this.grid.get,_7e6=this.view.structure.cells;for(var j=0,row;(row=_7e6[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.get=cell.get||(cell.value==undefined)&&_7e5;cell.markup=this.generateCellMarkup(cell,cell.cellStyles,cell.cellClasses,false);if(!this.grid.editable&&cell.editable){this.grid.editable=true;}}}},generateHtml:function(_7e7,_7e8){var html=this.getTableArray(),v=this.view,_7e9=v.structure.cells,item=this.grid.getItem(_7e8);util.fire(this.view,"onBeforeRow",[_7e8,_7e9]);for(var j=0,row;(row=_7e9[j]);j++){if(row.hidden||row.header){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,m,cc,cs;(cell=row[i]);i++){m=cell.markup;cc=cell.customClasses=[];cs=cell.customStyles=[];m[5]=cell.format(_7e8,item);m[1]=cc.join(" ");m[3]=cs.join(";");html.push.apply(html,m);}html.push("</tr>");}html.push("</table>");return html.join("");},decorateEvent:function(e){e.rowNode=this.findRowTarget(e.target);if(!e.rowNode){return false;}e.rowIndex=e.rowNode[_7d1];this.baseDecorateEvent(e);e.cell=this.grid.getCell(e.cellIndex);return true;}});var _7ea=dg._HeaderBuilder=lang.extend(function(view){this.moveable=null;_7d3.call(this,view);},_7d3.prototype,{_skipBogusClicks:false,overResizeWidth:4,minColWidth:1,update:function(){if(this.tableMap){this.tableMap.mapRows(this.view.structure.cells);}else{this.tableMap=new dg._TableMap(this.view.structure.cells);}},generateHtml:function(_7eb,_7ec){var html=this.getTableArray(),_7ed=this.view.structure.cells;util.fire(this.view,"onBeforeRow",[-1,_7ed]);for(var j=0,row;(row=_7ed[j]);j++){if(row.hidden){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,_7ee;(cell=row[i]);i++){cell.customClasses=[];cell.customStyles=[];if(this.view.simpleStructure){if(cell.draggable){if(cell.headerClasses){if(cell.headerClasses.indexOf("dojoDndItem")==-1){cell.headerClasses+=" dojoDndItem";}}else{cell.headerClasses="dojoDndItem";}}if(cell.attrs){if(cell.attrs.indexOf("dndType='gridColumn_")==-1){cell.attrs+=" dndType='gridColumn_"+this.grid.id+"'";}}else{cell.attrs="dndType='gridColumn_"+this.grid.id+"'";}}_7ee=this.generateCellMarkup(cell,cell.headerStyles,cell.headerClasses,true);_7ee[5]=(_7ec!=undefined?_7ec:_7eb(cell));_7ee[3]=cell.customStyles.join(";");_7ee[1]=cell.customClasses.join(" ");html.push(_7ee.join(""));}html.push("</tr>");}html.push("</table>");return html.join("");},getCellX:function(e){var n,x=e.layerX;if(has("mozilla")||has("ie")>=9){n=_7cc(e.target,_7cf("th"));x-=(n&&n.offsetLeft)||0;var t=e.sourceView.getScrollbarWidth();if(!this.grid.isLeftToRight()){table=_7cc(n,_7cf("table"));x-=(table&&table.offsetLeft)||0;}}n=_7cc(e.target,function(){if(!n||n==e.cellNode){return false;}x+=(n.offsetLeft<0?0:n.offsetLeft);return true;});return x;},decorateEvent:function(e){this.baseDecorateEvent(e);e.rowIndex=-1;e.cellX=this.getCellX(e);return true;},prepareResize:function(e,mod){do{var i=e.cellIndex;e.cellNode=(i?e.cellNode.parentNode.cells[i+mod]:null);e.cellIndex=(e.cellNode?this.getCellNodeIndex(e.cellNode):-1);}while(e.cellNode&&e.cellNode.style.display=="none");return Boolean(e.cellNode);},canResize:function(e){if(!e.cellNode||e.cellNode.colSpan>1){return false;}var cell=this.grid.getCell(e.cellIndex);return !cell.noresize&&cell.canResize();},overLeftResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return (e.cellIndex>0)&&(e.cellX>0&&e.cellX<this.overResizeWidth)&&this.prepareResize(e,-1);}var t=e.cellNode&&(e.cellX>0&&e.cellX<this.overResizeWidth);return t;},overRightResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return e.cellNode&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth);}return (e.cellIndex>0)&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth)&&this.prepareResize(e,-1);},domousemove:function(e){if(!this.moveable){var c=(this.overRightResizeArea(e)?"dojoxGridColResize":(this.overLeftResizeArea(e)?"dojoxGridColResize":""));if(c&&!this.canResize(e)){c="dojoxGridColNoResize";}html.toggleClass(e.sourceView.headerNode,"dojoxGridColNoResize",(c=="dojoxGridColNoResize"));html.toggleClass(e.sourceView.headerNode,"dojoxGridColResize",(c=="dojoxGridColResize"));if(c){_7c2.stop(e);}}},domousedown:function(e){if(!this.moveable){if((this.overRightResizeArea(e)||this.overLeftResizeArea(e))&&this.canResize(e)){this.beginColumnResize(e);}else{this.grid.onMouseDown(e);this.grid.onMouseOverRow(e);}}},doclick:function(e){if(this._skipBogusClicks){_7c2.stop(e);return true;}return false;},colResizeSetup:function(e,_7ef){var _7f0=html.contentBox(e.sourceView.headerNode);if(_7ef){this.lineDiv=document.createElement("div");var vw=html.position(e.sourceView.headerNode,true);var _7f1=html.contentBox(e.sourceView.domNode);var l=e.pageX;if(!this.grid.isLeftToRight()&&has("ie")<8){l-=_7c5.getScrollbar().w;}html.style(this.lineDiv,{top:vw.y+"px",left:l+"px",height:(_7f1.h+_7f0.h)+"px"});html.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=l;win.body().appendChild(this.lineDiv);}var _7f2=[],_7f3=this.tableMap.findOverlappingNodes(e.cellNode);for(var i=0,cell;(cell=_7f3[i]);i++){_7f2.push({node:cell,index:this.getCellNodeIndex(cell),width:cell.offsetWidth});}var view=e.sourceView;var adj=this.grid.isLeftToRight()?1:-1;var _7f4=e.grid.views.views;var _7f5=[];for(var j=view.idx+adj,_7f6;(_7f6=_7f4[j]);j=j+adj){_7f5.push({node:_7f6.headerNode,left:window.parseInt(_7f6.headerNode.style.left)});}var _7f7=view.headerContentNode.firstChild;var drag={scrollLeft:e.sourceView.headerNode.scrollLeft,view:view,node:e.cellNode,index:e.cellIndex,w:html.contentBox(e.cellNode).w,vw:_7f0.w,table:_7f7,tw:html.contentBox(_7f7).w,spanners:_7f2,followers:_7f5};return drag;},beginColumnResize:function(e){this.moverDiv=document.createElement("div");html.style(this.moverDiv,{position:"absolute",left:0});win.body().appendChild(this.moverDiv);html.addClass(this.grid.domNode,"dojoxGridColumnResizing");var m=(this.moveable=new _7c4(this.moverDiv));var drag=this.colResizeSetup(e,true);m.onMove=lang.hitch(this,"doResizeColumn",drag);_7c3.connect(m,"onMoveStop",lang.hitch(this,function(){this.endResizeColumn(drag);if(drag.node.releaseCapture){drag.node.releaseCapture();}this.moveable.destroy();delete this.moveable;this.moveable=null;html.removeClass(this.grid.domNode,"dojoxGridColumnResizing");}));if(e.cellNode.setCapture){e.cellNode.setCapture();}m.onMouseDown(e);},doResizeColumn:function(_7f8,_7f9,_7fa){var _7fb=_7fa.l;var data={deltaX:_7fb,w:_7f8.w+(this.grid.isLeftToRight()?_7fb:-_7fb),vw:_7f8.vw+_7fb,tw:_7f8.tw+_7fb};this.dragRecord={inDrag:_7f8,mover:_7f9,leftTop:_7fa};if(data.w>=this.minColWidth){if(!_7f9){this.doResizeNow(_7f8,data);}else{html.style(this.lineDiv,"left",(this.lineDiv._origLeft+data.deltaX)+"px");}}},endResizeColumn:function(_7fc){if(this.dragRecord){var _7fd=this.dragRecord.leftTop;var _7fe=this.grid.isLeftToRight()?_7fd.l:-_7fd.l;_7fe+=Math.max(_7fc.w+_7fe,this.minColWidth)-(_7fc.w+_7fe);if(has("webkit")&&_7fc.spanners.length){_7fe+=html._getPadBorderExtents(_7fc.spanners[0].node).w;}var data={deltaX:_7fe,w:_7fc.w+_7fe,vw:_7fc.vw+_7fe,tw:_7fc.tw+_7fe};this.doResizeNow(_7fc,data);delete this.dragRecord;}html.destroy(this.lineDiv);html.destroy(this.moverDiv);html.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=true;_7fc.view.update();this._skipBogusClicks=false;this.grid.onResizeColumn(_7fc.index);},doResizeNow:function(_7ff,data){_7ff.view.convertColPctToFixed();if(_7ff.view.flexCells&&!_7ff.view.testFlexCells()){var t=_7cb(_7ff.node);if(t){(t.style.width="");}}var i,s,sw,f,fl;for(i=0;(s=_7ff.spanners[i]);i++){sw=s.width+data.deltaX;if(sw>0){s.node.style.width=sw+"px";_7ff.view.setColWidth(s.index,sw);}}if(this.grid.isLeftToRight()||!has("ie")){for(i=0;(f=_7ff.followers[i]);i++){fl=f.left+data.deltaX;f.node.style.left=fl+"px";}}_7ff.node.style.width=data.w+"px";_7ff.view.setColWidth(_7ff.index,data.w);_7ff.view.headerNode.style.width=data.vw+"px";_7ff.view.setColumnsWidth(data.tw);if(!this.grid.isLeftToRight()){_7ff.view.headerNode.scrollLeft=_7ff.scrollLeft+data.deltaX;}}});dg._TableMap=lang.extend(function(rows){this.mapRows(rows);},{map:null,mapRows:function(_800){var _801=_800.length;if(!_801){return;}this.map=[];var row;for(var k=0;(row=_800[k]);k++){this.map[k]=[];}for(var j=0;(row=_800[j]);j++){for(var i=0,x=0,cell,_802,_803;(cell=row[i]);i++){while(this.map[j][x]){x++;}this.map[j][x]={c:i,r:j};_803=cell.rowSpan||1;_802=cell.colSpan||1;for(var y=0;y<_803;y++){for(var s=0;s<_802;s++){this.map[j+y][x+s]=this.map[j][x];}}x+=_802;}}},dumpMap:function(){for(var j=0,row,h="";(row=this.map[j]);j++,h=""){for(var i=0,cell;(cell=row[i]);i++){h+=cell.r+","+cell.c+"   ";}}},getMapCoords:function(_804,_805){for(var j=0,row;(row=this.map[j]);j++){for(var i=0,cell;(cell=row[i]);i++){if(cell.c==_805&&cell.r==_804){return {j:j,i:i};}}}return {j:-1,i:-1};},getNode:function(_806,_807,_808){var row=_806&&_806.rows[_807];return row&&row.cells[_808];},_findOverlappingNodes:function(_809,_80a,_80b){var _80c=[];var m=this.getMapCoords(_80a,_80b);for(var j=0,row;(row=this.map[j]);j++){if(j==m.j){continue;}var rw=row[m.i];var n=(rw?this.getNode(_809,rw.r,rw.c):null);if(n){_80c.push(n);}}return _80c;},findOverlappingNodes:function(_80d){return this._findOverlappingNodes(_7cb(_80d),_7c7(_80d.parentNode),_7c6(_80d));}});return {_Builder:_7d3,_HeaderBuilder:_7ea,_ContentBuilder:_7e4};});},"dojox/grid/_Scroller":function(){define("dojox/grid/_Scroller",["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],function(_80e,_80f,lang,util,html){var _810=function(_811){var i=0,n,p=_811.parentNode;while((n=p.childNodes[i++])){if(n==_811){return i-1;}}return -1;};var _812=function(_813){if(!_813){return;}dojo.forEach(_80e.toArray(),function(w){if(w.domNode&&html.isDescendant(w.domNode,_813,true)){w.destroy();}});};var _814=function(_815){var node=html.byId(_815);return (node&&node.tagName?node.tagName.toLowerCase():"");};var _816=function(_817,_818){var _819=[];var i=0,n;while((n=_817.childNodes[i])){i++;if(_814(n)==_818){_819.push(n);}}return _819;};var _81a=function(_81b){return _816(_81b,"div");};return _80f("dojox.grid._Scroller",null,{constructor:function(_81c){this.setContentNodes(_81c);this.pageHeights=[];this.pageNodes=[];this.stack=[];},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(_81d,_81e,_81f){switch(arguments.length){case 3:this.rowsPerPage=_81f;case 2:this.keepRows=_81e;case 1:this.rowCount=_81d;default:break;}this.defaultPageHeight=(this.grid.rowHeight>0?this.grid.rowHeight:this.defaultRowHeight)*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();if(this.scrollboxNode){this.scrollboxNode.scrollTop=0;this.scroll(0);this.scrollboxNode.onscroll=lang.hitch(this,"onscroll");}},_getPageCount:function(_820,_821){return _820?(Math.ceil(_820/_821)||1):0;},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode;},setKeepInfo:function(_822){this.keepRows=_822;this.keepPages=!this.keepRows?this.keepPages:Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2);},setContentNodes:function(_823){this.contentNodes=_823;this.colCount=(this.contentNodes?this.contentNodes.length:0);this.pageNodes=[];for(var i=0;i<this.colCount;i++){this.pageNodes[i]=[];}},getDefaultNodes:function(){return this.pageNodes[0]||[];},invalidate:function(){this._invalidating=true;this.invalidateNodes();this.pageHeights=[];this.height=(this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0);this.resize();this._invalidating=false;},updateRowCount:function(_824){this.invalidateNodes();this.rowCount=_824;var _825=this.pageCount;if(_825===0){this.height=1;}this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<_825){for(var i=_825-1;i>=this.pageCount;i--){this.height-=this.getPageHeight(i);delete this.pageHeights[i];}}else{if(this.pageCount>_825){this.height+=this.defaultPageHeight*(this.pageCount-_825-1)+this.calcLastPageHeight();}}this.resize();},pageExists:function(_826){return Boolean(this.getDefaultPageNode(_826));},measurePage:function(_827){if(this.grid.rowHeight){return ((_827+1)*this.rowsPerPage>this.rowCount?this.rowCount-_827*this.rowsPerPage:this.rowsPerPage)*this.grid.rowHeight;}var n=this.getDefaultPageNode(_827);return (n&&n.innerHTML)?n.offsetHeight:undefined;},positionPage:function(_828,_829){for(var i=0;i<this.colCount;i++){this.pageNodes[i][_828].style.top=_829+"px";}},repositionPages:function(_82a){var _82b=this.getDefaultNodes();var last=0;for(var i=0;i<this.stack.length;i++){last=Math.max(this.stack[i],last);}var n=_82b[_82a];var y=(n?this.getPageNodePosition(n)+this.getPageHeight(_82a):0);for(var p=_82a+1;p<=last;p++){n=_82b[p];if(n){if(this.getPageNodePosition(n)==y){return;}this.positionPage(p,y);}y+=this.getPageHeight(p);}},installPage:function(_82c){for(var i=0;i<this.colCount;i++){this.contentNodes[i].appendChild(this.pageNodes[i][_82c]);}},preparePage:function(_82d,_82e){var p=(_82e?this.popPage():null);for(var i=0;i<this.colCount;i++){var _82f=this.pageNodes[i];var _830=(p===null?this.createPageNode():this.invalidatePageNode(p,_82f));_830.pageIndex=_82d;_82f[_82d]=_830;}},renderPage:function(_831){var _832=[];var i,j;for(i=0;i<this.colCount;i++){_832[i]=this.pageNodes[i][_831];}for(i=0,j=_831*this.rowsPerPage;(i<this.rowsPerPage)&&(j<this.rowCount);i++,j++){this.renderRow(j,_832);}},removePage:function(_833){for(var i=0,j=_833*this.rowsPerPage;i<this.rowsPerPage;i++,j++){this.removeRow(j);}},destroyPage:function(_834){for(var i=0;i<this.colCount;i++){var n=this.invalidatePageNode(_834,this.pageNodes[i]);if(n){html.destroy(n);}}},pacify:function(_835){},pacifying:false,pacifyTicks:200,setPacifying:function(_836){if(this.pacifying!=_836){this.pacifying=_836;this.pacify(this.pacifying);}},startPacify:function(){this.startPacifyTicks=new Date().getTime();},doPacify:function(){var _837=(new Date().getTime()-this.startPacifyTicks)>this.pacifyTicks;this.setPacifying(true);this.startPacify();return _837;},endPacify:function(){this.setPacifying(false);},resize:function(){if(this.scrollboxNode){this.windowHeight=this.scrollboxNode.clientHeight;}for(var i=0;i<this.colCount;i++){util.setStyleHeightPx(this.contentNodes[i],Math.max(1,this.height));}var _838=(!this._invalidating);if(!_838){var ah=this.grid.get("autoHeight");if(typeof ah=="number"&&ah<=Math.min(this.rowsPerPage,this.rowCount)){_838=true;}}if(_838){this.needPage(this.page,this.pageTop);}var _839=(this.page<this.pageCount-1)?this.rowsPerPage:((this.rowCount%this.rowsPerPage)||this.rowsPerPage);var _83a=this.getPageHeight(this.page);this.averageRowHeight=(_83a>0&&_839>0)?(_83a/_839):0;},calcLastPageHeight:function(){if(!this.pageCount){return 0;}var _83b=this.pageCount-1;var _83c=((this.rowCount%this.rowsPerPage)||(this.rowsPerPage))*this.defaultRowHeight;this.pageHeights[_83b]=_83c;return _83c;},updateContentHeight:function(inDh){this.height+=inDh;this.resize();},updatePageHeight:function(_83d,_83e,_83f){if(this.pageExists(_83d)){var oh=this.getPageHeight(_83d);var h=(this.measurePage(_83d));if(h===undefined){h=oh;}this.pageHeights[_83d]=h;if(oh!=h){this.updateContentHeight(h-oh);var ah=this.grid.get("autoHeight");if((typeof ah=="number"&&ah>this.rowCount)||(ah===true&&!_83e)){if(!_83f){this.grid.sizeChange();}else{var ns=this.grid.viewsNode.style;ns.height=parseInt(ns.height)+h-oh+"px";this.repositionPages(_83d);}}else{this.repositionPages(_83d);}}return h;}return 0;},rowHeightChanged:function(_840,_841){this.updatePageHeight(Math.floor(_840/this.rowsPerPage),false,_841);},invalidateNodes:function(){while(this.stack.length){this.destroyPage(this.popPage());}},createPageNode:function(){var p=document.createElement("div");html.attr(p,"role","presentation");p.style.position="absolute";p.style[this.grid.isLeftToRight()?"left":"right"]="0";return p;},getPageHeight:function(_842){var ph=this.pageHeights[_842];return (ph!==undefined?ph:this.defaultPageHeight);},pushPage:function(_843){return this.stack.push(_843);},popPage:function(){return this.stack.shift();},findPage:function(_844){var i=0,h=0;for(var ph=0;i<this.pageCount;i++,h+=ph){ph=this.getPageHeight(i);if(h+ph>=_844){break;}}this.page=i;this.pageTop=h;},buildPage:function(_845,_846,_847){this.preparePage(_845,_846);this.positionPage(_845,_847);this.installPage(_845);this.renderPage(_845);this.pushPage(_845);},needPage:function(_848,_849){var h=this.getPageHeight(_848),oh=h;if(!this.pageExists(_848)){this.buildPage(_848,(!this.grid._autoHeight&&this.keepPages&&(this.stack.length>=this.keepPages)),_849);h=this.updatePageHeight(_848,true);}else{this.positionPage(_848,_849);}return h;},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop);},scroll:function(_84a){this.grid.scrollTop=_84a;if(this.colCount){this.startPacify();this.findPage(_84a);var h=this.height;var b=this.getScrollBottom(_84a);for(var p=this.page,y=this.pageTop;(p<this.pageCount)&&((b<0)||(y<b));p++){y+=this.needPage(p,y);}this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,_84a);this.lastVisibleRow=this.getLastVisibleRow(p-1,y,b);if(h!=this.height){this.repositionPages(p-1);}this.endPacify();}},getScrollBottom:function(_84b){return (this.windowHeight>=0?_84b+this.windowHeight:-1);},processNodeEvent:function(e,_84c){var t=e.target;while(t&&(t!=_84c)&&t.parentNode&&(t.parentNode.parentNode!=_84c)){t=t.parentNode;}if(!t||!t.parentNode||(t.parentNode.parentNode!=_84c)){return false;}var page=t.parentNode;e.topRowIndex=page.pageIndex*this.rowsPerPage;e.rowIndex=e.topRowIndex+_810(t);e.rowTarget=t;return true;},processEvent:function(e){return this.processNodeEvent(e,this.contentNode);},renderRow:function(_84d,_84e){},removeRow:function(_84f){},getDefaultPageNode:function(_850){return this.getDefaultNodes()[_850];},positionPageNode:function(_851,_852){},getPageNodePosition:function(_853){return _853.offsetTop;},invalidatePageNode:function(_854,_855){var p=_855[_854];if(p){delete _855[_854];this.removePage(_854,p);_812(p);p.innerHTML="";}return p;},getPageRow:function(_856){return _856*this.rowsPerPage;},getLastPageRow:function(_857){return Math.min(this.rowCount,this.getPageRow(_857+1))-1;},getFirstVisibleRow:function(_858,_859,_85a){if(!this.pageExists(_858)){return 0;}var row=this.getPageRow(_858);var _85b=this.getDefaultNodes();var rows=_81a(_85b[_858]);for(var i=0,l=rows.length;i<l&&_859<_85a;i++,row++){_859+=rows[i].offsetHeight;}return (row?row-1:row);},getLastVisibleRow:function(_85c,_85d,_85e){if(!this.pageExists(_85c)){return 0;}var _85f=this.getDefaultNodes();var row=this.getLastPageRow(_85c);var rows=_81a(_85f[_85c]);for(var i=rows.length-1;i>=0&&_85d>_85e;i--,row--){_85d-=rows[i].offsetHeight;}return row+1;},findTopRow:function(_860){var _861=this.getDefaultNodes();var rows=_81a(_861[this.page]);for(var i=0,l=rows.length,t=this.pageTop,h;i<l;i++){h=rows[i].offsetHeight;t+=h;if(t>=_860){this.offset=h-(t-_860);return i+this.page*this.rowsPerPage;}}return -1;},findScrollTop:function(_862){var _863=Math.floor(_862/this.rowsPerPage);var t=0;var i,l;for(i=0;i<_863;i++){t+=this.getPageHeight(i);}this.pageTop=t;this.page=_863;this.needPage(_863,this.pageTop);var _864=this.getDefaultNodes();var rows=_81a(_864[_863]);var r=_862-this.rowsPerPage*_863;for(i=0,l=rows.length;i<l&&i<r;i++){t+=rows[i].offsetHeight;}return t;},dummy:0});});},"dojox/grid/_Layout":function(){define("dojox/grid/_Layout",["dojo/_base/kernel","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-geometry","./cells","./_RowSelector"],function(dojo,_865,_866,_867,lang,_868){return _866("dojox.grid._Layout",null,{constructor:function(_869){this.grid=_869;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_86a,_86b,_86c,_86d,_86e){var _86f=this.structure[_86a].cells[0];var _870=this.structure[_86b].cells[0];var cell=null;var _871=0;var _872=0;for(var i=0,c;c=_86f[i];i++){if(c.index==_86c){_871=i;break;}}cell=_86f.splice(_871,1)[0];cell.view=this.grid.views.views[_86b];for(i=0,c=null;c=_870[i];i++){if(c.index==_86d){_872=i;break;}}if(!_86e){_872+=1;}_870.splice(_872,0,cell);var _873=this.grid.getCell(this.grid.getSortIndex());if(_873){_873._currentlySorted=this.grid.getSortAsc();}this.cells=[];_86c=0;var v;for(i=0;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0;c=cs[k];k++){c.index=_86c;this.cells.push(c);if("_currentlySorted" in c){var si=_86c+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_86c++;}}}_867.forEach(this.cells,function(c){var _874=c.markup[2].split(" ");var _875=parseInt(_874[1].substring(5));if(_875!=c.index){_874[1]="idx=\""+c.index+"\"";c.markup[2]=_874.join(" ");}});this.grid.setupHeaderMenu();},setColumnVisibility:function(_876,_877){var cell=this.cells[_876];if(cell.hidden==_877){cell.hidden=!_877;var v=cell.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_868.getMarginBox(cell.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_878,_879,_87a){var self=this;var _87b=function(_87c){var w=0;if(_87c.colSpan>1){w=0;}else{w=_87c.width||self._defaultCellProps.width||self.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _87d={grid:this.grid,subrow:_878,layoutIndex:_879,index:this.cells.length};if(_87a&&_87a instanceof _865.grid.cells._Base){var _87e=lang.clone(_87a);_87d.unitWidth=_87b(_87e._props);_87e=lang.mixin(_87e,this._defaultCellProps,_87a._props,_87d);return _87e;}var _87f=_87a.type||_87a.cellType||this._defaultCellProps.type||this._defaultCellProps.cellType||_865.grid.cells.Cell;if(lang.isString(_87f)){_87f=lang.getObject(_87f);}_87d.unitWidth=_87b(_87a);return new _87f(lang.mixin({},this._defaultCellProps,_87a,_87d));},addRowDef:function(_880,_881){var _882=[];var _883=0,_884=0,_885=true;for(var i=0,def,cell;(def=_881[i]);i++){cell=this.addCellDef(_880,i,def);_882.push(cell);this.cells.push(cell);if(_885&&cell.relWidth){_883+=cell.relWidth;}else{if(cell.width){var w=cell.width;if(typeof w=="string"&&w.slice(-1)=="%"){_884+=window.parseInt(w,10);}else{if(w=="auto"){_885=false;}}}}}if(_883&&_885){_867.forEach(_882,function(cell){if(cell.relWidth){cell.width=cell.unitWidth=((cell.relWidth/_883)*(100-_884))+"%";}});}return _882;},addRowsDef:function(_886){var _887=[];if(lang.isArray(_886)){if(lang.isArray(_886[0])){for(var i=0,row;_886&&(row=_886[i]);i++){_887.push(this.addRowDef(i,row));}}else{_887.push(this.addRowDef(0,_886));}}return _887;},addViewDef:function(_888){this._defaultCellProps=_888.defaultCell||{};if(_888.width&&_888.width=="auto"){delete _888.width;}return lang.mixin({},_888,{cells:this.addRowsDef(_888.rows||_888.cells)});},setStructure:function(_889){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_865._scopeName+".grid._RowSelector"};if(lang.isString(this.grid.rowSelector)){var _88a=this.grid.rowSelector;if(_88a=="false"){sel=null;}else{if(_88a!="true"){sel["width"]=_88a;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _88b=function(def){return ("name" in def||"field" in def||"get" in def);};var _88c=function(def){if(lang.isArray(def)){if(lang.isArray(def[0])||_88b(def[0])){return true;}}return false;};var _88d=function(def){return (def!==null&&lang.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_88b(def))));};if(lang.isArray(_889)){var _88e=false;for(var i=0,st;(st=_889[i]);i++){if(_88d(st)){_88e=true;break;}}if(!_88e){s.push(this.addViewDef({cells:_889}));}else{for(i=0;(st=_889[i]);i++){if(_88c(st)){s.push(this.addViewDef({cells:st}));}else{if(_88d(st)){s.push(this.addViewDef(st));}}}}}else{if(_88d(_889)){s.push(this.addViewDef(_889));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});});},"dojo/dnd/Source":function(){define(["../_base/array","../_base/connect","../_base/declare","../_base/kernel","../_base/lang","../dom-class","../dom-geometry","../mouse","../ready","../topic","./common","./Selector","./Manager"],function(_88f,_890,_891,_892,lang,_893,_894,_895,_896,_897,dnd,_898,_899){if(!_892.isAsync){_896(0,function(){var _89a=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_89a);});}var _89b=_891("dojo.dnd.Source",_898,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_89c){lang.mixin(this,lang.mixin({},_89c));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_893.add(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_893.add(this.node,"dojoDndTarget");}if(this.horizontal){_893.add(this.node,"dojoDndHorizontal");}this.topics=[_897.subscribe("/dnd/source/over",lang.hitch(this,"onDndSourceOver")),_897.subscribe("/dnd/start",lang.hitch(this,"onDndStart")),_897.subscribe("/dnd/drop",lang.hitch(this,"onDndDrop")),_897.subscribe("/dnd/cancel",lang.hitch(this,"onDndCancel"))];},checkAcceptance:function(_89d,_89e){if(this==_89d){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_89e.length;++i){var type=_89d.getItem(_89e[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_89f,self){if(_89f){return true;}if(arguments.length<2){self=this==_899.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){_89b.superclass.destroy.call(this);_88f.forEach(this.topics,function(t){t.remove();});this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}_89b.superclass.onMouseMove.call(this,e);var m=_899.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _8a0=this.getSelectedNodes();if(_8a0.length){m.startDrag(this,_8a0,this.copyState(dnd.getCopyKeyState(e),true));}}}if(this.isDragging){var _8a1=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_894.position(this.current,true);}if(this.horizontal){_8a1=(e.pageX-this.targetBox.x<this.targetBox.w/2)==_894.isBodyLtr(this.current.ownerDocument);}else{_8a1=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_8a1!=this.before){this._markTargetAnchor(_8a1);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;_89b.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;_89b.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_8a2){if(this!==_8a2){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_899.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_8a3,_8a4,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_8a3?(copy?"Copied":"Moved"):"");}var _8a5=this.accept&&this.checkAcceptance(_8a3,_8a4);this._changeState("Target",_8a5?"":"Disabled");if(this==_8a3){_899.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_8a6,_8a7,copy,_8a8){if(this==_8a8){this.onDrop(_8a6,_8a7,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_8a9,_8aa,copy){if(this!=_8a9){this.onDropExternal(_8a9,_8aa,copy);}else{this.onDropInternal(_8aa,copy);}},onDropExternal:function(_8ab,_8ac,copy){var _8ad=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _8ad.call(this,_8ab.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node){var t=_8ab.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node){var t=_8ab.getItem(node.id);_8ab.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_8ab.selectNone();}this.insertNodes(true,_8ac,this.before,this.current);if(!copy&&this.creator){_8ab.deleteSelectedNodes();}this._normalizedCreator=_8ad;},onDropInternal:function(_8ae,copy){var _8af=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _8af.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_8ae,this.before,this.current);this._normalizedCreator=_8af;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){_89b.superclass.onOverEvent.call(this);_899.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){_89b.superclass.onOutEvent.call(this);_899.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_8b0){if(this.current==this.targetAnchor&&this.before==_8b0){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_8b0;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(e.type!="touchstart"&&!_895.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(_893.contains(node,"dojoDndHandle")){return true;}if(_893.contains(node,"dojoDndItem")||_893.contains(node,"dojoDndIgnore")){break;}}return false;}});return _89b;});},"dojox/gfx/Moveable":function(){define("dojox/gfx/Moveable",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/topic","dojo/touch","dojo/dom-class","dojo/_base/window","./Mover","dojo/mouse"],function(lang,_8b1,arr,_8b2,_8b3,_8b4,_8b5,win,_8b6,_8b7){return _8b1("dojox.gfx.Moveable",null,{constructor:function(_8b8,_8b9){this.shape=_8b8;this.delay=(_8b9&&_8b9.delay>0)?_8b9.delay:0;this.mover=(_8b9&&_8b9.mover)?_8b9.mover:_8b6;this.leftButtonOnly=_8b9&&_8b9.leftButtonOnly;this.events=[this.shape.connect(_8b4.press,lang.hitch(this,"onMouseDown"))];},destroy:function(){arr.forEach(this.events,function(_8ba){_8ba.remove();});this.events=this.shape=null;},onMouseDown:function(e){if(this.delay){this.events.push(this.shape.connect(_8b4.move,lang.hitch(this,"onMouseMove")),this.shape.connect(_8b4.release,lang.hitch(this,"onMouseUp")));this._lastX=e.clientX;this._lastY=e.clientY;}else{if(!this.leftButtonOnly||_8b7.isLeft(e)){new this.mover(this.shape,e,this);}}_8b2.stop(e);},onMouseMove:function(e){var _8bb=e.clientX,_8bc=e.clientY;if(Math.abs(_8bb-this._lastX)>this.delay||Math.abs(_8bc-this._lastY)>this.delay){this.onMouseUp(e);new this.mover(this.shape,e,this);}_8b2.stop(e);},onMouseUp:function(e){this.events.pop().remove();},onMoveStart:function(_8bd){_8b3.publish("/gfx/move/start",_8bd);_8b5.add(win.body(),"dojoMove");},onMoveStop:function(_8be){_8b3.publish("/gfx/move/stop",_8be);_8b5.remove(win.body(),"dojoMove");},onFirstMove:function(_8bf){},onMove:function(_8c0,_8c1){this.onMoving(_8c0,_8c1);this.shape.applyLeftTransform(_8c1);this.onMoved(_8c0,_8c1);},onMoving:function(_8c2,_8c3){},onMoved:function(_8c4,_8c5){}});});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_8c6,_8c7){return _8c6("dijit._Contained",null,{_getSibling:function(_8c8){var node=this.domNode;do{node=node[_8c8+"Sibling"];}while(node&&node.nodeType!=1);return node&&_8c7.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"dojox/grid/_RowManager":function(){define("dojox/grid/_RowManager",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class"],function(_8c9,lang,_8ca){var _8cb=function(_8cc,_8cd){if(_8cc.style.cssText==undefined){_8cc.setAttribute("style",_8cd);}else{_8cc.style.cssText=_8cd;}};return _8c9("dojox.grid._RowManager",null,{constructor:function(_8ce){this.grid=_8ce;},linesToEms:2,overRow:-2,prepareStylingRow:function(_8cf,_8d0){return {index:_8cf,node:_8d0,odd:Boolean(_8cf&1),selected:!!this.grid.selection.isSelected(_8cf),over:this.isOver(_8cf),customStyles:"",customClasses:"dojoxGridRow"};},styleRowNode:function(_8d1,_8d2){var row=this.prepareStylingRow(_8d1,_8d2);this.grid.onStyleRow(row);this.applyStyles(row);},applyStyles:function(_8d3){var i=_8d3;i.node.className=i.customClasses;var h=i.node.style.height;_8cb(i.node,i.customStyles+";"+(i.node._style||""));i.node.style.height=h;},updateStyles:function(_8d4){this.grid.updateRowStyles(_8d4);},setOverRow:function(_8d5){var last=this.overRow;this.overRow=_8d5;if((last!=this.overRow)&&(lang.isString(last)||last>=0)){this.updateStyles(last);}this.updateStyles(this.overRow);},isOver:function(_8d6){return (this.overRow==_8d6&&!_8ca.contains(this.grid.domNode,"dojoxGridColumnResizing"));}});});},"esri/layers/FeatureEditResult":function(){define("esri/layers/FeatureEditResult",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_8d7,lang,has,_8d8){var _8d9=_8d7(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(json){if(json&&lang.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});if(has("extend-esri")){lang.setObject("layers.FeatureEditResult",_8d9,_8d8);}return _8d9;});},"dojo/dnd/Container":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../_base/window","../dom","../dom-class","../dom-construct","../Evented","../has","../on","../query","../ready","../touch","./common"],function(_8da,_8db,_8dc,_8dd,lang,win,dom,_8de,_8df,_8e0,has,on,_8e1,_8e2,_8e3,dnd){var _8e4=_8db("dojo.dnd.Container",_8e0,{skipForm:false,allowNested:false,constructor:function(node,_8e5){this.node=dom.byId(node);if(!_8e5){_8e5={};}this.creator=_8e5.creator||null;this.skipForm=_8e5.skipForm;this.parent=_8e5.dropParent&&dom.byId(_8e5.dropParent);this.map={};this.current=null;this.containerState="";_8de.add(this.node,"dojoDndContainer");if(!(_8e5&&_8e5._skipStartup)){this.startup();}this.events=[on(this.node,_8e3.over,lang.hitch(this,"onMouseOver")),on(this.node,_8e3.out,lang.hitch(this,"onMouseOut")),on(this.node,"dragstart",lang.hitch(this,"onSelectStart")),on(this.node,"selectstart",lang.hitch(this,"onSelectStart"))];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||_8dd.global;var m=this.map,e=dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return _8e1((this.allowNested?"":"> ")+".dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_8e6,_8e7){if(!this.parent.firstChild){_8e7=null;}else{if(_8e6){if(!_8e7){_8e7=this.parent.firstChild;}}else{if(_8e7){_8e7=_8e7.nextSibling;}}}var i,t;if(_8e7){for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});_8e7.parentNode.insertBefore(t.node,_8e7);}}else{for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){_8da.forEach(this.events,function(_8e8){_8e8.remove();});this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_8e9,node,Ctor){_8e9._skipStartup=true;return new Ctor(node,_8e9);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dnd.isFormElement(e)){_8dc.stop(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_8ea){var _8eb="dojoDnd"+type;var _8ec=type.toLowerCase()+"State";_8de.replace(this.node,_8eb+_8ea,_8eb+this[_8ec]);this[_8ec]=_8ea;},_addItemClass:function(node,type){_8de.add(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){_8de.remove(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _8ed=node.parentNode;_8ed;node=_8ed,_8ed=node.parentNode){if((_8ed==this.parent||this.allowNested)&&_8de.contains(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!lang.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dnd.getUniqueId();}_8de.add(t.node,"dojoDndItem");return t;}});dnd._createNode=function(tag){if(!tag){return dnd._createSpan;}return function(text){return _8df.create(tag,{innerHTML:text});};};dnd._createTrTd=function(text){var tr=_8df.create("tr");_8df.create("td",{innerHTML:text},tr);return tr;};dnd._createSpan=function(text){return _8df.create("span",{innerHTML:text});};dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dnd._createTrTd:dnd._createNode(dnd._defaultCreatorNodes[tag]);return function(item,hint){var _8ee=item&&lang.isObject(item),data,type,n;if(_8ee&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_8ee&&item.data)?item.data:item;type=(_8ee&&item.type)?item.type:["text"];n=(hint=="avatar"?dnd._createSpan:c)(String(data));}if(!n.id){n.id=dnd.getUniqueId();}return {node:n,data:data,type:type};};};return _8e4;});},"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n","dojo/dnd/Manager":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../_base/window","../dom-class","../Evented","../has","../keys","../on","../topic","../touch","./common","./autoscroll","./Avatar"],function(_8ef,_8f0,_8f1,lang,win,_8f2,_8f3,has,keys,on,_8f4,_8f5,dnd,_8f6,_8f7){var _8f8=_8f0("dojo.dnd.Manager",[_8f3],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:has("touch")?0:16,OFFSET_Y:has("touch")?-64:16,overSource:function(_8f9){if(this.avatar){this.target=(_8f9&&_8f9.targetState!="Disabled")?_8f9:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}_8f4.publish("/dnd/source/over",_8f9);},outSource:function(_8fa){if(this.avatar){if(this.target==_8fa){this.target=null;this.canDropFlag=false;this.avatar.update();_8f4.publish("/dnd/source/over",null);}}else{_8f4.publish("/dnd/source/over",null);}},startDrag:function(_8fb,_8fc,copy){_8f6.autoScrollStart(win.doc);this.source=_8fb;this.nodes=_8fc;this.copy=Boolean(copy);this.avatar=this.makeAvatar();win.body().appendChild(this.avatar.node);_8f4.publish("/dnd/start",_8fb,_8fc,this.copy);this.events=[on(win.doc,_8f5.move,lang.hitch(this,"onMouseMove")),on(win.doc,_8f5.release,lang.hitch(this,"onMouseUp")),on(win.doc,"keydown",lang.hitch(this,"onKeyDown")),on(win.doc,"keyup",lang.hitch(this,"onKeyUp")),on(win.doc,"dragstart",_8f1.stop),on(win.body(),"selectstart",_8f1.stop)];var c="dojoDnd"+(copy?"Copy":"Move");_8f2.add(win.body(),c);},canDrop:function(flag){var _8fd=Boolean(this.target&&flag);if(this.canDropFlag!=_8fd){this.canDropFlag=_8fd;this.avatar.update();}},stopDrag:function(){_8f2.remove(win.body(),["dojoDndCopy","dojoDndMove"]);_8ef.forEach(this.events,function(_8fe){_8fe.remove();});this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new _8f7(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){_8f6.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}if(has("touch")){e.preventDefault();}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));_8f4.publish("/dnd/drop/before",this.source,this.nodes,copy,this.target,e);_8f4.publish("/dnd/drop",this.source,this.nodes,copy,this.target,e);}else{_8f4.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case keys.ESCAPE:_8f4.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();_8f2.replace(win.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dnd._manager=null;_8f8.manager=dnd.manager=function(){if(!dnd._manager){dnd._manager=new _8f8();}return dnd._manager;};return _8f8;});},"dojo/dnd/Avatar":function(){define(["../_base/declare","../_base/window","../dom","../dom-attr","../dom-class","../dom-construct","../hccss","../query"],function(_8ff,win,dom,_900,_901,_902,has,_903){return _8ff("dojo.dnd.Avatar",null,{constructor:function(_904){this.manager=_904;this.construct();},construct:function(){var a=_902.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_905=this.manager.source,node,b=_902.create("tbody",null,a),tr=_902.create("tr",null,b),td=_902.create("td",null,tr),k=Math.min(5,this.manager.nodes.length),i=0;if(has("highcontrast")){_902.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td);}_902.create("span",{innerHTML:_905.generateText?this._generateText():""},td);_900.set(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_905.creator){node=_905._normalizedCreator(_905.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _906=_902.create("table"),_907=_902.create("tbody",null,_906);_907.appendChild(node);node=_906;}}node.id="";tr=_902.create("tr",null,b);td=_902.create("td",null,tr);td.appendChild(node);_900.set(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){_902.destroy(this.node);this.node=false;},update:function(){_901.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(has("highcontrast")){var icon=dom.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}_903(("tr.dojoDndAvatarHeader td span"+(has("highcontrast")?" span":"")),this.node).forEach(function(node){node.innerHTML=this.manager.source.generateText?this._generateText():"";},this);},_generateText:function(){return this.manager.nodes.length.toString();}});});},"dojox/grid/_SelectionPreserver":function(){define("dojox/grid/_SelectionPreserver",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(_908,_909,lang,_90a){return _908("dojox.grid._SelectionPreserver",null,{constructor:function(_90b){this.selection=_90b;var grid=this.grid=_90b.grid;this.reset();this._connects=[_909.connect(grid,"_setStore",this,"reset"),_909.connect(grid,"_addItem",this,"_reSelectById"),_909.connect(_90b,"onSelected",lang.hitch(this,"_selectById",true)),_909.connect(_90b,"onDeselected",lang.hitch(this,"_selectById",false)),_909.connect(_90b,"deselectAll",this,"reset")];},destroy:function(){this.reset();_90a.forEach(this._connects,_909.disconnect);delete this._connects;},reset:function(){this._selectedById={};},_reSelectById:function(item,_90c){if(item&&this.grid._hasIdentity){this.selection.selected[_90c]=this._selectedById[this.grid.store.getIdentity(item)];}},_selectById:function(_90d,_90e){if(this.selection.mode=="none"||!this.grid._hasIdentity){return;}var item=_90e,g=this.grid;if(typeof _90e=="number"||typeof _90e=="string"){var _90f=g._by_idx[_90e];item=_90f&&_90f.item;}if(item){this._selectedById[g.store.getIdentity(item)]=!!_90d;}return item;}});});},"dojox/grid/_FocusManager":function(){define("dojox/grid/_FocusManager",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/event","dojo/_base/sniff","dojo/query","./util","dojo/_base/html"],function(_910,lang,_911,_912,_913,has,_914,util,html){return _911("dojox.grid._FocusManager",null,{constructor:function(_915){this.grid=_915;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(_912.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(_912.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(_912.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(_912.connect(this.grid.domNode,"mouseup",this,"_mouseUp"));this._connects.push(_912.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(_912.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(_912.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(_912.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(_912.connect(this.grid,"postrender",this,"_delayedHeaderFocus"));},destroy:function(){_910.forEach(this._connects,_912.disconnect);_910.forEach(this._headerConnects,_912.disconnect);delete this.grid;delete this.cell;},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:false,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders();},isFocusCell:function(_916,_917){return (this.cell==_916)&&(this.rowIndex==_917);},isLastFocusCell:function(){if(this.cell){return (this.rowIndex==this.grid.rowCount-1)&&(this.cell.index==this.grid.layout.cellCount-1);}return false;},isFirstFocusCell:function(){if(this.cell){return (this.rowIndex===0)&&(this.cell.index===0);}return false;},isNoFocusCell:function(){return (this.rowIndex<0)||!this.cell;},isNavHeader:function(){return (!!this._colHeadNode);},getHeaderIndex:function(){if(this._colHeadNode){return _910.indexOf(this._findHeaderCells(),this._colHeadNode);}else{return -1;}},_focusifyCellNode:function(_918){var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){html.toggleClass(n,this.focusClass,_918);if(_918){var sl=this.scrollIntoView();try{if(has("webkit")||!this.grid.edit.isEditing()){util.fire(n,"focus");if(sl){this.cell.view.scrollboxNode.scrollLeft=sl;}}}catch(e){}}}},_delayedCellFocus:function(){if(this.isNavHeader()||!this.grid.focused){return;}var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){try{if(!this.grid.edit.isEditing()){html.toggleClass(n,this.focusClass,true);if(this._colHeadNode){this.blurHeader();}util.fire(n,"focus");}}catch(e){}}},_delayedHeaderFocus:function(){if(this.isNavHeader()){this.focusHeader();}},_initColumnHeaders:function(){_910.forEach(this._headerConnects,_912.disconnect);this._headerConnects=[];var _919=this._findHeaderCells();for(var i=0;i<_919.length;i++){this._headerConnects.push(_912.connect(_919[i],"onfocus",this,"doColHeaderFocus"));this._headerConnects.push(_912.connect(_919[i],"onblur",this,"doColHeaderBlur"));}},_findHeaderCells:function(){var _91a=_914("th",this.grid.viewsHeaderNode);var _91b=[];for(var i=0;i<_91a.length;i++){var _91c=_91a[i];var _91d=html.hasAttr(_91c,"tabIndex");var _91e=html.attr(_91c,"tabIndex");if(_91d&&_91e<0){_91b.push(_91c);}}return _91b;},_setActiveColHeader:function(_91f,_920,_921){this.grid.domNode.setAttribute("aria-activedescendant",_91f.id);if(_921!=null&&_921>=0&&_921!=_920){html.toggleClass(this._findHeaderCells()[_921],this.focusClass,false);}html.toggleClass(_91f,this.focusClass,true);this._colHeadNode=_91f;this._colHeadFocusIdx=_920;this._scrollHeader(this._colHeadFocusIdx);},scrollIntoView:function(){var info=(this.cell?this._scrollInfo(this.cell):null);if(!info||!info.s){return null;}var rt=this.grid.scroller.findScrollTop(this.rowIndex);if(info.n&&info.sr){if(info.n.offsetLeft+info.n.offsetWidth>info.sr.l+info.sr.w){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}}}if(info.r&&info.sr){if(rt+info.r.offsetHeight>info.sr.t+info.sr.h){this.grid.setScrollTop(rt+info.r.offsetHeight-info.sr.h);}else{if(rt<info.sr.t){this.grid.setScrollTop(rt);}}}return info.s.scrollLeft;},_scrollInfo:function(cell,_922){if(cell){var cl=cell,sbn=cl.view.scrollboxNode,sbnr={w:sbn.clientWidth,l:sbn.scrollLeft,t:sbn.scrollTop,h:sbn.clientHeight},rn=cl.view.getRowNode(this.rowIndex);return {c:cl,s:sbn,sr:sbnr,n:(_922?_922:cell.getNode(this.rowIndex)),r:rn};}return null;},_scrollHeader:function(_923){var info=null;if(this._colHeadNode){var cell=this.grid.getCell(_923);if(!cell){return;}info=this._scrollInfo(cell,cell.getNode(0));}if(info&&info.s&&info.sr&&info.n){var _924=info.sr.l+info.sr.w;if(info.n.offsetLeft+info.n.offsetWidth>_924){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}else{if(has("ie")<=7&&cell&&cell.view.headerNode){cell.view.headerNode.scrollLeft=info.s.scrollLeft;}}}}},_isHeaderHidden:function(){var _925=this.focusView;if(!_925){for(var i=0,_926;(_926=this.grid.views.views[i]);i++){if(_926.headerNode){_925=_926;break;}}}return (_925&&html.getComputedStyle(_925.headerNode).display=="none");},colSizeAdjust:function(e,_927,_928){var _929=this._findHeaderCells();var view=this.focusView;if(!view||!view.header.tableMap.map){for(var i=0,_92a;(_92a=this.grid.views.views[i]);i++){if(_92a.header.tableMap.map){view=_92a;break;}}}var _92b=_929[_927];if(!view||(_927==_929.length-1&&_927===0)){return;}view.content.baseDecorateEvent(e);e.cellNode=_92b;e.cellIndex=view.content.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);if(view.header.canResize(e)){var _92c={l:_928};var drag=view.header.colResizeSetup(e,false);view.header.doResizeColumn(drag,null,_92c);view.update();}},styleRow:function(_92d){return;},setFocusIndex:function(_92e,_92f){this.setFocusCell(this.grid.getCell(_92f),_92e);},setFocusCell:function(_930,_931){if(_930&&!this.isFocusCell(_930,_931)){this.tabbingOut=false;if(this._colHeadNode){this.blurHeader();}this._colHeadNode=this._colHeadFocusIdx=null;this.focusGridView();this._focusifyCellNode(false);this.cell=_930;this.rowIndex=_931;this._focusifyCellNode(true);}if(has("opera")){setTimeout(lang.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);}else{this.grid.onCellFocus(this.cell,this.rowIndex);}},next:function(){if(this.cell){var row=this.rowIndex,col=this.cell.index+1,cc=this.grid.layout.cellCount-1,rc=this.grid.rowCount-1;if(col>cc){col=0;row++;}if(row>rc){col=cc;row=rc;}if(this.grid.edit.isEditing()){var _932=this.grid.getCell(col);if(!this.isLastFocusCell()&&(!_932.editable||this.grid.canEdit&&!this.grid.canEdit(_932,row))){this.cell=_932;this.rowIndex=row;this.next();return;}}this.setFocusIndex(row,col);}},previous:function(){if(this.cell){var row=(this.rowIndex||0),col=(this.cell.index||0)-1;if(col<0){col=this.grid.layout.cellCount-1;row--;}if(row<0){row=0;col=0;}if(this.grid.edit.isEditing()){var _933=this.grid.getCell(col);if(!this.isFirstFocusCell()&&!_933.editable){this.cell=_933;this.rowIndex=row;this.previous();return;}}this.setFocusIndex(row,col);}},move:function(_934,_935){var _936=_935<0?-1:1;if(this.isNavHeader()){var _937=this._findHeaderCells();var _938=currentIdx=_910.indexOf(_937,this._colHeadNode);currentIdx+=_935;while(currentIdx>=0&&currentIdx<_937.length&&_937[currentIdx].style.display=="none"){currentIdx+=_936;}if((currentIdx>=0)&&(currentIdx<_937.length)){this._setActiveColHeader(_937[currentIdx],currentIdx,_938);}}else{if(this.cell){var sc=this.grid.scroller,r=this.rowIndex,rc=this.grid.rowCount-1,row=Math.min(rc,Math.max(0,r+_934));if(_934){if(_934>0){if(row>sc.getLastPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop+sc.findScrollTop(row)-sc.findScrollTop(r));}}else{if(_934<0){if(row<=sc.getPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop-sc.findScrollTop(r)-sc.findScrollTop(row));}}}}var cc=this.grid.layout.cellCount-1,i=this.cell.index,col=Math.min(cc,Math.max(0,i+_935));var cell=this.grid.getCell(col);while(col>=0&&col<cc&&cell&&cell.hidden===true){col+=_936;cell=this.grid.getCell(col);}if(!cell||cell.hidden===true){col=i;}var n=cell.getNode(row);if(!n&&_934){if((row+_934)>=0&&(row+_934)<=rc){this.move(_934>0?++_934:--_934,_935);}return;}else{if((!n||html.style(n,"display")==="none")&&_935){if((col+_935)>=0&&(col+_935)<=cc){this.move(_934,_935>0?++_935:--_935);}return;}}this.setFocusIndex(row,col);if(_934){this.grid.updateRow(r);}}}},previousKey:function(e){if(this.grid.edit.isEditing()){_913.stop(e);this.previous();}else{if(!this.isNavHeader()&&!this._isHeaderHidden()){this.grid.domNode.focus();_913.stop(e);}else{this.tabOut(this.grid.domNode);if(this._colHeadFocusIdx!=null){html.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,false);this._colHeadFocusIdx=null;}this._focusifyCellNode(false);}}},nextKey:function(e){var _939=(this.grid.rowCount===0);if(e.target===this.grid.domNode&&this._colHeadFocusIdx==null){this.focusHeader();_913.stop(e);}else{if(this.isNavHeader()){this.blurHeader();if(!this.findAndFocusGridCell()){this.tabOut(this.grid.lastFocusNode);}this._colHeadNode=this._colHeadFocusIdx=null;}else{if(this.grid.edit.isEditing()){_913.stop(e);this.next();}else{this.tabOut(this.grid.lastFocusNode);}}}},tabOut:function(_93a){this.tabbingOut=true;_93a.focus();},focusGridView:function(){util.fire(this.focusView,"focus");},focusGrid:function(_93b){this.focusGridView();this._focusifyCellNode(true);},findAndFocusGridCell:function(){var _93c=true;var _93d=(this.grid.rowCount===0);if(this.isNoFocusCell()&&!_93d){var _93e=0;var cell=this.grid.getCell(_93e);if(cell.hidden){_93e=this.isNavHeader()?this._colHeadFocusIdx:0;}this.setFocusIndex(0,_93e);}else{if(this.cell&&!_93d){if(this.focusView&&!this.focusView.rowNodes[this.rowIndex]){this.grid.scrollToRow(this.rowIndex);}this.focusGrid();}else{_93c=false;}}this._colHeadNode=this._colHeadFocusIdx=null;return _93c;},focusHeader:function(){var _93f=this._findHeaderCells();var _940=this._colHeadFocusIdx;if(this._isHeaderHidden()){this.findAndFocusGridCell();}else{if(!this._colHeadFocusIdx){if(this.isNoFocusCell()){this._colHeadFocusIdx=0;}else{this._colHeadFocusIdx=this.cell.index;}}}this._colHeadNode=_93f[this._colHeadFocusIdx];while(this._colHeadNode&&this._colHeadFocusIdx>=0&&this._colHeadFocusIdx<_93f.length&&this._colHeadNode.style.display=="none"){this._colHeadFocusIdx++;this._colHeadNode=_93f[this._colHeadFocusIdx];}if(this._colHeadNode&&this._colHeadNode.style.display!="none"){if(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode){this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode);this.headerMenu.bindDomNode(this.grid.domNode);this._contextMenuBindNode=this.grid.domNode;}this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,_940);this._scrollHeader(this._colHeadFocusIdx);this._focusifyCellNode(false);}else{this.findAndFocusGridCell();}},blurHeader:function(){html.removeClass(this._colHeadNode,this.focusClass);html.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var _941=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(_941);this._contextMenuBindNode=_941;}},doFocus:function(e){if(e&&e.target!=e.currentTarget){_913.stop(e);return;}if(this._clickFocus){return;}if(!this.tabbingOut){this.focusHeader();}this.tabbingOut=false;_913.stop(e);},doBlur:function(e){_913.stop(e);},doContextMenu:function(e){if(!this.headerMenu){_913.stop(e);}},doLastNodeFocus:function(e){if(this.tabbingOut){this._focusifyCellNode(false);}else{if(this.grid.rowCount>0){if(this.isNoFocusCell()){this.setFocusIndex(0,0);}this._focusifyCellNode(true);}else{this.focusHeader();}}this.tabbingOut=false;_913.stop(e);},doLastNodeBlur:function(e){_913.stop(e);},doColHeaderFocus:function(e){this._setActiveColHeader(e.target,html.attr(e.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());_913.stop(e);},doColHeaderBlur:function(e){html.toggleClass(e.target,this.focusClass,false);},_mouseDown:function(e){this._clickFocus=dojo.some(this.grid.views.views,function(v){return v.scrollboxNode===e.target;});},_mouseUp:function(e){this._clickFocus=false;}});});},"dijit/DropDownMenu":function(){require({cache:{"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n"}});define("dijit/DropDownMenu",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(_942,_943,keys,_944,_945,_946){return _942("dijit.DropDownMenu",[_946,_945],{templateString:_944,baseClass:"dijitMenu",postCreate:function(){this.inherited(arguments);var l=this.isLeftToRight();this._openSubMenuKey=l?keys.RIGHT_ARROW:keys.LEFT_ARROW;this._closeSubMenuKey=l?keys.LEFT_ARROW:keys.RIGHT_ARROW;this.connectKeyNavHandlers([keys.UP_ARROW],[keys.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_943.stop(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_943.stop(evt);}break;}}});});},"esri/layers/FeatureTemplate":function(){define("esri/layers/FeatureTemplate",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/lang","esri/graphic"],function(_947,lang,has,_948,_949,_94a){var _94b=_947(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(json){if(json&&lang.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _94c=json.prototype;this.prototype=new _94a(_94c.geometry,null,_94c.attributes);}},toJson:function(){return _949.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});lang.mixin(_94b,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});if(has("extend-esri")){lang.setObject("layers.FeatureTemplate",_94b,_948);}return _94b;});},"dijit/MenuItem":function(){require({cache:{"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"}});define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/sniff","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_94d,dom,_94e,_94f,_950,has,_951,_952,_953,_954,_955){return _94d("dijit.MenuItem",[_951,_952,_953,_954],{templateString:_955,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(val){this.containerNode.innerHTML=val;this._set("label",val);if(this.textDir==="auto"){this.applyTextDir(this.focusNode,this.label);}},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_956){if(_956&&!("label" in this.params)){this.set("label",_956.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _957=this.id+"_text";_94e.set(this.containerNode,"id",_957);if(this.accelKeyNode){_94e.set(this.accelKeyNode,"id",this.id+"_accel");_957+=" "+this.id+"_accel";}this.domNode.setAttribute("aria-labelledby",_957);dom.setSelectable(this.domNode,false);},onClick:function(){},focus:function(){try{if(has("ie")==8){this.containerNode.focus();}this.focusNode.focus();}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_958){_94f.toggle(this.domNode,"dijitMenuItemSelected",_958);},setLabel:function(_959){_950.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_959);},setDisabled:function(_95a){_950.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_95a);},_setDisabledAttr:function(_95b){this.focusNode.setAttribute("aria-disabled",_95b?"true":"false");this._set("disabled",_95b);},_setAccelKeyAttr:function(_95c){this.accelKeyNode.style.display=_95c?"":"none";this.accelKeyNode.innerHTML=_95c;_94e.set(this.containerNode,"colSpan",_95c?"1":"2");this._set("accelKey",_95c);},_setTextDirAttr:function(_95d){if(!this._created||this.textDir!=_95d){this._set("textDir",_95d);this.applyTextDir(this.focusNode,this.label);}}});});},"dojox/grid/_Events":function(){define("dojox/grid/_Events",["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(keys,_95e,_95f,_960,has){return _95f("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(e){this.dispatchKeyEvent(e);},onContentEvent:function(e){this.dispatchContentEvent(e);},onHeaderEvent:function(e){this.dispatchHeaderEvent(e);},onStyleRow:function(_961){var i=_961;i.customClasses+=(i.odd?" dojoxGridRowOdd":"")+(i.selected?" dojoxGridRowSelected":"")+(i.over?" dojoxGridRowOver":"");this.focus.styleRow(_961);this.edit.styleRow(_961);},onKeyDown:function(e){if(e.altKey||e.metaKey){return;}var _962;switch(e.keyCode){case keys.ESCAPE:this.edit.cancel();break;case keys.ENTER:if(!this.edit.isEditing()){_962=this.focus.getHeaderIndex();if(_962>=0){this.setSortIndex(_962);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_960.stop(e);}if(!e.shiftKey){var _963=this.edit.isEditing();this.edit.apply();if(!_963){this.edit.setEditCell(this.focus.cell,this.focus.rowIndex);}}if(!this.edit.isEditing()){var _964=this.focus.focusView||this.views.views[0];_964.content.decorateEvent(e);this.onRowClick(e);_960.stop(e);}break;case keys.SPACE:if(!this.edit.isEditing()){_962=this.focus.getHeaderIndex();if(_962>=0){this.setSortIndex(_962);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_960.stop(e);}break;case keys.TAB:this.focus[e.shiftKey?"previousKey":"nextKey"](e);break;case keys.LEFT_ARROW:case keys.RIGHT_ARROW:if(!this.edit.isEditing()){var _965=e.keyCode;_960.stop(e);_962=this.focus.getHeaderIndex();if(_962>=0&&(e.shiftKey&&e.ctrlKey)){this.focus.colSizeAdjust(e,_962,(_965==keys.LEFT_ARROW?-1:1)*5);}else{var _966=(_965==keys.LEFT_ARROW)?1:-1;if(this.isLeftToRight()){_966*=-1;}this.focus.move(0,_966);}}break;case keys.UP_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_960.stop(e);this.focus.move(-1,0);}break;case keys.DOWN_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_960.stop(e);this.focus.move(1,0);}break;case keys.PAGE_UP:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_960.stop(e);if(this.focus.rowIndex!=this.scroller.firstVisibleRow+1){this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1));this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0);}}break;case keys.PAGE_DOWN:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_960.stop(e);if(this.focus.rowIndex!=this.scroller.lastVisibleRow-1){this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1));this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0);}}break;default:break;}},onMouseOver:function(e){e.rowIndex==-1?this.onHeaderCellMouseOver(e):this.onCellMouseOver(e);},onMouseOut:function(e){e.rowIndex==-1?this.onHeaderCellMouseOut(e):this.onCellMouseOut(e);},onMouseDown:function(e){e.rowIndex==-1?this.onHeaderCellMouseDown(e):this.onCellMouseDown(e);},onMouseOverRow:function(e){if(!this.rows.isOver(e.rowIndex)){this.rows.setOverRow(e.rowIndex);e.rowIndex==-1?this.onHeaderMouseOver(e):this.onRowMouseOver(e);}},onMouseOutRow:function(e){if(this.rows.isOver(-1)){this.onHeaderMouseOut(e);}else{if(!this.rows.isOver(-2)){this.rows.setOverRow(-2);this.onRowMouseOut(e);}}},onMouseDownRow:function(e){if(e.rowIndex!=-1){this.onRowMouseDown(e);}},onCellMouseOver:function(e){if(e.cellNode){_95e.add(e.cellNode,this.cellOverClass);}},onCellMouseOut:function(e){if(e.cellNode){_95e.remove(e.cellNode,this.cellOverClass);}},onCellMouseDown:function(e){},onCellClick:function(e){this._click[0]=this._click[1];this._click[1]=e;if(!this.edit.isEditCell(e.rowIndex,e.cellIndex)){this.focus.setFocusCell(e.cell,e.rowIndex);}if(this._click.length>1&&this._click[0]==null){this._click.shift();}this.onRowClick(e);},onCellDblClick:function(e){var _967;if(this._click.length>1&&has("ie")){_967=this._click[1];}else{if(this._click.length>1&&this._click[0].rowIndex!=this._click[1].rowIndex){_967=this._click[0];}else{_967=e;}}this.focus.setFocusCell(_967.cell,_967.rowIndex);this.onRowClick(_967);this.edit.setEditCell(_967.cell,_967.rowIndex);this.onRowDblClick(e);},onCellContextMenu:function(e){this.onRowContextMenu(e);},onCellFocus:function(_968,_969){this.edit.cellFocus(_968,_969);},onRowClick:function(e){this.edit.rowClick(e);this.selection.clickSelectEvent(e);},onRowDblClick:function(e){},onRowMouseOver:function(e){},onRowMouseOut:function(e){},onRowMouseDown:function(e){},onRowContextMenu:function(e){_960.stop(e);},onHeaderMouseOver:function(e){},onHeaderMouseOut:function(e){},onHeaderCellMouseOver:function(e){if(e.cellNode){_95e.add(e.cellNode,this.cellOverClass);}},onHeaderCellMouseOut:function(e){if(e.cellNode){_95e.remove(e.cellNode,this.cellOverClass);}},onHeaderCellMouseDown:function(e){},onHeaderClick:function(e){},onHeaderCellClick:function(e){this.setSortIndex(e.cell.index);this.onHeaderClick(e);},onHeaderDblClick:function(e){},onHeaderCellDblClick:function(e){this.onHeaderDblClick(e);},onHeaderCellContextMenu:function(e){this.onHeaderContextMenu(e);},onHeaderContextMenu:function(e){if(!this.headerMenu){_960.stop(e);}},onStartEdit:function(_96a,_96b){},onApplyCellEdit:function(_96c,_96d,_96e){},onCancelEdit:function(_96f){},onApplyEdit:function(_970){},onCanSelect:function(_971){return true;},onCanDeselect:function(_972){return true;},onSelected:function(_973){this.updateRowStyles(_973);},onDeselected:function(_974){this.updateRowStyles(_974);},onSelectionChanged:function(){}});});},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(lang){var _975={};lang.setObject("dojo.data.util.filter",_975);_975.patternToRegExp=function(_976,_977){var rxp="^";var c=null;for(var i=0;i<_976.length;i++){c=_976.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_976.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_977){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _975;});},"dojox/grid/_RowSelector":function(){define("dojox/grid/_RowSelector",["dojo/_base/declare","./_View"],function(_978,_979){return _978("dojox.grid._RowSelector",_979,{defaultWidth:"2em",noscroll:true,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility="hidden";},getWidth:function(){return this.viewWidth||this.defaultWidth;},buildRowContent:function(_97a,_97b){var w=this.contentWidth||0;_97b.innerHTML="<table class=\"dojoxGridRowbarTable\" style=\"width:"+w+"px;height:1px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"><tr><td class=\"dojoxGridRowbarInner\">&nbsp;</td></tr></table>";},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight();},adaptWidth:function(){if(!("contentWidth" in this)&&this.contentNode&&this.contentNode.offsetWidth>0){this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth;}},doStyleRowNode:function(_97c,_97d){var n=["dojoxGridRowbar dojoxGridNonNormalizedCell"];if(this.grid.rows.isOver(_97c)){n.push("dojoxGridRowbarOver");}if(this.grid.selection.isSelected(_97c)){n.push("dojoxGridRowbarSelected");}_97d.className=n.join(" ");},domouseover:function(e){this.grid.onMouseOverRow(e);},domouseout:function(e){if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}});});},"*noref":1}});define("esri/dijit/editing/TemplatePicker-all",["esri/layers/FeatureLayer","esri/toolbars/draw","esri/toolbars/edit","esri/dijit/editing/TemplatePicker"],function(_97e,Draw,Edit,_97f){return {};});